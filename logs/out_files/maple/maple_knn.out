1 1
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn1

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7994; Top5: 0.9739
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7993981945837513, 'ACC_ID': 0.7362086258776329, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7908; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7909151636606546, 'ACC_ID': 0.7334669338677354, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7938; Top5: 0.9785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7934131736526946, 'ACC_ID': 0.7400199600798403, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7975; Top5: 0.9820
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7968063872255489, 'ACC_ID': 0.7465069860279441, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7971; Top5: 0.9827
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.796480743691899, 'ACC_ID': 0.750332005312085, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7913; Top5: 0.9809
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7907771135781383, 'ACC_ID': 0.7423854255621976, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7886; Top5: 0.9806
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.788135593220339, 'ACC_ID': 0.7350448654037887, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7830; Top5: 0.9795
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7825506343200535, 'ACC_ID': 0.7264633874916537, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7807; Top5: 0.9791
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7803166967328122, 'ACC_ID': 0.7223892563640008, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7806; Top5: 0.9790
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7802755620014503, 'ACC_ID': 0.7202683103698332, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7807; Top5: 0.9791
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7803947586664455, 'ACC_ID': 0.7203516337701111, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7805; Top5: 0.9788
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7801691006917756, 'ACC_ID': 0.7200614911606457, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7787; Top5: 0.9785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7783475783475784, 'ACC_ID': 0.7188034188034188, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7782; Top5: 0.9781
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7779694757796948, 'ACC_ID': 0.7179827471798275, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7771; Top5: 0.9777
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7769182782283219, 'ACC_ID': 0.7154086088583905, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7775; Top5: 0.9770
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7771119727411585, 'ACC_ID': 0.7130771942192456, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7778; Top5: 0.9767
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7774822695035462, 'ACC_ID': 0.7115469858156028, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7784; Top5: 0.9771
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7781282860147214, 'ACC_ID': 0.7096740273396425, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7770; Top5: 0.9762
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7767, 'ACC_ID': 0.7078, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33738869 0.29947633 ... 0.16104475 0.15926886 0.15847464]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 77.7000; Top-5 accuracy: 97.6200
{'Method': 'rosita_knn_txt', 'AUC': 0.9621800349999999, 'FPR95': 0.2639, 'ACC_ALL': 0.7767, 'ACC_ID': 0.7078, 'ACC_OOD': 0.9944, 'ACC_HM': 0.8269725296674891, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn1

Step 999: Top1: 0.7881; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7880658436213992, 'ACC_ID': 0.7119341563786008, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7984; Top5: 0.9739
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.79839518555667, 'ACC_ID': 0.7331995987963892, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7928; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7922511690046761, 'ACC_ID': 0.7294589178356713, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7978; Top5: 0.9785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7974051896207585, 'ACC_ID': 0.7375249500998003, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8031; Top5: 0.9812
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8027944111776447, 'ACC_ID': 0.7457085828343314, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8064; Top5: 0.9821
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8061088977423638, 'ACC_ID': 0.7563081009296149, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.8005; Top5: 0.9806
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8001707941929974, 'ACC_ID': 0.7540563620836892, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7993; Top5: 0.9808
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7991026919242273, 'ACC_ID': 0.7522432701894317, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7959; Top5: 0.9800
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7956821722679724, 'ACC_ID': 0.7484976630313821, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7931; Top5: 0.9783
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7927440368811385, 'ACC_ID': 0.745640408899579, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7915; Top5: 0.9777
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7913343002175489, 'ACC_ID': 0.7436548223350253, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7903; Top5: 0.9773
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901807928346326, 'ACC_ID': 0.7405871620500912, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7877; Top5: 0.9759
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7875480399692544, 'ACC_ID': 0.7380476556495004, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7869; Top5: 0.9756
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7866096866096867, 'ACC_ID': 0.7356125356125356, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7849; Top5: 0.9750
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7847378898473789, 'ACC_ID': 0.7335102853351029, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7838; Top5: 0.9743
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7837804117280099, 'ACC_ID': 0.7312538989394884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7831; Top5: 0.9734
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7831042180707319, 'ACC_ID': 0.7274115850076371, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7831; Top5: 0.9727
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7831338652482269, 'ACC_ID': 0.7255097517730497, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7841; Top5: 0.9725
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7841219768664563, 'ACC_ID': 0.7243953732912723, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7825; Top5: 0.9714
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7825, 'ACC_ID': 0.7208, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33737585 0.29968607 ... 0.17030925 0.17030171 0.12413253]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 78.2500; Top-5 accuracy: 97.1400
{'Method': 'rosita_knn_txt', 'AUC': 0.95807811, 'FPR95': 0.2906, 'ACC_ALL': 0.7825, 'ACC_ID': 0.7208, 'ACC_OOD': 0.977, 'ACC_HM': 0.8295695606078455, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn1

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.668724279835391, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7994; Top5: 0.9769
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7993981945837513, 'ACC_ID': 0.6740220661985958, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7961; Top5: 0.9779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7955911823647295, 'ACC_ID': 0.6947227788911156, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7998; Top5: 0.9800
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7994011976047904, 'ACC_ID': 0.7125748502994012, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8031; Top5: 0.9824
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8027944111776447, 'ACC_ID': 0.7221556886227545, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8047; Top5: 0.9834
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8041168658698539, 'ACC_ID': 0.7274236387782205, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7990; Top5: 0.9821
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.798462852263023, 'ACC_ID': 0.72644463421577, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7983; Top5: 0.9820
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7981056829511466, 'ACC_ID': 0.7225822532402791, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7966; Top5: 0.9822
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7963498775873581, 'ACC_ID': 0.7204540396171822, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7973; Top5: 0.9822
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7969532972539587, 'ACC_ID': 0.721186610543195, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7982; Top5: 0.9831
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7980420594633792, 'ACC_ID': 0.7235315445975344, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7996; Top5: 0.9827
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7994692320451153, 'ACC_ID': 0.7258251783048598, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7995; Top5: 0.9828
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7993850883935434, 'ACC_ID': 0.7268255188316679, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7993; Top5: 0.9818
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.799002849002849, 'ACC_ID': 0.7239316239316239, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7979; Top5: 0.9814
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7977438619774386, 'ACC_ID': 0.7232913072329131, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7975; Top5: 0.9813
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7973799126637554, 'ACC_ID': 0.7231441048034934, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7984; Top5: 0.9811
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7982610739043591, 'ACC_ID': 0.7215368346845259, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7992; Top5: 0.9809
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7990913120567376, 'ACC_ID': 0.7199689716312057, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.8005; Top5: 0.9811
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8004206098843323, 'ACC_ID': 0.7197686645636172, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7991; Top5: 0.9809
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7989, 'ACC_ID': 0.7178, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.34116995 0.33056915 ... 0.17455591 0.17436658 0.15763152]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 79.9000; Top-5 accuracy: 98.0900
{'Method': 'rosita_knn_txt', 'AUC': 0.861676675, 'FPR95': 0.5413, 'ACC_ALL': 0.7989, 'ACC_ID': 0.7178, 'ACC_OOD': 0.738, 'ACC_HM': 0.7277598571232312, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn1

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7994; Top5: 0.9769
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7993981945837513, 'ACC_ID': 0.7352056168505516, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7934; Top5: 0.9779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7922511690046761, 'ACC_ID': 0.7361389445557782, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7968; Top5: 0.9800
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7959081836327345, 'ACC_ID': 0.7415169660678643, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8007; Top5: 0.9820
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8, 'ACC_ID': 0.7481037924151697, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8034; Top5: 0.9827
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8027888446215139, 'ACC_ID': 0.7576361221779548, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7962; Top5: 0.9826
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7956162823797325, 'ACC_ID': 0.7546256760603473, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7953; Top5: 0.9833
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7948654037886341, 'ACC_ID': 0.7537387836490529, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7950; Top5: 0.9829
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7945693300689962, 'ACC_ID': 0.7509459158691297, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7957; Top5: 0.9832
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.79514932852275, 'ACC_ID': 0.7508518741230708, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7966; Top5: 0.9842
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.796047860768673, 'ACC_ID': 0.7536258158085569, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7979; Top5: 0.9841
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7974788522142976, 'ACC_ID': 0.7538563609222093, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7980; Top5: 0.9839
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7975403535741737, 'ACC_ID': 0.7538816295157571, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7981; Top5: 0.9830
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7975783475783476, 'ACC_ID': 0.7525641025641026, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7973; Top5: 0.9827
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7969475779694758, 'ACC_ID': 0.7520902455209024, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7967; Top5: 0.9827
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.79638178415471, 'ACC_ID': 0.7508421709295072, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7974; Top5: 0.9823
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7970861238397368, 'ACC_ID': 0.7517330513453179, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7981; Top5: 0.9820
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.797761524822695, 'ACC_ID': 0.7522163120567376, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7994; Top5: 0.9822
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7990536277602523, 'ACC_ID': 0.7528916929547844, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7975; Top5: 0.9821
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7971, 'ACC_ID': 0.7506, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.34017128 0.33747816 ... 0.18045133 0.18044823 0.14450285]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 79.7400; Top-5 accuracy: 98.2100
{'Method': 'rosita_knn_txt', 'AUC': 0.8735930700000001, 'FPR95': 0.3794, 'ACC_ALL': 0.7971, 'ACC_ID': 0.7506, 'ACC_OOD': 0.7234, 'ACC_HM': 0.7367490366350068, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn1

Step 999: Top1: 0.5123; Top5: 0.7942
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.37037037037037035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4915; Top5: 0.7924
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49147442326980945, 'ACC_ID': 0.3640922768304915, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4960; Top5: 0.7754
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49632598530394123, 'ACC_ID': 0.37808951235804944, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5072; Top5: 0.7808
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5069860279441117, 'ACC_ID': 0.3912175648702595, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5172; Top5: 0.7804
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5173652694610779, 'ACC_ID': 0.40479041916167663, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5131; Top5: 0.7801
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5132802124833997, 'ACC_ID': 0.4166666666666667, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5110; Top5: 0.7768
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.510959294050669, 'ACC_ID': 0.42755479647025335, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5076; Top5: 0.7719
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5074775672981057, 'ACC_ID': 0.4339481555333998, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5079; Top5: 0.7716
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.507901179612731, 'ACC_ID': 0.44135321611395506, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5060; Top5: 0.7715
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.506113449589096, 'ACC_ID': 0.4449789536981359, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5012; Top5: 0.7672
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5010877447425671, 'ACC_ID': 0.44488759970993474, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4975; Top5: 0.7654
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49742909271852714, 'ACC_ID': 0.44501575717366065, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4941; Top5: 0.7642
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49423520368946966, 'ACC_ID': 0.4453497309761722, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4922; Top5: 0.7611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49230769230769234, 'ACC_ID': 0.446011396011396, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4933; Top5: 0.7615
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4932979429329794, 'ACC_ID': 0.44897146648971464, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4924; Top5: 0.7604
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4924516531503431, 'ACC_ID': 0.45028072364316907, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4897; Top5: 0.7594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4899541769474797, 'ACC_ID': 0.4495358947244742, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4865; Top5: 0.7578
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4867021276595745, 'ACC_ID': 0.44769503546099293, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4868; Top5: 0.7576
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4869610935856993, 'ACC_ID': 0.44931650893796005, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4838; Top5: 0.7570
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4841, 'ACC_ID': 0.4479, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36348835 0.32038867 ... 0.14424716 0.14417148 0.11259501]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 48.3900; Top-5 accuracy: 75.7000
{'Method': 'rosita_knn_txt', 'AUC': 0.94455295, 'FPR95': 0.2261, 'ACC_ALL': 0.4841, 'ACC_ID': 0.4479, 'ACC_OOD': 0.9873, 'ACC_HM': 0.6162369983277591, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn1

Step 999: Top1: 0.5123; Top5: 0.7984
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.4012345679012346, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4935; Top5: 0.7954
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4934804413239719, 'ACC_ID': 0.3811434302908726, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4973; Top5: 0.7774
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49766199064796257, 'ACC_ID': 0.38877755511022044, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5097; Top5: 0.7798
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5094810379241517, 'ACC_ID': 0.40069860279441116, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5176; Top5: 0.7764
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5181636726546907, 'ACC_ID': 0.40678642714570856, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5148; Top5: 0.7752
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5152722443559097, 'ACC_ID': 0.40836653386454186, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5155; Top5: 0.7726
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.515798462852263, 'ACC_ID': 0.4121833191004839, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5064; Top5: 0.7684
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5064805583250249, 'ACC_ID': 0.40852442671984046, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4959; Top5: 0.7578
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49610505230358337, 'ACC_ID': 0.4006231916314267, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4886; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4888755261575466, 'ACC_ID': 0.3976748847464422, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4856; Top5: 0.7519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.485859318346628, 'ACC_ID': 0.3988397389412618, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4832; Top5: 0.7497
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4833305689169016, 'ACC_ID': 0.40023221098026207, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4801; Top5: 0.7480
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4802459646425826, 'ACC_ID': 0.40015372790161413, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4774; Top5: 0.7465
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4774928774928775, 'ACC_ID': 0.39914529914529917, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4738; Top5: 0.7464
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47378898473788983, 'ACC_ID': 0.39827471798274716, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4717; Top5: 0.7428
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47161572052401746, 'ACC_ID': 0.3986275733000624, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4696; Top5: 0.7417
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46962754082951474, 'ACC_ID': 0.3990130419457173, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4644; Top5: 0.7391
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4644281914893617, 'ACC_ID': 0.3959441489361702, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4630; Top5: 0.7368
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4630914826498423, 'ACC_ID': 0.39589905362776023, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4599; Top5: 0.7353
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46, 'ACC_ID': 0.3948, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36902392 0.31931195 ... 0.18650444 0.18649675 0.14181064]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 46.0000; Top-5 accuracy: 73.5300
{'Method': 'rosita_knn_txt', 'AUC': 0.9087730399999998, 'FPR95': 0.4186, 'ACC_ALL': 0.46, 'ACC_ID': 0.3948, 'ACC_OOD': 0.9692, 'ACC_HM': 0.5610559530791789, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn1

Step 999: Top1: 0.5123; Top5: 0.7942
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.3374485596707819, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4935; Top5: 0.7934
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49147442326980945, 'ACC_ID': 0.3229689067201605, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4947; Top5: 0.7781
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49365397461589844, 'ACC_ID': 0.3333333333333333, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5042; Top5: 0.7828
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5029940119760479, 'ACC_ID': 0.35429141716566864, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5152; Top5: 0.7808
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5149700598802395, 'ACC_ID': 0.3652694610778443, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5151; Top5: 0.7821
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5149402390438247, 'ACC_ID': 0.3691899070385126, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5155; Top5: 0.7802
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5152291488756049, 'ACC_ID': 0.3669228579561628, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5146; Top5: 0.7781
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.514456630109671, 'ACC_ID': 0.3706380857427717, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5115; Top5: 0.7797
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5114622746494547, 'ACC_ID': 0.3665702203427554, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5108; Top5: 0.7813
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5107235919021849, 'ACC_ID': 0.36760873922629783, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5093; Top5: 0.7801
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5092458303118201, 'ACC_ID': 0.369108049311095, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5060; Top5: 0.7785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5057223420136009, 'ACC_ID': 0.3693813236025875, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5058; Top5: 0.7772
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5056110684089162, 'ACC_ID': 0.3714066102997694, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5033; Top5: 0.7749
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5031339031339032, 'ACC_ID': 0.3698005698005698, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5064; Top5: 0.7765
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5063039150630392, 'ACC_ID': 0.37305905773059056, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5079; Top5: 0.7771
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5076731129132875, 'ACC_ID': 0.37654398003742984, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5065; Top5: 0.7789
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5064034778521913, 'ACC_ID': 0.3763365056985078, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5038; Top5: 0.7785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.503656914893617, 'ACC_ID': 0.374113475177305, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5058; Top5: 0.7788
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5056782334384858, 'ACC_ID': 0.37455310199789693, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5054; Top5: 0.7796
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5054, 'ACC_ID': 0.3745, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36477283 0.34713408 ... 0.18304643 0.17892662 0.17863037]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 50.5400; Top-5 accuracy: 77.9600
{'Method': 'rosita_knn_txt', 'AUC': 0.693456755, 'FPR95': 0.8472, 'ACC_ALL': 0.5054, 'ACC_ID': 0.3745, 'ACC_OOD': 0.6807, 'ACC_HM': 0.48317314253222143, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn1

Step 999: Top1: 0.5123; Top5: 0.7984
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.38477366255144035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4905; Top5: 0.7964
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49147442326980945, 'ACC_ID': 0.34904714142427284, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4920; Top5: 0.7781
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49298597194388777, 'ACC_ID': 0.3513694054776219, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5032; Top5: 0.7818
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5029940119760479, 'ACC_ID': 0.3537924151696607, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5140; Top5: 0.7788
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5141716566866268, 'ACC_ID': 0.3588822355289421, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5135; Top5: 0.7798
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5132802124833997, 'ACC_ID': 0.3648738379814077, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5144; Top5: 0.7785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5138058639339596, 'ACC_ID': 0.3637916310845431, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5128; Top5: 0.7779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5122133599202393, 'ACC_ID': 0.36116650049850446, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5101; Top5: 0.7797
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5096817271310928, 'ACC_ID': 0.355886935232584, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5088; Top5: 0.7801
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5087191822008419, 'ACC_ID': 0.35458007616756865, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5073; Top5: 0.7779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5072516316171138, 'ACC_ID': 0.35569253081943436, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5033; Top5: 0.7759
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5030685022391773, 'ACC_ID': 0.35345828495604575, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5027; Top5: 0.7739
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5025365103766334, 'ACC_ID': 0.3544965411222137, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5008; Top5: 0.7716
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5005698005698006, 'ACC_ID': 0.35498575498575496, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5030; Top5: 0.7733
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5028533510285335, 'ACC_ID': 0.35514266755142665, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5040; Top5: 0.7740
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5038053649407361, 'ACC_ID': 0.35907673112913285, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5035; Top5: 0.7756
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5033486076841734, 'ACC_ID': 0.36023968981318294, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5013; Top5: 0.7750
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5012189716312057, 'ACC_ID': 0.35904255319148937, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5028; Top5: 0.7759
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5027339642481599, 'ACC_ID': 0.3598317560462671, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5025; Top5: 0.7763
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5023, 'ACC_ID': 0.3591, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.37943318 0.36566994 ... 0.17920546 0.17692836 0.17110148]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 50.2500; Top-5 accuracy: 77.6300
{'Method': 'rosita_knn_txt', 'AUC': 0.672087045, 'FPR95': 0.8446, 'ACC_ALL': 0.5023, 'ACC_ID': 0.3591, 'ACC_OOD': 0.6814, 'ACC_HM': 0.47033299375300336, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




1 3
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn3

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7984; Top5: 0.9719
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.79839518555667, 'ACC_ID': 0.7331995987963892, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7934; Top5: 0.9733
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7935871743486974, 'ACC_ID': 0.7361389445557782, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7898; Top5: 0.9760
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7899201596806387, 'ACC_ID': 0.7365269461077845, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7891; Top5: 0.9776
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7892215568862275, 'ACC_ID': 0.7233532934131737, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7805; Top5: 0.9761
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7805444887118194, 'ACC_ID': 0.7128154050464808, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7737; Top5: 0.9735
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7736976942783945, 'ACC_ID': 0.7050953600910902, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7714; Top5: 0.9746
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7714356929212363, 'ACC_ID': 0.7006480558325024, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7703; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7703093701313154, 'ACC_ID': 0.6984197640774538, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7686; Top5: 0.9763
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7686911204650231, 'ACC_ID': 0.6927239927841251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7712; Top5: 0.9770
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.771211022480058, 'ACC_ID': 0.6889050036258159, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7722; Top5: 0.9771
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7721015093713717, 'ACC_ID': 0.686183446674407, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7700; Top5: 0.9762
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7700230591852422, 'ACC_ID': 0.6840891621829363, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7691; Top5: 0.9756
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7689458689458689, 'ACC_ID': 0.683903133903134, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7670; Top5: 0.9748
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7669542136695421, 'ACC_ID': 0.6832116788321168, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7649; Top5: 0.9743
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7649407361197754, 'ACC_ID': 0.681971303805365, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7638; Top5: 0.9732
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7639525320173892, 'ACC_ID': 0.6799436023968981, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7632; Top5: 0.9731
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7632978723404256, 'ACC_ID': 0.6757535460992907, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7636; Top5: 0.9734
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7637223974763407, 'ACC_ID': 0.6744479495268139, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7625; Top5: 0.9727
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7625, 'ACC_ID': 0.6734, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33738869 0.30962974 ... 0.15254748 0.15252098 0.14165282]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.2400; Top-5 accuracy: 97.2700
{'Method': 'rosita_knn_txt', 'AUC': 0.945973245, 'FPR95': 0.3267, 'ACC_ALL': 0.7625, 'ACC_ID': 0.6734, 'ACC_OOD': 0.9925, 'ACC_HM': 0.8023884987094063, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn3

Step 999: Top1: 0.7881; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7880658436213992, 'ACC_ID': 0.7139917695473251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7994; Top5: 0.9739
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7993981945837513, 'ACC_ID': 0.7352056168505516, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7941; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7922511690046761, 'ACC_ID': 0.7307949231796927, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7973; Top5: 0.9785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7959081836327345, 'ACC_ID': 0.7420159680638723, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8023; Top5: 0.9812
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8011976047904191, 'ACC_ID': 0.7485029940119761, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7954; Top5: 0.9771
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7944887118193891, 'ACC_ID': 0.7407038512616202, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7837; Top5: 0.9704
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7828067179049246, 'ACC_ID': 0.7298605180757187, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7809; Top5: 0.9691
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7801595214356929, 'ACC_ID': 0.7270687936191426, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7797; Top5: 0.9691
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7789895392833296, 'ACC_ID': 0.7186734920988204, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7789; Top5: 0.9683
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.778111846061335, 'ACC_ID': 0.7165764682301062, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7761; Top5: 0.9688
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7753807106598984, 'ACC_ID': 0.7137418419144308, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7750; Top5: 0.9686
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7744236191739924, 'ACC_ID': 0.710565599601924, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7726; Top5: 0.9676
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.772021521906226, 'ACC_ID': 0.7057647963105304, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7712; Top5: 0.9678
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7705128205128206, 'ACC_ID': 0.7051282051282052, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7691; Top5: 0.9664
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7685467816854679, 'ACC_ID': 0.704313205043132, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7692; Top5: 0.9661
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7686837180286962, 'ACC_ID': 0.704678727386151, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7682; Top5: 0.9652
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7677123722241804, 'ACC_ID': 0.7026201386441077, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7672; Top5: 0.9651
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7667331560283688, 'ACC_ID': 0.70135195035461, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7669; Top5: 0.9647
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7663512092534175, 'ACC_ID': 0.7003154574132492, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7657; Top5: 0.9635
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7652, 'ACC_ID': 0.6992, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33737585 0.28989017 ... 0.16256143 0.16255325 0.10226153]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.5700; Top-5 accuracy: 96.3500
{'Method': 'rosita_knn_txt', 'AUC': 0.950613715, 'FPR95': 0.3089, 'ACC_ALL': 0.7652, 'ACC_ID': 0.6992, 'ACC_OOD': 0.9792, 'ACC_HM': 0.815844423260248, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn3

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.6707818930041153, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8024; Top5: 0.9769
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.802407221664995, 'ACC_ID': 0.683049147442327, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7955; Top5: 0.9779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7955911823647295, 'ACC_ID': 0.6967267869071476, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7968; Top5: 0.9810
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7969061876247505, 'ACC_ID': 0.7085828343313373, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8019; Top5: 0.9824
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8019960079840319, 'ACC_ID': 0.7141716566866267, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8001; Top5: 0.9824
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.800132802124834, 'ACC_ID': 0.7111553784860558, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7913; Top5: 0.9804
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7913464275547964, 'ACC_ID': 0.703672075149445, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7871; Top5: 0.9781
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7871385842472582, 'ACC_ID': 0.6961615154536391, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7850; Top5: 0.9780
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7847763187180058, 'ACC_ID': 0.6928555530825729, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7851; Top5: 0.9775
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7847263980757667, 'ACC_ID': 0.6941270795750651, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7877; Top5: 0.9784
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7875271936185642, 'ACC_ID': 0.6970630891950689, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7895; Top5: 0.9784
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7893514679051252, 'ACC_ID': 0.6987891856029192, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7897; Top5: 0.9789
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7895465026902383, 'ACC_ID': 0.69684857801691, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7896; Top5: 0.9786
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7896011396011396, 'ACC_ID': 0.692022792022792, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7887; Top5: 0.9785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7887193098871931, 'ACC_ID': 0.691838088918381, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7881; Top5: 0.9783
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7881472239550842, 'ACC_ID': 0.692077354959451, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7887; Top5: 0.9783
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7887439783809188, 'ACC_ID': 0.691340618023734, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7882; Top5: 0.9785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7882313829787234, 'ACC_ID': 0.688386524822695, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7877; Top5: 0.9787
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7876971608832808, 'ACC_ID': 0.68664563617245, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7860; Top5: 0.9777
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.786, 'ACC_ID': 0.6836, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33856344 0.32937652 ... 0.17355958 0.17350274 0.12085843]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 78.6000; Top-5 accuracy: 97.7700
{'Method': 'rosita_knn_txt', 'AUC': 0.8406737649999999, 'FPR95': 0.62, 'ACC_ALL': 0.786, 'ACC_ID': 0.6836, 'ACC_OOD': 0.754, 'ACC_HM': 0.7170762381747356, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn3

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8014; Top5: 0.9759
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8014042126379137, 'ACC_ID': 0.7362086258776329, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7948; Top5: 0.9779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7949231796927188, 'ACC_ID': 0.7348029392117569, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7958; Top5: 0.9800
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7959081836327345, 'ACC_ID': 0.7430139720558883, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7979; Top5: 0.9816
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7980039920159681, 'ACC_ID': 0.7497005988023953, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7981; Top5: 0.9821
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.798140770252324, 'ACC_ID': 0.75199203187251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7891; Top5: 0.9792
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7890691716481639, 'ACC_ID': 0.7409621406205522, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7861; Top5: 0.9791
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7861415752741775, 'ACC_ID': 0.7377866400797607, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7848; Top5: 0.9782
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7847763187180058, 'ACC_ID': 0.7373692410416203, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7853; Top5: 0.9779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7851272800160353, 'ACC_ID': 0.738825415915013, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7869; Top5: 0.9793
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7869833212472807, 'ACC_ID': 0.7420232052211748, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7882; Top5: 0.9793
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7880245480179134, 'ACC_ID': 0.7415823519655, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7874; Top5: 0.9800
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7872405841660262, 'ACC_ID': 0.7398923904688701, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7873; Top5: 0.9801
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7871794871794872, 'ACC_ID': 0.7357549857549858, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7853; Top5: 0.9800
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7851360318513603, 'ACC_ID': 0.7328467153284671, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7844; Top5: 0.9797
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7842794759825328, 'ACC_ID': 0.7288833437305053, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7840; Top5: 0.9792
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7839266831159676, 'ACC_ID': 0.725766654917166, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7850; Top5: 0.9785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.784906914893617, 'ACC_ID': 0.7244015957446809, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7857; Top5: 0.9784
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7855941114616194, 'ACC_ID': 0.7215562565720295, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7840; Top5: 0.9771
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7839, 'ACC_ID': 0.7169, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33747816 0.33558223 ... 0.16947813 0.1694002  0.12993291]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 78.4000; Top-5 accuracy: 97.7100
{'Method': 'rosita_knn_txt', 'AUC': 0.855504255, 'FPR95': 0.4776, 'ACC_ALL': 0.7839, 'ACC_ID': 0.7169, 'ACC_OOD': 0.7325, 'ACC_HM': 0.7246160480198702, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn3

Step 999: Top1: 0.5123; Top5: 0.7963
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.37037037037037035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4915; Top5: 0.7944
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49047141424272817, 'ACC_ID': 0.362086258776329, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4920; Top5: 0.7767
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4916499665998664, 'ACC_ID': 0.37742150968603877, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4928; Top5: 0.7688
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49201596806387227, 'ACC_ID': 0.4041916167664671, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4872; Top5: 0.7600
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4870259481037924, 'ACC_ID': 0.4167664670658683, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4846; Top5: 0.7592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4843957503320053, 'ACC_ID': 0.42297476759628155, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4796; Top5: 0.7569
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4793623683461429, 'ACC_ID': 0.42442356959863364, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4782; Top5: 0.7519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47781655034895315, 'ACC_ID': 0.4269690927218345, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4765; Top5: 0.7521
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47629646116180724, 'ACC_ID': 0.4295570888048075, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4743; Top5: 0.7512
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4740428943676087, 'ACC_ID': 0.4309480857887352, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4689; Top5: 0.7460
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4684554024655547, 'ACC_ID': 0.4278462654097172, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4652; Top5: 0.7435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46458782551003486, 'ACC_ID': 0.4269364737103997, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4623; Top5: 0.7419
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4619523443504996, 'ACC_ID': 0.4267486548808609, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4619; Top5: 0.7400
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46153846153846156, 'ACC_ID': 0.4287749287749288, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4613; Top5: 0.7399
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46091572660915725, 'ACC_ID': 0.43012607830126076, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4599; Top5: 0.7381
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4595134123518403, 'ACC_ID': 0.43019338739862756, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4596; Top5: 0.7383
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4592879802608389, 'ACC_ID': 0.431676653742216, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4581; Top5: 0.7360
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4577792553191489, 'ACC_ID': 0.4315159574468085, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4597; Top5: 0.7356
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4594111461619348, 'ACC_ID': 0.4340694006309148, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4577; Top5: 0.7362
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4575, 'ACC_ID': 0.4334, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.3654511  0.31050912 ... 0.14559078 0.14557385 0.10805216]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 45.7800; Top-5 accuracy: 73.6200
{'Method': 'rosita_knn_txt', 'AUC': 0.956188705, 'FPR95': 0.139, 'ACC_ALL': 0.4575, 'ACC_ID': 0.4334, 'ACC_OOD': 0.9833, 'ACC_HM': 0.6016266252558763, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn3

Step 999: Top1: 0.5123; Top5: 0.7963
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.4012345679012346, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4935; Top5: 0.7964
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4934804413239719, 'ACC_ID': 0.3791374122367101, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4967; Top5: 0.7787
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4969939879759519, 'ACC_ID': 0.39011356045424184, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5047; Top5: 0.7813
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5044910179640718, 'ACC_ID': 0.40219560878243515, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5052; Top5: 0.7752
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5053892215568863, 'ACC_ID': 0.4103792415169661, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4912; Top5: 0.7579
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4916998671978752, 'ACC_ID': 0.398406374501992, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4785; Top5: 0.7484
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4785083973811557, 'ACC_ID': 0.39111870196413323, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4734; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4733300099700897, 'ACC_ID': 0.3925722831505484, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4683; Top5: 0.7409
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4680614288893835, 'ACC_ID': 0.38927220120186956, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4619; Top5: 0.7374
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.462016436159551, 'ACC_ID': 0.3862497494487873, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4557; Top5: 0.7291
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4557650471356055, 'ACC_ID': 0.3839738941261784, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4484; Top5: 0.7228
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4483330568916902, 'ACC_ID': 0.3793332227566761, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4455; Top5: 0.7190
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4455034588777863, 'ACC_ID': 0.3790930053804766, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4421; Top5: 0.7155
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44202279202279204, 'ACC_ID': 0.37735042735042734, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4382; Top5: 0.7135
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43822163238221634, 'ACC_ID': 0.37518248175182484, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4359; Top5: 0.7123
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43580786026200874, 'ACC_ID': 0.3762944479101684, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4343; Top5: 0.7108
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4342615438843849, 'ACC_ID': 0.3763365056985078, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4310; Top5: 0.7090
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4308510638297872, 'ACC_ID': 0.375, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4294; Top5: 0.7075
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4293375394321767, 'ACC_ID': 0.37455310199789693, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4266; Top5: 0.7055
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4266, 'ACC_ID': 0.3738, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36523804 0.29747143 ... 0.18765412 0.18765397 0.11941594]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 42.6700; Top-5 accuracy: 70.5500
{'Method': 'rosita_knn_txt', 'AUC': 0.907098995, 'FPR95': 0.3758, 'ACC_ALL': 0.4266, 'ACC_ID': 0.3738, 'ACC_OOD': 0.9603, 'ACC_HM': 0.5381307847987408, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn3

Step 999: Top1: 0.5103; Top5: 0.7942
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5102880658436214, 'ACC_ID': 0.3374485596707819, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4875; Top5: 0.7934
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48746238716148443, 'ACC_ID': 0.32196589769307926, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4913; Top5: 0.7781
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4916499665998664, 'ACC_ID': 0.3333333333333333, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5027; Top5: 0.7808
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5024950099800399, 'ACC_ID': 0.34880239520958084, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5124; Top5: 0.7776
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5125748502994012, 'ACC_ID': 0.35409181636726544, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5081; Top5: 0.7755
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5079681274900398, 'ACC_ID': 0.35292164674634796, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5067; Top5: 0.7711
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5064047822374039, 'ACC_ID': 0.35098206660973524, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5044; Top5: 0.7664
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5037387836490529, 'ACC_ID': 0.35194416749750745, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5037; Top5: 0.7685
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.503227242377031, 'ACC_ID': 0.3503227242377031, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5048; Top5: 0.7719
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5045099218280217, 'ACC_ID': 0.3563840448987773, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5046; Top5: 0.7714
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5043509789702683, 'ACC_ID': 0.3600435097897027, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5012; Top5: 0.7696
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5007463924365566, 'ACC_ID': 0.3581025045612871, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5010; Top5: 0.7689
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5005380476556495, 'ACC_ID': 0.3594158339738663, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5014; Top5: 0.7676
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5008547008547009, 'ACC_ID': 0.3613960113960114, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5035; Top5: 0.7699
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5032514930325149, 'ACC_ID': 0.3652289316522893, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5026; Top5: 0.7698
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5023081721771678, 'ACC_ID': 0.36481597005614474, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5022; Top5: 0.7710
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5019386676066268, 'ACC_ID': 0.36317706497473856, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4989; Top5: 0.7701
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49867021276595747, 'ACC_ID': 0.362145390070922, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4983; Top5: 0.7690
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4981072555205047, 'ACC_ID': 0.3629863301787592, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4962; Top5: 0.7677
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4961, 'ACC_ID': 0.3623, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36561108 0.35210598 ... 0.16376866 0.15899123 0.14328527]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 49.6300; Top-5 accuracy: 76.7700
{'Method': 'rosita_knn_txt', 'AUC': 0.6815210949999999, 'FPR95': 0.8621, 'ACC_ALL': 0.4961, 'ACC_ID': 0.3623, 'ACC_OOD': 0.6818, 'ACC_HM': 0.4731656737860358, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn3

Step 999: Top1: 0.5123; Top5: 0.7984
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.38477366255144035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4915; Top5: 0.7954
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49247743229689067, 'ACC_ID': 0.35907723169508526, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4947; Top5: 0.7787
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4956579826319305, 'ACC_ID': 0.3593854375417502, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5047; Top5: 0.7808
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5049900199600799, 'ACC_ID': 0.36377245508982037, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5144; Top5: 0.7776
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5149700598802395, 'ACC_ID': 0.3660678642714571, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5125; Top5: 0.7758
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5129482071713147, 'ACC_ID': 0.3645418326693227, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5130; Top5: 0.7737
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5132365499573015, 'ACC_ID': 0.363222317107885, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5096; Top5: 0.7704
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5097208374875374, 'ACC_ID': 0.3634097706879362, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5075; Top5: 0.7716
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5076786111729357, 'ACC_ID': 0.360560872468284, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5072; Top5: 0.7739
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5075165363800361, 'ACC_ID': 0.36299859691320907, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5073; Top5: 0.7723
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5076142131979695, 'ACC_ID': 0.3656635242929659, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5038; Top5: 0.7701
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5037319621827833, 'ACC_ID': 0.3635760490960358, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5028; Top5: 0.7689
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5028439661798616, 'ACC_ID': 0.3654112221368178, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5026; Top5: 0.7675
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5025641025641026, 'ACC_ID': 0.36709401709401707, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5039; Top5: 0.7680
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5040477770404778, 'ACC_ID': 0.36708692767086926, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5040; Top5: 0.7685
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5040548970679976, 'ACC_ID': 0.3681846537741734, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5017; Top5: 0.7692
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5018211726001645, 'ACC_ID': 0.3656444601104453, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4977; Top5: 0.7677
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4977836879432624, 'ACC_ID': 0.36447251773049644, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4968; Top5: 0.7673
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49695057833859096, 'ACC_ID': 0.3651945320715037, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4945; Top5: 0.7649
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4947, 'ACC_ID': 0.3628, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36694217 0.3668552  ... 0.16708359 0.15672854 0.15440263]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 49.4600; Top-5 accuracy: 76.4900
{'Method': 'rosita_knn_txt', 'AUC': 0.670429955, 'FPR95': 0.85, 'ACC_ALL': 0.4947, 'ACC_ID': 0.3628, 'ACC_OOD': 0.6621, 'ACC_HM': 0.46874793638403744, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




1 5
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn5

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7139917695473251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7984; Top5: 0.9729
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.79839518555667, 'ACC_ID': 0.7321965897693079, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7921; Top5: 0.9739
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7922511690046761, 'ACC_ID': 0.7321309285237141, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7888; Top5: 0.9755
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7889221556886228, 'ACC_ID': 0.7295409181636726, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7863; Top5: 0.9764
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7864271457085829, 'ACC_ID': 0.7177644710578842, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7811; Top5: 0.9764
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7812084993359893, 'ACC_ID': 0.7114873837981408, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7726; Top5: 0.9769
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7725590663250783, 'ACC_ID': 0.7056646740677484, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7721; Top5: 0.9771
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7721834496510469, 'ACC_ID': 0.7056331006979063, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7716; Top5: 0.9769
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7718673492098821, 'ACC_ID': 0.7004228800356109, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7684; Top5: 0.9775
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7686911204650231, 'ACC_ID': 0.6889156143515734, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7695; Top5: 0.9784
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7697606961566352, 'ACC_ID': 0.6818346627991299, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7696; Top5: 0.9778
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7696135345828495, 'ACC_ID': 0.6775584674075302, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7665; Top5: 0.9760
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.766641045349731, 'ACC_ID': 0.673174481168332, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7651; Top5: 0.9756
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7650997150997151, 'ACC_ID': 0.672934472934473, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7627; Top5: 0.9745
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7629727936297279, 'ACC_ID': 0.6723291307232913, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7600; Top5: 0.9740
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7604491578290705, 'ACC_ID': 0.6712414223331253, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7591; Top5: 0.9729
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7594877217718247, 'ACC_ID': 0.6706614968863823, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7584; Top5: 0.9727
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7587544326241135, 'ACC_ID': 0.6693262411347518, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7597; Top5: 0.9730
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7600420609884332, 'ACC_ID': 0.6702418506834911, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7585; Top5: 0.9722
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7588, 'ACC_ID': 0.6695, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33738869 0.294191   ... 0.15339147 0.15307325 0.13420919]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 75.8400; Top-5 accuracy: 97.2200
{'Method': 'rosita_knn_txt', 'AUC': 0.946536695, 'FPR95': 0.3109, 'ACC_ALL': 0.7588, 'ACC_ID': 0.6695, 'ACC_OOD': 0.9917, 'ACC_HM': 0.7993536600048159, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn5

Step 999: Top1: 0.7881; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7880658436213992, 'ACC_ID': 0.7139917695473251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8004; Top5: 0.9739
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8004012036108324, 'ACC_ID': 0.7352056168505516, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7941; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7942551770207081, 'ACC_ID': 0.7327989311957248, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7978; Top5: 0.9785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7984031936127745, 'ACC_ID': 0.7450099800399201, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7991; Top5: 0.9796
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7992015968063872, 'ACC_ID': 0.7429141716566866, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7855; Top5: 0.9704
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7855245683930943, 'ACC_ID': 0.7307436918990704, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7746; Top5: 0.9656
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7745516652433817, 'ACC_ID': 0.7224594363791631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7744; Top5: 0.9658
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7744267198404786, 'ACC_ID': 0.7141076769690927, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7741; Top5: 0.9659
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7740930336078344, 'ACC_ID': 0.7064322279100823, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7727; Top5: 0.9651
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7724994988975746, 'ACC_ID': 0.6997394267388254, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7704; Top5: 0.9657
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7704858593183467, 'ACC_ID': 0.6947063089195069, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7684; Top5: 0.9660
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7684524796815392, 'ACC_ID': 0.6898324763642395, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7643; Top5: 0.9642
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7641813989239047, 'ACC_ID': 0.6871637202152191, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7625; Top5: 0.9638
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7622507122507123, 'ACC_ID': 0.6867521367521368, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7605; Top5: 0.9631
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7603185136031851, 'ACC_ID': 0.6858659588586596, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7593; Top5: 0.9636
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7592014971927635, 'ACC_ID': 0.6848409232688709, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7587; Top5: 0.9625
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7586652567265891, 'ACC_ID': 0.6841734226295383, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7583; Top5: 0.9624
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.758311170212766, 'ACC_ID': 0.6852836879432624, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7591; Top5: 0.9618
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7590956887486856, 'ACC_ID': 0.68664563617245, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7583; Top5: 0.9606
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7583, 'ACC_ID': 0.6865, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33737585 0.29359055 ... 0.14652245 0.14651993 0.10325004]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 75.8300; Top-5 accuracy: 96.0600
{'Method': 'rosita_knn_txt', 'AUC': 0.9459499200000001, 'FPR95': 0.3088, 'ACC_ALL': 0.7583, 'ACC_ID': 0.6865, 'ACC_OOD': 0.9786, 'ACC_HM': 0.8069291934418353, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn5

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.668724279835391, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8024; Top5: 0.9769
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.802407221664995, 'ACC_ID': 0.683049147442327, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7961; Top5: 0.9779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7955911823647295, 'ACC_ID': 0.6960587842351369, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7978; Top5: 0.9810
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7974051896207585, 'ACC_ID': 0.7065868263473054, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8015; Top5: 0.9824
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8007984031936127, 'ACC_ID': 0.7117764471057885, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7971; Top5: 0.9807
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.796480743691899, 'ACC_ID': 0.701527224435591, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7871; Top5: 0.9778
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7865072587532024, 'ACC_ID': 0.6959863364645602, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7851; Top5: 0.9766
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7846460618145563, 'ACC_ID': 0.6944167497507477, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7841; Top5: 0.9773
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7838860449588249, 'ACC_ID': 0.6950812374805253, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7845; Top5: 0.9769
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7841250751653638, 'ACC_ID': 0.6963319302465424, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7873; Top5: 0.9777
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7871646120377085, 'ACC_ID': 0.6965192168237854, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7890; Top5: 0.9776
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7888538729474208, 'ACC_ID': 0.6979598606734119, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7897; Top5: 0.9777
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7895465026902383, 'ACC_ID': 0.6986933128362798, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7891; Top5: 0.9778
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.789031339031339, 'ACC_ID': 0.6958689458689459, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7883; Top5: 0.9774
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7881884538818845, 'ACC_ID': 0.6952886529528866, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7870; Top5: 0.9770
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7868995633187773, 'ACC_ID': 0.6946974422956955, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7842; Top5: 0.9761
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7840441781224298, 'ACC_ID': 0.6911056280108095, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7829; Top5: 0.9757
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7826906028368794, 'ACC_ID': 0.6867242907801419, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7820; Top5: 0.9754
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7819137749737118, 'ACC_ID': 0.6856992639327024, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7792; Top5: 0.9736
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7791, 'ACC_ID': 0.6823, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33737299 0.32869294 ... 0.15509355 0.15486038 0.10802294]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 77.9200; Top-5 accuracy: 97.3600
{'Method': 'rosita_knn_txt', 'AUC': 0.832097895, 'FPR95': 0.6408, 'ACC_ALL': 0.7791, 'ACC_ID': 0.6823, 'ACC_OOD': 0.7491, 'ACC_HM': 0.7141413022216012, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn5

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8014; Top5: 0.9759
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8004012036108324, 'ACC_ID': 0.7362086258776329, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7961; Top5: 0.9779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7955911823647295, 'ACC_ID': 0.7354709418837675, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7968; Top5: 0.9805
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7964071856287425, 'ACC_ID': 0.7420159680638723, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7999; Top5: 0.9820
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7996007984031936, 'ACC_ID': 0.7477045908183633, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7974; Top5: 0.9821
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.797144754316069, 'ACC_ID': 0.7430278884462151, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7879; Top5: 0.9789
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7876458867065187, 'ACC_ID': 0.735269000853971, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7843; Top5: 0.9771
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.784147557328016, 'ACC_ID': 0.7308075772681955, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7832; Top5: 0.9766
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7829957711996439, 'ACC_ID': 0.7306921878477632, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7831; Top5: 0.9765
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7827219883744237, 'ACC_ID': 0.7318099819603127, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7844; Top5: 0.9779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7842639593908629, 'ACC_ID': 0.733502538071066, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7860; Top5: 0.9779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7858683032011943, 'ACC_ID': 0.7332891026704262, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7846; Top5: 0.9785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7843197540353574, 'ACC_ID': 0.7305149884704074, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7843; Top5: 0.9786
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.784045584045584, 'ACC_ID': 0.7283475783475784, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7825; Top5: 0.9782
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7822163238221632, 'ACC_ID': 0.7250165892501659, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7815; Top5: 0.9775
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7812850904553962, 'ACC_ID': 0.7202744853399875, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7809; Top5: 0.9766
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7806368229350252, 'ACC_ID': 0.714839619316179, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7783; Top5: 0.9754
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7779255319148937, 'ACC_ID': 0.7084441489361702, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7767; Top5: 0.9746
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7763406940063091, 'ACC_ID': 0.704521556256572, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7733; Top5: 0.9731
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.773, 'ACC_ID': 0.6997, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33747816 0.33578619 ... 0.16442227 0.16438359 0.13172886]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 77.3300; Top-5 accuracy: 97.3100
{'Method': 'rosita_knn_txt', 'AUC': 0.850766085, 'FPR95': 0.5081, 'ACC_ALL': 0.773, 'ACC_ID': 0.6997, 'ACC_OOD': 0.7436, 'ACC_HM': 0.720982359869743, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn5

Step 999: Top1: 0.5123; Top5: 0.7942
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.37037037037037035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4895; Top5: 0.7914
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4884653961885657, 'ACC_ID': 0.3630892678034102, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4920; Top5: 0.7754
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4916499665998664, 'ACC_ID': 0.3800935203740815, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4893; Top5: 0.7659
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48852295409181634, 'ACC_ID': 0.40219560878243515, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4852; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48582834331337327, 'ACC_ID': 0.4167664670658683, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4799; Top5: 0.7536
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4804116865869854, 'ACC_ID': 0.4196547144754316, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4754; Top5: 0.7484
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47566182749786506, 'ACC_ID': 0.42043837176202675, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4705; Top5: 0.7435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47058823529411764, 'ACC_ID': 0.419740777666999, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4634; Top5: 0.7418
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46361006009347877, 'ACC_ID': 0.4170932561762742, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4581; Top5: 0.7398
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4584084986971337, 'ACC_ID': 0.41511324914812586, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4522; Top5: 0.7347
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45250181290790426, 'ACC_ID': 0.41171138506163885, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4487; Top5: 0.7304
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4486647868634931, 'ACC_ID': 0.4108475700779565, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4473; Top5: 0.7281
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44734819369715606, 'ACC_ID': 0.41199077632590314, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4469; Top5: 0.7275
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44686609686609685, 'ACC_ID': 0.41367521367521365, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4470; Top5: 0.7283
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44698075646980756, 'ACC_ID': 0.4155275381552754, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4455; Top5: 0.7269
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4452900810979414, 'ACC_ID': 0.41547099189020587, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4452; Top5: 0.7266
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44507108447890964, 'ACC_ID': 0.4165197979085889, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4435; Top5: 0.7250
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4432624113475177, 'ACC_ID': 0.4161125886524823, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4447; Top5: 0.7245
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4444794952681388, 'ACC_ID': 0.41829652996845423, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4427; Top5: 0.7246
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4426, 'ACC_ID': 0.4177, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36495143 0.30999169 ... 0.13520679 0.13518734 0.12219442]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 44.2800; Top-5 accuracy: 72.4600
{'Method': 'rosita_knn_txt', 'AUC': 0.9504806150000001, 'FPR95': 0.144, 'ACC_ALL': 0.4426, 'ACC_ID': 0.4177, 'ACC_OOD': 0.985, 'ACC_HM': 0.5866322093106152, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn5

Step 999: Top1: 0.5123; Top5: 0.7963
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.4012345679012346, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4945; Top5: 0.7954
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4944834503510532, 'ACC_ID': 0.3831494483450351, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4967; Top5: 0.7794
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4969939879759519, 'ACC_ID': 0.3921175684702739, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5032; Top5: 0.7793
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5024950099800399, 'ACC_ID': 0.40469061876247503, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5020; Top5: 0.7704
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5017964071856288, 'ACC_ID': 0.40718562874251496, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4849; Top5: 0.7496
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4850597609561753, 'ACC_ID': 0.3944223107569721, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4768; Top5: 0.7441
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4768004554511813, 'ACC_ID': 0.3956732137773982, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4727; Top5: 0.7402
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47258225324027914, 'ACC_ID': 0.396061814556331, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4661; Top5: 0.7363
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46605831293122635, 'ACC_ID': 0.3901624749610505, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4605; Top5: 0.7344
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4606133493686109, 'ACC_ID': 0.3882541591501303, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4542; Top5: 0.7271
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45395213923132705, 'ACC_ID': 0.38506163886874545, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4476; Top5: 0.7203
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4471720019903798, 'ACC_ID': 0.3804942776579864, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4437; Top5: 0.7168
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44335126825518834, 'ACC_ID': 0.3790930053804766, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4411; Top5: 0.7138
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44074074074074077, 'ACC_ID': 0.37905982905982905, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4374; Top5: 0.7143
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43715992037159923, 'ACC_ID': 0.37796947577969475, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4352; Top5: 0.7126
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4349344978165939, 'ACC_ID': 0.3787897691827823, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4336; Top5: 0.7105
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4333215838326871, 'ACC_ID': 0.3792738808600635, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4304; Top5: 0.7080
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43018617021276595, 'ACC_ID': 0.3782136524822695, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4295; Top5: 0.7061
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4293375394321767, 'ACC_ID': 0.37844374342797055, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4273; Top5: 0.7050
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4272, 'ACC_ID': 0.3777, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36557126 0.30880639 ... 0.18025859 0.18024819 0.11637728]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 42.7400; Top-5 accuracy: 70.5000
{'Method': 'rosita_knn_txt', 'AUC': 0.91657291, 'FPR95': 0.3395, 'ACC_ALL': 0.4272, 'ACC_ID': 0.3777, 'ACC_OOD': 0.9633, 'ACC_HM': 0.5426374496644295, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn5

Step 999: Top1: 0.5103; Top5: 0.7942
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5102880658436214, 'ACC_ID': 0.3374485596707819, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4895; Top5: 0.7934
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48946840521564694, 'ACC_ID': 0.3279839518555667, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4926; Top5: 0.7781
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49298597194388777, 'ACC_ID': 0.3393453573814295, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5052; Top5: 0.7808
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5049900199600799, 'ACC_ID': 0.3502994011976048, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5112; Top5: 0.7764
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.511377245508982, 'ACC_ID': 0.35528942115768464, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5035; Top5: 0.7718
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5036520584329349, 'ACC_ID': 0.34428950863213814, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4950; Top5: 0.7589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4950185027042414, 'ACC_ID': 0.3358952462282949, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4941; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49401794616151545, 'ACC_ID': 0.34272183449651045, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4948; Top5: 0.7594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4947696416648119, 'ACC_ID': 0.34431337636323167, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4968; Top5: 0.7634
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4968931649629184, 'ACC_ID': 0.3509721387051513, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4972; Top5: 0.7648
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.497643219724438, 'ACC_ID': 0.35351704133430023, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4942; Top5: 0.7631
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49460938795820203, 'ACC_ID': 0.351799635097031, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4949; Top5: 0.7620
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49500384319754037, 'ACC_ID': 0.35465026902382785, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4947; Top5: 0.7609
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4947293447293447, 'ACC_ID': 0.35527065527065527, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4953; Top5: 0.7624
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4955540809555408, 'ACC_ID': 0.35660252156602523, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4945; Top5: 0.7622
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49469744229569557, 'ACC_ID': 0.35820336868371805, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4925; Top5: 0.7632
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49277405710257316, 'ACC_ID': 0.35777229467747623, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4891; Top5: 0.7609
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48936170212765956, 'ACC_ID': 0.35693705673758863, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4875; Top5: 0.7588
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48769716088328074, 'ACC_ID': 0.3562565720294427, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4834; Top5: 0.7559
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4837, 'ACC_ID': 0.3531, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36600122 0.35282406 ... 0.16674119 0.15878445 0.14654841]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 48.3500; Top-5 accuracy: 75.5900
{'Method': 'rosita_knn_txt', 'AUC': 0.666809815, 'FPR95': 0.8881, 'ACC_ALL': 0.4837, 'ACC_ID': 0.3531, 'ACC_OOD': 0.6661, 'ACC_HM': 0.46153828492935633, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn5

Step 999: Top1: 0.5123; Top5: 0.7963
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.38271604938271603, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4915; Top5: 0.7954
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49147442326980945, 'ACC_ID': 0.35907723169508526, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4953; Top5: 0.7767
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4956579826319305, 'ACC_ID': 0.3580494321977288, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5072; Top5: 0.7793
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5069860279441117, 'ACC_ID': 0.36327345309381237, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5120; Top5: 0.7756
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5121756487025948, 'ACC_ID': 0.3568862275449102, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5051; Top5: 0.7715
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5049800796812749, 'ACC_ID': 0.34926958831341304, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4956; Top5: 0.7612
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49530315969257044, 'ACC_ID': 0.336464560204953, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4931; Top5: 0.7577
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4927716849451645, 'ACC_ID': 0.3369890329012961, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4932; Top5: 0.7596
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49298909414645004, 'ACC_ID': 0.3385265969285555, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4946; Top5: 0.7626
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49428743235117256, 'ACC_ID': 0.34495890960112247, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4952; Top5: 0.7621
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4949238578680203, 'ACC_ID': 0.3471718636693256, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4920; Top5: 0.7616
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4916238182119754, 'ACC_ID': 0.34533090064687344, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4912; Top5: 0.7613
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4906994619523444, 'ACC_ID': 0.34619523443504996, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4908; Top5: 0.7591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49031339031339033, 'ACC_ID': 0.3475783475783476, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4904; Top5: 0.7598
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48998009289980093, 'ACC_ID': 0.34717982747179826, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4894; Top5: 0.7588
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48895820336868373, 'ACC_ID': 0.3482220835932626, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4863; Top5: 0.7589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4859593467277641, 'ACC_ID': 0.34649277405710255, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4832; Top5: 0.7565
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4828235815602837, 'ACC_ID': 0.346520390070922, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4816; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48128286014721344, 'ACC_ID': 0.3461619348054679, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4791; Top5: 0.7527
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4789, 'ACC_ID': 0.3442, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36692628 0.35909623 ... 0.1688503  0.15836307 0.15562975]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 47.9200; Top-5 accuracy: 75.2700
{'Method': 'rosita_knn_txt', 'AUC': 0.656722255, 'FPR95': 0.8677, 'ACC_ALL': 0.4789, 'ACC_ID': 0.3442, 'ACC_OOD': 0.6787, 'ACC_HM': 0.45675733698308735, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




1 7
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn7

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7139917695473251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7994; Top5: 0.9729
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7993981945837513, 'ACC_ID': 0.7331995987963892, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7921; Top5: 0.9739
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7922511690046761, 'ACC_ID': 0.7321309285237141, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7883; Top5: 0.9745
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7884231536926147, 'ACC_ID': 0.7255489021956087, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7847; Top5: 0.9748
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7848303393213573, 'ACC_ID': 0.7121756487025949, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7801; Top5: 0.9754
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7802124833997344, 'ACC_ID': 0.7075033200531209, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7709; Top5: 0.9761
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.770851124395104, 'ACC_ID': 0.7005408482778253, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7699; Top5: 0.9766
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7699401794616152, 'ACC_ID': 0.6999002991026919, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7699; Top5: 0.9762
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7698642332517249, 'ACC_ID': 0.6935232584019586, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7656; Top5: 0.9761
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7656845059130086, 'ACC_ID': 0.6823010623371417, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7666; Top5: 0.9773
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7666787527193618, 'ACC_ID': 0.6783901377810008, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7671; Top5: 0.9768
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7671255597943274, 'ACC_ID': 0.6750704926190081, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7640; Top5: 0.9756
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7640276710222905, 'ACC_ID': 0.6728670253651038, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7632; Top5: 0.9754
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7631054131054131, 'ACC_ID': 0.6727920227920228, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7610; Top5: 0.9744
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7609820836098208, 'ACC_ID': 0.6724618447246185, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7590; Top5: 0.9742
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7590767311291329, 'ACC_ID': 0.6717404865876482, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7581; Top5: 0.9729
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7581952767007403, 'ACC_ID': 0.6705440018799201, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7575; Top5: 0.9726
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7576462765957447, 'ACC_ID': 0.6698803191489362, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7585; Top5: 0.9726
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7586750788643533, 'ACC_ID': 0.6706624605678233, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7575; Top5: 0.9717
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7576, 'ACC_ID': 0.6702, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33738869 0.29521036 ... 0.15643224 0.15633738 0.13581036]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 75.7400; Top-5 accuracy: 97.1700
{'Method': 'rosita_knn_txt', 'AUC': 0.9474974, 'FPR95': 0.2958, 'ACC_ALL': 0.7576, 'ACC_ID': 0.6702, 'ACC_OOD': 0.9921, 'ACC_HM': 0.7999824580400648, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn7

Step 999: Top1: 0.7881; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7880658436213992, 'ACC_ID': 0.7139917695473251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7994; Top5: 0.9739
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8004012036108324, 'ACC_ID': 0.7352056168505516, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7941; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7942551770207081, 'ACC_ID': 0.7334669338677354, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7973; Top5: 0.9785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7974051896207585, 'ACC_ID': 0.7450099800399201, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7935; Top5: 0.9768
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7936127744510978, 'ACC_ID': 0.7357285429141717, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7808; Top5: 0.9698
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7808764940239044, 'ACC_ID': 0.7260956175298805, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7728; Top5: 0.9658
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7728437233134073, 'ACC_ID': 0.7201821804725306, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7721; Top5: 0.9656
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7721834496510469, 'ACC_ID': 0.7116151545363908, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7710; Top5: 0.9651
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.770977075450701, 'ACC_ID': 0.7046516803917204, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7690; Top5: 0.9641
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7688915614351574, 'ACC_ID': 0.6967328121868109, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7659; Top5: 0.9636
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7659535895576505, 'ACC_ID': 0.6914430746918057, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7634; Top5: 0.9638
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7634765301044949, 'ACC_ID': 0.6873445015757174, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7591; Top5: 0.9625
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7591083781706379, 'ACC_ID': 0.6847040737893928, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7582; Top5: 0.9624
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7581196581196581, 'ACC_ID': 0.6851851851851852, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7573; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7573988055739881, 'ACC_ID': 0.6852023888520239, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7571; Top5: 0.9609
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7569557080474111, 'ACC_ID': 0.6853399875233936, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7563; Top5: 0.9602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7561978615908824, 'ACC_ID': 0.6844084126424627, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7559; Top5: 0.9599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7557624113475178, 'ACC_ID': 0.684729609929078, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7569; Top5: 0.9594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7567823343848581, 'ACC_ID': 0.6852786540483702, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7558; Top5: 0.9582
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7557, 'ACC_ID': 0.6852, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33737585 0.29345411 ... 0.13745004 0.13744661 0.10211417]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 75.5800; Top-5 accuracy: 95.8200
{'Method': 'rosita_knn_txt', 'AUC': 0.945701135, 'FPR95': 0.3052, 'ACC_ALL': 0.7557, 'ACC_ID': 0.6852, 'ACC_OOD': 0.9785, 'ACC_HM': 0.8059965137945544, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn7

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.6707818930041153, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8034; Top5: 0.9759
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8034102306920762, 'ACC_ID': 0.6890672016048145, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7948; Top5: 0.9773
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7949231796927188, 'ACC_ID': 0.700066800267201, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7953; Top5: 0.9800
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7959081836327345, 'ACC_ID': 0.7085828343313373, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7991; Top5: 0.9808
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7996007984031936, 'ACC_ID': 0.7069860279441118, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7931; Top5: 0.9781
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7934926958831341, 'ACC_ID': 0.6988711819389111, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7848; Top5: 0.9747
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7853686307998862, 'ACC_ID': 0.6914318246512952, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7833; Top5: 0.9743
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7838983050847458, 'ACC_ID': 0.689431704885344, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7817; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7823280658802582, 'ACC_ID': 0.6888493211662586, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7819; Top5: 0.9751
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7823211064341551, 'ACC_ID': 0.6885147324113049, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7844; Top5: 0.9759
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7849891225525744, 'ACC_ID': 0.6903553299492385, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7863; Top5: 0.9759
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7866976281307017, 'ACC_ID': 0.6944766959694808, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7860; Top5: 0.9765
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7863182167563413, 'ACC_ID': 0.6953112990007686, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7870; Top5: 0.9768
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7873219373219373, 'ACC_ID': 0.6927350427350427, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7857; Top5: 0.9757
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7859323158593231, 'ACC_ID': 0.689051094890511, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7830; Top5: 0.9750
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7834061135371179, 'ACC_ID': 0.6857142857142857, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7798; Top5: 0.9737
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7801668429091764, 'ACC_ID': 0.6799436023968981, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7762; Top5: 0.9717
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7764849290780141, 'ACC_ID': 0.6753102836879432, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7742; Top5: 0.9707
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.774553101997897, 'ACC_ID': 0.6691903259726604, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7697; Top5: 0.9680
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7699, 'ACC_ID': 0.6629, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33737299 0.32963526 ... 0.14699225 0.13667627 0.13226785]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.9600; Top-5 accuracy: 96.8000
{'Method': 'rosita_knn_txt', 'AUC': 0.822629465, 'FPR95': 0.6784, 'ACC_ALL': 0.7699, 'ACC_ID': 0.6629, 'ACC_OOD': 0.7615, 'ACC_HM': 0.708787349059253, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn7

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8004; Top5: 0.9759
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7993981945837513, 'ACC_ID': 0.7342026078234705, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7955; Top5: 0.9779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7949231796927188, 'ACC_ID': 0.7348029392117569, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7963; Top5: 0.9805
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7959081836327345, 'ACC_ID': 0.7415169660678643, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7979; Top5: 0.9820
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7976047904191617, 'ACC_ID': 0.7421157684630738, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7938; Top5: 0.9817
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7934926958831341, 'ACC_ID': 0.7367197875166003, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7848; Top5: 0.9787
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.784514659834899, 'ACC_ID': 0.7301451750640479, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7821; Top5: 0.9773
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7819042871385843, 'ACC_ID': 0.7268195413758723, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7823; Top5: 0.9769
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.782105497440463, 'ACC_ID': 0.7280213665702203, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7825; Top5: 0.9767
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7821206654640208, 'ACC_ID': 0.7288033674082982, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7837; Top5: 0.9782
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7835387962291516, 'ACC_ID': 0.7295141406816533, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7850; Top5: 0.9779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7848731132857854, 'ACC_ID': 0.7286448830651849, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7843; Top5: 0.9788
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7843197540353574, 'ACC_ID': 0.7275941583397386, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7840; Top5: 0.9791
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.784045584045584, 'ACC_ID': 0.7250712250712251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7821; Top5: 0.9788
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7820836098208361, 'ACC_ID': 0.721300597213006, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7803; Top5: 0.9777
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7804117280099813, 'ACC_ID': 0.7140361821584529, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7790; Top5: 0.9761
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7791093878510164, 'ACC_ID': 0.7084948889672189, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7774; Top5: 0.9751
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7774822695035462, 'ACC_ID': 0.7042331560283688, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7764; Top5: 0.9744
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7765509989484752, 'ACC_ID': 0.7005257623554153, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7736; Top5: 0.9722
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7737, 'ACC_ID': 0.6954, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33747816 0.33556604 ... 0.1571269  0.15692809 0.12800896]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 77.3600; Top-5 accuracy: 97.2200
{'Method': 'rosita_knn_txt', 'AUC': 0.84768636, 'FPR95': 0.5343, 'ACC_ALL': 0.7737, 'ACC_ID': 0.6954, 'ACC_OOD': 0.7534, 'ACC_HM': 0.7232390392048593, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn7

Step 999: Top1: 0.5123; Top5: 0.7942
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.3724279835390947, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4885; Top5: 0.7924
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4884653961885657, 'ACC_ID': 0.3630892678034102, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4947; Top5: 0.7787
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4956579826319305, 'ACC_ID': 0.37675350701402804, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4948; Top5: 0.7698
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49500998003992014, 'ACC_ID': 0.3932135728542914, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4944; Top5: 0.7620
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49540918163672654, 'ACC_ID': 0.41317365269461076, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4895; Top5: 0.7602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4903718459495352, 'ACC_ID': 0.4216467463479416, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4828; Top5: 0.7560
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48334756618274977, 'ACC_ID': 0.42413891261030456, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4822; Top5: 0.7522
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48255234297108673, 'ACC_ID': 0.43020937188434694, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4774; Top5: 0.7498
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47785444024037393, 'ACC_ID': 0.4308924994435789, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4735; Top5: 0.7480
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4740428943676087, 'ACC_ID': 0.4317498496692724, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4694; Top5: 0.7443
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46954314720812185, 'ACC_ID': 0.43129079042784624, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4672; Top5: 0.7405
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46724166528445843, 'ACC_ID': 0.432244153259247, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4656; Top5: 0.7385
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4657955418908532, 'ACC_ID': 0.4328977709454266, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4642; Top5: 0.7367
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46424501424501424, 'ACC_ID': 0.43347578347578347, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4637; Top5: 0.7362
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46383543463835436, 'ACC_ID': 0.4351692103516921, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4638; Top5: 0.7351
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46388022457891454, 'ACC_ID': 0.43693075483468496, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4638; Top5: 0.7349
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4638702855128657, 'ACC_ID': 0.43849136411702505, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4623; Top5: 0.7344
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46243351063829785, 'ACC_ID': 0.4384973404255319, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4628; Top5: 0.7353
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4628811777076761, 'ACC_ID': 0.4401682439537329, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4619; Top5: 0.7351
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4621, 'ACC_ID': 0.4405, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36555779 0.30953708 ... 0.126876   0.12686297 0.08698478]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 46.2000; Top-5 accuracy: 73.5100
{'Method': 'rosita_knn_txt', 'AUC': 0.95507371, 'FPR95': 0.1489, 'ACC_ALL': 0.4621, 'ACC_ID': 0.4405, 'ACC_OOD': 0.99, 'ACC_HM': 0.6097098916462775, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn7

Step 999: Top1: 0.5123; Top5: 0.7963
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.4012345679012346, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4945; Top5: 0.7974
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4944834503510532, 'ACC_ID': 0.38415245737211634, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4960; Top5: 0.7807
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4969939879759519, 'ACC_ID': 0.3921175684702739, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5017; Top5: 0.7803
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.501996007984032, 'ACC_ID': 0.40818363273453095, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4952; Top5: 0.7684
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49580838323353293, 'ACC_ID': 0.4039920159680639, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4809; Top5: 0.7506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4814077025232404, 'ACC_ID': 0.3954183266932271, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4737; Top5: 0.7449
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4739538855678907, 'ACC_ID': 0.39766581269570167, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4685; Top5: 0.7397
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46859421734795614, 'ACC_ID': 0.3963110667996012, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4618; Top5: 0.7345
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4622746494547073, 'ACC_ID': 0.3890496327620743, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4565; Top5: 0.7316
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45700541190619365, 'ACC_ID': 0.38584886750851877, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4500; Top5: 0.7233
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45050761421319796, 'ACC_ID': 0.3819796954314721, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4436; Top5: 0.7165
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4438547022723503, 'ACC_ID': 0.37800630286946424, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4398; Top5: 0.7139
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43996925441967716, 'ACC_ID': 0.37586471944657956, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4380; Top5: 0.7111
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43803418803418803, 'ACC_ID': 0.37606837606837606, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4345; Top5: 0.7123
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43463835434638354, 'ACC_ID': 0.3750497677504977, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4319; Top5: 0.7109
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4319401122894573, 'ACC_ID': 0.3754210854647536, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4305; Top5: 0.7093
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4306191986840559, 'ACC_ID': 0.37610151568558337, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4283; Top5: 0.7074
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4284131205673759, 'ACC_ID': 0.37577570921985815, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4280; Top5: 0.7060
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4280757097791798, 'ACC_ID': 0.37697160883280756, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4250; Top5: 0.7046
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4252, 'ACC_ID': 0.3755, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36571923 0.29748192 ... 0.18471143 0.18468013 0.12453283]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 42.5100; Top-5 accuracy: 70.4600
{'Method': 'rosita_knn_txt', 'AUC': 0.918901685, 'FPR95': 0.3338, 'ACC_ALL': 0.4252, 'ACC_ID': 0.3755, 'ACC_OOD': 0.9659, 'ACC_HM': 0.5407715073803488, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn7

Step 999: Top1: 0.5103; Top5: 0.7942
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5102880658436214, 'ACC_ID': 0.3374485596707819, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4885; Top5: 0.7924
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4884653961885657, 'ACC_ID': 0.32698094282848544, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4920; Top5: 0.7781
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49298597194388777, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5047; Top5: 0.7798
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5049900199600799, 'ACC_ID': 0.3473053892215569, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5076; Top5: 0.7740
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5085828343313373, 'ACC_ID': 0.3465069860279441, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4978; Top5: 0.7635
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49867197875166, 'ACC_ID': 0.3389774236387782, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4962; Top5: 0.7617
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4967264446342158, 'ACC_ID': 0.3435809849131796, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4966; Top5: 0.7632
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49700897308075775, 'ACC_ID': 0.348703888334995, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4992; Top5: 0.7661
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4996661473403071, 'ACC_ID': 0.3516581348764745, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5006; Top5: 0.7688
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5011024253357387, 'ACC_ID': 0.3585888955702546, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5008; Top5: 0.7690
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5010877447425671, 'ACC_ID': 0.3593183466279913, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4977; Top5: 0.7674
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49776082269033006, 'ACC_ID': 0.3581025045612871, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4984; Top5: 0.7663
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49853958493466566, 'ACC_ID': 0.35895465026902384, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4975; Top5: 0.7654
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49757834757834757, 'ACC_ID': 0.36011396011396013, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4977; Top5: 0.7658
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4978102189781022, 'ACC_ID': 0.3621765096217651, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4948; Top5: 0.7639
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49494697442295693, 'ACC_ID': 0.35945102932002493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4902; Top5: 0.7589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49042415697332864, 'ACC_ID': 0.3543649394900717, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4843; Top5: 0.7537
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4844858156028369, 'ACC_ID': 0.3497340425531915, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4795; Top5: 0.7487
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4797055730809674, 'ACC_ID': 0.3437434279705573, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4717; Top5: 0.7415
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4719, 'ACC_ID': 0.3371, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.366081   0.35990104 ... 0.17008099 0.1667825  0.14694704]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 47.1700; Top-5 accuracy: 74.1500
{'Method': 'rosita_knn_txt', 'AUC': 0.656528425, 'FPR95': 0.8949, 'ACC_ALL': 0.4719, 'ACC_ID': 0.3371, 'ACC_OOD': 0.6843, 'ACC_HM': 0.4516889171725083, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn7

Step 999: Top1: 0.5123; Top5: 0.7942
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.38271604938271603, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4905; Top5: 0.7944
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49047141424272817, 'ACC_ID': 0.3600802407221665, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4953; Top5: 0.7774
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4956579826319305, 'ACC_ID': 0.3587174348697395, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5067; Top5: 0.7798
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5059880239520959, 'ACC_ID': 0.3627744510978044, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5108; Top5: 0.7748
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5109780439121756, 'ACC_ID': 0.35808383233532937, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5025; Top5: 0.7669
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5029880478087649, 'ACC_ID': 0.3462815405046481, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4913; Top5: 0.7532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4916026188442926, 'ACC_ID': 0.3327640193566752, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4914; Top5: 0.7522
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4915254237288136, 'ACC_ID': 0.33873379860418745, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4923; Top5: 0.7550
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49254395726685957, 'ACC_ID': 0.34275539728466503, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4944; Top5: 0.7572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49468831429144117, 'ACC_ID': 0.3491681699739427, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4950; Top5: 0.7572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.495286439448876, 'ACC_ID': 0.3509789702683104, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4920; Top5: 0.7565
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4921214131696799, 'ACC_ID': 0.34881406535080445, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4892; Top5: 0.7556
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4894696387394312, 'ACC_ID': 0.34788624135280555, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4868; Top5: 0.7538
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48703703703703705, 'ACC_ID': 0.3468660968660969, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4852; Top5: 0.7532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48546781685467816, 'ACC_ID': 0.34611811546118115, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4822; Top5: 0.7506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48234560199625703, 'ACC_ID': 0.34535246412975673, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4789; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.479144636352955, 'ACC_ID': 0.34320291387616025, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4755; Top5: 0.7448
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4757313829787234, 'ACC_ID': 0.34131205673758863, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4743; Top5: 0.7427
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47455310199789696, 'ACC_ID': 0.34006309148264985, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4700; Top5: 0.7389
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4704, 'ACC_ID': 0.3367, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36697659 0.36032107 ... 0.16627261 0.15773275 0.14645195]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 47.0100; Top-5 accuracy: 73.8900
{'Method': 'rosita_knn_txt', 'AUC': 0.64311534, 'FPR95': 0.8967, 'ACC_ALL': 0.4704, 'ACC_ID': 0.3367, 'ACC_OOD': 0.6638, 'ACC_HM': 0.44677953023488254, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




1 10
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn10

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7139917695473251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7994; Top5: 0.9739
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7993981945837513, 'ACC_ID': 0.7321965897693079, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7921; Top5: 0.9746
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7922511690046761, 'ACC_ID': 0.7287909151636607, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7873; Top5: 0.9760
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7874251497005988, 'ACC_ID': 0.716566866267465, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7839; Top5: 0.9728
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7840319361277445, 'ACC_ID': 0.7049900199600798, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7825; Top5: 0.9724
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7825365205843293, 'ACC_ID': 0.7055112881806109, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7757; Top5: 0.9724
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.775690293196698, 'ACC_ID': 0.7059493310560774, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7771; Top5: 0.9721
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7771684945164506, 'ACC_ID': 0.7126121635094715, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7719; Top5: 0.9706
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7718673492098821, 'ACC_ID': 0.7133318495437347, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7698; Top5: 0.9689
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7696933253156946, 'ACC_ID': 0.7167769092002405, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7679; Top5: 0.9697
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7679477882523568, 'ACC_ID': 0.7197244379985497, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7691; Top5: 0.9705
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7691159396251451, 'ACC_ID': 0.724498258417648, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7677; Top5: 0.9702
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.76771714066103, 'ACC_ID': 0.7263643351268255, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7662; Top5: 0.9701
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7660968660968661, 'ACC_ID': 0.7277777777777777, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7651; Top5: 0.9703
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7652289316522893, 'ACC_ID': 0.7295288652952886, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7638; Top5: 0.9698
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7639426076107299, 'ACC_ID': 0.7303805364940736, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7627; Top5: 0.9693
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7630125719656915, 'ACC_ID': 0.7314064152273528, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7634; Top5: 0.9691
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7637411347517731, 'ACC_ID': 0.7339317375886525, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7650; Top5: 0.9699
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7652996845425868, 'ACC_ID': 0.7370136698212408, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7643; Top5: 0.9699
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7645, 'ACC_ID': 0.7376, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33738869 0.29583132 ... 0.13752389 0.13752308 0.07515739]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.4200; Top-5 accuracy: 96.9900
{'Method': 'rosita_knn_txt', 'AUC': 0.9815475600000002, 'FPR95': 0.1387, 'ACC_ALL': 0.7645, 'ACC_ID': 0.7376, 'ACC_OOD': 0.9984, 'ACC_HM': 0.8484099539170508, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn10

Step 999: Top1: 0.7881; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7880658436213992, 'ACC_ID': 0.7139917695473251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8004; Top5: 0.9739
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8004012036108324, 'ACC_ID': 0.7352056168505516, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7934; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7935871743486974, 'ACC_ID': 0.7327989311957248, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7943; Top5: 0.9785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7949101796407185, 'ACC_ID': 0.7405189620758483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7883; Top5: 0.9760
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7888223552894211, 'ACC_ID': 0.7301397205588822, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7788; Top5: 0.9701
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7792164674634794, 'ACC_ID': 0.7227755644090306, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7714; Top5: 0.9664
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7717050953600911, 'ACC_ID': 0.717904924565898, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7701; Top5: 0.9658
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7704386839481555, 'ACC_ID': 0.7088733798604188, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7690; Top5: 0.9644
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7691965279323392, 'ACC_ID': 0.7028711328733586, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7664; Top5: 0.9635
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7662858288234115, 'ACC_ID': 0.6953297253958709, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7639; Top5: 0.9630
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7637781000725163, 'ACC_ID': 0.6916243654822335, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7618; Top5: 0.9633
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7616520152595787, 'ACC_ID': 0.6893348814065351, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7583; Top5: 0.9617
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7581860107609532, 'ACC_ID': 0.6871637202152191, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7574; Top5: 0.9620
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7571225071225072, 'ACC_ID': 0.6866096866096866, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7565; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.756337093563371, 'ACC_ID': 0.688122096881221, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7571; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7569557080474111, 'ACC_ID': 0.689207735495945, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7569; Top5: 0.9602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7567853366231935, 'ACC_ID': 0.6891082129009517, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7570; Top5: 0.9601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7568705673758865, 'ACC_ID': 0.6898271276595744, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7578; Top5: 0.9598
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7577287066246057, 'ACC_ID': 0.689589905362776, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7573; Top5: 0.9589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7571, 'ACC_ID': 0.69, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33737585 0.29719958 ... 0.13841537 0.13841249 0.09758542]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 75.7200; Top-5 accuracy: 95.8900
{'Method': 'rosita_knn_txt', 'AUC': 0.94838903, 'FPR95': 0.2928, 'ACC_ALL': 0.7571, 'ACC_ID': 0.69, 'ACC_OOD': 0.9795, 'ACC_HM': 0.8096495956873315, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn10

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.6728395061728395, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8034; Top5: 0.9759
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8034102306920762, 'ACC_ID': 0.691073219658977, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7955; Top5: 0.9773
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7962591850367402, 'ACC_ID': 0.7020708082832331, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7958; Top5: 0.9805
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7964071856287425, 'ACC_ID': 0.7070858283433133, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7979; Top5: 0.9804
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7984031936127745, 'ACC_ID': 0.7013972055888223, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7918; Top5: 0.9781
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7921646746347941, 'ACC_ID': 0.6935590969455512, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7839; Top5: 0.9747
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7842300028465699, 'ACC_ID': 0.6865926558497011, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7833; Top5: 0.9746
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7836490528414756, 'ACC_ID': 0.6864406779661016, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7821; Top5: 0.9748
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7823280658802582, 'ACC_ID': 0.6848430892499443, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7821; Top5: 0.9745
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7821206654640208, 'ACC_ID': 0.6831028262176789, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7837; Top5: 0.9755
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7839013778100072, 'ACC_ID': 0.6869108049311095, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7852; Top5: 0.9758
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7853707082434898, 'ACC_ID': 0.6885055564770277, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7843; Top5: 0.9763
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7844734819369715, 'ACC_ID': 0.688086087624904, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7829; Top5: 0.9763
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7829059829059829, 'ACC_ID': 0.6821937321937321, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7798; Top5: 0.9741
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7799601857996019, 'ACC_ID': 0.6765759787657598, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7756; Top5: 0.9723
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7756706175920149, 'ACC_ID': 0.6701185277604491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7705; Top5: 0.9695
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7706497473857361, 'ACC_ID': 0.6644342615438844, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7656; Top5: 0.9672
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7657358156028369, 'ACC_ID': 0.6563608156028369, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7629; Top5: 0.9665
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7629863301787592, 'ACC_ID': 0.6513144058885384, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7599; Top5: 0.9650
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.76, 'ACC_ID': 0.6465, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33737299 0.32856619 ... 0.13845217 0.1379972  0.12616335]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 75.9900; Top-5 accuracy: 96.5000
{'Method': 'rosita_knn_txt', 'AUC': 0.81471154, 'FPR95': 0.7001, 'ACC_ALL': 0.76, 'ACC_ID': 0.6465, 'ACC_OOD': 0.7732, 'ACC_HM': 0.7041963795167994, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn10

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8014; Top5: 0.9759
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8014042126379137, 'ACC_ID': 0.7352056168505516, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7961; Top5: 0.9779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7962591850367402, 'ACC_ID': 0.7348029392117569, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7958; Top5: 0.9800
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7959081836327345, 'ACC_ID': 0.7405189620758483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7967; Top5: 0.9816
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7968063872255489, 'ACC_ID': 0.7397205588822355, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7924; Top5: 0.9804
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7924966799468791, 'ACC_ID': 0.7367197875166003, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7837; Top5: 0.9778
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7839453458582408, 'ACC_ID': 0.7307144890407059, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7818; Top5: 0.9773
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7821535393818544, 'ACC_ID': 0.7285643070787637, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7823; Top5: 0.9773
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7825506343200535, 'ACC_ID': 0.7289116403294013, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7825; Top5: 0.9771
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7825215474042895, 'ACC_ID': 0.7292042493485669, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7835; Top5: 0.9784
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7837200870195794, 'ACC_ID': 0.7278825235678028, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7847; Top5: 0.9783
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7848731132857854, 'ACC_ID': 0.7256593133189584, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7832; Top5: 0.9788
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7833973866256726, 'ACC_ID': 0.7249807840122983, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7836; Top5: 0.9788
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7836182336182336, 'ACC_ID': 0.7235042735042735, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7812; Top5: 0.9774
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7812873258128733, 'ACC_ID': 0.7206370272063702, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7791; Top5: 0.9769
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.779288833437305, 'ACC_ID': 0.7135371179039302, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7764; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7765244977088473, 'ACC_ID': 0.7064974738573611, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7742; Top5: 0.9743
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7742686170212766, 'ACC_ID': 0.7002437943262412, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7740; Top5: 0.9742
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7741324921135647, 'ACC_ID': 0.6972660357518402, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7717; Top5: 0.9723
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7718, 'ACC_ID': 0.6916, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33747816 0.33529359 ... 0.15047278 0.15034117 0.12006044]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 77.1700; Top-5 accuracy: 97.2300
{'Method': 'rosita_knn_txt', 'AUC': 0.8444503250000001, 'FPR95': 0.5403, 'ACC_ALL': 0.7718, 'ACC_ID': 0.6916, 'ACC_OOD': 0.7493, 'ACC_HM': 0.719294718578666, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn10

Step 999: Top1: 0.5144; Top5: 0.7942
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.3724279835390947, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4905; Top5: 0.7934
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49047141424272817, 'ACC_ID': 0.3630892678034102, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4947; Top5: 0.7801
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49498997995991983, 'ACC_ID': 0.374749498997996, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4913; Top5: 0.7738
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49101796407185627, 'ACC_ID': 0.38822355289421157, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4900; Top5: 0.7648
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4906187624750499, 'ACC_ID': 0.40838323353293415, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4849; Top5: 0.7625
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4853917662682603, 'ACC_ID': 0.4166666666666667, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4777; Top5: 0.7563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4779390834044976, 'ACC_ID': 0.4187304298320524, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4789; Top5: 0.7524
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4788135593220339, 'ACC_ID': 0.4264705882352941, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4738; Top5: 0.7492
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47384820832405966, 'ACC_ID': 0.4268862675272646, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4703; Top5: 0.7468
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47043495690519144, 'ACC_ID': 0.42794147123672077, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4664; Top5: 0.7429
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4662799129804206, 'ACC_ID': 0.4278462654097172, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4623; Top5: 0.7387
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46226571570741415, 'ACC_ID': 0.4271023386963012, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4609; Top5: 0.7368
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4608762490392006, 'ACC_ID': 0.42797847809377404, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4593; Top5: 0.7354
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45925925925925926, 'ACC_ID': 0.4284900284900285, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4588; Top5: 0.7346
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45892501658925017, 'ACC_ID': 0.4302587923025879, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4584; Top5: 0.7338
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45864004990642543, 'ACC_ID': 0.43169058016219586, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4586; Top5: 0.7335
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4589354952414522, 'ACC_ID': 0.4335565738456116, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4571; Top5: 0.7332
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4574468085106383, 'ACC_ID': 0.43351063829787234, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4578; Top5: 0.7344
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4580441640378549, 'ACC_ID': 0.4353312302839117, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4571; Top5: 0.7342
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4574, 'ACC_ID': 0.4358, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36522254 0.30889454 ... 0.14220278 0.14219493 0.08503631]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 45.7200; Top-5 accuracy: 73.4200
{'Method': 'rosita_knn_txt', 'AUC': 0.954864565, 'FPR95': 0.1482, 'ACC_ALL': 0.4574, 'ACC_ID': 0.4358, 'ACC_OOD': 0.9898, 'ACC_HM': 0.6051554994388328, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn10

Step 999: Top1: 0.5144; Top5: 0.7963
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.4012345679012346, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4955; Top5: 0.7954
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4954864593781344, 'ACC_ID': 0.38515546639919757, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4960; Top5: 0.7787
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49632598530394123, 'ACC_ID': 0.3927855711422846, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5017; Top5: 0.7783
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5014970059880239, 'ACC_ID': 0.4086826347305389, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4912; Top5: 0.7616
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49141716566866267, 'ACC_ID': 0.3968063872255489, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4763; Top5: 0.7449
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4764276228419655, 'ACC_ID': 0.3901062416998672, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4688; Top5: 0.7404
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46883005977796754, 'ACC_ID': 0.39054938798747507, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4640; Top5: 0.7342
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46385842472582256, 'ACC_ID': 0.38808574277168495, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4567; Top5: 0.7296
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4567104384598264, 'ACC_ID': 0.38237257956821724, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4523; Top5: 0.7259
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45239526959310483, 'ACC_ID': 0.38043696131489274, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4462; Top5: 0.7179
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4463379260333575, 'ACC_ID': 0.37744742567077594, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4394; Top5: 0.7123
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4393763476530104, 'ACC_ID': 0.37319621827832145, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4357; Top5: 0.7082
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43566487317448116, 'ACC_ID': 0.3714066102997694, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4341; Top5: 0.7059
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4337606837606838, 'ACC_ID': 0.37207977207977205, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4307; Top5: 0.7071
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43039150630391504, 'ACC_ID': 0.37133377571333775, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4281; Top5: 0.7059
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4278228321896444, 'ACC_ID': 0.3718028696194635, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4274; Top5: 0.7043
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42721184349665137, 'ACC_ID': 0.37328163553048993, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4253; Top5: 0.7032
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4250886524822695, 'ACC_ID': 0.37300531914893614, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4252; Top5: 0.7022
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4251314405888538, 'ACC_ID': 0.37455310199789693, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4229; Top5: 0.7006
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4228, 'ACC_ID': 0.3733, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36568931 0.31012627 ... 0.17460771 0.17458043 0.12613508]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 42.3000; Top-5 accuracy: 70.0600
{'Method': 'rosita_knn_txt', 'AUC': 0.9196828799999999, 'FPR95': 0.3211, 'ACC_ALL': 0.4228, 'ACC_ID': 0.3733, 'ACC_OOD': 0.9671, 'ACC_HM': 0.5386726797970754, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn10

Step 999: Top1: 0.5103; Top5: 0.7942
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5102880658436214, 'ACC_ID': 0.3374485596707819, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4885; Top5: 0.7934
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4884653961885657, 'ACC_ID': 0.3319959879638917, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4926; Top5: 0.7774
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49432197728790916, 'ACC_ID': 0.3453573814295257, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5057; Top5: 0.7788
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5064870259481038, 'ACC_ID': 0.3502994011976048, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5060; Top5: 0.7700
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5069860279441117, 'ACC_ID': 0.34530938123752497, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4909; Top5: 0.7479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4916998671978752, 'ACC_ID': 0.32735723771580344, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4873; Top5: 0.7438
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4879020779960148, 'ACC_ID': 0.3330486763450043, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4889; Top5: 0.7479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48928215353938187, 'ACC_ID': 0.339481555333998, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4919; Top5: 0.7516
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49232138882706433, 'ACC_ID': 0.3425328288448698, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4946; Top5: 0.7556
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49508919623170977, 'ACC_ID': 0.34936861094407695, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4952; Top5: 0.7567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4956490210297317, 'ACC_ID': 0.35152284263959394, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4930; Top5: 0.7566
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4932824680709902, 'ACC_ID': 0.35163377011112956, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4932; Top5: 0.7550
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49346656418139895, 'ACC_ID': 0.3535741737125288, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4914; Top5: 0.7541
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4915954415954416, 'ACC_ID': 0.35313390313390314, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4896; Top5: 0.7533
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48971466489714666, 'ACC_ID': 0.35142667551426676, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4858; Top5: 0.7497
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4857142857142857, 'ACC_ID': 0.34847161572052404, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4826; Top5: 0.7464
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48255199154035955, 'ACC_ID': 0.34590529902479145, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4796; Top5: 0.7428
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4796099290780142, 'ACC_ID': 0.3431959219858156, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4763; Top5: 0.7389
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47634069400630913, 'ACC_ID': 0.3405888538380652, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4699; Top5: 0.7326
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4699, 'ACC_ID': 0.3344, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36601159 0.35913074 ... 0.16410106 0.15909268 0.14112698]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 46.9900; Top-5 accuracy: 73.2600
{'Method': 'rosita_knn_txt', 'AUC': 0.64590647, 'FPR95': 0.912, 'ACC_ALL': 0.4699, 'ACC_ID': 0.3344, 'ACC_OOD': 0.6766, 'ACC_HM': 0.4475866271018793, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp1_kn10

Step 999: Top1: 0.5123; Top5: 0.7963
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.38271604938271603, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4885; Top5: 0.7944
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48946840521564694, 'ACC_ID': 0.3600802407221665, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4940; Top5: 0.7767
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49498997995991983, 'ACC_ID': 0.3580494321977288, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5052; Top5: 0.7778
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5054890219560878, 'ACC_ID': 0.3587824351297405, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5076; Top5: 0.7708
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5081836327345309, 'ACC_ID': 0.350499001996008, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4968; Top5: 0.7556
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49734395750332006, 'ACC_ID': 0.33598937583001326, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4910; Top5: 0.7504
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49131796185596355, 'ACC_ID': 0.33247936236834613, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4916; Top5: 0.7517
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49177467597208374, 'ACC_ID': 0.3382352941176471, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4934; Top5: 0.7550
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4934342310260405, 'ACC_ID': 0.34231026040507456, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4948; Top5: 0.7584
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49488875526157544, 'ACC_ID': 0.34876728803367407, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4950; Top5: 0.7572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.495286439448876, 'ACC_ID': 0.3509789702683104, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4919; Top5: 0.7563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4919555481837784, 'ACC_ID': 0.34815060540719855, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4895; Top5: 0.7551
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48962336664104533, 'ACC_ID': 0.3468101460415065, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4878; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4878917378917379, 'ACC_ID': 0.34629629629629627, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4857; Top5: 0.7537
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4858659588586596, 'ACC_ID': 0.3453218314532183, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4835; Top5: 0.7517
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48359326263256397, 'ACC_ID': 0.34485339987523395, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4797; Top5: 0.7489
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4799671013981906, 'ACC_ID': 0.34085301374691573, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4761; Top5: 0.7463
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4762854609929078, 'ACC_ID': 0.3379875886524823, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4735; Top5: 0.7430
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4737118822292324, 'ACC_ID': 0.3349106203995794, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4672; Top5: 0.7377
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4675, 'ACC_ID': 0.3294, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.3670482  0.35960361 ... 0.15735877 0.1555486  0.14534621]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 46.7300; Top-5 accuracy: 73.7700
{'Method': 'rosita_knn_txt', 'AUC': 0.633306265, 'FPR95': 0.9057, 'ACC_ALL': 0.4675, 'ACC_ID': 0.3294, 'ACC_OOD': 0.668, 'ACC_HM': 0.4412255865249649, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




2 1
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=2, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp2_kn1

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7964; Top5: 0.9739
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7973921765295887, 'ACC_ID': 0.7342026078234705, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7908; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7915831663326653, 'ACC_ID': 0.7321309285237141, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7948; Top5: 0.9785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7954091816367266, 'ACC_ID': 0.7400199600798403, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7987; Top5: 0.9820
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7996007984031936, 'ACC_ID': 0.7477045908183633, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8004; Top5: 0.9831
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8011288180610889, 'ACC_ID': 0.7556440903054449, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7948; Top5: 0.9818
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7953316253914033, 'ACC_ID': 0.7517791061770567, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7938; Top5: 0.9806
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7946161515453639, 'ACC_ID': 0.7495014955134596, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7903; Top5: 0.9797
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7910082350322725, 'ACC_ID': 0.7424883151569107, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7887; Top5: 0.9794
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7893365403888555, 'ACC_ID': 0.7372218881539386, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7889; Top5: 0.9793
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7895213923132705, 'ACC_ID': 0.7378535170413343, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7890; Top5: 0.9794
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7895173328910267, 'ACC_ID': 0.7377674572897661, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7877; Top5: 0.9794
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.788162951575711, 'ACC_ID': 0.7363566487317448, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7864; Top5: 0.9789
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7868945868945869, 'ACC_ID': 0.7334757834757835, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7857; Top5: 0.9785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7860650298606503, 'ACC_ID': 0.7315195753151957, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7843; Top5: 0.9783
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7846537741734249, 'ACC_ID': 0.7293824079850281, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7842; Top5: 0.9777
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7845141581482787, 'ACC_ID': 0.7284690400657972, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7839; Top5: 0.9777
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7842420212765957, 'ACC_ID': 0.7272828014184397, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7843; Top5: 0.9781
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7846477392218717, 'ACC_ID': 0.7277602523659306, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7831; Top5: 0.9777
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7832, 'ACC_ID': 0.7247, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33738869 0.29563084 ... 0.17055908 0.15461858 0.15070625]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 78.3000; Top-5 accuracy: 97.7700
{'Method': 'rosita_knn_txt', 'AUC': 0.972151625, 'FPR95': 0.1813, 'ACC_ALL': 0.7832, 'ACC_ID': 0.7247, 'ACC_OOD': 0.995, 'ACC_HM': 0.8386073152294005, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=2, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp2_kn1

Step 999: Top1: 0.7881; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7880658436213992, 'ACC_ID': 0.7139917695473251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7984; Top5: 0.9749
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.79839518555667, 'ACC_ID': 0.7362086258776329, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7948; Top5: 0.9759
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7949231796927188, 'ACC_ID': 0.7341349365397462, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7993; Top5: 0.9790
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7994011976047904, 'ACC_ID': 0.7425149700598802, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8039; Top5: 0.9820
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8043912175648703, 'ACC_ID': 0.7497005988023953, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8074; Top5: 0.9837
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8077689243027888, 'ACC_ID': 0.7569721115537849, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.8016; Top5: 0.9824
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8018787361229718, 'ACC_ID': 0.7549103330486764, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.8010; Top5: 0.9823
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.801345962113659, 'ACC_ID': 0.7562313060817547, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.8004; Top5: 0.9815
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8005786779434676, 'ACC_ID': 0.755842421544625, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.8007; Top5: 0.9818
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8007616756865104, 'ACC_ID': 0.7568651032270997, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.8009; Top5: 0.9831
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8013052936910805, 'ACC_ID': 0.7585206671501088, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.8004; Top5: 0.9827
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8007961519323271, 'ACC_ID': 0.7585005805274506, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7982; Top5: 0.9814
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7984627209838586, 'ACC_ID': 0.7564950038431976, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7964; Top5: 0.9805
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7965811965811965, 'ACC_ID': 0.7541310541310541, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7936; Top5: 0.9794
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7940278699402787, 'ACC_ID': 0.752621101526211, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7926; Top5: 0.9792
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7930131004366813, 'ACC_ID': 0.751715533374922, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7926; Top5: 0.9780
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7929737986135589, 'ACC_ID': 0.7491481612031489, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7922; Top5: 0.9775
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7924423758865248, 'ACC_ID': 0.7461214539007093, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7930; Top5: 0.9777
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7931650893796004, 'ACC_ID': 0.7441640378548896, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7906; Top5: 0.9769
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7908, 'ACC_ID': 0.7414, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33737585 0.29997364 ... 0.15628821 0.15622257 0.1197174 ]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 79.0600; Top-5 accuracy: 97.6900
{'Method': 'rosita_knn_txt', 'AUC': 0.966558545, 'FPR95': 0.2267, 'ACC_ALL': 0.7908, 'ACC_ID': 0.7414, 'ACC_OOD': 0.9785, 'ACC_HM': 0.8436070701784987, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp2_kn1

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.6707818930041153, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7984; Top5: 0.9769
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.79839518555667, 'ACC_ID': 0.6680040120361084, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7948; Top5: 0.9779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7949231796927188, 'ACC_ID': 0.6893787575150301, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7983; Top5: 0.9805
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7984031936127745, 'ACC_ID': 0.7085828343313373, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8011; Top5: 0.9828
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8011976047904191, 'ACC_ID': 0.7201596806387226, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8037; Top5: 0.9841
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8037848605577689, 'ACC_ID': 0.7274236387782205, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7987; Top5: 0.9826
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7987475092513521, 'ACC_ID': 0.7272986051807572, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7983; Top5: 0.9835
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7983549351944168, 'ACC_ID': 0.727567298105683, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7963; Top5: 0.9835
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7963498775873581, 'ACC_ID': 0.7251279768528822, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7971; Top5: 0.9838
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.797153738224093, 'ACC_ID': 0.7251954299458809, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7980; Top5: 0.9848
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7980420594633792, 'ACC_ID': 0.72643219724438, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7989; Top5: 0.9844
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7989716370874108, 'ACC_ID': 0.7259910432907614, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.8000; Top5: 0.9843
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7998462720983859, 'ACC_ID': 0.7282090699461953, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7998; Top5: 0.9835
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7997150997150997, 'ACC_ID': 0.7246438746438747, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7989; Top5: 0.9834
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7989382879893829, 'ACC_ID': 0.7246184472461845, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7981; Top5: 0.9830
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7981285090455396, 'ACC_ID': 0.7252651278852152, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7992; Top5: 0.9827
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7992010339560569, 'ACC_ID': 0.7260016449300905, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.8004; Top5: 0.9826
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8004210992907801, 'ACC_ID': 0.7278368794326241, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.8021; Top5: 0.9830
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8021030494216614, 'ACC_ID': 0.7294426919032597, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.8012; Top5: 0.9828
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8011, 'ACC_ID': 0.728, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34189326 0.33080244 ... 0.18327859 0.18315572 0.16379109]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 80.1100; Top-5 accuracy: 98.2800
{'Method': 'rosita_knn_txt', 'AUC': 0.86717916, 'FPR95': 0.508, 'ACC_ALL': 0.8011, 'ACC_ID': 0.728, 'ACC_OOD': 0.7175, 'ACC_HM': 0.7227118644067797, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp2_kn1

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8004; Top5: 0.9769
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8004012036108324, 'ACC_ID': 0.7372116349047142, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7948; Top5: 0.9786
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7949231796927188, 'ACC_ID': 0.7408149632598531, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7988; Top5: 0.9800
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7989021956087824, 'ACC_ID': 0.7470059880239521, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8015; Top5: 0.9824
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8019960079840319, 'ACC_ID': 0.7516966067864271, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8047; Top5: 0.9834
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8051128818061088, 'ACC_ID': 0.7602921646746348, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7985; Top5: 0.9826
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7987475092513521, 'ACC_ID': 0.7574722459436379, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7981; Top5: 0.9833
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7983549351944168, 'ACC_ID': 0.7577268195413759, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7970; Top5: 0.9829
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.797240151346539, 'ACC_ID': 0.7556198531048297, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7979; Top5: 0.9832
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7981559430747645, 'ACC_ID': 0.7562637803166967, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7989; Top5: 0.9844
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7991298042059464, 'ACC_ID': 0.7577955039883973, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.8004; Top5: 0.9841
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8006302869464256, 'ACC_ID': 0.7588323104992536, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.8005; Top5: 0.9842
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8006149116064566, 'ACC_ID': 0.7588009223674097, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.8001; Top5: 0.9835
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8002849002849003, 'ACC_ID': 0.7561253561253561, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7984; Top5: 0.9833
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7986728599867285, 'ACC_ID': 0.7552753815527539, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7979; Top5: 0.9830
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7981285090455396, 'ACC_ID': 0.7543356207111666, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7986; Top5: 0.9825
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7988485489366702, 'ACC_ID': 0.7552579015391846, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7991; Top5: 0.9825
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7993129432624113, 'ACC_ID': 0.7565381205673759, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.8011; Top5: 0.9828
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8012618296529969, 'ACC_ID': 0.7581493165089379, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7995; Top5: 0.9824
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7996, 'ACC_ID': 0.7573, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34137774 0.33401099 ... 0.18482649 0.18480626 0.14826593]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 79.9400; Top-5 accuracy: 98.2400
{'Method': 'rosita_knn_txt', 'AUC': 0.87846933, 'FPR95': 0.3531, 'ACC_ALL': 0.7996, 'ACC_ID': 0.7573, 'ACC_OOD': 0.726, 'ACC_HM': 0.7413197599946066, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp2_kn1

Step 999: Top1: 0.5123; Top5: 0.7942
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.37037037037037035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4915; Top5: 0.7924
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49147442326980945, 'ACC_ID': 0.3650952858575727, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4947; Top5: 0.7767
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4956579826319305, 'ACC_ID': 0.3787575150300601, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5047; Top5: 0.7813
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5044910179640718, 'ACC_ID': 0.3902195608782435, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5176; Top5: 0.7812
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5177644710578843, 'ACC_ID': 0.3992015968063872, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5168; Top5: 0.7808
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5169322709163346, 'ACC_ID': 0.4050464807436919, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5169; Top5: 0.7797
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5169370908055793, 'ACC_ID': 0.41901508682038147, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5138; Top5: 0.7771
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5137088733798604, 'ACC_ID': 0.42746759720837485, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5132; Top5: 0.7788
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5132428221678166, 'ACC_ID': 0.4353438682394836, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5128; Top5: 0.7777
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5129284425736621, 'ACC_ID': 0.44217278011625577, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5086; Top5: 0.7743
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5085206671501088, 'ACC_ID': 0.4439811457577955, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5050; Top5: 0.7726
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5048930170840935, 'ACC_ID': 0.44567921711726655, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5021; Top5: 0.7714
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5020753266717909, 'ACC_ID': 0.44704073789392773, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4996; Top5: 0.7685
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4995726495726496, 'ACC_ID': 0.448005698005698, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5010; Top5: 0.7691
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5011280690112807, 'ACC_ID': 0.4520238885202389, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4995; Top5: 0.7688
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4995633187772926, 'ACC_ID': 0.45315034310667496, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4975; Top5: 0.7679
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49770884737398663, 'ACC_ID': 0.4536482199506521, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4940; Top5: 0.7665
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4942375886524823, 'ACC_ID': 0.45246010638297873, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4945; Top5: 0.7667
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4946372239747634, 'ACC_ID': 0.4545741324921136, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4928; Top5: 0.7658
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.493, 'ACC_ID': 0.4545, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.36339048 0.31255054 ... 0.17503947 0.17503841 0.1211065 ]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 49.2900; Top-5 accuracy: 76.5800
{'Method': 'rosita_knn_txt', 'AUC': 0.9477066699999999, 'FPR95': 0.2515, 'ACC_ALL': 0.493, 'ACC_ID': 0.4545, 'ACC_OOD': 0.9853, 'ACC_HM': 0.6220570218085846, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp2_kn1

Step 999: Top1: 0.5123; Top5: 0.7984
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.40329218106995884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4925; Top5: 0.7954
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49247743229689067, 'ACC_ID': 0.38214643931795383, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4967; Top5: 0.7767
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4969939879759519, 'ACC_ID': 0.3914495657982632, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5082; Top5: 0.7783
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5079840319361277, 'ACC_ID': 0.4031936127744511, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5176; Top5: 0.7764
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5173652694610779, 'ACC_ID': 0.41077844311377243, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5168; Top5: 0.7765
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5169322709163346, 'ACC_ID': 0.41434262948207173, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5172; Top5: 0.7746
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5172217477939084, 'ACC_ID': 0.421576999715343, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5146; Top5: 0.7736
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.514456630109671, 'ACC_ID': 0.42397806580259223, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5137; Top5: 0.7732
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5139105274872023, 'ACC_ID': 0.42577342532828844, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5096; Top5: 0.7749
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5097213870515134, 'ACC_ID': 0.42613750250551213, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5019; Top5: 0.7661
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5019941986947063, 'ACC_ID': 0.4196881798404641, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4955; Top5: 0.7600
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4956045778736109, 'ACC_ID': 0.41781389948581854, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4902; Top5: 0.7577
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49039200614911604, 'ACC_ID': 0.41691006917755574, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4867; Top5: 0.7545
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48675213675213674, 'ACC_ID': 0.41737891737891736, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4831; Top5: 0.7541
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4832116788321168, 'ACC_ID': 0.4163238221632382, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4815; Top5: 0.7516
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4815970056144729, 'ACC_ID': 0.41734248284466624, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4776; Top5: 0.7494
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4777346962754083, 'ACC_ID': 0.4152273528375044, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4725; Top5: 0.7460
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47273936170212766, 'ACC_ID': 0.412677304964539, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4715; Top5: 0.7445
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47171398527865405, 'ACC_ID': 0.4125131440588854, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4690; Top5: 0.7438
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4692, 'ACC_ID': 0.4115, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.36985138 0.31493434 ... 0.18064067 0.18063724 0.1447825 ]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 46.9100; Top-5 accuracy: 74.3800
{'Method': 'rosita_knn_txt', 'AUC': 0.9102604299999999, 'FPR95': 0.44, 'ACC_ALL': 0.4692, 'ACC_ID': 0.4115, 'ACC_OOD': 0.9803, 'ACC_HM': 0.579671576375916, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2
maple_kp2_kn1

Step 999: Top1: 0.5123; Top5: 0.7942
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.3374485596707819, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4925; Top5: 0.7944
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49247743229689067, 'ACC_ID': 0.31795386158475425, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4947; Top5: 0.7767
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4956579826319305, 'ACC_ID': 0.3306613226452906, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5042; Top5: 0.7783
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5044910179640718, 'ACC_ID': 0.35429141716566864, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5156; Top5: 0.7784
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5161676646706587, 'ACC_ID': 0.36926147704590817, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5174; Top5: 0.7795
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5179282868525896, 'ACC_ID': 0.37749003984063745, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5184; Top5: 0.7791
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5186450327355536, 'ACC_ID': 0.38001707941929974, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5171; Top5: 0.7796
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.517198404785643, 'ACC_ID': 0.3798604187437687, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5166; Top5: 0.7810
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5168039172045404, 'ACC_ID': 0.37413754729579346, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5164; Top5: 0.7817
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5167368210062137, 'ACC_ID': 0.373822409300461, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5157; Top5: 0.7806
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5159535895576505, 'ACC_ID': 0.3734590282813633, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5124; Top5: 0.7799
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5125228064355615, 'ACC_ID': 0.37037651351799633, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5113; Top5: 0.7780
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5114527286702536, 'ACC_ID': 0.37002305918524214, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5082; Top5: 0.7765
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5082621082621083, 'ACC_ID': 0.36752136752136755, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5103; Top5: 0.7782
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5102853351028533, 'ACC_ID': 0.3678832116788321, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5117; Top5: 0.7798
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5116656269494697, 'ACC_ID': 0.37043044291952587, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5106; Top5: 0.7810
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5105158030783692, 'ACC_ID': 0.3701092703560099, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5086; Top5: 0.7806
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5085328014184397, 'ACC_ID': 0.36912677304964536, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5102; Top5: 0.7815
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5100946372239747, 'ACC_ID': 0.36824395373291274, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5100; Top5: 0.7825
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5099, 'ACC_ID': 0.3688, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.36443725 0.3535296  ... 0.2088649  0.20150854 0.19071889]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 51.0000; Top-5 accuracy: 78.2500
{'Method': 'rosita_knn_txt', 'AUC': 0.6930089300000001, 'FPR95': 0.8376, 'ACC_ALL': 0.5099, 'ACC_ID': 0.3688, 'ACC_OOD': 0.6946, 'ACC_HM': 0.4817913861199925, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
2 3
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
2 5
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
2 7
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
2 10
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
3 1
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
3 3
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
3 5
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
3 7
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
3 10
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
4 1
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
4 3
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
4 5
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
4 7
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
4 10
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
5 1
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
5 3
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
5 5
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
5 7
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
5 10
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood_maple.py", line 22, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
