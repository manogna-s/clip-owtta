Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='msp', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.6790123456790124, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.8044; Top5: 0.9769
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8044132397191575, 'ACC_ID': 0.6930792377131394, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.7968; Top5: 0.9779
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7969271877087508, 'ACC_ID': 0.6933867735470942, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.8028; Top5: 0.9820
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8028942115768463, 'ACC_ID': 0.7015968063872255, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.8107; Top5: 0.9844
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8107784431137725, 'ACC_ID': 0.7109780439121757, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.8120; Top5: 0.9851
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8120849933598937, 'ACC_ID': 0.7138114209827358, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.8061; Top5: 0.9852
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8061485909479078, 'ACC_ID': 0.7119271278109878, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.8053; Top5: 0.9855
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.805333998005982, 'ACC_ID': 0.7136091724825523, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.8053; Top5: 0.9860
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8052526151791676, 'ACC_ID': 0.7160026708212776, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.8051; Top5: 0.9862
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8051713770294648, 'ACC_ID': 0.7147724994988975, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.8063; Top5: 0.9869
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8063814358230602, 'ACC_ID': 0.7170050761421319, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.8089; Top5: 0.9862
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8089235362414994, 'ACC_ID': 0.7203516337701111, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.8091; Top5: 0.9865
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8090699461952344, 'ACC_ID': 0.720522674865488, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.8087; Top5: 0.9862
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8086894586894587, 'ACC_ID': 0.7210826210826211, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.8076; Top5: 0.9859
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.807564698075647, 'ACC_ID': 0.7201061712010617, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.8065; Top5: 0.9857
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.806487835308796, 'ACC_ID': 0.7203992514036183, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.8077; Top5: 0.9852
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8077781694277993, 'ACC_ID': 0.7215368346845259, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.8091; Top5: 0.9854
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8091755319148937, 'ACC_ID': 0.7230718085106383, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.8111; Top5: 0.9857
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8112513144058885, 'ACC_ID': 0.7255520504731862, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.8093; Top5: 0.9855
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8094, 'ACC_ID': 0.7248, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar10OOD MNIST ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0.941895845, 'FPR95': 0.37, 'ACC_ALL': 0.8094, 'ACC_ID': 0.7248, 'ACC_OOD': 0.9533, 'ACC_HM': 0.8234930457064537}

Online evaluation: Top-1 accuracy: 80.9300; Top-5 accuracy: 98.5500




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7881; Top5: 0.9753
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7880658436213992, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.8064; Top5: 0.9759
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8064192577733199, 'ACC_ID': 0.7452357071213641, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.8001; Top5: 0.9773
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8002672010688042, 'ACC_ID': 0.7428189712758851, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.7993; Top5: 0.9800
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7994011976047904, 'ACC_ID': 0.7475049900199601, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.8035; Top5: 0.9820
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8031936127744511, 'ACC_ID': 0.7548902195608782, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.8050; Top5: 0.9821
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8047808764940239, 'ACC_ID': 0.7629482071713147, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.7976; Top5: 0.9812
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7973242243097068, 'ACC_ID': 0.7594648448619413, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.7978; Top5: 0.9818
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7976071784646062, 'ACC_ID': 0.7604685942173479, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.7979; Top5: 0.9822
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7976852882261295, 'ACC_ID': 0.7620743378588916, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.7979; Top5: 0.9822
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7975546201643616, 'ACC_ID': 0.7634796552415314, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.7996; Top5: 0.9831
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.799492385786802, 'ACC_ID': 0.7679477882523568, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.8008; Top5: 0.9832
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8006302869464256, 'ACC_ID': 0.7702769945264555, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.8009; Top5: 0.9836
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8007686395080708, 'ACC_ID': 0.7717140661029976, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.8020; Top5: 0.9839
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8017094017094017, 'ACC_ID': 0.7726495726495727, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.8007; Top5: 0.9835
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8003981420039814, 'ACC_ID': 0.772528201725282, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.8000; Top5: 0.9834
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7997504678727386, 'ACC_ID': 0.772800998128509, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.8007; Top5: 0.9838
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8004934790271413, 'ACC_ID': 0.7744095875925273, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.8011; Top5: 0.9840
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8008643617021277, 'ACC_ID': 0.7755984042553191, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.8030; Top5: 0.9843
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8028391167192429, 'ACC_ID': 0.7772870662460568, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.8019; Top5: 0.9841
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8016, 'ACC_ID': 0.7762, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar10OOD MNIST ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0.99141882, 'FPR95': 0.039, 'ACC_ALL': 0.8016, 'ACC_ID': 0.7762, 'ACC_OOD': 0.995, 'ACC_HM': 0.8720855916892503}

Online evaluation: Top-1 accuracy: 80.1800; Top-5 accuracy: 98.4100




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='msp', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.6893004115226338, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.8034; Top5: 0.9759
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8034102306920762, 'ACC_ID': 0.6980942828485457, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.7961; Top5: 0.9773
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7955911823647295, 'ACC_ID': 0.6993987975951904, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.8018; Top5: 0.9815
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8013972055888223, 'ACC_ID': 0.7075848303393214, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.8079; Top5: 0.9840
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8075848303393214, 'ACC_ID': 0.7161676646706587, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.8097; Top5: 0.9847
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8094289508632138, 'ACC_ID': 0.7181274900398407, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.8042; Top5: 0.9849
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8035866780529461, 'ACC_ID': 0.7161969826359237, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.8035; Top5: 0.9850
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8030907278165503, 'ACC_ID': 0.7178464606181456, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.8039; Top5: 0.9853
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8034720676608057, 'ACC_ID': 0.7197863342977966, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.8049; Top5: 0.9856
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8045700541190619, 'ACC_ID': 0.7189817598717178, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.8062; Top5: 0.9864
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8058375634517766, 'ACC_ID': 0.7213560551124003, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.8084; Top5: 0.9857
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.808094211311992, 'ACC_ID': 0.7241665284458451, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.8086; Top5: 0.9859
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8083013066871637, 'ACC_ID': 0.7235972328977709, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.8079; Top5: 0.9858
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8076923076923077, 'ACC_ID': 0.7242165242165243, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.8070; Top5: 0.9854
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8069011280690113, 'ACC_ID': 0.724087591240876, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.8061; Top5: 0.9849
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8059887710542732, 'ACC_ID': 0.7240174672489083, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.8071; Top5: 0.9844
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8069557043825637, 'ACC_ID': 0.7248266948654682, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.8084; Top5: 0.9844
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8083998226950354, 'ACC_ID': 0.7263962765957447, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.8109; Top5: 0.9846
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8109358569926394, 'ACC_ID': 0.7290220820189275, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.8089; Top5: 0.9846
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8089, 'ACC_ID': 0.7275, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar10OOD SVHN ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0.935117965, 'FPR95': 0.3778, 'ACC_ALL': 0.8089, 'ACC_ID': 0.7275, 'ACC_OOD': 0.9086, 'ACC_HM': 0.8080270154636026}

Online evaluation: Top-1 accuracy: 80.8900; Top-5 accuracy: 98.4600




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7881; Top5: 0.9753
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7880658436213992, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.8054; Top5: 0.9759
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8054162487462387, 'ACC_ID': 0.7422266800401204, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.7995; Top5: 0.9779
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7995991983967936, 'ACC_ID': 0.7401469605878424, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.7993; Top5: 0.9805
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7994011976047904, 'ACC_ID': 0.7445109780439122, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.8051; Top5: 0.9828
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.805189620758483, 'ACC_ID': 0.7500998003992015, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.8064; Top5: 0.9827
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8064409030544488, 'ACC_ID': 0.7539840637450199, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.7999; Top5: 0.9821
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7998861372046684, 'ACC_ID': 0.7466552803871335, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.7993; Top5: 0.9820
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7996011964107677, 'ACC_ID': 0.7432701894317049, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.7999; Top5: 0.9824
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8001335410638771, 'ACC_ID': 0.7431560204762965, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.7995; Top5: 0.9828
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7995590298657046, 'ACC_ID': 0.7402285027059531, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.8013; Top5: 0.9837
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8014865844815083, 'ACC_ID': 0.7423857868020305, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.8031; Top5: 0.9834
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8032841267208493, 'ACC_ID': 0.742577541880909, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.8045; Top5: 0.9839
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8044581091468102, 'ACC_ID': 0.7412759415833974, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.8055; Top5: 0.9839
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8055555555555556, 'ACC_ID': 0.7401709401709402, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.8048; Top5: 0.9835
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.804777704047777, 'ACC_ID': 0.7368281353682814, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.8055; Top5: 0.9835
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8054897067997505, 'ACC_ID': 0.7368683718028696, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.8064; Top5: 0.9840
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8063682293502527, 'ACC_ID': 0.7358712254729174, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.8075; Top5: 0.9843
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8075132978723404, 'ACC_ID': 0.7360372340425532, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.8097; Top5: 0.9844
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8096740273396424, 'ACC_ID': 0.7362776025236593, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.8081; Top5: 0.9843
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.808, 'ACC_ID': 0.7346, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar10OOD SVHN ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0.9689463800000001, 'FPR95': 0.175, 'ACC_ALL': 0.808, 'ACC_ID': 0.7346, 'ACC_OOD': 0.9532, 'ACC_HM': 0.8297437137101552}

Online evaluation: Top-1 accuracy: 80.8000; Top-5 accuracy: 98.4300




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='msp', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7881; Top5: 0.9753
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7880658436213992, 'ACC_ID': 0.6666666666666666, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.8054; Top5: 0.9759
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8054162487462387, 'ACC_ID': 0.6850551654964895, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.7975; Top5: 0.9773
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7975951903807615, 'ACC_ID': 0.6860387441549766, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.8048; Top5: 0.9815
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8048902195608783, 'ACC_ID': 0.6941117764471058, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.8111; Top5: 0.9836
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8111776447105788, 'ACC_ID': 0.7013972055888223, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.8124; Top5: 0.9841
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8124169986719787, 'ACC_ID': 0.702855245683931, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.8056; Top5: 0.9832
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8055792769712496, 'ACC_ID': 0.7022487902077996, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.8040; Top5: 0.9830
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8040877367896311, 'ACC_ID': 0.7031405782652044, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.8030; Top5: 0.9835
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8030269307812152, 'ACC_ID': 0.7050968172713109, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.8039; Top5: 0.9836
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8037682902385248, 'ACC_ID': 0.7039486871116456, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.8047; Top5: 0.9844
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8047498187092096, 'ACC_ID': 0.705221174764322, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.8052; Top5: 0.9841
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.805274506551667, 'ACC_ID': 0.7079117598275004, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.8051; Top5: 0.9845
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8050730207532667, 'ACC_ID': 0.7069946195234436, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.8045; Top5: 0.9845
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8045584045584045, 'ACC_ID': 0.7076923076923077, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.8033; Top5: 0.9838
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8033178500331785, 'ACC_ID': 0.7068347710683477, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.8031; Top5: 0.9833
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8031191515907673, 'ACC_ID': 0.7075483468496568, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.8034; Top5: 0.9830
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.803430854188697, 'ACC_ID': 0.7089648689930678, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.8050; Top5: 0.9833
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8049645390070922, 'ACC_ID': 0.7098847517730497, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.8063; Top5: 0.9835
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8063091482649842, 'ACC_ID': 0.7125131440588854, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.8043; Top5: 0.9827
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8042, 'ACC_ID': 0.7112, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar10OOD cifar100 ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0.83209361, 'FPR95': 0.7097, 'ACC_ALL': 0.8042, 'ACC_ID': 0.7112, 'ACC_OOD': 0.6913, 'ACC_HM': 0.7011088199643495}

Online evaluation: Top-1 accuracy: 80.4300; Top-5 accuracy: 98.2700




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.6707818930041153, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.8064; Top5: 0.9759
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8064192577733199, 'ACC_ID': 0.6990972918756269, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.8001; Top5: 0.9779
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8002672010688042, 'ACC_ID': 0.7120908483633934, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.8013; Top5: 0.9805
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8013972055888223, 'ACC_ID': 0.718562874251497, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.8055; Top5: 0.9820
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8059880239520958, 'ACC_ID': 0.7189620758483034, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.8070; Top5: 0.9824
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8074369189907038, 'ACC_ID': 0.7207835325365206, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.7999; Top5: 0.9815
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8001707941929974, 'ACC_ID': 0.717620267577569, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.8000; Top5: 0.9816
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8000997008973081, 'ACC_ID': 0.7183449651046859, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.8001; Top5: 0.9817
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8001335410638771, 'ACC_ID': 0.7191186289784108, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.7997; Top5: 0.9816
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7995590298657046, 'ACC_ID': 0.7199839647223892, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.8007; Top5: 0.9824
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.800761421319797, 'ACC_ID': 0.7240754169688179, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.8018; Top5: 0.9824
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8017913418477359, 'ACC_ID': 0.7259910432907614, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.8020; Top5: 0.9828
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8019984627209839, 'ACC_ID': 0.7243658724058417, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.8027; Top5: 0.9826
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8027065527065527, 'ACC_ID': 0.7246438746438747, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.8007; Top5: 0.9818
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8006635700066357, 'ACC_ID': 0.7232913072329131, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.8012; Top5: 0.9815
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8012476606363069, 'ACC_ID': 0.7240174672489083, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.8019; Top5: 0.9818
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8019034191046881, 'ACC_ID': 0.7242392198331571, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.8027; Top5: 0.9820
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8027482269503546, 'ACC_ID': 0.7250664893617021, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.8045; Top5: 0.9824
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8045215562565721, 'ACC_ID': 0.7264984227129337, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.8026; Top5: 0.9819
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8025, 'ACC_ID': 0.7251, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar10OOD cifar100 ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0.8678252200000001, 'FPR95': 0.5025, 'ACC_ALL': 0.8025, 'ACC_ID': 0.7251, 'ACC_OOD': 0.7227, 'ACC_HM': 0.7238980107749688}

Online evaluation: Top-1 accuracy: 80.2500; Top-5 accuracy: 98.1900




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='msp', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7881; Top5: 0.9753
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7880658436213992, 'ACC_ID': 0.6707818930041153, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.8034; Top5: 0.9759
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8034102306920762, 'ACC_ID': 0.6870611835506519, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.7961; Top5: 0.9773
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7962591850367402, 'ACC_ID': 0.6880427521710086, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.8018; Top5: 0.9815
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8018962075848304, 'ACC_ID': 0.6966067864271457, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.8087; Top5: 0.9836
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8087824351297406, 'ACC_ID': 0.7069860279441118, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.8107; Top5: 0.9844
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8107569721115537, 'ACC_ID': 0.7098273572377158, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.8044; Top5: 0.9841
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8044406490179334, 'ACC_ID': 0.7087959009393681, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.8033; Top5: 0.9835
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8033399800598205, 'ACC_ID': 0.7093718843469591, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.8032; Top5: 0.9840
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8034720676608057, 'ACC_ID': 0.7122190073447585, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.8033; Top5: 0.9844
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8035678492683904, 'ACC_ID': 0.7115654439767488, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.8058; Top5: 0.9857
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8060188542422045, 'ACC_ID': 0.7126540971718637, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.8072; Top5: 0.9852
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8074307513683862, 'ACC_ID': 0.7148780892353624, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.8071; Top5: 0.9854
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8072252113758647, 'ACC_ID': 0.7140661029976941, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.8060; Top5: 0.9853
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8061253561253561, 'ACC_ID': 0.7145299145299145, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.8048; Top5: 0.9847
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8049104180491041, 'ACC_ID': 0.7134704711347047, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.8022; Top5: 0.9839
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8023705552089831, 'ACC_ID': 0.7126637554585152, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.8026; Top5: 0.9832
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8027258841499236, 'ACC_ID': 0.7130771942192456, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.8033; Top5: 0.9830
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8034131205673759, 'ACC_ID': 0.7130984042553191, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.8049; Top5: 0.9833
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8050473186119874, 'ACC_ID': 0.714931650893796, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.8029; Top5: 0.9827
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.803, 'ACC_ID': 0.7136, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar10OOD Tiny ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0.8372720499999999, 'FPR95': 0.5957, 'ACC_ALL': 0.803, 'ACC_ID': 0.7136, 'ACC_OOD': 0.7264, 'ACC_HM': 0.7199431111111111}

Online evaluation: Top-1 accuracy: 80.2900; Top-5 accuracy: 98.2700




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7860; Top5: 0.9753
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7860082304526749, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.8044; Top5: 0.9749
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8044132397191575, 'ACC_ID': 0.7462387161484454, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.7975; Top5: 0.9766
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7969271877087508, 'ACC_ID': 0.7441549766199065, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.7953; Top5: 0.9800
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7949101796407185, 'ACC_ID': 0.7470059880239521, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.8003; Top5: 0.9820
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8, 'ACC_ID': 0.7508982035928143, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.8031; Top5: 0.9821
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8031208499335989, 'ACC_ID': 0.7546480743691899, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.7956; Top5: 0.9809
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7956162823797325, 'ACC_ID': 0.7477939083404498, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.7961; Top5: 0.9813
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7958624127617149, 'ACC_ID': 0.7467597208374875, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.7977; Top5: 0.9817
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7974627197863343, 'ACC_ID': 0.7507233474293346, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.7971; Top5: 0.9816
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7969532972539587, 'ACC_ID': 0.7512527560633393, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.8002; Top5: 0.9830
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8000362581580855, 'ACC_ID': 0.7541696881798404, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.8009; Top5: 0.9824
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8009620169182285, 'ACC_ID': 0.7545198208658153, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.8014; Top5: 0.9820
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8013835511145273, 'ACC_ID': 0.7544965411222136, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.8004; Top5: 0.9823
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8004273504273505, 'ACC_ID': 0.7514245014245015, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.7987; Top5: 0.9813
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7986728599867285, 'ACC_ID': 0.7495686794956868, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.7975; Top5: 0.9810
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7975046787273862, 'ACC_ID': 0.7479725514660013, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.7969; Top5: 0.9804
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7968511338268124, 'ACC_ID': 0.7457408060157443, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.7968; Top5: 0.9799
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7967641843971631, 'ACC_ID': 0.7433510638297872, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.7976; Top5: 0.9803
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7975814931650894, 'ACC_ID': 0.7434279705573081, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.7948; Top5: 0.9793
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7948, 'ACC_ID': 0.7402, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar10OOD Tiny ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0.86306637, 'FPR95': 0.4061, 'ACC_ALL': 0.7948, 'ACC_ID': 0.7402, 'ACC_OOD': 0.7051, 'ACC_HM': 0.7222237874489724}

Online evaluation: Top-1 accuracy: 79.4800; Top-5 accuracy: 97.9300




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='msp', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.5123; Top5: 0.7942
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.3683127572016461, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.4925; Top5: 0.7944
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4934804413239719, 'ACC_ID': 0.3370110330992979, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.4933; Top5: 0.7781
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49498997995991983, 'ACC_ID': 0.3486973947895792, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.5047; Top5: 0.7818
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5054890219560878, 'ACC_ID': 0.36327345309381237, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.5176; Top5: 0.7800
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.518562874251497, 'ACC_ID': 0.36966067864271457, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.5178; Top5: 0.7798
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5185922974767596, 'ACC_ID': 0.37217795484727756, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.5184; Top5: 0.7791
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5189296897238828, 'ACC_ID': 0.37460859664104756, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.5173; Top5: 0.7794
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5176969092721835, 'ACC_ID': 0.3771186440677966, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.5164; Top5: 0.7812
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5168039172045404, 'ACC_ID': 0.37658580013354104, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.5152; Top5: 0.7821
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5159350571256764, 'ACC_ID': 0.37843255161354983, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.5137; Top5: 0.7808
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5143219724437998, 'ACC_ID': 0.3798042059463379, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.5113; Top5: 0.7804
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5118593464919555, 'ACC_ID': 0.38115773760159233, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.5101; Top5: 0.7788
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5106840891621829, 'ACC_ID': 0.3813989239046887, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.5089; Top5: 0.7776
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5092592592592593, 'ACC_ID': 0.3811965811965812, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.5113; Top5: 0.7796
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5117451891174519, 'ACC_ID': 0.3831453218314532, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.5130; Top5: 0.7804
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5132875857766688, 'ACC_ID': 0.3852776044915783, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.5131; Top5: 0.7809
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5134531782399248, 'ACC_ID': 0.3864410762542592, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.5117; Top5: 0.7811
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5120789007092199, 'ACC_ID': 0.38563829787234044, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.5137; Top5: 0.7824
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5140904311251314, 'ACC_ID': 0.3882229232386961, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.5134; Top5: 0.7829
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5138, 'ACC_ID': 0.388, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar100OOD MNIST ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0.691416095, 'FPR95': 0.9335, 'ACC_ALL': 0.5138, 'ACC_ID': 0.388, 'ACC_OOD': 0.7804, 'ACC_HM': 0.5183074289626839}

Online evaluation: Top-1 accuracy: 51.3400; Top-5 accuracy: 78.2900




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.5123; Top5: 0.7922
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.3724279835390947, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.4935; Top5: 0.7934
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4944834503510532, 'ACC_ID': 0.36810431293881646, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.4947; Top5: 0.7787
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4956579826319305, 'ACC_ID': 0.38209752839011357, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.5062; Top5: 0.7833
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5064870259481038, 'ACC_ID': 0.3967065868263473, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.5172; Top5: 0.7815
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5177644710578843, 'ACC_ID': 0.4035928143712575, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.5174; Top5: 0.7808
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5179282868525896, 'ACC_ID': 0.4050464807436919, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.5184; Top5: 0.7794
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5189296897238828, 'ACC_ID': 0.40933674921719326, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.5173; Top5: 0.7796
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5176969092721835, 'ACC_ID': 0.4137587238285145, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.5179; Top5: 0.7819
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.518361896283107, 'ACC_ID': 0.41486757177832184, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.5178; Top5: 0.7839
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5183403487672881, 'ACC_ID': 0.4181198637001403, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.5171; Top5: 0.7830
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5175852066715011, 'ACC_ID': 0.41986947063089197, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.5158; Top5: 0.7810
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5160059711394924, 'ACC_ID': 0.4194725493448333, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.5142; Top5: 0.7796
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5145272867025366, 'ACC_ID': 0.4198308993082244, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.5129; Top5: 0.7782
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5131054131054131, 'ACC_ID': 0.4202279202279202, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.5143; Top5: 0.7800
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5145321831453218, 'ACC_ID': 0.4229595222295952, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.5160; Top5: 0.7803
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5161572052401747, 'ACC_ID': 0.4264504054897068, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.5156; Top5: 0.7813
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5158030783691693, 'ACC_ID': 0.426506873457878, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.5134; Top5: 0.7817
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5135195035460993, 'ACC_ID': 0.42542109929078015, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.5157; Top5: 0.7831
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5156677181913775, 'ACC_ID': 0.42818086225026286, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.5150; Top5: 0.7836
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.515, 'ACC_ID': 0.4281, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar100OOD MNIST ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0.9219300699999999, 'FPR95': 0.454, 'ACC_ALL': 0.515, 'ACC_ID': 0.4281, 'ACC_OOD': 0.9572, 'ACC_HM': 0.5916080560167473}

Online evaluation: Top-1 accuracy: 51.5000; Top-5 accuracy: 78.3600




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='msp', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.5144; Top5: 0.7942
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5164609053497943, 'ACC_ID': 0.3786008230452675, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.4955; Top5: 0.7934
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49648946840521563, 'ACC_ID': 0.3460381143430291, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.4973; Top5: 0.7787
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4983299933199733, 'ACC_ID': 0.3587174348697395, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.5087; Top5: 0.7833
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5094810379241517, 'ACC_ID': 0.37325349301397204, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.5196; Top5: 0.7815
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5205588822355289, 'ACC_ID': 0.38243512974051896, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.5208; Top5: 0.7821
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5215803452855245, 'ACC_ID': 0.38645418326693226, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.5221; Top5: 0.7808
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5226302305721605, 'ACC_ID': 0.38941076003415886, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.5211; Top5: 0.7811
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5211864406779662, 'ACC_ID': 0.392073778664008, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.5201; Top5: 0.7826
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5203650122412642, 'ACC_ID': 0.39083018028043626, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.5198; Top5: 0.7831
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5201443174984967, 'ACC_ID': 0.3928643014632191, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.5175; Top5: 0.7819
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5177664974619289, 'ACC_ID': 0.39430746918056564, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.5153; Top5: 0.7812
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5153425111958866, 'ACC_ID': 0.3952562614032178, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.5141; Top5: 0.7799
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5142198308993082, 'ACC_ID': 0.3953881629515757, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.5120; Top5: 0.7789
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5121082621082621, 'ACC_ID': 0.3957264957264957, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.5143; Top5: 0.7806
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5143994691439947, 'ACC_ID': 0.39721300597213005, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.5158; Top5: 0.7816
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5159076731129133, 'ACC_ID': 0.39887710542732374, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.5150; Top5: 0.7825
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150981083303959, 'ACC_ID': 0.3998355069909529, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.5125; Top5: 0.7826
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5127437943262412, 'ACC_ID': 0.3991578014184397, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.5148; Top5: 0.7837
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150368033648791, 'ACC_ID': 0.4017875920084122, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.5148; Top5: 0.7852
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5151, 'ACC_ID': 0.4028, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar100OOD SVHN ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0.8402762699999999, 'FPR95': 0.6827, 'ACC_ALL': 0.5151, 'ACC_ID': 0.4028, 'ACC_OOD': 0.9231, 'ACC_HM': 0.5608638358850592}

Online evaluation: Top-1 accuracy: 51.4800; Top-5 accuracy: 78.5200




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.5144; Top5: 0.7942
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5164609053497943, 'ACC_ID': 0.4012345679012346, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.4965; Top5: 0.7954
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49648946840521563, 'ACC_ID': 0.3801404212637914, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.4980; Top5: 0.7787
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49899799599198397, 'ACC_ID': 0.3914495657982632, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.5092; Top5: 0.7848
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5094810379241517, 'ACC_ID': 0.4041916167664671, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.5208; Top5: 0.7831
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5213572854291417, 'ACC_ID': 0.4103792415169661, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.5211; Top5: 0.7828
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5212483399734396, 'ACC_ID': 0.4103585657370518, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.5215; Top5: 0.7814
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5214916026188443, 'ACC_ID': 0.4107600341588386, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.5203; Top5: 0.7814
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5201894317048853, 'ACC_ID': 0.4102691924227318, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.5199; Top5: 0.7837
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5199198753616737, 'ACC_ID': 0.4061874026263076, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.5198; Top5: 0.7855
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5199438765283624, 'ACC_ID': 0.4046903187011425, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.5186; Top5: 0.7844
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5186729514140682, 'ACC_ID': 0.4059100797679478, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.5158; Top5: 0.7835
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5156742411676895, 'ACC_ID': 0.40537402554320784, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.5148; Top5: 0.7816
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5148347425057648, 'ACC_ID': 0.40476556495003846, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.5137; Top5: 0.7797
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5136752136752136, 'ACC_ID': 0.4045584045584046, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.5156; Top5: 0.7816
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5154611811546118, 'ACC_ID': 0.4037159920371599, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.5176; Top5: 0.7824
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5174048658764816, 'ACC_ID': 0.40736119775421087, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.5164; Top5: 0.7832
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5163905534014804, 'ACC_ID': 0.40606274233345085, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.5146; Top5: 0.7836
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5145168439716312, 'ACC_ID': 0.4048093971631206, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.5169; Top5: 0.7848
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5167192429022082, 'ACC_ID': 0.40515247108307045, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.5167; Top5: 0.7856
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5166, 'ACC_ID': 0.4049, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar100OOD SVHN ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0.91320391, 'FPR95': 0.5716, 'ACC_ALL': 0.5166, 'ACC_ID': 0.4049, 'ACC_OOD': 0.9702, 'ACC_HM': 0.5713533270307614}

Online evaluation: Top-1 accuracy: 51.6700; Top-5 accuracy: 78.5600




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='msp', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.5123; Top5: 0.7942
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.36419753086419754, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.4925; Top5: 0.7964
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4934804413239719, 'ACC_ID': 0.3350050150451354, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.4947; Top5: 0.7807
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49632598530394123, 'ACC_ID': 0.3466933867735471, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.5057; Top5: 0.7833
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5069860279441117, 'ACC_ID': 0.36177644710578843, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.5168; Top5: 0.7812
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5177644710578843, 'ACC_ID': 0.3664670658682635, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.5164; Top5: 0.7828
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5169322709163346, 'ACC_ID': 0.36885790172642763, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.5181; Top5: 0.7808
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5183603757472246, 'ACC_ID': 0.37233134073441504, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.5168; Top5: 0.7804
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5169491525423728, 'ACC_ID': 0.372382851445663, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.5152; Top5: 0.7819
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5154685065657689, 'ACC_ID': 0.37057645225906966, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.5164; Top5: 0.7833
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5167368210062137, 'ACC_ID': 0.37261976347965525, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.5151; Top5: 0.7824
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.515409717186367, 'ACC_ID': 0.37472806381435825, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.5129; Top5: 0.7819
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5128545364073644, 'ACC_ID': 0.3751865981091392, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.5121; Top5: 0.7800
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5120676402767103, 'ACC_ID': 0.37432744043043814, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.5108; Top5: 0.7790
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5106837606837606, 'ACC_ID': 0.3745014245014245, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.5132; Top5: 0.7814
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5132050431320504, 'ACC_ID': 0.37584605175846053, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.5148; Top5: 0.7828
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5147847785402371, 'ACC_ID': 0.37766687461010606, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.5142; Top5: 0.7838
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5141581482786981, 'ACC_ID': 0.37880390083421456, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.5120; Top5: 0.7837
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.511968085106383, 'ACC_ID': 0.3778812056737589, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.5148; Top5: 0.7851
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5147213459516299, 'ACC_ID': 0.3804416403785489, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.5147; Top5: 0.7859
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5146, 'ACC_ID': 0.3806, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar100OOD cifar10 ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0.62610874, 'FPR95': 0.9365, 'ACC_ALL': 0.5146, 'ACC_ID': 0.3806, 'ACC_OOD': 0.6896, 'ACC_HM': 0.4904910484021678}

Online evaluation: Top-1 accuracy: 51.4700; Top-5 accuracy: 78.5900




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.5123; Top5: 0.7922
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.3395061728395062, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.4945; Top5: 0.7944
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4944834503510532, 'ACC_ID': 0.31795386158475425, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.4973; Top5: 0.7794
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49766199064796257, 'ACC_ID': 0.32665330661322645, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.5062; Top5: 0.7838
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5059880239520959, 'ACC_ID': 0.3498003992015968, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.5176; Top5: 0.7812
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5177644710578843, 'ACC_ID': 0.3652694610778443, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.5188; Top5: 0.7808
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5192563081009296, 'ACC_ID': 0.3738379814077025, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.5192; Top5: 0.7791
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5194990037005408, 'ACC_ID': 0.37631653857102193, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.5181; Top5: 0.7796
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5181954137587238, 'ACC_ID': 0.37537387836490527, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.5179; Top5: 0.7814
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.518361896283107, 'ACC_ID': 0.37191186289784106, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.5176; Top5: 0.7829
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5181399077971537, 'ACC_ID': 0.3728202044497895, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.5166; Top5: 0.7815
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170413343002176, 'ACC_ID': 0.3736403190717911, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.5143; Top5: 0.7809
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5145131862663792, 'ACC_ID': 0.37236689334881407, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.5130; Top5: 0.7796
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5132974634896234, 'ACC_ID': 0.3732513451191391, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.5110; Top5: 0.7786
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5112535612535613, 'ACC_ID': 0.3730769230769231, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.5132; Top5: 0.7800
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5134704711347047, 'ACC_ID': 0.3757133377571334, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.5142; Top5: 0.7806
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5145352464129757, 'ACC_ID': 0.3777916406737367, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.5137; Top5: 0.7818
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5140406532722359, 'ACC_ID': 0.3782164258019034, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.5119; Top5: 0.7815
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123005319148937, 'ACC_ID': 0.37666223404255317, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.5142; Top5: 0.7834
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5146161934805468, 'ACC_ID': 0.37823343848580443, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.5130; Top5: 0.7841
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5134, 'ACC_ID': 0.3787, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar100OOD cifar10 ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0.69306238, 'FPR95': 0.8381, 'ACC_ALL': 0.5134, 'ACC_ID': 0.3787, 'ACC_OOD': 0.6754, 'ACC_HM': 0.48529357745944407}

Online evaluation: Top-1 accuracy: 51.3000; Top-5 accuracy: 78.4100




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='msp', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.5123; Top5: 0.7901
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.35802469135802467, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.4915; Top5: 0.7914
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49247743229689067, 'ACC_ID': 0.3299899699097292, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.4953; Top5: 0.7747
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49632598530394123, 'ACC_ID': 0.3413493653974616, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.5082; Top5: 0.7788
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5084830339321357, 'ACC_ID': 0.35728542914171657, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.5172; Top5: 0.7760
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5181636726546907, 'ACC_ID': 0.36207584830339323, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.5161; Top5: 0.7772
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5169322709163346, 'ACC_ID': 0.3642098273572377, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.5184; Top5: 0.7765
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5192143467122118, 'ACC_ID': 0.36521491602618844, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.5171; Top5: 0.7761
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5174476570289133, 'ACC_ID': 0.36615154536390826, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.5150; Top5: 0.7779
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5154685065657689, 'ACC_ID': 0.36323169374582687, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.5150; Top5: 0.7791
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5155341751854079, 'ACC_ID': 0.3644016837041491, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.5131; Top5: 0.7775
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5135968092820885, 'ACC_ID': 0.36620739666424945, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.5116; Top5: 0.7764
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5116934815060541, 'ACC_ID': 0.3673909437717698, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.5104; Top5: 0.7746
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5103766333589547, 'ACC_ID': 0.3671022290545734, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.5089; Top5: 0.7738
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5088319088319089, 'ACC_ID': 0.36695156695156694, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.5106; Top5: 0.7760
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5106834771068348, 'ACC_ID': 0.3690776376907764, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.5111; Top5: 0.7781
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.511166562694947, 'ACC_ID': 0.37080474111041795, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.5104; Top5: 0.7788
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5105158030783692, 'ACC_ID': 0.37234167547879216, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.5089; Top5: 0.7783
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5089760638297872, 'ACC_ID': 0.3717863475177305, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.5114; Top5: 0.7795
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5114616193480547, 'ACC_ID': 0.3747634069400631, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.5110; Top5: 0.7802
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5111, 'ACC_ID': 0.3748, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar100OOD Tiny ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0.59838273, 'FPR95': 0.9576, 'ACC_ALL': 0.5111, 'ACC_ID': 0.3748, 'ACC_OOD': 0.6674, 'ACC_HM': 0.4800259451161006}

Online evaluation: Top-1 accuracy: 51.1000; Top-5 accuracy: 78.0200




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.5144; Top5: 0.7901
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.3786008230452675, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.4945; Top5: 0.7924
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4944834503510532, 'ACC_ID': 0.34904714142427284, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.4987; Top5: 0.7761
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49899799599198397, 'ACC_ID': 0.3520374081496326, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.5102; Top5: 0.7803
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5099800399201597, 'ACC_ID': 0.35479041916167664, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.5216; Top5: 0.7784
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5217564870259481, 'ACC_ID': 0.3624750499001996, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.5214; Top5: 0.7785
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5212483399734396, 'ACC_ID': 0.36752988047808766, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.5218; Top5: 0.7774
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5214916026188443, 'ACC_ID': 0.3694847708511244, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.5196; Top5: 0.7776
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5191924227318045, 'ACC_ID': 0.3693918245264207, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.5188; Top5: 0.7790
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5185844647229023, 'ACC_ID': 0.3683507678611173, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.5178; Top5: 0.7795
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5177390258568851, 'ACC_ID': 0.3694127079575065, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.5180; Top5: 0.7770
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5179477882523568, 'ACC_ID': 0.37164612037708483, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.5156; Top5: 0.7765
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5153425111958866, 'ACC_ID': 0.3707082434897993, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.5142; Top5: 0.7752
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5140661029976941, 'ACC_ID': 0.37109915449654113, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.5129; Top5: 0.7742
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5126780626780627, 'ACC_ID': 0.3715099715099715, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.5155; Top5: 0.7766
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5153284671532846, 'ACC_ID': 0.3735899137358991, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.5173; Top5: 0.7778
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5171553337492202, 'ACC_ID': 0.37616968184653776, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.5171; Top5: 0.7791
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5169780284337916, 'ACC_ID': 0.3763365056985078, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.5151; Top5: 0.7791
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5149601063829787, 'ACC_ID': 0.3754432624113475, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.5171; Top5: 0.7807
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170347003154574, 'ACC_ID': 0.37655099894847527, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.5162; Top5: 0.7815
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5161, 'ACC_ID': 0.3757, 'ACC_OOD': 0, 'ACC_HM': 0}



cifar100OOD Tiny ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0.68121437, 'FPR95': 0.8318, 'ACC_ALL': 0.5161, 'ACC_ID': 0.3757, 'ACC_OOD': 0.6663, 'ACC_HM': 0.48047775431861794}

Online evaluation: Top-1 accuracy: 51.6200; Top-5 accuracy: 78.1500




len 30000
dict_values(['goldfish', 'great white shark', 'hammerhead shark', 'stingray', 'hen', 'ostrich', 'goldfinch', 'junco', 'bald eagle', 'vulture', 'smooth newt', 'axolotl', 'tree frog', 'green iguana', 'chameleon', 'Indian cobra', 'scorpion', 'tarantula', 'centipede', 'peafowl', 'lorikeet', 'hummingbird', 'toucan', 'duck', 'goose', 'black swan', 'koala', 'jellyfish', 'snail', 'American lobster', 'hermit crab', 'flamingo', 'great egret', 'pelican', 'king penguin', 'grey whale', 'killer whale', 'sea lion', 'Chihuahua', 'Shih Tzu', 'Afghan Hound', 'Basset Hound', 'Beagle', 'Bloodhound', 'Italian Greyhound', 'Whippet', 'Weimaraner', 'Yorkshire Terrier', 'Boston Terrier', 'Scottish Terrier', 'West Highland White Terrier', 'Golden Retriever', 'Labrador Retriever', 'Cocker Spaniel', 'collie', 'Border Collie', 'Rottweiler', 'German Shepherd Dog', 'Boxer', 'French Bulldog', 'St. Bernard', 'Siberian Husky', 'Dalmatian', 'pug', 'Pomeranian', 'Chow Chow', 'Pembroke Welsh Corgi', 'Toy Poodle', 'Standard Poodle', 'grey wolf', 'hyena', 'red fox', 'tabby cat', 'leopard', 'snow leopard', 'lion', 'tiger', 'cheetah', 'polar bear', 'meerkat', 'ladybug', 'fly', 'bee', 'ant', 'grasshopper', 'cockroach', 'praying mantis', 'dragonfly', 'monarch butterfly', 'starfish', 'cottontail rabbit', 'porcupine', 'fox squirrel', 'beaver', 'guinea pig', 'zebra', 'pig', 'hippopotamus', 'bison', 'gazelle', 'llama', 'skunk', 'badger', 'orangutan', 'gorilla', 'chimpanzee', 'gibbon', 'baboon', 'giant panda', 'eel', 'clownfish', 'pufferfish', 'accordion', 'ambulance', 'assault rifle', 'backpack', 'barn', 'wheelbarrow', 'basketball', 'bathtub', 'lighthouse', 'beer glass', 'binoculars', 'birdhouse', 'bow tie', 'broom', 'bucket', 'cauldron', 'candle', 'cannon', 'canoe', 'carousel', 'castle', 'mobile phone', 'cowboy hat', 'electric guitar', 'fire truck', 'flute', 'gas mask or respirator', 'grand piano', 'guillotine', 'hammer', 'harmonica', 'harp', 'hatchet', 'jeep', 'joystick', 'lab coat', 'lawn mower', 'lipstick', 'mailbox', 'missile', 'mitten', 'parachute', 'pickup truck', 'pirate ship', 'revolver', 'rugby ball', 'sandal', 'saxophone', 'school bus', 'schooner', 'shield', 'soccer ball', 'space shuttle', 'spider web', 'steam locomotive', 'scarf', 'submarine', 'tank', 'tennis ball', 'tractor', 'trombone', 'vase', 'violin', 'military aircraft', 'wine bottle', 'ice cream', 'bagel', 'pretzel', 'cheeseburger', 'hot dog', 'cabbage', 'broccoli', 'cucumber', 'bell pepper', 'mushroom', 'Granny Smith apple', 'strawberry', 'lemon', 'pineapple', 'banana', 'pomegranate', 'pizza', 'burrito', 'espresso', 'volcano', 'baseball player', 'scuba diver', 'acorn'])
len 30000
30000 10000 40000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7766; Top5: 0.9442
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.77431906614786, 'ACC_ID': 0.6848249027237354, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.7697; Top5: 0.9357
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7691803278688525, 'ACC_ID': 0.6721311475409836, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.7693; Top5: 0.9330
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7684901531728665, 'ACC_ID': 0.674398249452954, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.7674; Top5: 0.9324
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7671503957783641, 'ACC_ID': 0.6804089709762533, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.7694; Top5: 0.9337
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7689042186256302, 'ACC_ID': 0.6842663836561422, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.7689; Top5: 0.9314
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7685164713685607, 'ACC_ID': 0.6842803449038249, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.7703; Top5: 0.9294
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7700151057401813, 'ACC_ID': 0.6873111782477341, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.7736; Top5: 0.9309
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7732606180796563, 'ACC_ID': 0.6899686002313667, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.7715; Top5: 0.9273
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7712562518387761, 'ACC_ID': 0.6871138570167696, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.7703; Top5: 0.9266
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7700937046324403, 'ACC_ID': 0.6872112973472351, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.7711; Top5: 0.9266
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7709182450251738, 'ACC_ID': 0.6877247662431072, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.7729; Top5: 0.9282
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7726872246696035, 'ACC_ID': 0.6893171806167401, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.7729; Top5: 0.9270
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.772736541598695, 'ACC_ID': 0.6900489396411092, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.7735; Top5: 0.9276
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.773209549071618, 'ACC_ID': 0.6894657067070861, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.7731; Top5: 0.9265
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7729404477479869, 'ACC_ID': 0.688523139545173, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.7742; Top5: 0.9266
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7739845502118116, 'ACC_ID': 0.6898413489492483, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.7740; Top5: 0.9272
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7737591983716925, 'ACC_ID': 0.6894473148583059, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.7747; Top5: 0.9280
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7744082840236687, 'ACC_ID': 0.690680473372781, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.7740; Top5: 0.9275
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7737052351250964, 'ACC_ID': 0.6901674959702853, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.7736; Top5: 0.9272
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7733173557020172, 'ACC_ID': 0.6884361893349311, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 20999: Top1: 0.7726; Top5: 0.9269
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7723117938301384, 'ACC_ID': 0.6875079344928272, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 21999: Top1: 0.7713; Top5: 0.9266
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7711478988539203, 'ACC_ID': 0.6867382208477352, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 22999: Top1: 0.7705; Top5: 0.9262
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7703549060542797, 'ACC_ID': 0.68580375782881, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 23999: Top1: 0.7715; Top5: 0.9263
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7713507806856699, 'ACC_ID': 0.6863366116574985, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 24999: Top1: 0.7720; Top5: 0.9258
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7717913154806358, 'ACC_ID': 0.6865464632454924, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 25999: Top1: 0.7724; Top5: 0.9260
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7722523814401311, 'ACC_ID': 0.6871863156816552, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 26999: Top1: 0.7719; Top5: 0.9258
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7717117916851606, 'ACC_ID': 0.6866893524683139, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 27999: Top1: 0.7716; Top5: 0.9260
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7713823613357436, 'ACC_ID': 0.6863286081248217, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 28999: Top1: 0.7718; Top5: 0.9264
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7716502892827625, 'ACC_ID': 0.6863807512168243, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 29999: Top1: 0.7714; Top5: 0.9264
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7712191872085277, 'ACC_ID': 0.6862536087053076, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 30999: Top1: 0.7707; Top5: 0.9258
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.770566491876558, 'ACC_ID': 0.6859795409610591, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 31999: Top1: 0.7712; Top5: 0.9262
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7710060404082483, 'ACC_ID': 0.6866486148719017, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 32999: Top1: 0.7712; Top5: 0.9263
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7710420032310178, 'ACC_ID': 0.6869143780290792, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 33999: Top1: 0.7710; Top5: 0.9265
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7708660181989332, 'ACC_ID': 0.6872450580483213, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 34999: Top1: 0.7706; Top5: 0.9262
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7704986676817662, 'ACC_ID': 0.6871336124857251, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 35999: Top1: 0.7706; Top5: 0.9262
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7704887704887705, 'ACC_ID': 0.6872756872756873, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 36999: Top1: 0.7704; Top5: 0.9261
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7702775677718976, 'ACC_ID': 0.6875832523310653, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 37999: Top1: 0.7711; Top5: 0.9262
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7709385521885522, 'ACC_ID': 0.6884118967452301, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 38999: Top1: 0.7706; Top5: 0.9258
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7705248760471876, 'ACC_ID': 0.6879466575482989, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 39999: Top1: 0.7702; Top5: 0.9254
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7701333333333333, 'ACC_ID': 0.6877333333333333, 'ACC_OOD': 0, 'ACC_HM': 0}



ImagenetROOD MNIST ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0.9466589516666666, 'FPR95': 0.3664, 'ACC_ALL': 0.7701333333333333, 'ACC_ID': 0.6877333333333333, 'ACC_OOD': 0.9733, 'ACC_HM': 0.8059691998956473}

Online evaluation: Top-1 accuracy: 77.0233; Top-5 accuracy: 92.5433




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='ImagenetROOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


len 30000
dict_values(['goldfish', 'great white shark', 'hammerhead shark', 'stingray', 'hen', 'ostrich', 'goldfinch', 'junco', 'bald eagle', 'vulture', 'smooth newt', 'axolotl', 'tree frog', 'green iguana', 'chameleon', 'Indian cobra', 'scorpion', 'tarantula', 'centipede', 'peafowl', 'lorikeet', 'hummingbird', 'toucan', 'duck', 'goose', 'black swan', 'koala', 'jellyfish', 'snail', 'American lobster', 'hermit crab', 'flamingo', 'great egret', 'pelican', 'king penguin', 'grey whale', 'killer whale', 'sea lion', 'Chihuahua', 'Shih Tzu', 'Afghan Hound', 'Basset Hound', 'Beagle', 'Bloodhound', 'Italian Greyhound', 'Whippet', 'Weimaraner', 'Yorkshire Terrier', 'Boston Terrier', 'Scottish Terrier', 'West Highland White Terrier', 'Golden Retriever', 'Labrador Retriever', 'Cocker Spaniel', 'collie', 'Border Collie', 'Rottweiler', 'German Shepherd Dog', 'Boxer', 'French Bulldog', 'St. Bernard', 'Siberian Husky', 'Dalmatian', 'pug', 'Pomeranian', 'Chow Chow', 'Pembroke Welsh Corgi', 'Toy Poodle', 'Standard Poodle', 'grey wolf', 'hyena', 'red fox', 'tabby cat', 'leopard', 'snow leopard', 'lion', 'tiger', 'cheetah', 'polar bear', 'meerkat', 'ladybug', 'fly', 'bee', 'ant', 'grasshopper', 'cockroach', 'praying mantis', 'dragonfly', 'monarch butterfly', 'starfish', 'cottontail rabbit', 'porcupine', 'fox squirrel', 'beaver', 'guinea pig', 'zebra', 'pig', 'hippopotamus', 'bison', 'gazelle', 'llama', 'skunk', 'badger', 'orangutan', 'gorilla', 'chimpanzee', 'gibbon', 'baboon', 'giant panda', 'eel', 'clownfish', 'pufferfish', 'accordion', 'ambulance', 'assault rifle', 'backpack', 'barn', 'wheelbarrow', 'basketball', 'bathtub', 'lighthouse', 'beer glass', 'binoculars', 'birdhouse', 'bow tie', 'broom', 'bucket', 'cauldron', 'candle', 'cannon', 'canoe', 'carousel', 'castle', 'mobile phone', 'cowboy hat', 'electric guitar', 'fire truck', 'flute', 'gas mask or respirator', 'grand piano', 'guillotine', 'hammer', 'harmonica', 'harp', 'hatchet', 'jeep', 'joystick', 'lab coat', 'lawn mower', 'lipstick', 'mailbox', 'missile', 'mitten', 'parachute', 'pickup truck', 'pirate ship', 'revolver', 'rugby ball', 'sandal', 'saxophone', 'school bus', 'schooner', 'shield', 'soccer ball', 'space shuttle', 'spider web', 'steam locomotive', 'scarf', 'submarine', 'tank', 'tennis ball', 'tractor', 'trombone', 'vase', 'violin', 'military aircraft', 'wine bottle', 'ice cream', 'bagel', 'pretzel', 'cheeseburger', 'hot dog', 'cabbage', 'broccoli', 'cucumber', 'bell pepper', 'mushroom', 'Granny Smith apple', 'strawberry', 'lemon', 'pineapple', 'banana', 'pomegranate', 'pizza', 'burrito', 'espresso', 'volcano', 'baseball player', 'scuba diver', 'acorn'])
len 30000
30000 10000 40000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7766; Top5: 0.9429
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.77431906614786, 'ACC_ID': 0.5706874189364461, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.7697; Top5: 0.9357
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7698360655737705, 'ACC_ID': 0.5626229508196722, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.7688; Top5: 0.9330
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7684901531728665, 'ACC_ID': 0.5689277899343544, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.7671; Top5: 0.9324
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7671503957783641, 'ACC_ID': 0.5718997361477572, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.7692; Top5: 0.9339
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7691695409923056, 'ACC_ID': 0.5741576014858053, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.7691; Top5: 0.9319
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7691797479548972, 'ACC_ID': 0.5741764315719655, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.7702; Top5: 0.9299
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7702039274924471, 'ACC_ID': 0.577416918429003, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.7737; Top5: 0.9311
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7737564039001817, 'ACC_ID': 0.5698231697240126, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.7712; Top5: 0.9276
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7712562518387761, 'ACC_ID': 0.5620770814945573, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.7705; Top5: 0.9274
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7704896396990893, 'ACC_ID': 0.5560248119308433, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.7707; Top5: 0.9273
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7706784943658596, 'ACC_ID': 0.5469911292256053, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.7729; Top5: 0.9287
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7729074889867842, 'ACC_ID': 0.5447136563876652, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.7731; Top5: 0.9280
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7731443719412724, 'ACC_ID': 0.5444535073409462, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.7737; Top5: 0.9287
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7735884804850323, 'ACC_ID': 0.5398825312618416, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.7737; Top5: 0.9278
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7737368374480135, 'ACC_ID': 0.5349969029289443, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.7747; Top5: 0.9280
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7747321206080239, 'ACC_ID': 0.5324362488578785, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.7745; Top5: 0.9288
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7745420385157351, 'ACC_ID': 0.529356505401597, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.7756; Top5: 0.9294
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7755917159763314, 'ACC_ID': 0.5287721893491124, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.7750; Top5: 0.9293
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7749667110519307, 'ACC_ID': 0.5258952974980727, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.7743; Top5: 0.9290
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7742493841954597, 'ACC_ID': 0.5232008521403368, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 20999: Top1: 0.7731; Top5: 0.9286
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7732004570267869, 'ACC_ID': 0.5203757775802971, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 21999: Top1: 0.7720; Top5: 0.9283
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7720574859014008, 'ACC_ID': 0.5177369474258686, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 22999: Top1: 0.7714; Top5: 0.9278
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7713987473903967, 'ACC_ID': 0.5157156112270935, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 23999: Top1: 0.7722; Top5: 0.9279
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7722398177474024, 'ACC_ID': 0.5146413291104073, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 24999: Top1: 0.7726; Top5: 0.9275
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7725914861837192, 'ACC_ID': 0.5135495572388776, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 25999: Top1: 0.7729; Top5: 0.9276
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.772918160401516, 'ACC_ID': 0.512701014032572, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 26999: Top1: 0.7723; Top5: 0.9274
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7723035952063915, 'ACC_ID': 0.5121566306652858, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 27999: Top1: 0.7720; Top5: 0.9276
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7719531918942061, 'ACC_ID': 0.5109884882504043, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 28999: Top1: 0.7721; Top5: 0.9280
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.772017632473138, 'ACC_ID': 0.5106070346220957, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 29999: Top1: 0.7717; Top5: 0.9280
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7716189207195203, 'ACC_ID': 0.5100599600266489, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 30999: Top1: 0.7710; Top5: 0.9274
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7710392847932606, 'ACC_ID': 0.5098856700765065, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 31999: Top1: 0.7713; Top5: 0.9277
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7712559883357634, 'ACC_ID': 0.5082691106019579, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 32999: Top1: 0.7712; Top5: 0.9277
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7712035541195477, 'ACC_ID': 0.5083602584814216, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 33999: Top1: 0.7711; Top5: 0.9278
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7709836837150925, 'ACC_ID': 0.5075305930342014, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 34999: Top1: 0.7706; Top5: 0.9275
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7706128663875143, 'ACC_ID': 0.5068138561096308, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 35999: Top1: 0.7708; Top5: 0.9273
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7707847707847708, 'ACC_ID': 0.5066415066415066, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 36999: Top1: 0.7707; Top5: 0.9271
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7707095798682363, 'ACC_ID': 0.5062101738848688, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 37999: Top1: 0.7714; Top5: 0.9273
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7714295735129069, 'ACC_ID': 0.5064884960718294, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 38999: Top1: 0.7710; Top5: 0.9269
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7710377842366216, 'ACC_ID': 0.5051461788339887, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 39999: Top1: 0.7707; Top5: 0.9266
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7706666666666667, 'ACC_ID': 0.5046666666666667, 'ACC_OOD': 0, 'ACC_HM': 0}



ImagenetROOD MNIST ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0.81817849, 'FPR95': 0.9793, 'ACC_ALL': 0.7706666666666667, 'ACC_ID': 0.5046666666666667, 'ACC_OOD': 0.972, 'ACC_HM': 0.6643828442437925}

Online evaluation: Top-1 accuracy: 77.0667; Top-5 accuracy: 92.6567




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='ImagenetROOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='msp', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


len 30000
dict_values(['goldfish', 'great white shark', 'hammerhead shark', 'stingray', 'hen', 'ostrich', 'goldfinch', 'junco', 'bald eagle', 'vulture', 'smooth newt', 'axolotl', 'tree frog', 'green iguana', 'chameleon', 'Indian cobra', 'scorpion', 'tarantula', 'centipede', 'peafowl', 'lorikeet', 'hummingbird', 'toucan', 'duck', 'goose', 'black swan', 'koala', 'jellyfish', 'snail', 'American lobster', 'hermit crab', 'flamingo', 'great egret', 'pelican', 'king penguin', 'grey whale', 'killer whale', 'sea lion', 'Chihuahua', 'Shih Tzu', 'Afghan Hound', 'Basset Hound', 'Beagle', 'Bloodhound', 'Italian Greyhound', 'Whippet', 'Weimaraner', 'Yorkshire Terrier', 'Boston Terrier', 'Scottish Terrier', 'West Highland White Terrier', 'Golden Retriever', 'Labrador Retriever', 'Cocker Spaniel', 'collie', 'Border Collie', 'Rottweiler', 'German Shepherd Dog', 'Boxer', 'French Bulldog', 'St. Bernard', 'Siberian Husky', 'Dalmatian', 'pug', 'Pomeranian', 'Chow Chow', 'Pembroke Welsh Corgi', 'Toy Poodle', 'Standard Poodle', 'grey wolf', 'hyena', 'red fox', 'tabby cat', 'leopard', 'snow leopard', 'lion', 'tiger', 'cheetah', 'polar bear', 'meerkat', 'ladybug', 'fly', 'bee', 'ant', 'grasshopper', 'cockroach', 'praying mantis', 'dragonfly', 'monarch butterfly', 'starfish', 'cottontail rabbit', 'porcupine', 'fox squirrel', 'beaver', 'guinea pig', 'zebra', 'pig', 'hippopotamus', 'bison', 'gazelle', 'llama', 'skunk', 'badger', 'orangutan', 'gorilla', 'chimpanzee', 'gibbon', 'baboon', 'giant panda', 'eel', 'clownfish', 'pufferfish', 'accordion', 'ambulance', 'assault rifle', 'backpack', 'barn', 'wheelbarrow', 'basketball', 'bathtub', 'lighthouse', 'beer glass', 'binoculars', 'birdhouse', 'bow tie', 'broom', 'bucket', 'cauldron', 'candle', 'cannon', 'canoe', 'carousel', 'castle', 'mobile phone', 'cowboy hat', 'electric guitar', 'fire truck', 'flute', 'gas mask or respirator', 'grand piano', 'guillotine', 'hammer', 'harmonica', 'harp', 'hatchet', 'jeep', 'joystick', 'lab coat', 'lawn mower', 'lipstick', 'mailbox', 'missile', 'mitten', 'parachute', 'pickup truck', 'pirate ship', 'revolver', 'rugby ball', 'sandal', 'saxophone', 'school bus', 'schooner', 'shield', 'soccer ball', 'space shuttle', 'spider web', 'steam locomotive', 'scarf', 'submarine', 'tank', 'tennis ball', 'tractor', 'trombone', 'vase', 'violin', 'military aircraft', 'wine bottle', 'ice cream', 'bagel', 'pretzel', 'cheeseburger', 'hot dog', 'cabbage', 'broccoli', 'cucumber', 'bell pepper', 'mushroom', 'Granny Smith apple', 'strawberry', 'lemon', 'pineapple', 'banana', 'pomegranate', 'pizza', 'burrito', 'espresso', 'volcano', 'baseball player', 'scuba diver', 'acorn'])
len 30000
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7766; Top5: 0.9442
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.77431906614786, 'ACC_ID': 0.6848249027237354, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.7690; Top5: 0.9357
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7685245901639344, 'ACC_ID': 0.6721311475409836, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.7684; Top5: 0.9326
{'Method': 'ft_pl_neg_proto_bank_v0_txt'
Step 22999: Top1: 0.7707; Top5: 0.9265
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7707608443516586, 'ACC_ID': 0.6917768499188124, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 23999: Top1: 0.7717; Top5: 0.9267
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7716841695838196, 'ACC_ID': 0.6927265655387009, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 24999: Top1: 0.7722; Top5: 0.9262
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7721647284754081, 'ACC_ID': 0.6930545182972367, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 25999: Top1: 0.7727; Top5: 0.9264
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7728157328689952, 'ACC_ID': 0.6935368226979413, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 26999: Top1: 0.7721; Top5: 0.9261
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7722049612861863, 'ACC_ID': 0.6931498742417518, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 27999: Top1: 0.7718; Top5: 0.9262
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7718580534677957, 'ACC_ID': 0.693083436399962, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 28999: Top1: 0.7721; Top5: 0.9266
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7721094682707319, 'ACC_ID': 0.6934521076315547, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 29999: Top1: 0.7717; Top5: 0.9266
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7717965800577393, 'ACC_ID': 0.6932711525649567, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 30999: Top1: 0.7711; Top5: 0.9261
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7711682283159976, 'ACC_ID': 0.6931573970600877, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 31999: Top1: 0.7715; Top5: 0.9265
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7715059362632785, 'ACC_ID': 0.6937304728181629, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 32999: Top1: 0.7715; Top5: 0.9267
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7715266558966074, 'ACC_ID': 0.6940630048465266, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 33999: Top1: 0.7714; Top5: 0.9268
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7713759021022906, 'ACC_ID': 0.6945010982114842, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 34999: Top1: 0.7710; Top5: 0.9265
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7709935287400076, 'ACC_ID': 0.6945945945945946, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 35999: Top1: 0.7710; Top5: 0.9263
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.771006771006771, 'ACC_ID': 0.695082695082695, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 36999: Top1: 0.7710; Top5: 0.9261
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7709615869244338, 'ACC_ID': 0.6955034740972748, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 37999: Top1: 0.7716; Top5: 0.9262
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7715698653198653, 'ACC_ID': 0.6966540404040404, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 38999: Top1: 0.7711; Top5: 0.9259
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7711061719952128, 'ACC_ID': 0.6964951273722004, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 39999: Top1: 0.7708; Top5: 0.9255
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7708, 'ACC_ID': 0.6963333333333334, 'ACC_OOD': 0, 'ACC_HM': 0}



ImagenetROOD SVHN ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0.9669735600000001, 'FPR95': 0.1872, 'ACC_ALL': 0.7708, 'ACC_ID': 0.6963333333333334, 'ACC_OOD': 0.9713, 'ACC_HM': 0.8111478142677249}

Online evaluation: Top-1 accuracy: 77.0833; Top-5 accuracy: 92.5500




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='ImagenetROOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


len 30000
dict_values(['goldfish', 'great white shark', 'hammerhead shark', 'stingray', 'hen', 'ostrich', 'goldfinch', 'junco', 'bald eagle', 'vulture', 'smooth newt', 'axolotl', 'tree frog', 'green iguana', 'chameleon', 'Indian cobra', 'scorpion', 'tarantula', 'centipede', 'peafowl', 'lorikeet', 'hummingbird', 'toucan', 'duck', 'goose', 'black swan', 'koala', 'jellyfish', 'snail', 'American lobster', 'hermit crab', 'flamingo', 'great egret', 'pelican', 'king penguin', 'grey whale', 'killer whale', 'sea lion', 'Chihuahua', 'Shih Tzu', 'Afghan Hound', 'Basset Hound', 'Beagle', 'Bloodhound', 'Italian Greyhound', 'Whippet', 'Weimaraner', 'Yorkshire Terrier', 'Boston Terrier', 'Scottish Terrier', 'West Highland White Terrier', 'Golden Retriever', 'Labrador Retriever', 'Cocker Spaniel', 'collie', 'Border Collie', 'Rottweiler', 'German Shepherd Dog', 'Boxer', 'French Bulldog', 'St. Bernard', 'Siberian Husky', 'Dalmatian', 'pug', 'Pomeranian', 'Chow Chow', 'Pembroke Welsh Corgi', 'Toy Poodle', 'Standard Poodle', 'grey wolf', 'hyena', 'red fox', 'tabby cat', 'leopard', 'snow leopard', 'lion', 'tiger', 'cheetah', 'polar bear', 'meerkat', 'ladybug', 'fly', 'bee', 'ant', 'grasshopper', 'cockroach', 'praying mantis', 'dragonfly', 'monarch butterfly', 'starfish', 'cottontail rabbit', 'porcupine', 'fox squirrel', 'beaver', 'guinea pig', 'zebra', 'pig', 'hippopotamus', 'bison', 'gazelle', 'llama', 'skunk', 'badger', 'orangutan', 'gorilla', 'chimpanzee', 'gibbon', 'baboon', 'giant panda', 'eel', 'clownfish', 'pufferfish', 'accordion', 'ambulance', 'assault rifle', 'backpack', 'barn', 'wheelbarrow', 'basketball', 'bathtub', 'lighthouse', 'beer glass', 'binoculars', 'birdhouse', 'bow tie', 'broom', 'bucket', 'cauldron', 'candle', 'cannon', 'canoe', 'carousel', 'castle', 'mobile phone', 'cowboy hat', 'electric guitar', 'fire truck', 'flute', 'gas mask or respirator', 'grand piano', 'guillotine', 'hammer', 'harmonica', 'harp', 'hatchet', 'jeep', 'joystick', 'lab coat', 'lawn mower', 'lipstick', 'mailbox', 'missile', 'mitten', 'parachute', 'pickup truck', 'pirate ship', 'revolver', 'rugby ball', 'sandal', 'saxophone', 'school bus', 'schooner', 'shield', 'soccer ball', 'space shuttle', 'spider web', 'steam locomotive', 'scarf', 'submarine', 'tank', 'tennis ball', 'tractor', 'trombone', 'vase', 'violin', 'military aircraft', 'wine bottle', 'ice cream', 'bagel', 'pretzel', 'cheeseburger', 'hot dog', 'cabbage', 'broccoli', 'cucumber', 'bell pepper', 'mushroom', 'Granny Smith apple', 'strawberry', 'lemon', 'pineapple', 'banana', 'pomegranate', 'pizza', 'burrito', 'espresso', 'volcano', 'baseball player', 'scuba diver', 'acorn'])
len 30000
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7753; Top5: 0.9429
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.77431906614786, 'ACC_ID': 0.5966277561608301, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.7690; Top5: 0.9344
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7691803278688525, 'ACC_ID': 0.5816393442622951, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.7684; Top5: 0.9321
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7680525164113785, 'ACC_ID': 0.5846827133479212, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.7664; Top5: 0.9324
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7664907651715039, 'ACC_ID': 0.5870712401055409, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.7686; Top5: 0.9337
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7686388962589547, 'ACC_ID': 0.5871583974529053, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.7682; Top5: 0.9314
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7685164713685607, 'ACC_ID': 0.5874419632986956, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.7694; Top5: 0.9297
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7694486404833837, 'ACC_ID': 0.588179758308157, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.7729; Top5: 0.9309
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7729300941993059, 'ACC_ID': 0.5896546025450339, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.7706; Top5: 0.9276
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7706678434833775, 'ACC_ID': 0.5867902324213004, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.7699; Top5: 0.9270
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7699617262768906, 'ACC_ID': 0.5846641150851261, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.7702; Top5: 0.9271
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7701989930472308, 'ACC_ID': 0.5815152241668664, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.7726; Top5: 0.9288
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7725770925110133, 'ACC_ID': 0.5794052863436123, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.7728; Top5: 0.9279
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.772736541598695, 'ACC_ID': 0.5807504078303426, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.7735; Top5: 0.9284
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7733042819249716, 'ACC_ID': 0.5777756726032588, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.7733; Top5: 0.9273
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7732059109813291, 'ACC_ID': 0.5764976550747721, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.7743; Top5: 0.9275
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7742337403438824, 'ACC_ID': 0.5761275853476202, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.7742; Top5: 0.9284
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7741506184437138, 'ACC_ID': 0.5757789259433224, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.7752; Top5: 0.9290
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7751479289940828, 'ACC_ID': 0.5784763313609468, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.7747; Top5: 0.9289
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7746163010722545, 'ACC_ID': 0.5776858924942182, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.7742; Top5: 0.9286
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7741162372678251, 'ACC_ID': 0.5762599028027429, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 20999: Top1: 0.7732; Top5: 0.9283
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7731369810841691, 'ACC_ID': 0.5750920401167957, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 21999: Top1: 0.7723; Top5: 0.9281
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7723606815838943, 'ACC_ID': 0.5729185616396822, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 22999: Top1: 0.7718; Top5: 0.9277
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7718626768731153, 'ACC_ID': 0.5711551844119693, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 23999: Top1: 0.7728; Top5: 0.9279
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7727954659109851, 'ACC_ID': 0.568983719508807, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 24999: Top1: 0.7731; Top5: 0.9274
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7730182438920303, 'ACC_ID': 0.5679078203350048, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 25999: Top1: 0.7736; Top5: 0.9275
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7736351531291611, 'ACC_ID': 0.5648878418518898, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 26999: Top1: 0.7729; Top5: 0.9273
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7728953987276225, 'ACC_ID': 0.562311979089609, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 27999: Top1: 0.7727; Top5: 0.9274
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7726191608790791, 'ACC_ID': 0.5596042241461326, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 28999: Top1: 0.7729; Top5: 0.9279
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7728441546514832, 'ACC_ID': 0.5589126641564882, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 29999: Top1: 0.7724; Top5: 0.9276
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7723295580723962, 'ACC_ID': 0.5582500555185432, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 30999: Top1: 0.7718; Top5: 0.9271
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7718129459296827, 'ACC_ID': 0.557422848792229, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 31999: Top1: 0.7720; Top5: 0.9273
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7719225161424703, 'ACC_ID': 0.5565507186002916, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 32999: Top1: 0.7719; Top5: 0.9273
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7718497576736673, 'ACC_ID': 0.5575121163166398, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 33999: Top1: 0.7719; Top5: 0.9274
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7717681204894885, 'ACC_ID': 0.5565971132726703, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 34999: Top1: 0.7715; Top5: 0.9271
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7714122573277503, 'ACC_ID': 0.5562618956985154, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 35999: Top1: 0.7717; Top5: 0.9269
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7716357716357717, 'ACC_ID': 0.5566285566285566, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 36999: Top1: 0.7715; Top5: 0.9265
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.771465601036829, 'ACC_ID': 0.5567555891564964, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 37999: Top1: 0.7720; Top5: 0.9266
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7719205948372615, 'ACC_ID': 0.5567129629629629, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 38999: Top1: 0.7716; Top5: 0.9264
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7714823046674645, 'ACC_ID': 0.5554795691571208, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 39999: Top1: 0.7711; Top5: 0.9261
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7710666666666667, 'ACC_ID': 0.5554333333333333, 'ACC_OOD': 0, 'ACC_HM': 0}



ImagenetROOD SVHN ft_pl_neg_proto_bank_v0_txt
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0.8912796133333333, 'FPR95': 0.8088, 'ACC_ALL': 0.7710666666666667, 'ACC_ID': 0.5554333333333333, 'ACC_OOD': 0.9879, 'ACC_HM': 0.7110746306695465}

Online evaluation: Top-1 accuracy: 77.1133; Top-5 accuracy: 92.6067


Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='VisdaOOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='msp', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


{'ID_class_descriptions': {'aeroplane': ['An airplane typically has two wings and one main body.', 'An airplane is a large, metal aircraft with wings that help it fly.', 'An airplane is a large, metal object with wings.', 'An airplane typically has two wings and a tail.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane typically has two wings and a tail.', 'An airplane has large metal wings and a long body.', 'An airplane is a metal tube with wings that has dozens of seats inside of it for passengers to sit in.', 'An airplane is a large metal object with many wings and propellers.', 'An airplane is typically a long, thin metal tube with wings.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a large, metal bird that flies through the air.', 'An airplane is a powered flying vehicle with fixed wings and a weight greater than that of the air it displaces; an airplane relies on thrust from a jet engine, propeller, or rocket engines to provide the power required to push it through.', 'An airplane is a powered flying vehicle with fixed wings and a weight greater than that of the air it displaces; an airplane relies on thrust from a jet engine, propeller, or rocket engine to push it through the air.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a large, metal bird that flies through the air.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a powered flying vehicle with fixed wings and a weight greater than that of the air it displaces; an airplane relies on thrust from a jet engine, propeller, or rocket engine to overcome drag and provide lift.', 'A typical airplane is a metal tube with wings and engines.', 'Some identifying characteristics of an airplane are that it has wings and it is a machine that is used for flying.', 'The identifying characteristics of an airplane are: wings, a tail, one or more engines, and a fuselage.', 'The identifying characteristics of an airplane are a long body with wings attached.', 'Some identifying characteristics of an airplane are that it has wings and it flies.', 'The identifying characteristics of an airplane are that it has wings and it flies.', 'Some identifying characteristics of an airplane are that it has wings and it flies.', 'The identifying characteristics of an airplane are its wings and its tail.', 'An airplane has wings and a tail.', 'The identifying characteristics of an airplane are typically its size, shape, and color.', 'The identifying characteristics of an airplane are its wings, engines, and tail.'], 'bicycle': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'bus': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'car': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'horse': ['A horse is a four-legged mammal with a long neck and a tail.', 'A horse is a quadruped mammal with a long face, neck, and legs.', 'A horse is a mammal with four legs, a long neck, and a big head with eyes on the sides of its head.', 'A horse is a mammal with four legs, a tail, and a mane.', 'A horse is a mammal with four legs, a mane, and a tail.', 'A horse is a quadruped mammal with sexually dimorphic coat colors.', 'A horse is a mammal with hooves, a mane, and a tail.', 'A horse is a quadrupeddian mammal with brown or black fur.', 'A horse has four legs, a tail, and a mane.', 'A horse has a long face, with two pointy ears on the top.', 'A horse is a four-legged mammal with a long neck and tail.', 'A horse is a four-legged mammal of the family Equidae.', 'A horse is a quadrupedal mammalian herbivore of the family Equidae.', 'A horse is a noble animal, one which has been revered by many cultures throughout history.', 'A horse is a four-legged mammal that is used for riding and racing.', 'Physical characteristics: Horses are large, four-legged animals with hooves.', 'A horse is a four-legged mammal with a long neck, mane, and tail.', 'A horse is a large, four-legged mammal with a long neck and tail.', 'A horse is a mammal of the family Equidae.', 'A horse is a mammalian creature with hooves and a long mane.', 'Horses arefour-legged animals with manes and tails.', 'size; proportions of body parts; color of hair; nature of mane and tail;Teeth;cranial bones; and the muscles of the neck, shoulder, and hindquarters.', 'Some common characteristics of horses are that they have long faces, manes, and tails.', 'A horse has a mane, a tail, and hooves.', 'The organizing characteristics of a horse are that it is a mammal with hooves, it is covered in hair, and it has a long face with a protruding snout.', 'Some identifying characteristics of a horse are that they are quadrupeds, have fruits and flowers as their diet, have a diploid chromosome number of 64, haveMEDIA TYPEa hoofed foot, and are hair-covered mammals.', 'A horse has four legs, a mane, and a tail.', 'The identifying characteristics of a horse are a head with large eyes, a long face, and large, long ears; a long neck; a chestnut coat; a mane and tail of long, coarse hair; and four legs with ho.', 'The identifying characteristics of a horse are that they are a four legged mammal with a long face, Mane, and tail.', 'Some of the identifying characteristics of a horse include: a long face, pointed ears, four legs, and a mane.'], 'knife': ['A cat is a small, carnivorous mammal.', 'Most cats are covered in fur, have four legs, a tail, and whiskers.', 'A cat has four legs, a tail, and fur.', 'A cat has fur, four legs, two ears, and a tail.', 'Cats are small, four-legged animals with furry coats, sharp claws, and whiskers on their face.', 'A domesticated cat is a small, usually furry, carnivorous mammal.', 'A cat typically has fur, four legs, a tail, and whiskers.', 'A cat is a small, furred, carnivorous mammal.', 'Cats are carnivorous mammals of the Felidae family.', 'A cat is a small, furry creature with four legs, a tail, and whiskers.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small, four-legged, carnivorous mammal.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small, typically furry, carnivorous mammal.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small carnivorous mammal.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small, furry animal with sharp claws and whiskers.', 'A cat is a small carnivorous mammal of the Felidae family.', 'A cat is a small, typically furry, carnivorous mammal.', ' Typically, cats have fur, four legs, two ears, and a tail.', 'The identifying characteristics of a cat include whiskers, fur, four legs, and a tail.', 'The defining characteristics of a cat are its whiskers, its retractable claws, and its pupils that contract to slits when exposed to bright light.', 'Are you asking for physical characteristics or personality traits?.', 'A cat is a small carnivorous mammal of the Felidae family.', 'Cats have whiskers, four legs, a tail, fur, and they meow.', 'The most common domestic cat is the brown tabby.', "A cat's whiskers, eyes, and ears are its most distinctive features.", 'There are many different types of cats, so there are no specific identifying characteristics that all cats have.', 'The most common identifying characteristics of a cat are their fur, whiskers, and tails.'], 'motorcycle': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'person': ['Deer have four legs and a tail.', 'A deer is a hoofed mammal with antlers.', 'A deer is a four-legged mammal that typically has brown fur and antlers on its head.', 'A deer is a four-legged mammal with hooves.', 'A deer is a four-legged mammal with hooves.', 'A deer is a four-legged, hoofed mammal that is covered in brown fur.', 'A deer is a four-legged mammal with brown fur.', 'A deer is a four-legged mammal that typically has a reddish-brown coat.', 'The deer is a four-legged mammal with brown fur and antlers.', 'A deer has a long neck, four legs, and a tail.', 'A deer is a mammal with four legs, a tail, and antlers.', 'A deer is a four-legged mammal that typically has a reddish-brown coat.', 'A deer is a hoofed mammal with antlers, typically a male, that feeds on plants and leaves.', 'A deer is a hoofed mammal with brown fur.', 'A deer is a timid and graceful creature.', 'A deer has brown fur and four legs.', 'A deer is a four-legged mammal that typically has a reddish-brown coat.', 'A deer is a four-legged mammal with a thin coat of fur.', 'A deer is a four-legged mammal that is covered in fur.', ' deer are four-legged, hoofed mammals that are members of the family Cervidae.', 'Fur that is red-brown in the summer and gray-brown in the winter; a white belly; a white rump in the shape of a V; antlers on the males.', 'Some identifying characteristics of a deer are that they have four long legs, hooves, antlers, and a wide tail.', 'The identifying characteristics of a deer are its hooves, its antlers, and its fur.', 'Deer are four-legged animals with hooves.', 'One of the most identifying characteristics of a deer is its antlers.', 'Some identifying characteristics of deer are that they have four legs, two eyes, two ears, and they are covered in fur.', 'The identifying characteristics of a deer are its antlers, its fur, and its hooves.', 'The identifying characteristics of a deer are its hooves, antlers, and tail.', 'The identify characteristics of a deer are that they are a hoofed mammal with antlers on males.', 'The identifying characteristics of a deer are: Keen eyesight, Excellent hearing, Good sense of smell, Foot pads that have cushioning to absorb shock, and Hooves that are split to allow for flexibility.'], 'plant': ['A dog is a brown, furry animal with a tail.', 'Dogs are typically four-legged mammals with a tail and fur.', 'A dog typically has four legs, a tail, and a head with facial features including a nose and eyes.', '.', 'A dog has four legs, a tail, and a head with big ears.', 'Most dogs have four legs, a tail, and a head with two ears.', 'A is a four-legged Mammal with a tail.', 'A dog has four legs and a tail.', 'A dog is a four-legged mammal that has a tail, fur, and follows commands.', 'A dog typically has four legs, a tail, and fur.', 'A dog is a four-legged mammal of the family Canidae.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'Dogs are playful, friendly, and loyal animals.', 'A dog is a Mammal.', 'A dog is a four-legged mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog is a four-legged mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', ' A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog is a Mammal of the Canidae family.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog typically has four legs, a tail, and fur.', 'The identifying characteristics of a dog are four legs, a tail, a head, and a body.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'The identifying characteristics of a dog are: four legs, a tail, fur, and a face with two eyes, a nose, and a mouth.', 'The identifying characteristics of a dog include four legs, a tail, fur, and a head with eyes, a nose, and a mouth.', 'Some identifying characteristics of a dog are that they are a mammal, they are a vertebrate, they are a carnivore, and they have four legs.', 'The identifying characteristics of a dog are that it is a mammal, it has four legs, it has fur, and it barks.', 'Identifying characteristics of a dog include four legs, a tail, and fur.', 'Some identifying characteristics of dogs are that they have four legs, fur, and a tail.', 'Some identifying characteristics of a dog are that they are a mammal, have four legs, a tail, and bark.'], 'skateboard': ['A frog has a wide mouth, webbed feet, and smooth, wet skin.', 'A frog is a small, tailless amphibian that has webbed feet and long hind legs for jumping.', 'A frog is a small amphibian that has a short body and long legs.', '.', 'A frog is a small, tailless amphibian that typically has a green body with dark spots.', 'Frogs are small, tailless amphibians with long, Powerful hind legs for leaping, and webbed feet for swimming.', 'A frog looks like a small, tailless amphibian that typically has green or brown skin,webbed feet, and bulging eyes.', 'Most frogs have a green body, though some species can be brown, grey, or cyan.', 'Most frogs have a body that is green, brown, or gray with spots.', 'Frogs are small, tailless amphibians with bulging eyes, moist skin, and long hind legs for leaping.', 'A frog is a small, tailless amphibian with moist, smooth skin and long hind legs for jumping.', 'A frog is an amphibian that typically has a short body, webbed feet, and protruding eyes.', 'A frog is a small, tailless amphibian with long, webbed hind feet.', 'Frogs are amphibians, which means they can live in water or on land.', 'Frogs are amphibians.', 'Frogs have long, muscular legs that help them jump long distances.', 'A frog is a small, tailless amphibian with long hind legs, webbed toes, and protruding eyes.', 'Frogs are amphibians and have smooth, moist skin.', 'A frog is a green or brown amphibian that lives near ponds and marshes.', 'A frog typically has a body that is green and brown with spots.', 'The identifying characteristics of a frog are its long, powerful hind legs; its short,ening arms; its webbed feet; its bulging, slippery skin; and its large, moist eyes.', ' frogs have moist skin, They live in water or on land but return to water to lay their eggs.', 'The identifying characteristics of a frog are that it has a wide mouth, bulging eyes, and long hind legs.', 'The identifying characteristics of a frog are that it has a short body, long legs, and webbed feet.', 'Some identifying characteristics of a frog are that they have a slimy body, they can jump very high, and they croak.', 'Some common characteristics of frogs are that they have moist smooth skin, long hind legs for jumping, large eyes, and a long protruding tongue.', 'A frog is a small amphibian that typically has a short body, webbed digits, protruding eyes, and a smooth or warty skin.', 'Frogs typically have a short, squat body and long hind legs that are ideal for jumping.', 'Some identifying characteristics of a frog are that they have bug eyes, they are good swimmers, and they can jump high.', 'The amphibian class includes the frog.'], 'train': ['Most ships are large and made of metal.', 'A ship looks like a large boat that is used for carrying people or cargo across water.', 'A large boat that is used to travel across water.', 'A ship looks like a large boat that is used for transport on water.', 'A typical merchant ship has three masts and is square-rigged on the foremast and mainmast.', 'A ship can be different sizes, but they generally have a large body with lots of cargo space.', 'A ship is a large, ocean-going vessel.', 'A ship is a large, ocean-going vessel that is used to transport people, cargo, or both.', 'A ship typically has a large hull, one or more decks, one or more masts with sails, and a rudder.', 'Ships are large, ocean-going vessels that are used for transportation or for carrying cargo.', 'The Titanic was a ship that was built in 1912.', 'The ship is long and thin, with a large sail in the middle.', 'A ship is a large vessel that is used to travel on water.', 'A ship typically refers to a large, ocean-going vessel.', 'A long, narrow boat with tall sides, used for carrying goods or passengers across water.', 'A ship is a large, ocean-going vessel designed to carry people, cargo, or both.', 'A large vessel that is designed to carry passengers or cargo, or both, across a body of water.', 'A ship is a large, ocean-going vessel designed to carry cargo or passengers, or both.', 'A ship is a large, ocean-going vessel.', 'A ship is a large, ocean-going vessel that is used for transporting people or goods.', 'The shape of a ship is long and thin.', 'A ship typically has a large and tall superstructure, a long hull, and a deep draft.', 'The identifying characteristics of a ship are its size, shape, color, and identifying marks.', 'The size, shape, and structure of a ship.', 'The bow, stern, keel, and rudder.', 'Some identifying characteristics of a ship are its size, color, and shape.', 'The identifying characteristics of a ship include its length, beam, draft, gross tonnage, and net tonnage.', 'Some identifying characteristics of ships are their size, shape, and color.', 'The identifying characteristics of a ship are its length, beam, draft, and tonnage.', 'The identifying characteristics of a ship is the name on its bow.'], 'truck': ['A truck is a large, heavy-duty vehicle used for carrying goods.', 'A truck typically has four tires, a large cab with space for passengers or storage, and a cargo area for hauling large items.', 'A truck is a vehicle with four wheels that is used to carry goods.', 'A truck is a vehicle with four wheels that is used to carry heavy objects.', 'A truck is a vehicle with four wheels that is used to carry goods from one place to another.', 'A truck is a vehicle with four wheels that is used for carrying goods.', 'A truck looks like a large vehicle with four wheels that is used to transport goods.', 'A truck is a large, heavy vehicle with four wheels, designed to carry goods by road.', 'A truck is a vehicle with four wheels that is used to transport goods.', 'A truck is a large vehicle with four wheels that is used to transport goods.', 'Trucks are large, roughly rectangular vehicles designed for hauling cargo.', 'A truck is a large vehicle with either four or six wheels that is used to transport goods or materials.', 'A truck is a vehicle designed to transport goods or materials.', 'A truck is a four-wheeled vehicle designed to carry heavy loads.', 'A truck is a vehicle with four wheels that is used to carry goods.', 'A truck is a large, heavy vehicle with four wheels that is used for transporting goods.', 'A truck is a vehicle that is used for carrying large loads or for towing other vehicles.', 'A truck is a vehicle designed to carry goods or materials.', 'A truck is a large vehicle typically used for carrying heavy loads or pulling trailers.', 'A truck is a large, heavy vehicle used for transporting goods or materials.', 'Some identifying characteristics of a truck are that they usually have a large cargo area, they are taller than a car, and they have a heavier frame.', 'A truck has a large, rectangular body and a large cargo area.', 'Trucks tend to be large and boxy, with four wheels and a heavy-duty engine.', 'The identifying characteristics of a truck are its large size, four wheels, and engine.', 'Some identifying characteristics of a truck are that they are larger and have a higher ground clearance than a car, they have a longer wheelbase, they have a higher payload and can tow more, and they have four-wheel drive.', 'Size, shape, and function.', 'The identifying characteristics of a truck are four wheels, a steering wheel, and a motor.', 'The identifying characteristics of a truck are a large body, four wheels, and a bed for hauling cargo.', 'A truck has a large and flat surface on the back, where items can be placed.', 'The identifying characteristics of a truck are its size, its weight, and its load capacity.']}, 'ID_classes': ['aeroplane', 'bicycle', 'bus', 'car', 'horse', 'knife', 'motorcycle', 'person', 'plant', 'skateboard', 'train', 'truck'], 'N_classes': 12, 'templates': ['a photo of a {}.', 'a blurry photo of a {}.', 'a black and white photo of a {}.', 'a low contrast photo of a {}.', 'a high contrast photo of a {}.', 'a bad photo of a {}.', 'a good photo of a {}.', 'a photo of a small {}.', 'a photo of a big {}.', 'a photo of the {}.', 'a blurry photo of the {}.', 'a black and white photo of the {}.', 'a low contrast photo of the {}.', 'a high contrast photo of the {}.', 'a bad photo of the {}.', 'a good photo of the {}.', 'a photo of the small {}.', 'a photo of the big {}.']}
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.8580; Top5: 0.9918
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8580246913580247, 'ACC_ID': 0.779835390946502, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.8606; Top5: 0.9930
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8605817452357071, 'ACC_ID': 0.7903711133400201, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.8576; Top5: 0.9940
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8577154308617234, 'ACC_ID': 0.7875751503006012, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.8567; Top5: 0.9910
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8567864271457086, 'ACC_ID': 0.7939121756487026, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.8578; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8578842315369262, 'ACC_ID': 0.7960079840319362, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.8589; Top5: 0.9897
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8588977423638778, 'ACC_ID': 0.796480743691899, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.8605; Top5: 0.9906
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8605180757187589, 'ACC_ID': 0.7970395673213777, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.8589; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8589232303090728, 'ACC_ID': 0.7956131605184447, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.8569; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8568884932116626, 'ACC_ID': 0.795237035388382, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.8579; Top5: 0.9898
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8580877931449188, 'ACC_ID': 0.7983563840448987, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.8575; Top5: 0.9897
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8576867295141407, 'ACC_ID': 0.7991298042059464, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.8587; Top5: 0.9895
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8588488969978437, 'ACC_ID': 0.7996350970310168, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.8583; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8584166026133744, 'ACC_ID': 0.8, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.8578; Top5: 0.9892
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.857977207977208, 'ACC_ID': 0.7988603988603988, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.8583; Top5: 0.9891
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8583941605839416, 'ACC_ID': 0.8002654280026543, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.8580; Top5: 0.9891
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8581409856519027, 'ACC_ID': 0.7998752339363693, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.8574; Top5: 0.9893
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8575960521677829, 'ACC_ID': 0.7988485489366702, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.8577; Top5: 0.9889
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8579343971631206, 'ACC_ID': 0.7982047872340425, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.8583; Top5: 0.9890
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8584647739221871, 'ACC_ID': 0.798527865404837, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.8581; Top5: 0.9888
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8583, 'ACC_ID': 0.7989, 'ACC_OOD': 0, 'ACC_HM': 0}



VisdaOOD MNIST ft_pl_neg_proto_bank_v0_txt msp
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0.955012395, 'FPR95': 0.255, 'ACC_ALL': 0.8583, 'ACC_ID': 0.7989, 'ACC_OOD': 0.8989, 'ACC_HM': 0.8459550123689481}

Online evaluation: Top-1 accuracy: 85.8100; Top-5 accuracy: 98.8800




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='VisdaOOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


{'ID_class_descriptions': {'aeroplane': ['An airplane typically has two wings and one main body.', 'An airplane is a large, metal aircraft with wings that help it fly.', 'An airplane is a large, metal object with wings.', 'An airplane typically has two wings and a tail.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane typically has two wings and a tail.', 'An airplane has large metal wings and a long body.', 'An airplane is a metal tube with wings that has dozens of seats inside of it for passengers to sit in.', 'An airplane is a large metal object with many wings and propellers.', 'An airplane is typically a long, thin metal tube with wings.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a large, metal bird that flies through the air.', 'An airplane is a powered flying vehicle with fixed wings and a weight greater than that of the air it displaces; an airplane relies on thrust from a jet engine, propeller, or rocket engines to provide the power required to push it through.', 'An airplane is a powered flying vehicle with fixed wings and a weight greater than that of the air it displaces; an airplane relies on thrust from a jet engine, propeller, or rocket engine to push it through the air.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a large, metal bird that flies through the air.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a powered flying vehicle with fixed wings and a weight greater than that of the air it displaces; an airplane relies on thrust from a jet engine, propeller, or rocket engine to overcome drag and provide lift.', 'A typical airplane is a metal tube with wings and engines.', 'Some identifying characteristics of an airplane are that it has wings and it is a machine that is used for flying.', 'The identifying characteristics of an airplane are: wings, a tail, one or more engines, and a fuselage.', 'The identifying characteristics of an airplane are a long body with wings attached.', 'Some identifying characteristics of an airplane are that it has wings and it flies.', 'The identifying characteristics of an airplane are that it has wings and it flies.', 'Some identifying characteristics of an airplane are that it has wings and it flies.', 'The identifying characteristics of an airplane are its wings and its tail.', 'An airplane has wings and a tail.', 'The identifying characteristics of an airplane are typically its size, shape, and color.', 'The identifying characteristics of an airplane are its wings, engines, and tail.'], 'bicycle': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'bus': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'car': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'horse': ['A horse is a four-legged mammal with a long neck and a tail.', 'A horse is a quadruped mammal with a long face, neck, and legs.', 'A horse is a mammal with four legs, a long neck, and a big head with eyes on the sides of its head.', 'A horse is a mammal with four legs, a tail, and a mane.', 'A horse is a mammal with four legs, a mane, and a tail.', 'A horse is a quadruped mammal with sexually dimorphic coat colors.', 'A horse is a mammal with hooves, a mane, and a tail.', 'A horse is a quadrupeddian mammal with brown or black fur.', 'A horse has four legs, a tail, and a mane.', 'A horse has a long face, with two pointy ears on the top.', 'A horse is a four-legged mammal with a long neck and tail.', 'A horse is a four-legged mammal of the family Equidae.', 'A horse is a quadrupedal mammalian herbivore of the family Equidae.', 'A horse is a noble animal, one which has been revered by many cultures throughout history.', 'A horse is a four-legged mammal that is used for riding and racing.', 'Physical characteristics: Horses are large, four-legged animals with hooves.', 'A horse is a four-legged mammal with a long neck, mane, and tail.', 'A horse is a large, four-legged mammal with a long neck and tail.', 'A horse is a mammal of the family Equidae.', 'A horse is a mammalian creature with hooves and a long mane.', 'Horses arefour-legged animals with manes and tails.', 'size; proportions of body parts; color of hair; nature of mane and tail;Teeth;cranial bones; and the muscles of the neck, shoulder, and hindquarters.', 'Some common characteristics of horses are that they have long faces, manes, and tails.', 'A horse has a mane, a tail, and hooves.', 'The organizing characteristics of a horse are that it is a mammal with hooves, it is covered in hair, and it has a long face with a protruding snout.', 'Some identifying characteristics of a horse are that they are quadrupeds, have fruits and flowers as their diet, have a diploid chromosome number of 64, haveMEDIA TYPEa hoofed foot, and are hair-covered mammals.', 'A horse has four legs, a mane, and a tail.', 'The identifying characteristics of a horse are a head with large eyes, a long face, and large, long ears; a long neck; a chestnut coat; a mane and tail of long, coarse hair; and four legs with ho.', 'The identifying characteristics of a horse are that they are a four legged mammal with a long face, Mane, and tail.', 'Some of the identifying characteristics of a horse include: a long face, pointed ears, four legs, and a mane.'], 'knife': ['A cat is a small, carnivorous mammal.', 'Most cats are covered in fur, have four legs, a tail, and whiskers.', 'A cat has four legs, a tail, and fur.', 'A cat has fur, four legs, two ears, and a tail.', 'Cats are small, four-legged animals with furry coats, sharp claws, and whiskers on their face.', 'A domesticated cat is a small, usually furry, carnivorous mammal.', 'A cat typically has fur, four legs, a tail, and whiskers.', 'A cat is a small, furred, carnivorous mammal.', 'Cats are carnivorous mammals of the Felidae family.', 'A cat is a small, furry creature with four legs, a tail, and whiskers.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small, four-legged, carnivorous mammal.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small, typically furry, carnivorous mammal.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small carnivorous mammal.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small, furry animal with sharp claws and whiskers.', 'A cat is a small carnivorous mammal of the Felidae family.', 'A cat is a small, typically furry, carnivorous mammal.', ' Typically, cats have fur, four legs, two ears, and a tail.', 'The identifying characteristics of a cat include whiskers, fur, four legs, and a tail.', 'The defining characteristics of a cat are its whiskers, its retractable claws, and its pupils that contract to slits when exposed to bright light.', 'Are you asking for physical characteristics or personality traits?.', 'A cat is a small carnivorous mammal of the Felidae family.', 'Cats have whiskers, four legs, a tail, fur, and they meow.', 'The most common domestic cat is the brown tabby.', "A cat's whiskers, eyes, and ears are its most distinctive features.", 'There are many different types of cats, so there are no specific identifying characteristics that all cats have.', 'The most common identifying characteristics of a cat are their fur, whiskers, and tails.'], 'motorcycle': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'person': ['Deer have four legs and a tail.', 'A deer is a hoofed mammal with antlers.', 'A deer is a four-legged mammal that typically has brown fur and antlers on its head.', 'A deer is a four-legged mammal with hooves.', 'A deer is a four-legged mammal with hooves.', 'A deer is a four-legged, hoofed mammal that is covered in brown fur.', 'A deer is a four-legged mammal with brown fur.', 'A deer is a four-legged mammal that typically has a reddish-brown coat.', 'The deer is a four-legged mammal with brown fur and antlers.', 'A deer has a long neck, four legs, and a tail.', 'A deer is a mammal with four legs, a tail, and antlers.', 'A deer is a four-legged mammal that typically has a reddish-brown coat.', 'A deer is a hoofed mammal with antlers, typically a male, that feeds on plants and leaves.', 'A deer is a hoofed mammal with brown fur.', 'A deer is a timid and graceful creature.', 'A deer has brown fur and four legs.', 'A deer is a four-legged mammal that typically has a reddish-brown coat.', 'A deer is a four-legged mammal with a thin coat of fur.', 'A deer is a four-legged mammal that is covered in fur.', ' deer are four-legged, hoofed mammals that are members of the family Cervidae.', 'Fur that is red-brown in the summer and gray-brown in the winter; a white belly; a white rump in the shape of a V; antlers on the males.', 'Some identifying characteristics of a deer are that they have four long legs, hooves, antlers, and a wide tail.', 'The identifying characteristics of a deer are its hooves, its antlers, and its fur.', 'Deer are four-legged animals with hooves.', 'One of the most identifying characteristics of a deer is its antlers.', 'Some identifying characteristics of deer are that they have four legs, two eyes, two ears, and they are covered in fur.', 'The identifying characteristics of a deer are its antlers, its fur, and its hooves.', 'The identifying characteristics of a deer are its hooves, antlers, and tail.', 'The identify characteristics of a deer are that they are a hoofed mammal with antlers on males.', 'The identifying characteristics of a deer are: Keen eyesight, Excellent hearing, Good sense of smell, Foot pads that have cushioning to absorb shock, and Hooves that are split to allow for flexibility.'], 'plant': ['A dog is a brown, furry animal with a tail.', 'Dogs are typically four-legged mammals with a tail and fur.', 'A dog typically has four legs, a tail, and a head with facial features including a nose and eyes.', '.', 'A dog has four legs, a tail, and a head with big ears.', 'Most dogs have four legs, a tail, and a head with two ears.', 'A is a four-legged Mammal with a tail.', 'A dog has four legs and a tail.', 'A dog is a four-legged mammal that has a tail, fur, and follows commands.', 'A dog typically has four legs, a tail, and fur.', 'A dog is a four-legged mammal of the family Canidae.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'Dogs are playful, friendly, and loyal animals.', 'A dog is a Mammal.', 'A dog is a four-legged mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog is a four-legged mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', ' A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog is a Mammal of the Canidae family.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog typically has four legs, a tail, and fur.', 'The identifying characteristics of a dog are four legs, a tail, a head, and a body.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'The identifying characteristics of a dog are: four legs, a tail, fur, and a face with two eyes, a nose, and a mouth.', 'The identifying characteristics of a dog include four legs, a tail, fur, and a head with eyes, a nose, and a mouth.', 'Some identifying characteristics of a dog are that they are a mammal, they are a vertebrate, they are a carnivore, and they have four legs.', 'The identifying characteristics of a dog are that it is a mammal, it has four legs, it has fur, and it barks.', 'Identifying characteristics of a dog include four legs, a tail, and fur.', 'Some identifying characteristics of dogs are that they have four legs, fur, and a tail.', 'Some identifying characteristics of a dog are that they are a mammal, have four legs, a tail, and bark.'], 'skateboard': ['A frog has a wide mouth, webbed feet, and smooth, wet skin.', 'A frog is a small, tailless amphibian that has webbed feet and long hind legs for jumping.', 'A frog is a small amphibian that has a short body and long legs.', '.', 'A frog is a small, tailless amphibian that typically has a green body with dark spots.', 'Frogs are small, tailless amphibians with long, Powerful hind legs for leaping, and webbed feet for swimming.', 'A frog looks like a small, tailless amphibian that typically has green or brown skin,webbed feet, and bulging eyes.', 'Most frogs have a green body, though some species can be brown, grey, or cyan.', 'Most frogs have a body that is green, brown, or gray with spots.', 'Frogs are small, tailless amphibians with bulging eyes, moist skin, and long hind legs for leaping.', 'A frog is a small, tailless amphibian with moist, smooth skin and long hind legs for jumping.', 'A frog is an amphibian that typically has a short body, webbed feet, and protruding eyes.', 'A frog is a small, tailless amphibian with long, webbed hind feet.', 'Frogs are amphibians, which means they can live in water or on land.', 'Frogs are amphibians.', 'Frogs have long, muscular legs that help them jump long distances.', 'A frog is a small, tailless amphibian with long hind legs, webbed toes, and protruding eyes.', 'Frogs are amphibians and have smooth, moist skin.', 'A frog is a green or brown amphibian that lives near ponds and marshes.', 'A frog typically has a body that is green and brown with spots.', 'The identifying characteristics of a frog are its long, powerful hind legs; its short,ening arms; its webbed feet; its bulging, slippery skin; and its large, moist eyes.', ' frogs have moist skin, They live in water or on land but return to water to lay their eggs.', 'The identifying characteristics of a frog are that it has a wide mouth, bulging eyes, and long hind legs.', 'The identifying characteristics of a frog are that it has a short body, long legs, and webbed feet.', 'Some identifying characteristics of a frog are that they have a slimy body, they can jump very high, and they croak.', 'Some common characteristics of frogs are that they have moist smooth skin, long hind legs for jumping, large eyes, and a long protruding tongue.', 'A frog is a small amphibian that typically has a short body, webbed digits, protruding eyes, and a smooth or warty skin.', 'Frogs typically have a short, squat body and long hind legs that are ideal for jumping.', 'Some identifying characteristics of a frog are that they have bug eyes, they are good swimmers, and they can jump high.', 'The amphibian class includes the frog.'], 'train': ['Most ships are large and made of metal.', 'A ship looks like a large boat that is used for carrying people or cargo across water.', 'A large boat that is used to travel across water.', 'A ship looks like a large boat that is used for transport on water.', 'A typical merchant ship has three masts and is square-rigged on the foremast and mainmast.', 'A ship can be different sizes, but they generally have a large body with lots of cargo space.', 'A ship is a large, ocean-going vessel.', 'A ship is a large, ocean-going vessel that is used to transport people, cargo, or both.', 'A ship typically has a large hull, one or more decks, one or more masts with sails, and a rudder.', 'Ships are large, ocean-going vessels that are used for transportation or for carrying cargo.', 'The Titanic was a ship that was built in 1912.', 'The ship is long and thin, with a large sail in the middle.', 'A ship is a large vessel that is used to travel on water.', 'A ship typically refers to a large, ocean-going vessel.', 'A long, narrow boat with tall sides, used for carrying goods or passengers across water.', 'A ship is a large, ocean-going vessel designed to carry people, cargo, or both.', 'A large vessel that is designed to carry passengers or cargo, or both, across a body of water.', 'A ship is a large, ocean-going vessel designed to carry cargo or passengers, or both.', 'A ship is a large, ocean-going vessel.', 'A ship is a large, ocean-going vessel that is used for transporting people or goods.', 'The shape of a ship is long and thin.', 'A ship typically has a large and tall superstructure, a long hull, and a deep draft.', 'The identifying characteristics of a ship are its size, shape, color, and identifying marks.', 'The size, shape, and structure of a ship.', 'The bow, stern, keel, and rudder.', 'Some identifying characteristics of a ship are its size, color, and shape.', 'The identifying characteristics of a ship include its length, beam, draft, gross tonnage, and net tonnage.', 'Some identifying characteristics of ships are their size, shape, and color.', 'The identifying characteristics of a ship are its length, beam, draft, and tonnage.', 'The identifying characteristics of a ship is the name on its bow.'], 'truck': ['A truck is a large, heavy-duty vehicle used for carrying goods.', 'A truck typically has four tires, a large cab with space for passengers or storage, and a cargo area for hauling large items.', 'A truck is a vehicle with four wheels that is used to carry goods.', 'A truck is a vehicle with four wheels that is used to carry heavy objects.', 'A truck is a vehicle with four wheels that is used to carry goods from one place to another.', 'A truck is a vehicle with four wheels that is used for carrying goods.', 'A truck looks like a large vehicle with four wheels that is used to transport goods.', 'A truck is a large, heavy vehicle with four wheels, designed to carry goods by road.', 'A truck is a vehicle with four wheels that is used to transport goods.', 'A truck is a large vehicle with four wheels that is used to transport goods.', 'Trucks are large, roughly rectangular vehicles designed for hauling cargo.', 'A truck is a large vehicle with either four or six wheels that is used to transport goods or materials.', 'A truck is a vehicle designed to transport goods or materials.', 'A truck is a four-wheeled vehicle designed to carry heavy loads.', 'A truck is a vehicle with four wheels that is used to carry goods.', 'A truck is a large, heavy vehicle with four wheels that is used for transporting goods.', 'A truck is a vehicle that is used for carrying large loads or for towing other vehicles.', 'A truck is a vehicle designed to carry goods or materials.', 'A truck is a large vehicle typically used for carrying heavy loads or pulling trailers.', 'A truck is a large, heavy vehicle used for transporting goods or materials.', 'Some identifying characteristics of a truck are that they usually have a large cargo area, they are taller than a car, and they have a heavier frame.', 'A truck has a large, rectangular body and a large cargo area.', 'Trucks tend to be large and boxy, with four wheels and a heavy-duty engine.', 'The identifying characteristics of a truck are its large size, four wheels, and engine.', 'Some identifying characteristics of a truck are that they are larger and have a higher ground clearance than a car, they have a longer wheelbase, they have a higher payload and can tow more, and they have four-wheel drive.', 'Size, shape, and function.', 'The identifying characteristics of a truck are four wheels, a steering wheel, and a motor.', 'The identifying characteristics of a truck are a large body, four wheels, and a bed for hauling cargo.', 'A truck has a large and flat surface on the back, where items can be placed.', 'The identifying characteristics of a truck are its size, its weight, and its load capacity.']}, 'ID_classes': ['aeroplane', 'bicycle', 'bus', 'car', 'horse', 'knife', 'motorcycle', 'person', 'plant', 'skateboard', 'train', 'truck'], 'N_classes': 12, 'templates': ['a photo of a {}.', 'a blurry photo of a {}.', 'a black and white photo of a {}.', 'a low contrast photo of a {}.', 'a high contrast photo of a {}.', 'a bad photo of a {}.', 'a good photo of a {}.', 'a photo of a small {}.', 'a photo of a big {}.', 'a photo of the {}.', 'a blurry photo of the {}.', 'a black and white photo of the {}.', 'a low contrast photo of the {}.', 'a high contrast photo of the {}.', 'a bad photo of the {}.', 'a good photo of the {}.', 'a photo of the small {}.', 'a photo of the big {}.']}
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.8580; Top5: 0.9918
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8580246913580247, 'ACC_ID': 0.6666666666666666, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.8596; Top5: 0.9930
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8595787362086259, 'ACC_ID': 0.6680040120361084, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.8570; Top5: 0.9940
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8570474281897128, 'ACC_ID': 0.6579826319305278, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.8567; Top5: 0.9910
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8567864271457086, 'ACC_ID': 0.6541916167664671, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.8578; Top5: 0.9904
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8578842315369262, 'ACC_ID': 0.6542914171656686, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.8582; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8582337317397079, 'ACC_ID': 0.6646746347941567, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.8594; Top5: 0.9909
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8593794477654426, 'ACC_ID': 0.6740677483632224, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.8579; Top5: 0.9905
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8579262213359921, 'ACC_ID': 0.6774675972083749, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.8560; Top5: 0.9909
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8559982194524817, 'ACC_ID': 0.6786111729356777, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.8569; Top5: 0.9902
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.856885147324113, 'ACC_ID': 0.6819001803968732, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.8568; Top5: 0.9902
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8565989847715736, 'ACC_ID': 0.6834662799129804, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.8582; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8581854370542379, 'ACC_ID': 0.6822026870127716, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.8576; Top5: 0.9905
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8576479631053037, 'ACC_ID': 0.6813220599538816, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.8570; Top5: 0.9897
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.856980056980057, 'ACC_ID': 0.6790598290598291, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.8576; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8575978765759787, 'ACC_ID': 0.6788321167883211, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.8576; Top5: 0.9903
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8576419213973799, 'ACC_ID': 0.675857766687461, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.8572; Top5: 0.9904
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8572435671483962, 'ACC_ID': 0.6744213370931735, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.8574; Top5: 0.9899
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8573803191489362, 'ACC_ID': 0.6733156028368794, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.8586; Top5: 0.9898
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8584647739221871, 'ACC_ID': 0.6715036803364879, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.8587; Top5: 0.9895
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8586, 'ACC_ID': 0.6701, 'ACC_OOD': 0, 'ACC_HM': 0}



VisdaOOD MNIST ft_pl_neg_proto_bank_v0_txt maxlogit
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0.948791725, 'FPR95': 0.3905, 'ACC_ALL': 0.8586, 'ACC_ID': 0.6701, 'ACC_OOD': 0.9952, 'ACC_HM': 0.8009169759202547}

Online evaluation: Top-1 accuracy: 85.8700; Top-5 accuracy: 98.9500




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='VisdaOOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='msp', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


{'ID_class_descriptions': {'aeroplane': ['An airplane typically has two wings and one main body.', 'An airplane is a large, metal aircraft with wings that help it fly.', 'An airplane is a large, metal object with wings.', 'An airplane typically has two wings and a tail.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane typically has two wings and a tail.', 'An airplane has large metal wings and a long body.', 'An airplane is a metal tube with wings that has dozens of seats inside of it for passengers to sit in.', 'An airplane is a large metal object with many wings and propellers.', 'An airplane is typically a long, thin metal tube with wings.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a large, metal bird that flies through the air.', 'An airplane is a powered flying vehicle with fixed wings and a weight greater than that of the air it displaces; an airplane relies on thrust from a jet engine, propeller, or rocket engines to provide the power required to push it through.', 'An airplane is a powered flying vehicle with fixed wings and a weight greater than that of the air it displaces; an airplane relies on thrust from a jet engine, propeller, or rocket engine to push it through the air.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a large, metal bird that flies through the air.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a powered flying vehicle with fixed wings and a weight greater than that of the air it displaces; an airplane relies on thrust from a jet engine, propeller, or rocket engine to overcome drag and provide lift.', 'A typical airplane is a metal tube with wings and engines.', 'Some identifying characteristics of an airplane are that it has wings and it is a machine that is used for flying.', 'The identifying characteristics of an airplane are: wings, a tail, one or more engines, and a fuselage.', 'The identifying characteristics of an airplane are a long body with wings attached.', 'Some identifying characteristics of an airplane are that it has wings and it flies.', 'The identifying characteristics of an airplane are that it has wings and it flies.', 'Some identifying characteristics of an airplane are that it has wings and it flies.', 'The identifying characteristics of an airplane are its wings and its tail.', 'An airplane has wings and a tail.', 'The identifying characteristics of an airplane are typically its size, shape, and color.', 'The identifying characteristics of an airplane are its wings, engines, and tail.'], 'bicycle': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'bus': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'car': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'horse': ['A horse is a four-legged mammal with a long neck and a tail.', 'A horse is a quadruped mammal with a long face, neck, and legs.', 'A horse is a mammal with four legs, a long neck, and a big head with eyes on the sides of its head.', 'A horse is a mammal with four legs, a tail, and a mane.', 'A horse is a mammal with four legs, a mane, and a tail.', 'A horse is a quadruped mammal with sexually dimorphic coat colors.', 'A horse is a mammal with hooves, a mane, and a tail.', 'A horse is a quadrupeddian mammal with brown or black fur.', 'A horse has four legs, a tail, and a mane.', 'A horse has a long face, with two pointy ears on the top.', 'A horse is a four-legged mammal with a long neck and tail.', 'A horse is a four-legged mammal of the family Equidae.', 'A horse is a quadrupedal mammalian herbivore of the family Equidae.', 'A horse is a noble animal, one which has been revered by many cultures throughout history.', 'A horse is a four-legged mammal that is used for riding and racing.', 'Physical characteristics: Horses are large, four-legged animals with hooves.', 'A horse is a four-legged mammal with a long neck, mane, and tail.', 'A horse is a large, four-legged mammal with a long neck and tail.', 'A horse is a mammal of the family Equidae.', 'A horse is a mammalian creature with hooves and a long mane.', 'Horses arefour-legged animals with manes and tails.', 'size; proportions of body parts; color of hair; nature of mane and tail;Teeth;cranial bones; and the muscles of the neck, shoulder, and hindquarters.', 'Some common characteristics of horses are that they have long faces, manes, and tails.', 'A horse has a mane, a tail, and hooves.', 'The organizing characteristics of a horse are that it is a mammal with hooves, it is covered in hair, and it has a long face with a protruding snout.', 'Some identifying characteristics of a horse are that they are quadrupeds, have fruits and flowers as their diet, have a diploid chromosome number of 64, haveMEDIA TYPEa hoofed foot, and are hair-covered mammals.', 'A horse has four legs, a mane, and a tail.', 'The identifying characteristics of a horse are a head with large eyes, a long face, and large, long ears; a long neck; a chestnut coat; a mane and tail of long, coarse hair; and four legs with ho.', 'The identifying characteristics of a horse are that they are a four legged mammal with a long face, Mane, and tail.', 'Some of the identifying characteristics of a horse include: a long face, pointed ears, four legs, and a mane.'], 'knife': ['A cat is a small, carnivorous mammal.', 'Most cats are covered in fur, have four legs, a tail, and whiskers.', 'A cat has four legs, a tail, and fur.', 'A cat has fur, four legs, two ears, and a tail.', 'Cats are small, four-legged animals with furry coats, sharp claws, and whiskers on their face.', 'A domesticated cat is a small, usually furry, carnivorous mammal.', 'A cat typically has fur, four legs, a tail, and whiskers.', 'A cat is a small, furred, carnivorous mammal.', 'Cats are carnivorous mammals of the Felidae family.', 'A cat is a small, furry creature with four legs, a tail, and whiskers.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small, four-legged, carnivorous mammal.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small, typically furry, carnivorous mammal.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small carnivorous mammal.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small, furry animal with sharp claws and whiskers.', 'A cat is a small carnivorous mammal of the Felidae family.', 'A cat is a small, typically furry, carnivorous mammal.', ' Typically, cats have fur, four legs, two ears, and a tail.', 'The identifying characteristics of a cat include whiskers, fur, four legs, and a tail.', 'The defining characteristics of a cat are its whiskers, its retractable claws, and its pupils that contract to slits when exposed to bright light.', 'Are you asking for physical characteristics or personality traits?.', 'A cat is a small carnivorous mammal of the Felidae family.', 'Cats have whiskers, four legs, a tail, fur, and they meow.', 'The most common domestic cat is the brown tabby.', "A cat's whiskers, eyes, and ears are its most distinctive features.", 'There are many different types of cats, so there are no specific identifying characteristics that all cats have.', 'The most common identifying characteristics of a cat are their fur, whiskers, and tails.'], 'motorcycle': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'person': ['Deer have four legs and a tail.', 'A deer is a hoofed mammal with antlers.', 'A deer is a four-legged mammal that typically has brown fur and antlers on its head.', 'A deer is a four-legged mammal with hooves.', 'A deer is a four-legged mammal with hooves.', 'A deer is a four-legged, hoofed mammal that is covered in brown fur.', 'A deer is a four-legged mammal with brown fur.', 'A deer is a four-legged mammal that typically has a reddish-brown coat.', 'The deer is a four-legged mammal with brown fur and antlers.', 'A deer has a long neck, four legs, and a tail.', 'A deer is a mammal with four legs, a tail, and antlers.', 'A deer is a four-legged mammal that typically has a reddish-brown coat.', 'A deer is a hoofed mammal with antlers, typically a male, that feeds on plants and leaves.', 'A deer is a hoofed mammal with brown fur.', 'A deer is a timid and graceful creature.', 'A deer has brown fur and four legs.', 'A deer is a four-legged mammal that typically has a reddish-brown coat.', 'A deer is a four-legged mammal with a thin coat of fur.', 'A deer is a four-legged mammal that is covered in fur.', ' deer are four-legged, hoofed mammals that are members of the family Cervidae.', 'Fur that is red-brown in the summer and gray-brown in the winter; a white belly; a white rump in the shape of a V; antlers on the males.', 'Some identifying characteristics of a deer are that they have four long legs, hooves, antlers, and a wide tail.', 'The identifying characteristics of a deer are its hooves, its antlers, and its fur.', 'Deer are four-legged animals with hooves.', 'One of the most identifying characteristics of a deer is its antlers.', 'Some identifying characteristics of deer are that they have four legs, two eyes, two ears, and they are covered in fur.', 'The identifying characteristics of a deer are its antlers, its fur, and its hooves.', 'The identifying characteristics of a deer are its hooves, antlers, and tail.', 'The identify characteristics of a deer are that they are a hoofed mammal with antlers on males.', 'The identifying characteristics of a deer are: Keen eyesight, Excellent hearing, Good sense of smell, Foot pads that have cushioning to absorb shock, and Hooves that are split to allow for flexibility.'], 'plant': ['A dog is a brown, furry animal with a tail.', 'Dogs are typically four-legged mammals with a tail and fur.', 'A dog typically has four legs, a tail, and a head with facial features including a nose and eyes.', '.', 'A dog has four legs, a tail, and a head with big ears.', 'Most dogs have four legs, a tail, and a head with two ears.', 'A is a four-legged Mammal with a tail.', 'A dog has four legs and a tail.', 'A dog is a four-legged mammal that has a tail, fur, and follows commands.', 'A dog typically has four legs, a tail, and fur.', 'A dog is a four-legged mammal of the family Canidae.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'Dogs are playful, friendly, and loyal animals.', 'A dog is a Mammal.', 'A dog is a four-legged mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog is a four-legged mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', ' A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog is a Mammal of the Canidae family.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog typically has four legs, a tail, and fur.', 'The identifying characteristics of a dog are four legs, a tail, a head, and a body.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'The identifying characteristics of a dog are: four legs, a tail, fur, and a face with two eyes, a nose, and a mouth.', 'The identifying characteristics of a dog include four legs, a tail, fur, and a head with eyes, a nose, and a mouth.', 'Some identifying characteristics of a dog are that they are a mammal, they are a vertebrate, they are a carnivore, and they have four legs.', 'The identifying characteristics of a dog are that it is a mammal, it has four legs, it has fur, and it barks.', 'Identifying characteristics of a dog include four legs, a tail, and fur.', 'Some identifying characteristics of dogs are that they have four legs, fur, and a tail.', 'Some identifying characteristics of a dog are that they are a mammal, have four legs, a tail, and bark.'], 'skateboard': ['A frog has a wide mouth, webbed feet, and smooth, wet skin.', 'A frog is a small, tailless amphibian that has webbed feet and long hind legs for jumping.', 'A frog is a small amphibian that has a short body and long legs.', '.', 'A frog is a small, tailless amphibian that typically has a green body with dark spots.', 'Frogs are small, tailless amphibians with long, Powerful hind legs for leaping, and webbed feet for swimming.', 'A frog looks like a small, tailless amphibian that typically has green or brown skin,webbed feet, and bulging eyes.', 'Most frogs have a green body, though some species can be brown, grey, or cyan.', 'Most frogs have a body that is green, brown, or gray with spots.', 'Frogs are small, tailless amphibians with bulging eyes, moist skin, and long hind legs for leaping.', 'A frog is a small, tailless amphibian with moist, smooth skin and long hind legs for jumping.', 'A frog is an amphibian that typically has a short body, webbed feet, and protruding eyes.', 'A frog is a small, tailless amphibian with long, webbed hind feet.', 'Frogs are amphibians, which means they can live in water or on land.', 'Frogs are amphibians.', 'Frogs have long, muscular legs that help them jump long distances.', 'A frog is a small, tailless amphibian with long hind legs, webbed toes, and protruding eyes.', 'Frogs are amphibians and have smooth, moist skin.', 'A frog is a green or brown amphibian that lives near ponds and marshes.', 'A frog typically has a body that is green and brown with spots.', 'The identifying characteristics of a frog are its long, powerful hind legs; its short,ening arms; its webbed feet; its bulging, slippery skin; and its large, moist eyes.', ' frogs have moist skin, They live in water or on land but return to water to lay their eggs.', 'The identifying characteristics of a frog are that it has a wide mouth, bulging eyes, and long hind legs.', 'The identifying characteristics of a frog are that it has a short body, long legs, and webbed feet.', 'Some identifying characteristics of a frog are that they have a slimy body, they can jump very high, and they croak.', 'Some common characteristics of frogs are that they have moist smooth skin, long hind legs for jumping, large eyes, and a long protruding tongue.', 'A frog is a small amphibian that typically has a short body, webbed digits, protruding eyes, and a smooth or warty skin.', 'Frogs typically have a short, squat body and long hind legs that are ideal for jumping.', 'Some identifying characteristics of a frog are that they have bug eyes, they are good swimmers, and they can jump high.', 'The amphibian class includes the frog.'], 'train': ['Most ships are large and made of metal.', 'A ship looks like a large boat that is used for carrying people or cargo across water.', 'A large boat that is used to travel across water.', 'A ship looks like a large boat that is used for transport on water.', 'A typical merchant ship has three masts and is square-rigged on the foremast and mainmast.', 'A ship can be different sizes, but they generally have a large body with lots of cargo space.', 'A ship is a large, ocean-going vessel.', 'A ship is a large, ocean-going vessel that is used to transport people, cargo, or both.', 'A ship typically has a large hull, one or more decks, one or more masts with sails, and a rudder.', 'Ships are large, ocean-going vessels that are used for transportation or for carrying cargo.', 'The Titanic was a ship that was built in 1912.', 'The ship is long and thin, with a large sail in the middle.', 'A ship is a large vessel that is used to travel on water.', 'A ship typically refers to a large, ocean-going vessel.', 'A long, narrow boat with tall sides, used for carrying goods or passengers across water.', 'A ship is a large, ocean-going vessel designed to carry people, cargo, or both.', 'A large vessel that is designed to carry passengers or cargo, or both, across a body of water.', 'A ship is a large, ocean-going vessel designed to carry cargo or passengers, or both.', 'A ship is a large, ocean-going vessel.', 'A ship is a large, ocean-going vessel that is used for transporting people or goods.', 'The shape of a ship is long and thin.', 'A ship typically has a large and tall superstructure, a long hull, and a deep draft.', 'The identifying characteristics of a ship are its size, shape, color, and identifying marks.', 'The size, shape, and structure of a ship.', 'The bow, stern, keel, and rudder.', 'Some identifying characteristics of a ship are its size, color, and shape.', 'The identifying characteristics of a ship include its length, beam, draft, gross tonnage, and net tonnage.', 'Some identifying characteristics of ships are their size, shape, and color.', 'The identifying characteristics of a ship are its length, beam, draft, and tonnage.', 'The identifying characteristics of a ship is the name on its bow.'], 'truck': ['A truck is a large, heavy-duty vehicle used for carrying goods.', 'A truck typically has four tires, a large cab with space for passengers or storage, and a cargo area for hauling large items.', 'A truck is a vehicle with four wheels that is used to carry goods.', 'A truck is a vehicle with four wheels that is used to carry heavy objects.', 'A truck is a vehicle with four wheels that is used to carry goods from one place to another.', 'A truck is a vehicle with four wheels that is used for carrying goods.', 'A truck looks like a large vehicle with four wheels that is used to transport goods.', 'A truck is a large, heavy vehicle with four wheels, designed to carry goods by road.', 'A truck is a vehicle with four wheels that is used to transport goods.', 'A truck is a large vehicle with four wheels that is used to transport goods.', 'Trucks are large, roughly rectangular vehicles designed for hauling cargo.', 'A truck is a large vehicle with either four or six wheels that is used to transport goods or materials.', 'A truck is a vehicle designed to transport goods or materials.', 'A truck is a four-wheeled vehicle designed to carry heavy loads.', 'A truck is a vehicle with four wheels that is used to carry goods.', 'A truck is a large, heavy vehicle with four wheels that is used for transporting goods.', 'A truck is a vehicle that is used for carrying large loads or for towing other vehicles.', 'A truck is a vehicle designed to carry goods or materials.', 'A truck is a large vehicle typically used for carrying heavy loads or pulling trailers.', 'A truck is a large, heavy vehicle used for transporting goods or materials.', 'Some identifying characteristics of a truck are that they usually have a large cargo area, they are taller than a car, and they have a heavier frame.', 'A truck has a large, rectangular body and a large cargo area.', 'Trucks tend to be large and boxy, with four wheels and a heavy-duty engine.', 'The identifying characteristics of a truck are its large size, four wheels, and engine.', 'Some identifying characteristics of a truck are that they are larger and have a higher ground clearance than a car, they have a longer wheelbase, they have a higher payload and can tow more, and they have four-wheel drive.', 'Size, shape, and function.', 'The identifying characteristics of a truck are four wheels, a steering wheel, and a motor.', 'The identifying characteristics of a truck are a large body, four wheels, and a bed for hauling cargo.', 'A truck has a large and flat surface on the back, where items can be placed.', 'The identifying characteristics of a truck are its size, its weight, and its load capacity.']}, 'ID_classes': ['aeroplane', 'bicycle', 'bus', 'car', 'horse', 'knife', 'motorcycle', 'person', 'plant', 'skateboard', 'train', 'truck'], 'N_classes': 12, 'templates': ['a photo of a {}.', 'a blurry photo of a {}.', 'a black and white photo of a {}.', 'a low contrast photo of a {}.', 'a high contrast photo of a {}.', 'a bad photo of a {}.', 'a good photo of a {}.', 'a photo of a small {}.', 'a photo of a big {}.', 'a photo of the {}.', 'a blurry photo of the {}.', 'a black and white photo of the {}.', 'a low contrast photo of the {}.', 'a high contrast photo of the {}.', 'a bad photo of the {}.', 'a good photo of the {}.', 'a photo of the small {}.', 'a photo of the big {}.']}
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/train_32x32.mat
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.8580; Top5: 0.9918
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8580246913580247, 'ACC_ID': 0.7880658436213992, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.8606; Top5: 0.9930
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8605817452357071, 'ACC_ID': 0.79839518555667, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.8570; Top5: 0.9940
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8570474281897128, 'ACC_ID': 0.7949231796927188, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.8562; Top5: 0.9910
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8562874251497006, 'ACC_ID': 0.8003992015968064, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.8574; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8574850299401198, 'ACC_ID': 0.8015968063872255, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.8582; Top5: 0.9897
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8582337317397079, 'ACC_ID': 0.799800796812749, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.8599; Top5: 0.9906
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8599487617421008, 'ACC_ID': 0.7998861372046684, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.8584; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8584247258225324, 'ACC_ID': 0.7988534396809571, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.8569; Top5: 0.9902
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8568884932116626, 'ACC_ID': 0.79813042510572, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.8579; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8578873521747845, 'ACC_ID': 0.8011625576267789, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.8577; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8576867295141407, 'ACC_ID': 0.801849166062364, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.8592; Top5: 0.9899
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8591806269696467, 'ACC_ID': 0.8021230718195389, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.8587; Top5: 0.9902
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8587240584166026, 'ACC_ID': 0.8023059185242122, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.8587; Top5: 0.9893
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8586894586894587, 'ACC_ID': 0.8015669515669516, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.8596; Top5: 0.9893
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8595885865958859, 'ACC_ID': 0.8031851360318514, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.8591; Top5: 0.9894
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8591391141609482, 'ACC_ID': 0.8031191515907673, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.8583; Top5: 0.9897
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8583010222065562, 'ACC_ID': 0.8028433791563858, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.8586; Top5: 0.9893
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8585992907801419, 'ACC_ID': 0.8030806737588653, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.8595; Top5: 0.9893
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8595162986330179, 'ACC_ID': 0.8035751840168244, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.8595; Top5: 0.9890
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8595, 'ACC_ID': 0.8039, 'ACC_OOD': 0, 'ACC_HM': 0}



VisdaOOD SVHN ft_pl_neg_proto_bank_v0_txt msp
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'msp_plthresh07', 'AUC': 0.9671919150000001, 'FPR95': 0.2, 'ACC_ALL': 0.8595, 'ACC_ID': 0.8039, 'ACC_OOD': 0.9231, 'ACC_HM': 0.8593863231036479}

Online evaluation: Top-1 accuracy: 85.9500; Top-5 accuracy: 98.9000




Namespace(N_m=512, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='VisdaOOD', level=5, model='maple', model_type='ViT-B/16', ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='ft_pl_neg_proto_bank_v0', workers=4)


{'ID_class_descriptions': {'aeroplane': ['An airplane typically has two wings and one main body.', 'An airplane is a large, metal aircraft with wings that help it fly.', 'An airplane is a large, metal object with wings.', 'An airplane typically has two wings and a tail.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane typically has two wings and a tail.', 'An airplane has large metal wings and a long body.', 'An airplane is a metal tube with wings that has dozens of seats inside of it for passengers to sit in.', 'An airplane is a large metal object with many wings and propellers.', 'An airplane is typically a long, thin metal tube with wings.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a large, metal bird that flies through the air.', 'An airplane is a powered flying vehicle with fixed wings and a weight greater than that of the air it displaces; an airplane relies on thrust from a jet engine, propeller, or rocket engines to provide the power required to push it through.', 'An airplane is a powered flying vehicle with fixed wings and a weight greater than that of the air it displaces; an airplane relies on thrust from a jet engine, propeller, or rocket engine to push it through the air.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a large, metal bird that flies through the air.', 'An airplane is a vehicle designed for air travel that has wings and one or more engines.', 'An airplane is a powered flying vehicle with fixed wings and a weight greater than that of the air it displaces; an airplane relies on thrust from a jet engine, propeller, or rocket engine to overcome drag and provide lift.', 'A typical airplane is a metal tube with wings and engines.', 'Some identifying characteristics of an airplane are that it has wings and it is a machine that is used for flying.', 'The identifying characteristics of an airplane are: wings, a tail, one or more engines, and a fuselage.', 'The identifying characteristics of an airplane are a long body with wings attached.', 'Some identifying characteristics of an airplane are that it has wings and it flies.', 'The identifying characteristics of an airplane are that it has wings and it flies.', 'Some identifying characteristics of an airplane are that it has wings and it flies.', 'The identifying characteristics of an airplane are its wings and its tail.', 'An airplane has wings and a tail.', 'The identifying characteristics of an airplane are typically its size, shape, and color.', 'The identifying characteristics of an airplane are its wings, engines, and tail.'], 'bicycle': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'bus': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'car': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'horse': ['A horse is a four-legged mammal with a long neck and a tail.', 'A horse is a quadruped mammal with a long face, neck, and legs.', 'A horse is a mammal with four legs, a long neck, and a big head with eyes on the sides of its head.', 'A horse is a mammal with four legs, a tail, and a mane.', 'A horse is a mammal with four legs, a mane, and a tail.', 'A horse is a quadruped mammal with sexually dimorphic coat colors.', 'A horse is a mammal with hooves, a mane, and a tail.', 'A horse is a quadrupeddian mammal with brown or black fur.', 'A horse has four legs, a tail, and a mane.', 'A horse has a long face, with two pointy ears on the top.', 'A horse is a four-legged mammal with a long neck and tail.', 'A horse is a four-legged mammal of the family Equidae.', 'A horse is a quadrupedal mammalian herbivore of the family Equidae.', 'A horse is a noble animal, one which has been revered by many cultures throughout history.', 'A horse is a four-legged mammal that is used for riding and racing.', 'Physical characteristics: Horses are large, four-legged animals with hooves.', 'A horse is a four-legged mammal with a long neck, mane, and tail.', 'A horse is a large, four-legged mammal with a long neck and tail.', 'A horse is a mammal of the family Equidae.', 'A horse is a mammalian creature with hooves and a long mane.', 'Horses arefour-legged animals with manes and tails.', 'size; proportions of body parts; color of hair; nature of mane and tail;Teeth;cranial bones; and the muscles of the neck, shoulder, and hindquarters.', 'Some common characteristics of horses are that they have long faces, manes, and tails.', 'A horse has a mane, a tail, and hooves.', 'The organizing characteristics of a horse are that it is a mammal with hooves, it is covered in hair, and it has a long face with a protruding snout.', 'Some identifying characteristics of a horse are that they are quadrupeds, have fruits and flowers as their diet, have a diploid chromosome number of 64, haveMEDIA TYPEa hoofed foot, and are hair-covered mammals.', 'A horse has four legs, a mane, and a tail.', 'The identifying characteristics of a horse are a head with large eyes, a long face, and large, long ears; a long neck; a chestnut coat; a mane and tail of long, coarse hair; and four legs with ho.', 'The identifying characteristics of a horse are that they are a four legged mammal with a long face, Mane, and tail.', 'Some of the identifying characteristics of a horse include: a long face, pointed ears, four legs, and a mane.'], 'knife': ['A cat is a small, carnivorous mammal.', 'Most cats are covered in fur, have four legs, a tail, and whiskers.', 'A cat has four legs, a tail, and fur.', 'A cat has fur, four legs, two ears, and a tail.', 'Cats are small, four-legged animals with furry coats, sharp claws, and whiskers on their face.', 'A domesticated cat is a small, usually furry, carnivorous mammal.', 'A cat typically has fur, four legs, a tail, and whiskers.', 'A cat is a small, furred, carnivorous mammal.', 'Cats are carnivorous mammals of the Felidae family.', 'A cat is a small, furry creature with four legs, a tail, and whiskers.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small, four-legged, carnivorous mammal.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small, typically furry, carnivorous mammal.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small carnivorous mammal.', 'A cat is a small, carnivorous mammal of the Felidae family.', 'A cat is a small, furry animal with sharp claws and whiskers.', 'A cat is a small carnivorous mammal of the Felidae family.', 'A cat is a small, typically furry, carnivorous mammal.', ' Typically, cats have fur, four legs, two ears, and a tail.', 'The identifying characteristics of a cat include whiskers, fur, four legs, and a tail.', 'The defining characteristics of a cat are its whiskers, its retractable claws, and its pupils that contract to slits when exposed to bright light.', 'Are you asking for physical characteristics or personality traits?.', 'A cat is a small carnivorous mammal of the Felidae family.', 'Cats have whiskers, four legs, a tail, fur, and they meow.', 'The most common domestic cat is the brown tabby.', "A cat's whiskers, eyes, and ears are its most distinctive features.", 'There are many different types of cats, so there are no specific identifying characteristics that all cats have.', 'The most common identifying characteristics of a cat are their fur, whiskers, and tails.'], 'motorcycle': ['Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile typically has four wheels and seat four to eight people.', 'An automobile typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a self-propelled vehicle that typically has four tires and four doors.', 'An automobile looks like a car.', 'An automobile is a vehicle with four wheels that is powered by an engine.', 'Most cars have four doors, four seats, a steering wheel, leather upholstery, and a metal frame.', 'Automobiles typically have four tires, four doors, and seat five passengers.', 'An automobile looks like a car.', 'An automobile has a long, metal body with four round, black wheels.', 'A car is a vehicle with four wheels that is powered by an engine.', 'An automobile is a wheeled, self-powered vehicle used for transportation.', 'An automobile is usually a four-wheeled vehicle designed for passenger transportation.', 'An automobile is a vehicle with four or more wheels that is used for transportation on roads.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'An automobile is a self-propelled vehicle, typically with four wheels, that is used for transport.', 'Most automobiles have four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle that typically contains four metal plates that hinge along the vertical y-axis to open and provide entry into the car for the passengers.', 'An automobile is a vehicle with four or more wheels that is propelled by an internal combustion engine.', 'An automobile is a vehicle with four or more wheels that is used for transportation.', 'Some identifying characteristics of an automobile are that it has four wheels, it usually has a steering wheel, and people usually sit inside of it to drive it.', 'Some identifying characteristics of an automobile are that it has four wheels and a steering wheel.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and seats.', 'An automobile typically has four wheels and is powered by an internal combustion engine.', 'There are many identifying characteristics of an automobile.', 'The identifying characteristics of an automobile typically include four metal plates with numbers and/or letters assigned by a government agency, four inflated rubber discs to create rolling contact with the ground, and a system of internally-combusting hydraulics that use.', 'Some identifying characteristics of an automobile are that it has four tires, a steering wheel, and an engine.', 'Its identifying characteristics are its make, model, and year.', 'There are many identifying characteristics of an automobile, but some of the most common are: four wheels, an engine, seats, headlights, and taillights.', 'Some identifying characteristics of an automobile are four wheels, a steering wheel, an engine, and seats for passengers.'], 'person': ['Deer have four legs and a tail.', 'A deer is a hoofed mammal with antlers.', 'A deer is a four-legged mammal that typically has brown fur and antlers on its head.', 'A deer is a four-legged mammal with hooves.', 'A deer is a four-legged mammal with hooves.', 'A deer is a four-legged, hoofed mammal that is covered in brown fur.', 'A deer is a four-legged mammal with brown fur.', 'A deer is a four-legged mammal that typically has a reddish-brown coat.', 'The deer is a four-legged mammal with brown fur and antlers.', 'A deer has a long neck, four legs, and a tail.', 'A deer is a mammal with four legs, a tail, and antlers.', 'A deer is a four-legged mammal that typically has a reddish-brown coat.', 'A deer is a hoofed mammal with antlers, typically a male, that feeds on plants and leaves.', 'A deer is a hoofed mammal with brown fur.', 'A deer is a timid and graceful creature.', 'A deer has brown fur and four legs.', 'A deer is a four-legged mammal that typically has a reddish-brown coat.', 'A deer is a four-legged mammal with a thin coat of fur.', 'A deer is a four-legged mammal that is covered in fur.', ' deer are four-legged, hoofed mammals that are members of the family Cervidae.', 'Fur that is red-brown in the summer and gray-brown in the winter; a white belly; a white rump in the shape of a V; antlers on the males.', 'Some identifying characteristics of a deer are that they have four long legs, hooves, antlers, and a wide tail.', 'The identifying characteristics of a deer are its hooves, its antlers, and its fur.', 'Deer are four-legged animals with hooves.', 'One of the most identifying characteristics of a deer is its antlers.', 'Some identifying characteristics of deer are that they have four legs, two eyes, two ears, and they are covered in fur.', 'The identifying characteristics of a deer are its antlers, its fur, and its hooves.', 'The identifying characteristics of a deer are its hooves, antlers, and tail.', 'The identify characteristics of a deer are that they are a hoofed mammal with antlers on males.', 'The identifying characteristics of a deer are: Keen eyesight, Excellent hearing, Good sense of smell, Foot pads that have cushioning to absorb shock, and Hooves that are split to allow for flexibility.'], 'plant': ['A dog is a brown, furry animal with a tail.', 'Dogs are typically four-legged mammals with a tail and fur.', 'A dog typically has four legs, a tail, and a head with facial features including a nose and eyes.', '.', 'A dog has four legs, a tail, and a head with big ears.', 'Most dogs have four legs, a tail, and a head with two ears.', 'A is a four-legged Mammal with a tail.', 'A dog has four legs and a tail.', 'A dog is a four-legged mammal that has a tail, fur, and follows commands.', 'A dog typically has four legs, a tail, and fur.', 'A dog is a four-legged mammal of the family Canidae.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'Dogs are playful, friendly, and loyal animals.', 'A dog is a Mammal.', 'A dog is a four-legged mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog is a four-legged mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', ' A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog is a Mammal of the Canidae family.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'A dog typically has four legs, a tail, and fur.', 'The identifying characteristics of a dog are four legs, a tail, a head, and a body.', 'A dog is a mammal of the family Canidae, typically a quadruped with mammalian characteristics and breed for the purpose of hunting with or without assistance.', 'The identifying characteristics of a dog are: four legs, a tail, fur, and a face with two eyes, a nose, and a mouth.', 'The identifying characteristics of a dog include four legs, a tail, fur, and a head with eyes, a nose, and a mouth.', 'Some identifying characteristics of a dog are that they are a mammal, they are a vertebrate, they are a carnivore, and they have four legs.', 'The identifying characteristics of a dog are that it is a mammal, it has four legs, it has fur, and it barks.', 'Identifying characteristics of a dog include four legs, a tail, and fur.', 'Some identifying characteristics of dogs are that they have four legs, fur, and a tail.', 'Some identifying characteristics of a dog are that they are a mammal, have four legs, a tail, and bark.'], 'skateboard': ['A frog has a wide mouth, webbed feet, and smooth, wet skin.', 'A frog is a small, tailless amphibian that has webbed feet and long hind legs for jumping.', 'A frog is a small amphibian that has a short body and long legs.', '.', 'A frog is a small, tailless amphibian that typically has a green body with dark spots.', 'Frogs are small, tailless amphibians with long, Powerful hind legs for leaping, and webbed feet for swimming.', 'A frog looks like a small, tailless amphibian that typically has green or brown skin,webbed feet, and bulging eyes.', 'Most frogs have a green body, though some species can be brown, grey, or cyan.', 'Most frogs have a body that is green, brown, or gray with spots.', 'Frogs are small, tailless amphibians with bulging eyes, moist skin, and long hind legs for leaping.', 'A frog is a small, tailless amphibian with moist, smooth skin and long hind legs for jumping.', 'A frog is an amphibian that typically has a short body, webbed feet, and protruding eyes.', 'A frog is a small, tailless amphibian with long, webbed hind feet.', 'Frogs are amphibians, which means they can live in water or on land.', 'Frogs are amphibians.', 'Frogs have long, muscular legs that help them jump long distances.', 'A frog is a small, tailless amphibian with long hind legs, webbed toes, and protruding eyes.', 'Frogs are amphibians and have smooth, moist skin.', 'A frog is a green or brown amphibian that lives near ponds and marshes.', 'A frog typically has a body that is green and brown with spots.', 'The identifying characteristics of a frog are its long, powerful hind legs; its short,ening arms; its webbed feet; its bulging, slippery skin; and its large, moist eyes.', ' frogs have moist skin, They live in water or on land but return to water to lay their eggs.', 'The identifying characteristics of a frog are that it has a wide mouth, bulging eyes, and long hind legs.', 'The identifying characteristics of a frog are that it has a short body, long legs, and webbed feet.', 'Some identifying characteristics of a frog are that they have a slimy body, they can jump very high, and they croak.', 'Some common characteristics of frogs are that they have moist smooth skin, long hind legs for jumping, large eyes, and a long protruding tongue.', 'A frog is a small amphibian that typically has a short body, webbed digits, protruding eyes, and a smooth or warty skin.', 'Frogs typically have a short, squat body and long hind legs that are ideal for jumping.', 'Some identifying characteristics of a frog are that they have bug eyes, they are good swimmers, and they can jump high.', 'The amphibian class includes the frog.'], 'train': ['Most ships are large and made of metal.', 'A ship looks like a large boat that is used for carrying people or cargo across water.', 'A large boat that is used to travel across water.', 'A ship looks like a large boat that is used for transport on water.', 'A typical merchant ship has three masts and is square-rigged on the foremast and mainmast.', 'A ship can be different sizes, but they generally have a large body with lots of cargo space.', 'A ship is a large, ocean-going vessel.', 'A ship is a large, ocean-going vessel that is used to transport people, cargo, or both.', 'A ship typically has a large hull, one or more decks, one or more masts with sails, and a rudder.', 'Ships are large, ocean-going vessels that are used for transportation or for carrying cargo.', 'The Titanic was a ship that was built in 1912.', 'The ship is long and thin, with a large sail in the middle.', 'A ship is a large vessel that is used to travel on water.', 'A ship typically refers to a large, ocean-going vessel.', 'A long, narrow boat with tall sides, used for carrying goods or passengers across water.', 'A ship is a large, ocean-going vessel designed to carry people, cargo, or both.', 'A large vessel that is designed to carry passengers or cargo, or both, across a body of water.', 'A ship is a large, ocean-going vessel designed to carry cargo or passengers, or both.', 'A ship is a large, ocean-going vessel.', 'A ship is a large, ocean-going vessel that is used for transporting people or goods.', 'The shape of a ship is long and thin.', 'A ship typically has a large and tall superstructure, a long hull, and a deep draft.', 'The identifying characteristics of a ship are its size, shape, color, and identifying marks.', 'The size, shape, and structure of a ship.', 'The bow, stern, keel, and rudder.', 'Some identifying characteristics of a ship are its size, color, and shape.', 'The identifying characteristics of a ship include its length, beam, draft, gross tonnage, and net tonnage.', 'Some identifying characteristics of ships are their size, shape, and color.', 'The identifying characteristics of a ship are its length, beam, draft, and tonnage.', 'The identifying characteristics of a ship is the name on its bow.'], 'truck': ['A truck is a large, heavy-duty vehicle used for carrying goods.', 'A truck typically has four tires, a large cab with space for passengers or storage, and a cargo area for hauling large items.', 'A truck is a vehicle with four wheels that is used to carry goods.', 'A truck is a vehicle with four wheels that is used to carry heavy objects.', 'A truck is a vehicle with four wheels that is used to carry goods from one place to another.', 'A truck is a vehicle with four wheels that is used for carrying goods.', 'A truck looks like a large vehicle with four wheels that is used to transport goods.', 'A truck is a large, heavy vehicle with four wheels, designed to carry goods by road.', 'A truck is a vehicle with four wheels that is used to transport goods.', 'A truck is a large vehicle with four wheels that is used to transport goods.', 'Trucks are large, roughly rectangular vehicles designed for hauling cargo.', 'A truck is a large vehicle with either four or six wheels that is used to transport goods or materials.', 'A truck is a vehicle designed to transport goods or materials.', 'A truck is a four-wheeled vehicle designed to carry heavy loads.', 'A truck is a vehicle with four wheels that is used to carry goods.', 'A truck is a large, heavy vehicle with four wheels that is used for transporting goods.', 'A truck is a vehicle that is used for carrying large loads or for towing other vehicles.', 'A truck is a vehicle designed to carry goods or materials.', 'A truck is a large vehicle typically used for carrying heavy loads or pulling trailers.', 'A truck is a large, heavy vehicle used for transporting goods or materials.', 'Some identifying characteristics of a truck are that they usually have a large cargo area, they are taller than a car, and they have a heavier frame.', 'A truck has a large, rectangular body and a large cargo area.', 'Trucks tend to be large and boxy, with four wheels and a heavy-duty engine.', 'The identifying characteristics of a truck are its large size, four wheels, and engine.', 'Some identifying characteristics of a truck are that they are larger and have a higher ground clearance than a car, they have a longer wheelbase, they have a higher payload and can tow more, and they have four-wheel drive.', 'Size, shape, and function.', 'The identifying characteristics of a truck are four wheels, a steering wheel, and a motor.', 'The identifying characteristics of a truck are a large body, four wheels, and a bed for hauling cargo.', 'A truck has a large and flat surface on the back, where items can be placed.', 'The identifying characteristics of a truck are its size, its weight, and its load capacity.']}, 'ID_classes': ['aeroplane', 'bicycle', 'bus', 'car', 'horse', 'knife', 'motorcycle', 'person', 'plant', 'skateboard', 'train', 'truck'], 'N_classes': 12, 'templates': ['a photo of a {}.', 'a blurry photo of a {}.', 'a black and white photo of a {}.', 'a low contrast photo of a {}.', 'a high contrast photo of a {}.', 'a bad photo of a {}.', 'a good photo of a {}.', 'a photo of a small {}.', 'a photo of a big {}.', 'a photo of the {}.', 'a blurry photo of the {}.', 'a black and white photo of the {}.', 'a low contrast photo of the {}.', 'a high contrast photo of the {}.', 'a bad photo of the {}.', 'a good photo of the {}.', 'a photo of the small {}.', 'a photo of the big {}.']}
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/train_32x32.mat
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.8580; Top5: 0.9918
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8580246913580247, 'ACC_ID': 0.6666666666666666, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 1999: Top1: 0.8606; Top5: 0.9930
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8595787362086259, 'ACC_ID': 0.6680040120361084, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 2999: Top1: 0.8576; Top5: 0.9933
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8570474281897128, 'ACC_ID': 0.657314629258517, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 3999: Top1: 0.8567; Top5: 0.9905
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8562874251497006, 'ACC_ID': 0.653692614770459, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 4999: Top1: 0.8578; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8574850299401198, 'ACC_ID': 0.649500998003992, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 5999: Top1: 0.8575; Top5: 0.9897
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8572377158034529, 'ACC_ID': 0.6547144754316069, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 6999: Top1: 0.8588; Top5: 0.9906
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8585254768004554, 'ACC_ID': 0.6646740677483632, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 7999: Top1: 0.8571; Top5: 0.9903
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8569292123629113, 'ACC_ID': 0.6699900299102692, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 8999: Top1: 0.8556; Top5: 0.9907
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8553305141330959, 'ACC_ID': 0.6723792566214111, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 9999: Top1: 0.8563; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8560833834435758, 'ACC_ID': 0.6768891561435157, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 10999: Top1: 0.8562; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8558738216098623, 'ACC_ID': 0.6789340101522843, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 11999: Top1: 0.8577; Top5: 0.9899
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8575219771106319, 'ACC_ID': 0.6783877923370376, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 12999: Top1: 0.8570; Top5: 0.9902
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8568793235972328, 'ACC_ID': 0.6773251345119139, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 13999: Top1: 0.8564; Top5: 0.9897
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8562678062678063, 'ACC_ID': 0.6754985754985755, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 14999: Top1: 0.8569; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8568015925680159, 'ACC_ID': 0.6759124087591241, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 15999: Top1: 0.8570; Top5: 0.9903
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8568933250155958, 'ACC_ID': 0.6731129132875858, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 16999: Top1: 0.8568; Top5: 0.9905
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8566560921160851, 'ACC_ID': 0.6719539419574668, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 17999: Top1: 0.8570; Top5: 0.9900
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8569370567375887, 'ACC_ID': 0.6706560283687943, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 18999: Top1: 0.8581; Top5: 0.9899
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8580441640378549, 'ACC_ID': 0.6690851735015773, 'ACC_OOD': 0, 'ACC_HM': 0}

Step 19999: Top1: 0.8583; Top5: 0.9895
{'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8582, 'ACC_ID': 0.6676, 'ACC_OOD': 0, 'ACC_HM': 0}



VisdaOOD SVHN ft_pl_neg_proto_bank_v0_txt maxlogit
Metrics: {'Method': 'ft_pl_neg_proto_bank_v0_txt', 'OOD Detector': 'maxlogit_plthresh07', 'AUC': 0.9296434849999999, 'FPR95': 0.5049, 'ACC_ALL': 0.8582, 'ACC_ID': 0.6676, 'ACC_OOD': 0.9691, 'ACC_HM': 0.7905800207735078}

Online evaluation: Top-1 accuracy: 85.8300; Top-5 accuracy: 98.9500







