1 1
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp1_kn1

Step 999: Top1: 0.7315; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.5971943887775552, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7503; Top5: 0.9455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7512846865364851, 'ACC_ID': 0.6073997944501541, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7575; Top5: 0.9506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7583444592790387, 'ACC_ID': 0.6201602136181575, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7580; Top5: 0.9512
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7581699346405228, 'ACC_ID': 0.6400201106083458, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7546; Top5: 0.9527
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7554129911788292, 'ACC_ID': 0.6507618283881316, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7438; Top5: 0.9521
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7440931780366057, 'ACC_ID': 0.6499168053244593, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7455; Top5: 0.9509
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7455536431440046, 'ACC_ID': 0.6534710269650029, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7421; Top5: 0.9512
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7420960916106547, 'ACC_ID': 0.6547174508339557, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7427; Top5: 0.9517
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7427937915742794, 'ACC_ID': 0.655210643015521, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7433; Top5: 0.9527
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7433433433433433, 'ACC_ID': 0.66006006006006, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7413; Top5: 0.9523
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7412663755458515, 'ACC_ID': 0.6568413391557496, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7374; Top5: 0.9511
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7374833110814419, 'ACC_ID': 0.6527036048064085, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7363; Top5: 0.9496
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7361689012174449, 'ACC_ID': 0.6504854368932039, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7336; Top5: 0.9493
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7338283592745966, 'ACC_ID': 0.646865629016136, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7352; Top5: 0.9500
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7353411513859275, 'ACC_ID': 0.6475213219616205, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7362; Top5: 0.9508
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7363283694155925, 'ACC_ID': 0.6484795394819172, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7389; Top5: 0.9516
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7389718856605105, 'ACC_ID': 0.6526291024585343, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7392; Top5: 0.9521
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7393095768374165, 'ACC_ID': 0.6564587973273942, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7392; Top5: 0.9520
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7392498679344955, 'ACC_ID': 0.6600105652403592, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7388; Top5: 0.9517
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7389, 'ACC_ID': 0.6628, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33127689 0.29453719 ... 0.17188397 0.17181939 0.12949866]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 73.8800; Top-5 accuracy: 95.1700
{'Method': 'rosita_knn_txt', 'AUC': 0.94827335, 'FPR95': 0.3754, 'ACC_ALL': 0.7389, 'ACC_ID': 0.6628, 'ACC_OOD': 0.9794, 'ACC_HM': 0.7905813177444891, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp1_kn1

Step 999: Top1: 0.7355; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7374749498997996, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7503; Top5: 0.9404
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7512846865364851, 'ACC_ID': 0.6289825282631039, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7502; Top5: 0.9486
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7516688918558078, 'ACC_ID': 0.6315086782376502, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7545; Top5: 0.9542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7551533433886375, 'ACC_ID': 0.6390145801910507, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7610; Top5: 0.9563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7610264635124299, 'ACC_ID': 0.6523656776263032, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7534; Top5: 0.9561
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7534109816971714, 'ACC_ID': 0.648252911813644, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7538; Top5: 0.9570
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7541594951233506, 'ACC_ID': 0.6474469305794607, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7533; Top5: 0.9564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7535474234503361, 'ACC_ID': 0.6455065969629077, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7483; Top5: 0.9523
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7485587583148559, 'ACC_ID': 0.6441241685144125, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7457; Top5: 0.9497
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7457457457457457, 'ACC_ID': 0.6428428428428429, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7413; Top5: 0.9476
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7412663755458515, 'ACC_ID': 0.6393740902474527, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7378; Top5: 0.9464
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7378170894526035, 'ACC_ID': 0.6388518024032043, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7384; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7383263985205732, 'ACC_ID': 0.6423177685313608, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7366; Top5: 0.9460
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7368270741110953, 'ACC_ID': 0.6421533628444952, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7369; Top5: 0.9456
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7370735607675906, 'ACC_ID': 0.6435234541577826, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7374; Top5: 0.9462
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7375797772494056, 'ACC_ID': 0.644725315980478, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7376; Top5: 0.9468
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.737677920244677, 'ACC_ID': 0.6425126455711093, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7366; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7366369710467706, 'ACC_ID': 0.6424276169265033, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7346; Top5: 0.9454
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7344955097728473, 'ACC_ID': 0.6406761753829899, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7320; Top5: 0.9444
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.732, 'ACC_ID': 0.6389, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.32763612 0.28832278 ... 0.17780346 0.17768982 0.13000861]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 73.2000; Top-5 accuracy: 94.4400
{'Method': 'rosita_knn_txt', 'AUC': 0.92273819, 'FPR95': 0.4622, 'ACC_ALL': 0.732, 'ACC_ID': 0.6389, 'ACC_OOD': 0.9347, 'ACC_HM': 0.7589982587697001, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=1, level=5, loss_pl=True, loss_simclr=True, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp1_kn1

Step 999: Top1: 0.7355; Top5: 0.9439
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.5891783567134269, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7492; Top5: 0.9404
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7492291880781089, 'ACC_ID': 0.6197327852004111, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7548; Top5: 0.9499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7550066755674232, 'ACC_ID': 0.6341789052069426, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7611; Top5: 0.9542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7611865258924082, 'ACC_ID': 0.6530920060331825, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7634; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7630312750601443, 'ACC_ID': 0.6579791499599038, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7541; Top5: 0.9557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7540765391014975, 'ACC_ID': 0.6449251247920134, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7549; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7550200803212851, 'ACC_ID': 0.6434308663224326, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7570; Top5: 0.9582
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7570326114015434, 'ACC_ID': 0.6400298730395818, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7591; Top5: 0.9590
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7592017738359201, 'ACC_ID': 0.6430155210643016, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7639; Top5: 0.9604
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7639639639639639, 'ACC_ID': 0.645045045045045, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7649; Top5: 0.9605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.764919941775837, 'ACC_ID': 0.638646288209607, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7623; Top5: 0.9599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7623497997329773, 'ACC_ID': 0.6325100133511349, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7639; Top5: 0.9593
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7637540453074434, 'ACC_ID': 0.6336877793188472, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7628; Top5: 0.9589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7628159360274168, 'ACC_ID': 0.6357275453377124, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7639; Top5: 0.9591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7638592750533049, 'ACC_ID': 0.6313965884861408, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7652; Top5: 0.9591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7652358903766737, 'ACC_ID': 0.629082718057815, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7667; Top5: 0.9588
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7666156922714975, 'ACC_ID': 0.6301611575108811, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7656; Top5: 0.9588
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7655902004454342, 'ACC_ID': 0.6312917594654789, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7631; Top5: 0.9589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7630216587427364, 'ACC_ID': 0.6288431061806656, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7635; Top5: 0.9587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7634, 'ACC_ID': 0.6286, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.32265729 0.31281179 ... 0.16723064 0.16654831 0.1578511 ]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.3500; Top-5 accuracy: 95.8700
{'Method': 'rosita_knn_txt', 'AUC': 0.816665575, 'FPR95': 0.6701, 'ACC_ALL': 0.7634, 'ACC_ID': 0.6286, 'ACC_OOD': 0.7599, 'ACC_HM': 0.6880419733525388, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp1_kn1

Step 999: Top1: 0.7335; Top5: 0.9439
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.6593186372745491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7482; Top5: 0.9424
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7492291880781089, 'ACC_ID': 0.6896197327852004, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7535; Top5: 0.9506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7543391188251002, 'ACC_ID': 0.6969292389853138, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7565; Top5: 0.9552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7571644042232277, 'ACC_ID': 0.7083961789844143, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7578; Top5: 0.9579
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7582197273456295, 'ACC_ID': 0.7125100240577386, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7504; Top5: 0.9557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7507487520798669, 'ACC_ID': 0.7011647254575707, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7521; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7524383247274814, 'ACC_ID': 0.6996557659208261, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7558; Top5: 0.9574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7560368434154842, 'ACC_ID': 0.7015185461787403, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7589; Top5: 0.9581
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7592017738359201, 'ACC_ID': 0.7037694013303769, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7633; Top5: 0.9594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7637637637637638, 'ACC_ID': 0.7071071071071071, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7636; Top5: 0.9592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7640101892285298, 'ACC_ID': 0.7072416302765647, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7601; Top5: 0.9589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7605140186915887, 'ACC_ID': 0.7031041388518025, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7614; Top5: 0.9587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7617506549545384, 'ACC_ID': 0.7042687625211898, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7612; Top5: 0.9592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7616735684706555, 'ACC_ID': 0.7032700271312294, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7625; Top5: 0.9594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7629264392324094, 'ACC_ID': 0.7025586353944563, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7638; Top5: 0.9597
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7642347641096233, 'ACC_ID': 0.703166061819547, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7648; Top5: 0.9600
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7650864604164216, 'ACC_ID': 0.703564286554523, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7645; Top5: 0.9602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7646993318485523, 'ACC_ID': 0.7043429844097996, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7626; Top5: 0.9602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7628103539355521, 'ACC_ID': 0.7041732699418912, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7621; Top5: 0.9597
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7624, 'ACC_ID': 0.7037, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.3249684  0.31490749 ... 0.17899534 0.17899399 0.1373716 ]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.2100; Top-5 accuracy: 95.9700
{'Method': 'rosita_knn_txt', 'AUC': 0.881684215, 'FPR95': 0.4193, 'ACC_ALL': 0.7624, 'ACC_ID': 0.7037, 'ACC_OOD': 0.751, 'ACC_HM': 0.7265810132673404, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp1_kn1

Step 999: Top1: 0.5170; Top5: 0.7615
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3306613226452906, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5026; Top5: 0.7605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5025693730729702, 'ACC_ID': 0.32168550873586843, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4930; Top5: 0.7502
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.493324432576769, 'ACC_ID': 0.32710280373831774, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4960; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49572649572649574, 'ACC_ID': 0.3479135243841126, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4956; Top5: 0.7462
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4955894145950281, 'ACC_ID': 0.3528468323977546, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4912; Top5: 0.7424
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49118136439267884, 'ACC_ID': 0.3574043261231281, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4890; Top5: 0.7406
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48881239242685026, 'ACC_ID': 0.3614457831325301, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4852; Top5: 0.7379
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4851879512073687, 'ACC_ID': 0.36544685088374407, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4824; Top5: 0.7356
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48226164079822614, 'ACC_ID': 0.3674057649667406, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4804; Top5: 0.7341
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4804804804804805, 'ACC_ID': 0.367967967967968, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4820; Top5: 0.7371
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48180494905385735, 'ACC_ID': 0.37063318777292575, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4777; Top5: 0.7348
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47763684913217624, 'ACC_ID': 0.36765687583444595, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4790; Top5: 0.7352
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4788102943442749, 'ACC_ID': 0.3701648944367391, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4787; Top5: 0.7358
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47865200628302157, 'ACC_ID': 0.3706982721690704, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4785; Top5: 0.7357
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47841151385927505, 'ACC_ID': 0.3712686567164179, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4766; Top5: 0.7348
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4765361031160055, 'ACC_ID': 0.3711675635089476, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4776; Top5: 0.7346
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4775908716621574, 'ACC_ID': 0.37430890483472534, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4773; Top5: 0.7357
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4771714922048998, 'ACC_ID': 0.3769487750556793, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4774; Top5: 0.7355
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47723190702588486, 'ACC_ID': 0.3774960380348653, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4793; Top5: 0.7377
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4792, 'ACC_ID': 0.3792, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35517251 0.30758619 ... 0.20645599 0.20641349 0.18384062]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 47.9300; Top-5 accuracy: 73.7700
{'Method': 'rosita_knn_txt', 'AUC': 0.8590196050000001, 'FPR95': 0.6975, 'ACC_ALL': 0.4792, 'ACC_ID': 0.3792, 'ACC_OOD': 0.9101, 'ACC_HM': 0.535344636624525, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp1_kn1

Step 999: Top1: 0.5150; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5036; Top5: 0.7544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5046248715313464, 'ACC_ID': 0.33093525179856115, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4970; Top5: 0.7435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4986648865153538, 'ACC_ID': 0.33978638184245663, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5050; Top5: 0.7450
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5062845651080945, 'ACC_ID': 0.34338863750628457, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5080; Top5: 0.7486
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5092221331194867, 'ACC_ID': 0.34643143544506816, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5092; Top5: 0.7534
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5101497504159733, 'ACC_ID': 0.3504159733777038, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5076; Top5: 0.7549
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5083189902467011, 'ACC_ID': 0.3548479632816982, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5016; Top5: 0.7498
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5023649489668908, 'ACC_ID': 0.35449340303709237, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4952; Top5: 0.7418
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4957871396895787, 'ACC_ID': 0.3501108647450111, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4816; Top5: 0.7271
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48228228228228226, 'ACC_ID': 0.34034034034034033, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4691; Top5: 0.7111
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4696142649199418, 'ACC_ID': 0.33133187772925765, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4518; Top5: 0.6932
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4522696929238985, 'ACC_ID': 0.32142857142857145, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4444; Top5: 0.6850
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44475265834489136, 'ACC_ID': 0.3193096008629989, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4436; Top5: 0.6825
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4439525917463944, 'ACC_ID': 0.3195773240039983, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4439; Top5: 0.6838
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44429637526652455, 'ACC_ID': 0.3220948827292111, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4406; Top5: 0.6824
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4409961206357152, 'ACC_ID': 0.3221123764234764, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4375; Top5: 0.6822
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4379484766498059, 'ACC_ID': 0.3217268556640395, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4353; Top5: 0.6801
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4356347438752784, 'ACC_ID': 0.321826280623608, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4325; Top5: 0.6784
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43275224511357635, 'ACC_ID': 0.32097200211304805, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4310; Top5: 0.6781
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4314, 'ACC_ID': 0.3214, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34794065 0.30573747 ... 0.17433114 0.1729987  0.15540472]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 43.1100; Top-5 accuracy: 67.8100
{'Method': 'rosita_knn_txt', 'AUC': 0.7911419000000001, 'FPR95': 0.789, 'ACC_ALL': 0.4314, 'ACC_ID': 0.3214, 'ACC_OOD': 0.8959, 'ACC_HM': 0.473083479832416, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp1_kn1

Step 999: Top1: 0.5170; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3406813627254509, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5077; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5077081192189106, 'ACC_ID': 0.35765673175745116, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4990; Top5: 0.7495
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4993324432576769, 'ACC_ID': 0.36248331108144194, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5075; Top5: 0.7520
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5082956259426847, 'ACC_ID': 0.37506284565108094, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5104; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5112269446672013, 'ACC_ID': 0.37650360866078586, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5131; Top5: 0.7581
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5141430948419301, 'ACC_ID': 0.37803660565723796, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5125; Top5: 0.7593
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5131956397016638, 'ACC_ID': 0.38009179575444635, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5123; Top5: 0.7583
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5130694548170276, 'ACC_ID': 0.37789395070948467, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5141; Top5: 0.7587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5144124168514412, 'ACC_ID': 0.3764966740576497, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5104; Top5: 0.7581
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5109109109109109, 'ACC_ID': 0.37537537537537535, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5118; Top5: 0.7593
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5121906841339156, 'ACC_ID': 0.37754730713246, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5059; Top5: 0.7558
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5061748998664887, 'ACC_ID': 0.37232977303070763, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5077; Top5: 0.7568
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5079365079365079, 'ACC_ID': 0.37586685159500693, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5051; Top5: 0.7576
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5054976438669142, 'ACC_ID': 0.37455376267314006, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5040; Top5: 0.7572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5042643923240938, 'ACC_ID': 0.37460021321961623, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5021; Top5: 0.7562
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5024402452759354, 'ACC_ID': 0.37316981604304844, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5013; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5015880484648865, 'ACC_ID': 0.3730149394188919, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5003; Top5: 0.7552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.500445434298441, 'ACC_ID': 0.37271714922049, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4985; Top5: 0.7550
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4987849973586899, 'ACC_ID': 0.37083993660855785, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4987; Top5: 0.7568
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4987, 'ACC_ID': 0.3705, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35097992 0.33065537 ... 0.18362036 0.18289655 0.172296  ]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 49.8700; Top-5 accuracy: 75.6700
{'Method': 'rosita_knn_txt', 'AUC': 0.702757325, 'FPR95': 0.8562, 'ACC_ALL': 0.4987, 'ACC_ID': 0.3705, 'ACC_OOD': 0.7004, 'ACC_HM': 0.48463572695863294, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp1_kn1

Step 999: Top1: 0.5150; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150300601202404, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4974; Top5: 0.7585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4984583761562179, 'ACC_ID': 0.3607399794450154, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4937; Top5: 0.7488
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4939919893190921, 'ACC_ID': 0.35847797062750336, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4990; Top5: 0.7470
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4997486173956762, 'ACC_ID': 0.37606837606837606, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5012; Top5: 0.7466
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5020048115477145, 'ACC_ID': 0.3781074578989575, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5038; Top5: 0.7471
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5044925124792013, 'ACC_ID': 0.3790349417637271, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5024; Top5: 0.7506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5028686173264486, 'ACC_ID': 0.3780837636259323, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5019; Top5: 0.7523
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5023649489668908, 'ACC_ID': 0.376151356733881, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5045; Top5: 0.7525
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.50509977827051, 'ACC_ID': 0.376940133037694, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5006; Top5: 0.7513
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5013013013013013, 'ACC_ID': 0.37457457457457455, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5027; Top5: 0.7507
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5032751091703057, 'ACC_ID': 0.37590975254730713, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4966; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4969959946595461, 'ACC_ID': 0.36949265687583444, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4985; Top5: 0.7483
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49884419787332407, 'ACC_ID': 0.3715518569887502, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4966; Top5: 0.7494
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49707268313579894, 'ACC_ID': 0.3712694559474511, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4967; Top5: 0.7495
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4970682302771855, 'ACC_ID': 0.3718017057569296, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4945; Top5: 0.7493
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49493179827305717, 'ACC_ID': 0.36866474784132147, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4944; Top5: 0.7494
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49476532172685567, 'ACC_ID': 0.36736854487707327, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4937; Top5: 0.7499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4939866369710468, 'ACC_ID': 0.3674832962138085, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4930; Top5: 0.7489
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49329107237189646, 'ACC_ID': 0.36661384046487056, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4922; Top5: 0.7493
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4925, 'ACC_ID': 0.3672, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35337436 0.35150778 ... 0.18498993 0.18466911 0.17454399]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 49.2200; Top-5 accuracy: 74.9200
{'Method': 'rosita_knn_txt', 'AUC': 0.67813639, 'FPR95': 0.8293, 'ACC_ALL': 0.4925, 'ACC_ID': 0.3672, 'ACC_OOD': 0.6763, 'ACC_HM': 0.4759700239578342, 'kp': 1, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




1 3
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp1_kn3

Step 999: Top1: 0.7355; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.6032064128256514, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7503; Top5: 0.9466
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.750256937307297, 'ACC_ID': 0.6207605344295992, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7442; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7449933244325768, 'ACC_ID': 0.6388518024032043, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7440; Top5: 0.9462
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7440925087983912, 'ACC_ID': 0.6530920060331825, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7426; Top5: 0.9503
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7429831595829992, 'ACC_ID': 0.656776263031275, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7341; Top5: 0.9478
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7344425956738768, 'ACC_ID': 0.6472545757071547, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7340; Top5: 0.9461
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7343660355708549, 'ACC_ID': 0.6376936316695353, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7279; Top5: 0.9430
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7281553398058253, 'ACC_ID': 0.627831715210356, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7230; Top5: 0.9408
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7232815964523281, 'ACC_ID': 0.6177383592017739, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7223; Top5: 0.9421
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7225225225225225, 'ACC_ID': 0.6126126126126126, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7187; Top5: 0.9421
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7188864628820961, 'ACC_ID': 0.6069868995633187, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7169; Top5: 0.9434
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7169559412550067, 'ACC_ID': 0.6073097463284379, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7159; Top5: 0.9431
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7159808907381723, 'ACC_ID': 0.6102635228848821, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7154; Top5: 0.9446
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7155504783664144, 'ACC_ID': 0.6145937455376267, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7175; Top5: 0.9451
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7176172707889126, 'ACC_ID': 0.6206023454157783, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7171; Top5: 0.9449
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7173069703416344, 'ACC_ID': 0.6245776498560881, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7187; Top5: 0.9458
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7189742383249029, 'ACC_ID': 0.6307493236089872, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7179; Top5: 0.9452
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7182628062360802, 'ACC_ID': 0.6339643652561248, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7172; Top5: 0.9460
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.717485472794506, 'ACC_ID': 0.637189646064448, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7168; Top5: 0.9460
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7171, 'ACC_ID': 0.6408, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34092343 0.30426651 ... 0.16519982 0.16516037 0.12693706]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 71.6800; Top-5 accuracy: 94.6000
{'Method': 'rosita_knn_txt', 'AUC': 0.95011394, 'FPR95': 0.3726, 'ACC_ALL': 0.7171, 'ACC_ID': 0.6408, 'ACC_OOD': 0.9813, 'ACC_HM': 0.7753122988718328, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp1_kn3

Step 999: Top1: 0.7335; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.6032064128256514, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7523; Top5: 0.9466
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7523124357656732, 'ACC_ID': 0.6207605344295992, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7562; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7563417890520694, 'ACC_ID': 0.6348464619492656, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7580; Top5: 0.9537
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7571644042232277, 'ACC_ID': 0.6495726495726496, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7578; Top5: 0.9543
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7574178027265437, 'ACC_ID': 0.6443464314354451, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7391; Top5: 0.9408
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7387687188019967, 'ACC_ID': 0.6232945091514143, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7286; Top5: 0.9314
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7280550774526678, 'ACC_ID': 0.6135972461273667, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7217; Top5: 0.9298
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7211849639034105, 'ACC_ID': 0.611899427433408, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7217; Top5: 0.9310
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7212860310421286, 'ACC_ID': 0.61529933481153, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7201; Top5: 0.9339
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7197197197197197, 'ACC_ID': 0.616016016016016, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7172; Top5: 0.9349
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7168850072780204, 'ACC_ID': 0.6111717612809315, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7149; Top5: 0.9344
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7147863818424566, 'ACC_ID': 0.6089786381842457, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7125; Top5: 0.9342
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7124364308830329, 'ACC_ID': 0.6079519186315303, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7055; Top5: 0.9337
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7052691703555619, 'ACC_ID': 0.6050264172497501, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7047; Top5: 0.9336
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7044243070362474, 'ACC_ID': 0.6050106609808102, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7016; Top5: 0.9343
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7014140908522087, 'ACC_ID': 0.6025528719809786, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7002; Top5: 0.9346
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7000352899658864, 'ACC_ID': 0.6008704858251971, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.6982; Top5: 0.9335
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6979955456570156, 'ACC_ID': 0.600445434298441, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.6959; Top5: 0.9337
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6957210776545166, 'ACC_ID': 0.5996830427892235, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.6932; Top5: 0.9335
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6931, 'ACC_ID': 0.5976, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33757153 0.3034454  ... 0.15455304 0.15442932 0.14246917]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 69.3200; Top-5 accuracy: 93.3500
{'Method': 'rosita_knn_txt', 'AUC': 0.9208783199999999, 'FPR95': 0.4734, 'ACC_ALL': 0.6931, 'ACC_ID': 0.5976, 'ACC_OOD': 0.958, 'ACC_HM': 0.7360514271020828, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp1_kn3

Step 999: Top1: 0.7375; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7394789579158316, 'ACC_ID': 0.6032064128256514, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7523; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7543679342240494, 'ACC_ID': 0.6361767728674204, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7555; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7556742323097463, 'ACC_ID': 0.6535380507343124, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7621; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7621920563097033, 'ACC_ID': 0.6626445449974862, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7630; Top5: 0.9599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7630312750601443, 'ACC_ID': 0.6639935846030474, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7571; Top5: 0.9597
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7577371048252912, 'ACC_ID': 0.6459234608985025, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7601; Top5: 0.9593
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7607573149741824, 'ACC_ID': 0.6454388984509466, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7623; Top5: 0.9594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7627582773213841, 'ACC_ID': 0.6447597709733632, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7616; Top5: 0.9585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7620842572062084, 'ACC_ID': 0.6407982261640798, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7635; Top5: 0.9592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7639639639639639, 'ACC_ID': 0.639039039039039, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7616; Top5: 0.9580
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7620087336244541, 'ACC_ID': 0.6291848617176128, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7586; Top5: 0.9573
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7590120160213618, 'ACC_ID': 0.625, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7597; Top5: 0.9568
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.759901371551857, 'ACC_ID': 0.6247495762058869, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7592; Top5: 0.9576
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7595316293017278, 'ACC_ID': 0.6244466657146936, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7600; Top5: 0.9579
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7602611940298507, 'ACC_ID': 0.6253997867803838, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7597; Top5: 0.9579
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.759979977474659, 'ACC_ID': 0.623326242022275, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7584; Top5: 0.9566
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7584990001176333, 'ACC_ID': 0.6234560639924714, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7536; Top5: 0.9542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7538975501113586, 'ACC_ID': 0.6208240534521158, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7481; Top5: 0.9528
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.748230322239831, 'ACC_ID': 0.6167987321711569, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7438; Top5: 0.9509
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.744, 'ACC_ID': 0.6122, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33400348 0.31169969 ... 0.1617634  0.16130701 0.16026263]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 74.3800; Top-5 accuracy: 95.0900
{'Method': 'rosita_knn_txt', 'AUC': 0.8067731349999999, 'FPR95': 0.7099, 'ACC_ALL': 0.744, 'ACC_ID': 0.6122, 'ACC_OOD': 0.7668, 'ACC_HM': 0.6808338796229152, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp1_kn3

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7374749498997996, 'ACC_ID': 0.6613226452905812, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7503; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7523124357656732, 'ACC_ID': 0.6947584789311408, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7482; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7489986648865153, 'ACC_ID': 0.6989319092122831, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7555; Top5: 0.9572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7561588738059326, 'ACC_ID': 0.7094017094017094, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7586; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7590216519647153, 'ACC_ID': 0.7125100240577386, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7527; Top5: 0.9604
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7530782029950083, 'ACC_ID': 0.6981697171381032, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7541; Top5: 0.9604
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7547332185886403, 'ACC_ID': 0.6982214572576019, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7540; Top5: 0.9592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7545431914363954, 'ACC_ID': 0.6942992282798108, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7532; Top5: 0.9579
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7534368070953437, 'ACC_ID': 0.6891352549889135, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7557; Top5: 0.9584
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.755955955955956, 'ACC_ID': 0.6888888888888889, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7558; Top5: 0.9571
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.756004366812227, 'ACC_ID': 0.6895924308588064, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7538; Top5: 0.9563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7540053404539386, 'ACC_ID': 0.6854138851802403, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7555; Top5: 0.9561
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7557404838958237, 'ACC_ID': 0.68777931884728, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7554; Top5: 0.9566
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.755533342853063, 'ACC_ID': 0.6875624732257604, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7563; Top5: 0.9570
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7563965884861408, 'ACC_ID': 0.6888326226012793, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7572; Top5: 0.9572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7573520210236516, 'ACC_ID': 0.6881491678137905, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7569; Top5: 0.9566
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7569697682625574, 'ACC_ID': 0.6870956358075521, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7550; Top5: 0.9560
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7551224944320712, 'ACC_ID': 0.6859688195991092, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7506; Top5: 0.9554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7506603275224512, 'ACC_ID': 0.6812466983623877, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7493; Top5: 0.9542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7494, 'ACC_ID': 0.6791, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33361286 0.32027653 ... 0.1767042  0.17670378 0.14359565]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 74.9300; Top-5 accuracy: 95.4200
{'Method': 'rosita_knn_txt', 'AUC': 0.86722532, 'FPR95': 0.469, 'ACC_ALL': 0.7494, 'ACC_ID': 0.6791, 'ACC_OOD': 0.7638, 'ACC_HM': 0.7189640030494144, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp1_kn3

Step 999: Top1: 0.5150; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3366733466933868, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4985; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.499486125385406, 'ACC_ID': 0.3319630010277492, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4910; Top5: 0.7482
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49198931909212285, 'ACC_ID': 0.3477970627503338, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4889; Top5: 0.7460
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4891905480140774, 'ACC_ID': 0.3599798893916541, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4844; Top5: 0.7402
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4847634322373697, 'ACC_ID': 0.35846030473135526, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4785; Top5: 0.7338
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4788685524126456, 'ACC_ID': 0.36638935108153076, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4755; Top5: 0.7297
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4759036144578313, 'ACC_ID': 0.3709122203098107, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4732; Top5: 0.7252
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47348767737117253, 'ACC_ID': 0.3716704007966144, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4711; Top5: 0.7239
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47117516629711753, 'ACC_ID': 0.3716186252771619, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4680; Top5: 0.7225
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4682682682682683, 'ACC_ID': 0.36856856856856857, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4702; Top5: 0.7254
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47034206695778746, 'ACC_ID': 0.3688136826783115, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4670; Top5: 0.7231
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4672897196261682, 'ACC_ID': 0.3653204272363151, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4666; Top5: 0.7219
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.466635845276622, 'ACC_ID': 0.36461704422869473, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4612; Top5: 0.7177
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4613736969870056, 'ACC_ID': 0.3628444952163359, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4587; Top5: 0.7152
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45882196162046907, 'ACC_ID': 0.36593816631130066, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4549; Top5: 0.7120
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45526216994118385, 'ACC_ID': 0.366412213740458, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4533; Top5: 0.7111
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4535936948594283, 'ACC_ID': 0.3670156452182096, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4514; Top5: 0.7103
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45167037861915366, 'ACC_ID': 0.36848552338530066, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4484; Top5: 0.7081
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4487057580559958, 'ACC_ID': 0.3687268885367142, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4475; Top5: 0.7075
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4479, 'ACC_ID': 0.3715, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35531944 0.30275971 ... 0.17589942 0.17583156 0.15442763]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 44.7600; Top-5 accuracy: 70.7500
{'Method': 'rosita_knn_txt', 'AUC': 0.8901678700000001, 'FPR95': 0.5274, 'ACC_ALL': 0.4479, 'ACC_ID': 0.3715, 'ACC_OOD': 0.9455, 'ACC_HM': 0.5334141989369781, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp1_kn3

Step 999: Top1: 0.5170; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.342685370741483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5067; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066803699897225, 'ACC_ID': 0.3329907502569373, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4970; Top5: 0.7468
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49666221628838453, 'ACC_ID': 0.3364485981308411, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5035; Top5: 0.7495
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5032679738562091, 'ACC_ID': 0.3559577677224736, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5020; Top5: 0.7450
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5020048115477145, 'ACC_ID': 0.36046511627906974, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4749; Top5: 0.7161
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47487520798668886, 'ACC_ID': 0.33610648918469216, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4488; Top5: 0.6858
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44865174985656914, 'ACC_ID': 0.3172690763052209, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4379; Top5: 0.6776
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4378889718695544, 'ACC_ID': 0.3154095095842669, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4334; Top5: 0.6749
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43325942350332597, 'ACC_ID': 0.3146341463414634, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4283; Top5: 0.6712
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42842842842842843, 'ACC_ID': 0.3115115115115115, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4223; Top5: 0.6668
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42230713245997087, 'ACC_ID': 0.311863173216885, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4150; Top5: 0.6578
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.41488651535380505, 'ACC_ID': 0.30774365821094796, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4115; Top5: 0.6543
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4116196640468485, 'ACC_ID': 0.3060564031437818, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4055; Top5: 0.6492
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.40554048265029274, 'ACC_ID': 0.30087105526203056, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.3997; Top5: 0.6421
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3997867803837953, 'ACC_ID': 0.29810767590618337, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.3947; Top5: 0.6359
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3949443123513953, 'ACC_ID': 0.2965836566136904, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.3919; Top5: 0.6334
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3920715209975297, 'ACC_ID': 0.2952593812492648, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.3887; Top5: 0.6314
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.38875278396436524, 'ACC_ID': 0.294543429844098, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.3872; Top5: 0.6290
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.387216059165346, 'ACC_ID': 0.29550977284733226, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.3862; Top5: 0.6292
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3864, 'ACC_ID': 0.2954, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35192648 0.30719686 ... 0.17297822 0.17273246 0.15341993]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 38.6300; Top-5 accuracy: 62.9200
{'Method': 'rosita_knn_txt', 'AUC': 0.7941411599999999, 'FPR95': 0.7579, 'ACC_ALL': 0.3864, 'ACC_ID': 0.2954, 'ACC_OOD': 0.8881, 'ACC_HM': 0.4433371187156739, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp1_kn3

Step 999: Top1: 0.5170; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3406813627254509, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5118; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5107913669064749, 'ACC_ID': 0.3566289825282631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.5023; Top5: 0.7522
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5013351134846462, 'ACC_ID': 0.35714285714285715, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5080; Top5: 0.7525
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5072900955253896, 'ACC_ID': 0.3720462543991956, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5056; Top5: 0.7502
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5052125100240578, 'ACC_ID': 0.37209302325581395, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5005; Top5: 0.7481
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5001663893510815, 'ACC_ID': 0.3670549084858569, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4933; Top5: 0.7418
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49282845668387837, 'ACC_ID': 0.3634538152610442, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4740; Top5: 0.7187
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47373661936768735, 'ACC_ID': 0.347025143141648, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4571; Top5: 0.6955
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4565410199556541, 'ACC_ID': 0.33569844789356984, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4481; Top5: 0.6864
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44784784784784787, 'ACC_ID': 0.32892892892892894, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4460; Top5: 0.6847
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44541484716157204, 'ACC_ID': 0.32787481804949054, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4385; Top5: 0.6790
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4379172229639519, 'ACC_ID': 0.3247663551401869, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4373; Top5: 0.6776
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4367390969332717, 'ACC_ID': 0.3237787024194791, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4349; Top5: 0.6747
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4343852634585178, 'ACC_ID': 0.31772097672426103, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4307; Top5: 0.6691
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4303038379530917, 'ACC_ID': 0.3119669509594883, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4249; Top5: 0.6623
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42460267801276436, 'ACC_ID': 0.3064697785008134, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4200; Top5: 0.6579
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.41971532760851665, 'ACC_ID': 0.3007881425714622, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4151; Top5: 0.6537
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4145879732739421, 'ACC_ID': 0.29743875278396437, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4113; Top5: 0.6503
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4109878499735869, 'ACC_ID': 0.294770206022187, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4094; Top5: 0.6490
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.409, 'ACC_ID': 0.2939, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35524797 0.3491016  ... 0.18074779 0.18037429 0.15855923]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 40.9400; Top-5 accuracy: 64.9000
{'Method': 'rosita_knn_txt', 'AUC': 0.62201214, 'FPR95': 0.9281, 'ACC_ALL': 0.409, 'ACC_ID': 0.2939, 'ACC_OOD': 0.6874, 'ACC_HM': 0.4117535106491389, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp1_kn3

Step 999: Top1: 0.5190; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5190380761523046, 'ACC_ID': 0.34468937875751504, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5036; Top5: 0.7636
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5035971223021583, 'ACC_ID': 0.36382322713257964, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4923; Top5: 0.7522
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49265687583444595, 'ACC_ID': 0.3704939919893191, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4975; Top5: 0.7490
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49673202614379086, 'ACC_ID': 0.38310708898944196, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4992; Top5: 0.7458
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4987971130713713, 'ACC_ID': 0.3777064955894146, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4988; Top5: 0.7471
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49850249584026624, 'ACC_ID': 0.37237936772046587, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4961; Top5: 0.7469
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49569707401032703, 'ACC_ID': 0.36374067699368906, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4941; Top5: 0.7446
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4939009210853871, 'ACC_ID': 0.36071695294996264, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4952; Top5: 0.7441
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49467849223946786, 'ACC_ID': 0.36430155210643017, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4916; Top5: 0.7419
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4912912912912913, 'ACC_ID': 0.36156156156156155, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4918; Top5: 0.7404
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49144832605531297, 'ACC_ID': 0.3637190684133916, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4864; Top5: 0.7371
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48598130841121495, 'ACC_ID': 0.35630841121495327, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4875; Top5: 0.7375
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4871320696563415, 'ACC_ID': 0.3578363384188627, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4859; Top5: 0.7379
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4856490075681851, 'ACC_ID': 0.35684706554333856, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4844; Top5: 0.7376
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4841417910447761, 'ACC_ID': 0.3591417910447761, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4811; Top5: 0.7359
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48091603053435117, 'ACC_ID': 0.3570266549868602, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4796; Top5: 0.7340
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4794730031760969, 'ACC_ID': 0.3557228561345724, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4760; Top5: 0.7314
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47583518930957686, 'ACC_ID': 0.35178173719376393, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4701; Top5: 0.7257
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4699418911780243, 'ACC_ID': 0.3473851030110935, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4657; Top5: 0.7219
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4657, 'ACC_ID': 0.3425, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35279396 0.3466796  ... 0.1747077  0.17369698 0.17312443]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 46.5800; Top-5 accuracy: 72.1900
{'Method': 'rosita_knn_txt', 'AUC': 0.6780603299999999, 'FPR95': 0.8185, 'ACC_ALL': 0.4657, 'ACC_ID': 0.3425, 'ACC_OOD': 0.6917, 'ACC_HM': 0.45814590988203446, 'kp': 1, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




1 5
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp1_kn5

Step 999: Top1: 0.7335; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.6032064128256514, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7461; Top5: 0.9455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7471736896197327, 'ACC_ID': 0.6228160328879754, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7401; Top5: 0.9452
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7409879839786382, 'ACC_ID': 0.6401869158878505, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7404; Top5: 0.9457
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7405731523378583, 'ACC_ID': 0.652589240824535, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7390; Top5: 0.9483
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.739374498797113, 'ACC_ID': 0.6547714514835605, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7291; Top5: 0.9461
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7294509151414309, 'ACC_ID': 0.6455906821963394, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7271; Top5: 0.9429
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7274813539873781, 'ACC_ID': 0.6374067699368904, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7192; Top5: 0.9363
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7194423699278069, 'ACC_ID': 0.6166293253671894, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7150; Top5: 0.9341
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.71529933481153, 'ACC_ID': 0.61019955654102, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7137; Top5: 0.9361
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7139139139139139, 'ACC_ID': 0.6052052052052052, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7116; Top5: 0.9383
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.711608442503639, 'ACC_ID': 0.6049854439592431, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7092; Top5: 0.9397
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7091121495327103, 'ACC_ID': 0.6066421895861148, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7092; Top5: 0.9399
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7090460779781168, 'ACC_ID': 0.6105717367853291, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7074; Top5: 0.9417
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7074111095244895, 'ACC_ID': 0.6147365414822219, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7094; Top5: 0.9424
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7093550106609808, 'ACC_ID': 0.6210021321961621, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7090; Top5: 0.9424
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7090476786384683, 'ACC_ID': 0.625328494556376, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7100; Top5: 0.9438
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7097988471944477, 'ACC_ID': 0.6305140571697447, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7097; Top5: 0.9440
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7094654788418708, 'ACC_ID': 0.6338530066815145, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7097; Top5: 0.9449
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7095615425250924, 'ACC_ID': 0.6376122556788167, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7102; Top5: 0.9457
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7101, 'ACC_ID': 0.642, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33859015 0.29203427 ... 0.14302054 0.14301804 0.11706896]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 71.0200; Top-5 accuracy: 94.5700
{'Method': 'rosita_knn_txt', 'AUC': 0.9528199500000001, 'FPR95': 0.3445, 'ACC_ALL': 0.7101, 'ACC_ID': 0.642, 'ACC_OOD': 0.9775, 'ACC_HM': 0.7749984563136771, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp1_kn5

Step 999: Top1: 0.7395; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7374749498997996, 'ACC_ID': 0.6052104208416834, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7513; Top5: 0.9476
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.750256937307297, 'ACC_ID': 0.6248715313463515, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7522; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7516688918558078, 'ACC_ID': 0.6341789052069426, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7545; Top5: 0.9542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7536450477626948, 'ACC_ID': 0.6460532931121167, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7474; Top5: 0.9503
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7469927826784283, 'ACC_ID': 0.623897353648757, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7278; Top5: 0.9351
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7271214642262895, 'ACC_ID': 0.6059900166389351, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7234; Top5: 0.9317
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7228915662650602, 'ACC_ID': 0.6041308089500861, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7192; Top5: 0.9315
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7186955439382624, 'ACC_ID': 0.6051779935275081, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7192; Top5: 0.9321
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7188470066518847, 'ACC_ID': 0.6084257206208425, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7177; Top5: 0.9333
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7173173173173173, 'ACC_ID': 0.6068068068068068, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7105; Top5: 0.9334
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7101528384279476, 'ACC_ID': 0.5997088791848617, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7069; Top5: 0.9316
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7066088117489987, 'ACC_ID': 0.5962950600801068, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7039; Top5: 0.9313
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7036523347202959, 'ACC_ID': 0.5937740792109724, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.6981; Top5: 0.9303
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6978437812366128, 'ACC_ID': 0.5906040268456376, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.6990; Top5: 0.9303
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6986940298507462, 'ACC_ID': 0.5930170575692963, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.6962; Top5: 0.9310
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6960330371668126, 'ACC_ID': 0.592416468527093, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.6952; Top5: 0.9308
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6947417950829314, 'ACC_ID': 0.5912245618162569, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.6936; Top5: 0.9296
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6932071269487751, 'ACC_ID': 0.5909799554565701, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.6917; Top5: 0.9299
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.691283676703645, 'ACC_ID': 0.590702588483888, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.6900; Top5: 0.9297
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6897, 'ACC_ID': 0.5895, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34172851 0.2934534  ... 0.15171638 0.15103194 0.13489321]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 69.0000; Top-5 accuracy: 92.9700
{'Method': 'rosita_knn_txt', 'AUC': 0.9141536450000001, 'FPR95': 0.5165, 'ACC_ALL': 0.6897, 'ACC_ID': 0.5895, 'ACC_OOD': 0.956, 'ACC_HM': 0.7292940795858945, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp1_kn5

Step 999: Top1: 0.7395; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7394789579158316, 'ACC_ID': 0.6032064128256514, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7533; Top5: 0.9445
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7543679342240494, 'ACC_ID': 0.6402877697841727, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7528; Top5: 0.9532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7536715620827771, 'ACC_ID': 0.6481975967957276, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7601; Top5: 0.9582
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7606837606837606, 'ACC_ID': 0.6586224233283057, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7622; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7626303127506014, 'ACC_ID': 0.6539695268644747, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7527; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7530782029950083, 'ACC_ID': 0.637603993344426, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7564; Top5: 0.9587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7567412507171544, 'ACC_ID': 0.6342512908777969, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7555; Top5: 0.9574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7557879014189693, 'ACC_ID': 0.6340552651232263, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7543; Top5: 0.9563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7545454545454545, 'ACC_ID': 0.6314855875831485, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7551; Top5: 0.9563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7553553553553554, 'ACC_ID': 0.6282282282282282, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7536; Top5: 0.9558
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.75382096069869, 'ACC_ID': 0.6206331877729258, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7511; Top5: 0.9546
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7513351134846462, 'ACC_ID': 0.6151535380507344, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7517; Top5: 0.9545
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7518878101402373, 'ACC_ID': 0.6155031591924796, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7502; Top5: 0.9552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7505354847922319, 'ACC_ID': 0.6161645009281737, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7485; Top5: 0.9538
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7488006396588486, 'ACC_ID': 0.6142057569296375, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7426; Top5: 0.9526
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7428356901514204, 'ACC_ID': 0.6108121636841447, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7391; Top5: 0.9509
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.739207152099753, 'ACC_ID': 0.6058110810492883, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7365; Top5: 0.9497
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7367483296213808, 'ACC_ID': 0.6028953229398664, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7299; Top5: 0.9471
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7300581088219757, 'ACC_ID': 0.5978869519281563, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7234; Top5: 0.9436
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7236, 'ACC_ID': 0.5936, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33294013 0.32318908 ... 0.16049264 0.15938573 0.15478122]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 72.3400; Top-5 accuracy: 94.3600
{'Method': 'rosita_knn_txt', 'AUC': 0.80124965, 'FPR95': 0.7379, 'ACC_ALL': 0.7236, 'ACC_ID': 0.5936, 'ACC_OOD': 0.7725, 'ACC_HM': 0.6713359197716127, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp1_kn5

Step 999: Top1: 0.7355; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7374749498997996, 'ACC_ID': 0.6613226452905812, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7513; Top5: 0.9466
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7523124357656732, 'ACC_ID': 0.6906474820143885, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7495; Top5: 0.9539
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7496662216288384, 'ACC_ID': 0.6949265687583445, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7565; Top5: 0.9577
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7566616390145802, 'ACC_ID': 0.705379587732529, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7586; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7582197273456295, 'ACC_ID': 0.7060946271050521, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7511; Top5: 0.9587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7504159733777038, 'ACC_ID': 0.6921797004991681, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7504; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7498565691336776, 'ACC_ID': 0.6916236374067699, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7481; Top5: 0.9554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7475728155339806, 'ACC_ID': 0.690067214339059, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7465; Top5: 0.9543
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7463414634146341, 'ACC_ID': 0.6831485587583148, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7505; Top5: 0.9551
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7503503503503504, 'ACC_ID': 0.6830830830830831, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7500; Top5: 0.9554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7498180494905385, 'ACC_ID': 0.6824963609898108, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7471; Top5: 0.9556
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.746995994659546, 'ACC_ID': 0.6799065420560748, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7498; Top5: 0.9551
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.749422098936662, 'ACC_ID': 0.6825396825396826, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7494; Top5: 0.9566
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7491075253462801, 'ACC_ID': 0.68313579894331, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7515; Top5: 0.9568
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7511993603411514, 'ACC_ID': 0.68363539445629, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7496; Top5: 0.9561
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7493430108872482, 'ACC_ID': 0.6795144537604806, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7485; Top5: 0.9548
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7481472767909658, 'ACC_ID': 0.6783907775555817, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7455; Top5: 0.9531
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7453229398663697, 'ACC_ID': 0.6729398663697105, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7403; Top5: 0.9522
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7399894347596407, 'ACC_ID': 0.6664553618594823, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7384; Top5: 0.9506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7382, 'ACC_ID': 0.6641, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32484961 0.32029197 ... 0.16784418 0.16771096 0.14071609]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 73.8400; Top-5 accuracy: 95.0600
{'Method': 'rosita_knn_txt', 'AUC': 0.8645777649999999, 'FPR95': 0.4791, 'ACC_ALL': 0.7382, 'ACC_ID': 0.6641, 'ACC_OOD': 0.771, 'ACC_HM': 0.71356853180963, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp1_kn5

Step 999: Top1: 0.5130; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150300601202404, 'ACC_ID': 0.3366733466933868, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4995; Top5: 0.7605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5005138746145941, 'ACC_ID': 0.33504624871531347, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4916; Top5: 0.7495
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49265687583444595, 'ACC_ID': 0.34913217623498, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4884; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4891905480140774, 'ACC_ID': 0.3614881850175968, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4832; Top5: 0.7402
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4839615076182839, 'ACC_ID': 0.3620689655172414, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4775; Top5: 0.7338
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4782029950083195, 'ACC_ID': 0.3697171381031614, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4743; Top5: 0.7297
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47475616752725186, 'ACC_ID': 0.3709122203098107, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4693; Top5: 0.7249
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4695046054269355, 'ACC_ID': 0.366940502862833, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4620; Top5: 0.7170
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46208425720620844, 'ACC_ID': 0.3623059866962306, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4567; Top5: 0.7117
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45705705705705707, 'ACC_ID': 0.35835835835835833, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4572; Top5: 0.7112
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4574235807860262, 'ACC_ID': 0.36080786026200873, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4492; Top5: 0.7052
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44943257676902537, 'ACC_ID': 0.3569759679572764, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4474; Top5: 0.7041
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44752658344891355, 'ACC_ID': 0.35906919402065035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4460; Top5: 0.7028
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44609453091532203, 'ACC_ID': 0.3592745966014565, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4444; Top5: 0.7014
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4445628997867804, 'ACC_ID': 0.36087420042643925, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4416; Top5: 0.6979
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.441746965336003, 'ACC_ID': 0.3617820047553498, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4392; Top5: 0.6965
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43936007528526055, 'ACC_ID': 0.36242794965298203, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4369; Top5: 0.6955
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43697104677060133, 'ACC_ID': 0.36247216035634744, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4335; Top5: 0.6938
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4335974643423138, 'ACC_ID': 0.3613312202852615, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4325; Top5: 0.6931
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4327, 'ACC_ID': 0.3632, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35545662 0.30011931 ... 0.16836539 0.16832829 0.14754082]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 43.2600; Top-5 accuracy: 69.3100
{'Method': 'rosita_knn_txt', 'AUC': 0.88431814, 'FPR95': 0.5286, 'ACC_ALL': 0.4327, 'ACC_ID': 0.3632, 'ACC_OOD': 0.9484, 'ACC_HM': 0.5252498932601403, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp1_kn5

Step 999: Top1: 0.5170; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.342685370741483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5077; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5077081192189106, 'ACC_ID': 0.3371017471736896, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.5003; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5, 'ACC_ID': 0.33978638184245663, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5055; Top5: 0.7460
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5047762694821518, 'ACC_ID': 0.35796882855706386, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4972; Top5: 0.7318
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4971932638331997, 'ACC_ID': 0.3528468323977546, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4596; Top5: 0.6859
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.459567387687188, 'ACC_ID': 0.3247920133111481, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4433; Top5: 0.6686
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44320137693631667, 'ACC_ID': 0.31669535283993117, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4379; Top5: 0.6662
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4378889718695544, 'ACC_ID': 0.31491162559123725, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4303; Top5: 0.6627
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43015521064301554, 'ACC_ID': 0.3124168514412417, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4217; Top5: 0.6576
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42162162162162165, 'ACC_ID': 0.3075075075075075, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4143; Top5: 0.6503
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4141193595342067, 'ACC_ID': 0.30604075691411936, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4048; Top5: 0.6403
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4045393858477971, 'ACC_ID': 0.2998998664886515, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.3990; Top5: 0.6366
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3988287871783017, 'ACC_ID': 0.2965017722299276, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.3959; Top5: 0.6334
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3956875624732258, 'ACC_ID': 0.2931600742538912, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.3917; Top5: 0.6271
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.39152452025586354, 'ACC_ID': 0.29144456289978676, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.3867; Top5: 0.6213
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.38668502064822924, 'ACC_ID': 0.2898260543111, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.3835; Top5: 0.6188
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3836019291848018, 'ACC_ID': 0.2889071873897189, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.3800; Top5: 0.6174
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3799554565701559, 'ACC_ID': 0.2880846325167038, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.3786; Top5: 0.6164
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.37855256207078714, 'ACC_ID': 0.28948758584257794, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.3788; Top5: 0.6172
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3789, 'ACC_ID': 0.2912, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35383242 0.31154287 ... 0.16417044 0.16401361 0.15762247]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 37.8900; Top-5 accuracy: 61.7200
{'Method': 'rosita_knn_txt', 'AUC': 0.79538519, 'FPR95': 0.7356, 'ACC_ALL': 0.3789, 'ACC_ID': 0.2912, 'ACC_OOD': 0.894, 'ACC_HM': 0.4393061086736416, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp1_kn5

Step 999: Top1: 0.5190; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5190380761523046, 'ACC_ID': 0.342685370741483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5098; Top5: 0.7626
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5097636176772867, 'ACC_ID': 0.3566289825282631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4990; Top5: 0.7542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4993324432576769, 'ACC_ID': 0.35647530040053405, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5055; Top5: 0.7515
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5052790346907994, 'ACC_ID': 0.371543489190548, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5048; Top5: 0.7470
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5048115477145149, 'ACC_ID': 0.36848436246992783, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4938; Top5: 0.7404
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49384359400998334, 'ACC_ID': 0.3603993344425957, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4714; Top5: 0.7145
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4713138267355135, 'ACC_ID': 0.3393574297188755, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4518; Top5: 0.6926
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45182972367438384, 'ACC_ID': 0.32735872541697786, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4447; Top5: 0.6813
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4445676274944568, 'ACC_ID': 0.3228381374722838, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4385; Top5: 0.6772
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4386386386386386, 'ACC_ID': 0.3169169169169169, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4352; Top5: 0.6750
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43522561863173215, 'ACC_ID': 0.3184133915574964, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4263; Top5: 0.6678
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4264018691588785, 'ACC_ID': 0.3137516688918558, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4243; Top5: 0.6638
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4242564339651718, 'ACC_ID': 0.3106796116504854, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4197; Top5: 0.6602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4196772811652149, 'ACC_ID': 0.3048693417106954, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4148; Top5: 0.6550
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4149786780383795, 'ACC_ID': 0.298773987206823, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4073; Top5: 0.6466
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4074583906895257, 'ACC_ID': 0.2930797146790139, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4019; Top5: 0.6414
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4020703446653335, 'ACC_ID': 0.2889071873897189, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.3977; Top5: 0.6373
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3977728285077951, 'ACC_ID': 0.2869710467706013, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.3944; Top5: 0.6352
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.39450607501320656, 'ACC_ID': 0.2838880084521923, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.3934; Top5: 0.6352
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3935, 'ACC_ID': 0.2819, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35432076 0.3353928  ... 0.18165113 0.17904709 0.15503335]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 39.3400; Top-5 accuracy: 63.5200
{'Method': 'rosita_knn_txt', 'AUC': 0.60912884, 'FPR95': 0.9355, 'ACC_ALL': 0.3935, 'ACC_ID': 0.2819, 'ACC_OOD': 0.6843, 'ACC_HM': 0.3993048437176568, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp1_kn5

Step 999: Top1: 0.5190; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5190380761523046, 'ACC_ID': 0.34468937875751504, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5067; Top5: 0.7636
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5056526207605344, 'ACC_ID': 0.3658787255909558, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4923; Top5: 0.7522
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49198931909212285, 'ACC_ID': 0.3704939919893191, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4985; Top5: 0.7470
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49673202614379086, 'ACC_ID': 0.38109602815485166, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5008; Top5: 0.7446
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4995990376904571, 'ACC_ID': 0.37570168404170007, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5002; Top5: 0.7491
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49916805324459235, 'ACC_ID': 0.36838602329450915, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4953; Top5: 0.7461
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4942627653471027, 'ACC_ID': 0.36316695352839934, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4914; Top5: 0.7423
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49066467513069456, 'ACC_ID': 0.35623599701269604, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4917; Top5: 0.7399
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4909090909090909, 'ACC_ID': 0.3558758314855876, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4868; Top5: 0.7367
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4862862862862863, 'ACC_ID': 0.35355355355355356, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4873; Top5: 0.7349
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48671761280931586, 'ACC_ID': 0.3551673944687045, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4824; Top5: 0.7318
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4818090787716956, 'ACC_ID': 0.34813084112149534, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4843; Top5: 0.7326
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48389582370164896, 'ACC_ID': 0.35290491601171214, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4817; Top5: 0.7331
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.481507925174925, 'ACC_ID': 0.3517064115379123, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4817; Top5: 0.7307
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4814765458422175, 'ACC_ID': 0.3519456289978678, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4732; Top5: 0.7257
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.473032161181329, 'ACC_ID': 0.3458891252659242, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4668; Top5: 0.7195
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4664157157981414, 'ACC_ID': 0.34007763792495, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4607; Top5: 0.7154
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4603563474387528, 'ACC_ID': 0.3346325167037862, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4556; Top5: 0.7093
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45525620707871106, 'ACC_ID': 0.3306920232435288, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4517; Top5: 0.7057
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4514, 'ACC_ID': 0.3259, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35152525 0.34815153 ... 0.17674634 0.17452759 0.17141168]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 45.1700; Top-5 accuracy: 70.5700
{'Method': 'rosita_knn_txt', 'AUC': 0.6655139050000001, 'FPR95': 0.8384, 'ACC_ALL': 0.4514, 'ACC_ID': 0.3259, 'ACC_OOD': 0.6904, 'ACC_HM': 0.44278531929548365, 'kp': 1, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




1 7
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp1_kn7

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7472; Top5: 0.9445
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7482014388489209, 'ACC_ID': 0.6207605344295992, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7415; Top5: 0.9452
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7423230974632844, 'ACC_ID': 0.6395193591455274, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7420; Top5: 0.9452
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7420814479638009, 'ACC_ID': 0.6505781799899447, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7402; Top5: 0.9475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7405773857257418, 'ACC_ID': 0.6515637530072174, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7298; Top5: 0.9454
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7301164725457571, 'ACC_ID': 0.6386023294509151, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7263; Top5: 0.9420
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7266207687894435, 'ACC_ID': 0.6285140562248996, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7172; Top5: 0.9338
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7174508339556883, 'ACC_ID': 0.6121483694299228, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7143; Top5: 0.9332
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7146341463414634, 'ACC_ID': 0.6068736141906874, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7141; Top5: 0.9355
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7143143143143144, 'ACC_ID': 0.6068068068068068, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7102; Top5: 0.9369
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7101528384279476, 'ACC_ID': 0.606259097525473, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7089; Top5: 0.9384
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7087783711615487, 'ACC_ID': 0.6096461949265688, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7076; Top5: 0.9388
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7076591154261057, 'ACC_ID': 0.6124210201880105, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7061; Top5: 0.9407
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7062687419677282, 'ACC_ID': 0.6161645009281737, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7076; Top5: 0.9415
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7077558635394456, 'ACC_ID': 0.6227345415778252, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7070; Top5: 0.9419
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.70729570767113, 'ACC_ID': 0.626579902390189, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7078; Top5: 0.9433
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7079167156805082, 'ACC_ID': 0.6316903893659569, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7081; Top5: 0.9436
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7081291759465479, 'ACC_ID': 0.6357461024498886, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7085; Top5: 0.9447
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7083993660855784, 'ACC_ID': 0.6396196513470681, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7086; Top5: 0.9453
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7086, 'ACC_ID': 0.6435, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34226871 0.30614969 ... 0.1251141  0.12509182 0.11575836]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 70.8600; Top-5 accuracy: 94.5300
{'Method': 'rosita_knn_txt', 'AUC': 0.953473695, 'FPR95': 0.3457, 'ACC_ALL': 0.7086, 'ACC_ID': 0.6435, 'ACC_OOD': 0.977, 'ACC_HM': 0.7759327368096267, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp1_kn7

Step 999: Top1: 0.7395; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7394789579158316, 'ACC_ID': 0.6052104208416834, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7523; Top5: 0.9476
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7523124357656732, 'ACC_ID': 0.6310380267214799, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7542; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7543391188251002, 'ACC_ID': 0.6335113484646195, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7565; Top5: 0.9542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7566616390145802, 'ACC_ID': 0.6420311714429362, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7446; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7445870088211708, 'ACC_ID': 0.6170809943865276, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7245; Top5: 0.9301
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.724126455906822, 'ACC_ID': 0.6016638935108153, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7211; Top5: 0.9286
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7211703958691911, 'ACC_ID': 0.6035570854847964, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7177; Top5: 0.9305
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7176997759522031, 'ACC_ID': 0.6034353995519044, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7155; Top5: 0.9304
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7157427937915742, 'ACC_ID': 0.6035476718403547, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7131; Top5: 0.9317
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7131131131131131, 'ACC_ID': 0.601001001001001, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7061; Top5: 0.9321
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7061499272197962, 'ACC_ID': 0.5913391557496361, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7004; Top5: 0.9294
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7002670226969292, 'ACC_ID': 0.587283044058745, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.6970; Top5: 0.9296
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6971798428109107, 'ACC_ID': 0.584835876098012, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.6914; Top5: 0.9292
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6915607596744252, 'ACC_ID': 0.5838926174496645, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.6918; Top5: 0.9291
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6916311300639659, 'ACC_ID': 0.5860874200426439, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.6902; Top5: 0.9295
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6901514203478913, 'ACC_ID': 0.5860342885746465, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.6898; Top5: 0.9299
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6894483001999765, 'ACC_ID': 0.5866368662510293, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.6887; Top5: 0.9292
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6884187082405345, 'ACC_ID': 0.587750556792873, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.6870; Top5: 0.9296
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6867406233491812, 'ACC_ID': 0.587849973586899, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.6852; Top5: 0.9289
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.685, 'ACC_ID': 0.5865, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33708346 0.29425651 ... 0.14999259 0.14956129 0.12934139]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 68.5200; Top-5 accuracy: 92.8900
{'Method': 'rosita_knn_txt', 'AUC': 0.91983255, 'FPR95': 0.4845, 'ACC_ALL': 0.685, 'ACC_ID': 0.5865, 'ACC_OOD': 0.9626, 'ACC_HM': 0.728894067523078, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp1_kn7

Step 999: Top1: 0.7375; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7414829659318637, 'ACC_ID': 0.6032064128256514, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7533; Top5: 0.9466
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7564234326824255, 'ACC_ID': 0.644398766700925, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7535; Top5: 0.9546
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7556742323097463, 'ACC_ID': 0.6522029372496663, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7616; Top5: 0.9582
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7631975867269984, 'ACC_ID': 0.6636500754147813, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7650; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7662389735364876, 'ACC_ID': 0.6579791499599038, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7554; Top5: 0.9587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7564059900166389, 'ACC_ID': 0.6386023294509151, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7549; Top5: 0.9558
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7558806655192197, 'ACC_ID': 0.6325301204819277, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7523; Top5: 0.9539
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7530495394573065, 'ACC_ID': 0.6328105551406522, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7521; Top5: 0.9532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7527716186252772, 'ACC_ID': 0.6301552106430155, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7541; Top5: 0.9545
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7547547547547547, 'ACC_ID': 0.6298298298298298, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7518; Top5: 0.9543
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7523653566229985, 'ACC_ID': 0.6228165938864629, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7465; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.746995994659546, 'ACC_ID': 0.616822429906542, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7424; Top5: 0.9504
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7427955000770535, 'ACC_ID': 0.6148867313915858, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7359; Top5: 0.9493
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7363986862773098, 'ACC_ID': 0.6118806225903184, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7339; Top5: 0.9490
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7342750533049041, 'ACC_ID': 0.6056769722814499, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7282; Top5: 0.9471
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7285696408459517, 'ACC_ID': 0.5995494931798273, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7239; Top5: 0.9445
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7241500999882367, 'ACC_ID': 0.594988824844136, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7199; Top5: 0.9429
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7201559020044543, 'ACC_ID': 0.5907572383073497, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7149; Top5: 0.9416
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7150554675118859, 'ACC_ID': 0.5858425779186477, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7123; Top5: 0.9398
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7125, 'ACC_ID': 0.5843, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32884675 0.31290865 ... 0.15456271 0.15426141 0.15057731]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 71.2300; Top-5 accuracy: 93.9800
{'Method': 'rosita_knn_txt', 'AUC': 0.78962068, 'FPR95': 0.7708, 'ACC_ALL': 0.7125, 'ACC_ID': 0.5843, 'ACC_OOD': 0.7631, 'ACC_HM': 0.6618366186729999, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp1_kn7

Step 999: Top1: 0.7395; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7374749498997996, 'ACC_ID': 0.6633266533066132, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7533; Top5: 0.9476
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7523124357656732, 'ACC_ID': 0.6927029804727647, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7508; Top5: 0.9546
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7503337783711616, 'ACC_ID': 0.6962616822429907, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7580; Top5: 0.9577
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7576671694318753, 'ACC_ID': 0.7023629964806435, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7594; Top5: 0.9603
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7590216519647153, 'ACC_ID': 0.7016840417000801, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7507; Top5: 0.9577
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7504159733777038, 'ACC_ID': 0.6871880199667221, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7489; Top5: 0.9552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7487091222030982, 'ACC_ID': 0.6841652323580034, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7478; Top5: 0.9537
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7475728155339806, 'ACC_ID': 0.6813542444610405, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7472; Top5: 0.9528
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7470066518847006, 'ACC_ID': 0.6762749445676275, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7515; Top5: 0.9537
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7513513513513513, 'ACC_ID': 0.6762762762762763, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7505; Top5: 0.9541
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7503639010189228, 'ACC_ID': 0.6750363901018923, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7478; Top5: 0.9534
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7474966622162884, 'ACC_ID': 0.671562082777036, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7495; Top5: 0.9533
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7491138850362151, 'ACC_ID': 0.6723686238249345, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7478; Top5: 0.9533
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7475367699557333, 'ACC_ID': 0.6719977152648865, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7472; Top5: 0.9527
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7469349680170576, 'ACC_ID': 0.6709754797441365, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7439; Top5: 0.9513
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7437116756350894, 'ACC_ID': 0.6676260793392567, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7426; Top5: 0.9500
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7422656158099047, 'ACC_ID': 0.6652158569580049, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7392; Top5: 0.9480
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7389755011135858, 'ACC_ID': 0.6603563474387528, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7340; Top5: 0.9472
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7337559429477021, 'ACC_ID': 0.6559957739038563, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7316; Top5: 0.9458
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7314, 'ACC_ID': 0.6508, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32569107 0.32011929 ... 0.16396612 0.16383682 0.1325147 ]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 73.1600; Top-5 accuracy: 94.5800
{'Method': 'rosita_knn_txt', 'AUC': 0.8612179249999999, 'FPR95': 0.4835, 'ACC_ALL': 0.7314, 'ACC_ID': 0.6508, 'ACC_OOD': 0.7751, 'ACC_HM': 0.7075321972087805, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp1_kn7

Step 999: Top1: 0.5130; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3406813627254509, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5087; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5107913669064749, 'ACC_ID': 0.3432682425488181, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4836; Top5: 0.7495
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48531375166889185, 'ACC_ID': 0.3384512683578104, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4794; Top5: 0.7430
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48014077425842133, 'ACC_ID': 0.35545500251382606, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4751; Top5: 0.7378
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4759422614274258, 'ACC_ID': 0.3608660785886127, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4722; Top5: 0.7314
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4728785357737105, 'ACC_ID': 0.3697171381031614, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4689; Top5: 0.7280
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46930579460699945, 'ACC_ID': 0.37005163511187605, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4610; Top5: 0.7194
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46153846153846156, 'ACC_ID': 0.3637042569081404, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4456; Top5: 0.6999
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4458980044345898, 'ACC_ID': 0.3492239467849224, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4335; Top5: 0.6858
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.434034034034034, 'ACC_ID': 0.33893893893893895, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4334; Top5: 0.6850
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43377001455604075, 'ACC_ID': 0.3400655021834061, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4276; Top5: 0.6815
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4280707610146863, 'ACC_ID': 0.33744993324432576, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4276; Top5: 0.6816
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4278008938203113, 'ACC_ID': 0.34057635999383573, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4264; Top5: 0.6819
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4266742824503784, 'ACC_ID': 0.3405683278594888, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4262; Top5: 0.6814
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42643923240938164, 'ACC_ID': 0.3439498933901919, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4222; Top5: 0.6778
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4226004254786635, 'ACC_ID': 0.3438868727318233, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4206; Top5: 0.6767
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4210092930243501, 'ACC_ID': 0.3451358663686625, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4199; Top5: 0.6770
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42015590200445435, 'ACC_ID': 0.3473273942093541, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4166; Top5: 0.6761
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4169043845747491, 'ACC_ID': 0.3467511885895404, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4162; Top5: 0.6762
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4165, 'ACC_ID': 0.3494, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35521358 0.32077014 ... 0.15947348 0.15902567 0.137971  ]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 41.6300; Top-5 accuracy: 67.6200
{'Method': 'rosita_knn_txt', 'AUC': 0.8757861149999999, 'FPR95': 0.518, 'ACC_ALL': 0.4165, 'ACC_ID': 0.3494, 'ACC_OOD': 0.9533, 'ACC_HM': 0.5113733323098181, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp1_kn7

Step 999: Top1: 0.5190; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.34468937875751504, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5087; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5077081192189106, 'ACC_ID': 0.34018499486125386, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.5023; Top5: 0.7482
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5026702269692924, 'ACC_ID': 0.3444592790387183, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5055; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5052790346907994, 'ACC_ID': 0.358974358974359, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4836; Top5: 0.7193
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.483560545308741, 'ACC_ID': 0.3396150761828388, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4502; Top5: 0.6775
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4502495840266223, 'ACC_ID': 0.3158069883527454, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4387; Top5: 0.6660
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43861158921399884, 'ACC_ID': 0.3118187033849684, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4309; Top5: 0.6632
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4314164799601693, 'ACC_ID': 0.30893701767488174, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4225; Top5: 0.6576
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4228381374722838, 'ACC_ID': 0.30598669623059865, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4137; Top5: 0.6510
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4142142142142142, 'ACC_ID': 0.3013013013013013, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4048; Top5: 0.6425
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.40502183406113534, 'ACC_ID': 0.2989446870451237, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.3946; Top5: 0.6311
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3946929238985314, 'ACC_ID': 0.2937249666221629, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.3912; Top5: 0.6289
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3912775466173524, 'ACC_ID': 0.29311141932501156, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.3892; Top5: 0.6274
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.38926174496644295, 'ACC_ID': 0.2913037269741539, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.3869; Top5: 0.6251
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.38699360341151384, 'ACC_ID': 0.2926439232409382, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.3826; Top5: 0.6220
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.38280565636340885, 'ACC_ID': 0.29207858841196344, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.3798; Top5: 0.6202
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.37995529937654393, 'ACC_ID': 0.29149511822138574, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.3767; Top5: 0.6173
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3767260579064588, 'ACC_ID': 0.2906458797327394, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.3753; Top5: 0.6172
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3752773375594295, 'ACC_ID': 0.2917062863180137, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.3755; Top5: 0.6182
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3756, 'ACC_ID': 0.2935, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35082465 0.31389043 ... 0.16589738 0.16557661 0.14159355]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 37.5600; Top-5 accuracy: 61.8200
{'Method': 'rosita_knn_txt', 'AUC': 0.8012557849999999, 'FPR95': 0.7304, 'ACC_ALL': 0.3756, 'ACC_ID': 0.2935, 'ACC_OOD': 0.8842, 'ACC_HM': 0.44071104695593105, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp1_kn7

Step 999: Top1: 0.5190; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5190380761523046, 'ACC_ID': 0.342685370741483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5087; Top5: 0.7626
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5087358684480987, 'ACC_ID': 0.3545734840698869, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4983; Top5: 0.7528
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4986648865153538, 'ACC_ID': 0.35781041388518026, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5060; Top5: 0.7490
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5057817998994469, 'ACC_ID': 0.371543489190548, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5044; Top5: 0.7434
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.504410585404972, 'ACC_ID': 0.3660785886126704, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4885; Top5: 0.7314
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4885191347753744, 'ACC_ID': 0.3507487520798669, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4571; Top5: 0.6933
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4569707401032702, 'ACC_ID': 0.32501434308663224, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4416; Top5: 0.6791
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4416231018172766, 'ACC_ID': 0.3188946975354742, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4387; Top5: 0.6733
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4385809312638581, 'ACC_ID': 0.3170731707317073, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4323; Top5: 0.6704
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43243243243243246, 'ACC_ID': 0.3119119119119119, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4274; Top5: 0.6656
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42740174672489084, 'ACC_ID': 0.30986171761280934, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4173; Top5: 0.6558
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4172229639519359, 'ACC_ID': 0.3027369826435247, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4109; Top5: 0.6507
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.41084912929573125, 'ACC_ID': 0.2977346278317152, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4063; Top5: 0.6464
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4062544623732686, 'ACC_ID': 0.29230329858632015, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4002; Top5: 0.6409
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4001865671641791, 'ACC_ID': 0.2877132196162047, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.3942; Top5: 0.6320
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3944437492178701, 'ACC_ID': 0.2835690151420348, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.3898; Top5: 0.6284
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.38995412304434773, 'ACC_ID': 0.28067286201623337, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.3862; Top5: 0.6262
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3863028953229399, 'ACC_ID': 0.2779510022271715, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.3836; Top5: 0.6245
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.38351822503961963, 'ACC_ID': 0.2751188589540412, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.3823; Top5: 0.6232
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3823, 'ACC_ID': 0.2733, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35418302 0.34198934 ... 0.16839024 0.16045737 0.1572286 ]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 38.2300; Top-5 accuracy: 62.3200
{'Method': 'rosita_knn_txt', 'AUC': 0.598719475, 'FPR95': 0.9433, 'ACC_ALL': 0.3823, 'ACC_ID': 0.2733, 'ACC_OOD': 0.6687, 'ACC_HM': 0.3880163694267516, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp1_kn7

Step 999: Top1: 0.5190; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5190380761523046, 'ACC_ID': 0.342685370741483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5057; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5056526207605344, 'ACC_ID': 0.3669064748201439, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4903; Top5: 0.7502
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49065420560747663, 'ACC_ID': 0.3651535380507343, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4955; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4952237305178482, 'ACC_ID': 0.3730517848164907, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4964; Top5: 0.7426
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4963913392141139, 'ACC_ID': 0.36768243785084204, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4925; Top5: 0.7428
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49217970049916804, 'ACC_ID': 0.3554076539101497, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4821; Top5: 0.7349
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48164084911072863, 'ACC_ID': 0.3442340791738382, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4757; Top5: 0.7301
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.475479213343291, 'ACC_ID': 0.3393079412496888, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4775; Top5: 0.7290
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.476940133037694, 'ACC_ID': 0.3412416851441242, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4750; Top5: 0.7281
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47467467467467467, 'ACC_ID': 0.34074074074074073, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4760; Top5: 0.7280
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47561863173216884, 'ACC_ID': 0.34152110625909754, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4712; Top5: 0.7253
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47079439252336447, 'ACC_ID': 0.3394526034712951, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4727; Top5: 0.7256
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4723378024348898, 'ACC_ID': 0.34211742949607027, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4686; Top5: 0.7229
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4683706982721691, 'ACC_ID': 0.34028273597029846, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4647; Top5: 0.7184
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46441897654584224, 'ACC_ID': 0.3382196162046908, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4562; Top5: 0.7099
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45601301464147165, 'ACC_ID': 0.33237392066074334, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4518; Top5: 0.7064
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4514762969062463, 'ACC_ID': 0.3284319491824491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4476; Top5: 0.7032
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4475501113585746, 'ACC_ID': 0.3234966592427617, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4432; Top5: 0.6978
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44310618066561014, 'ACC_ID': 0.32002113048071845, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4388; Top5: 0.6924
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4388, 'ACC_ID': 0.3151, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35276711 0.34879678 ... 0.17975086 0.17917518 0.17500201]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 43.8800; Top-5 accuracy: 69.2400
{'Method': 'rosita_knn_txt', 'AUC': 0.655561175, 'FPR95': 0.8512, 'ACC_ALL': 0.4388, 'ACC_ID': 0.3151, 'ACC_OOD': 0.6953, 'ACC_HM': 0.43366791369754554, 'kp': 1, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




1 10
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp1_kn10

Step 999: Top1: 0.7335; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7441; Top5: 0.9455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7440904419321686, 'ACC_ID': 0.6217882836587872, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7388; Top5: 0.9432
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7389853137516689, 'ACC_ID': 0.6388518024032043, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7394; Top5: 0.9437
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7395676219205631, 'ACC_ID': 0.6495726495726496, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7374; Top5: 0.9463
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7377706495589414, 'ACC_ID': 0.6507618283881316, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7271; Top5: 0.9434
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7274542429284526, 'ACC_ID': 0.6362728785357737, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7220; Top5: 0.9389
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7223178427997705, 'ACC_ID': 0.6179001721170396, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7115; Top5: 0.9286
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7114762260393328, 'ACC_ID': 0.598705501618123, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7090; Top5: 0.9279
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7090909090909091, 'ACC_ID': 0.5953436807095344, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7089; Top5: 0.9305
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7089089089089089, 'ACC_ID': 0.5977977977977978, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7038; Top5: 0.9321
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7039665211062591, 'ACC_ID': 0.5978893740902474, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7024; Top5: 0.9339
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7024365821094793, 'ACC_ID': 0.6029706275033377, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7019; Top5: 0.9346
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7019571582678379, 'ACC_ID': 0.6074895977808599, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7011; Top5: 0.9372
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7012708839068971, 'ACC_ID': 0.6128801942024846, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7034; Top5: 0.9386
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7034914712153518, 'ACC_ID': 0.6203358208955224, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7040; Top5: 0.9398
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7042923288699787, 'ACC_ID': 0.6252033537729946, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7068; Top5: 0.9409
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7068580167039172, 'ACC_ID': 0.6320432890248207, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7078; Top5: 0.9412
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7079064587973274, 'ACC_ID': 0.636859688195991, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7093; Top5: 0.9419
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7093502377179081, 'ACC_ID': 0.6417326994189118, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7099; Top5: 0.9420
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.71, 'ACC_ID': 0.646, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33945972 0.30696553 ... 0.14378291 0.1437739  0.11049777]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 70.9900; Top-5 accuracy: 94.2000
{'Method': 'rosita_knn_txt', 'AUC': 0.9494637100000001, 'FPR95': 0.3637, 'ACC_ALL': 0.71, 'ACC_ID': 0.646, 'ACC_OOD': 0.9784, 'ACC_HM': 0.7781905934498892, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp1_kn10

Step 999: Top1: 0.7355; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7523; Top5: 0.9476
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7523124357656732, 'ACC_ID': 0.632065775950668, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7535; Top5: 0.9506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7536715620827771, 'ACC_ID': 0.636849132176235, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7540; Top5: 0.9532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7541478129713424, 'ACC_ID': 0.6430367018602313, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7366; Top5: 0.9427
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7365677626303128, 'ACC_ID': 0.6166800320769847, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7195; Top5: 0.9304
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7194675540765391, 'ACC_ID': 0.6056572379367721, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7179; Top5: 0.9294
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7177280550774526, 'ACC_ID': 0.6055651176133103, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7140; Top5: 0.9305
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7134677620114513, 'ACC_ID': 0.6011949215832711, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7106; Top5: 0.9299
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.71019955654102, 'ACC_ID': 0.601330376940133, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7091; Top5: 0.9315
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7087087087087087, 'ACC_ID': 0.598998998998999, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7016; Top5: 0.9312
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7012372634643377, 'ACC_ID': 0.5860625909752547, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.6954; Top5: 0.9291
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6949265687583445, 'ACC_ID': 0.582109479305741, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.6917; Top5: 0.9296
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6914778856526429, 'ACC_ID': 0.5805208814917553, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.6874; Top5: 0.9300
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6871340853919748, 'ACC_ID': 0.5806083107239755, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.6879; Top5: 0.9298
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6876332622601279, 'ACC_ID': 0.5822228144989339, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.6869; Top5: 0.9299
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6866474784132148, 'ACC_ID': 0.580903516456013, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.6867; Top5: 0.9300
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6863898364898248, 'ACC_ID': 0.5819315374661804, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.6854; Top5: 0.9293
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6850779510022271, 'ACC_ID': 0.5830734966592428, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.6835; Top5: 0.9299
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6832540940306392, 'ACC_ID': 0.5826730058108822, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.6813; Top5: 0.9293
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.6811, 'ACC_ID': 0.5823, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33690271 0.29509515 ... 0.14873238 0.14864892 0.13066269]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 68.1300; Top-5 accuracy: 92.9300
{'Method': 'rosita_knn_txt', 'AUC': 0.9196931899999999, 'FPR95': 0.4835, 'ACC_ALL': 0.6811, 'ACC_ID': 0.5823, 'ACC_OOD': 0.967, 'ACC_HM': 0.7268884012134511, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp1_kn10

Step 999: Top1: 0.7395; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7414829659318637, 'ACC_ID': 0.6032064128256514, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7554; Top5: 0.9476
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7564234326824255, 'ACC_ID': 0.645426515930113, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7502; Top5: 0.9546
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7510013351134847, 'ACC_ID': 0.6495327102803738, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7596; Top5: 0.9582
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7601809954751131, 'ACC_ID': 0.6606334841628959, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7622; Top5: 0.9599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7626303127506014, 'ACC_ID': 0.6535685645549318, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7514; Top5: 0.9571
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.751747088186356, 'ACC_ID': 0.63261231281198, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7461; Top5: 0.9524
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7464142283419392, 'ACC_ID': 0.6230636833046471, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7443; Top5: 0.9502
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7445855115758029, 'ACC_ID': 0.6245954692556634, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7443; Top5: 0.9499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7447893569844789, 'ACC_ID': 0.6217294900221729, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7477; Top5: 0.9513
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7481481481481481, 'ACC_ID': 0.6216216216216216, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7431; Top5: 0.9505
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7434497816593887, 'ACC_ID': 0.6153566229985444, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7379; Top5: 0.9481
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.738150867823765, 'ACC_ID': 0.6114819759679573, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7327; Top5: 0.9467
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7329326552627523, 'ACC_ID': 0.6059485282786253, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7278; Top5: 0.9466
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7281165214907896, 'ACC_ID': 0.6001713551335142, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7247; Top5: 0.9458
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7249466950959488, 'ACC_ID': 0.5944829424307037, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7181; Top5: 0.9433
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7183080966086848, 'ACC_ID': 0.5889125265924164, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7153; Top5: 0.9407
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7152099752970239, 'ACC_ID': 0.5852252676155746, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7127; Top5: 0.9390
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7126948775055679, 'ACC_ID': 0.5824053452115813, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7073; Top5: 0.9371
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7073428420496566, 'ACC_ID': 0.5776016904384574, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7023; Top5: 0.9348
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7025, 'ACC_ID': 0.5754, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32939574 0.32253841 ... 0.15646431 0.15515579 0.14903888]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 70.2300; Top-5 accuracy: 93.4800
{'Method': 'rosita_knn_txt', 'AUC': 0.78608429, 'FPR95': 0.7981, 'ACC_ALL': 0.7025, 'ACC_ID': 0.5754, 'ACC_OOD': 0.7659, 'ACC_HM': 0.6571219861328562, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp1_kn10

Step 999: Top1: 0.7395; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7414829659318637, 'ACC_ID': 0.6633266533066132, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7544; Top5: 0.9486
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7553956834532374, 'ACC_ID': 0.6927029804727647, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7495; Top5: 0.9552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7503337783711616, 'ACC_ID': 0.6935914552736983, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7565; Top5: 0.9582
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7571644042232277, 'ACC_ID': 0.6978381096028154, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7582; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7590216519647153, 'ACC_ID': 0.694065757818765, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7501; Top5: 0.9574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7507487520798669, 'ACC_ID': 0.6818635607321132, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7489; Top5: 0.9547
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7492828456683879, 'ACC_ID': 0.6792885829030407, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7458; Top5: 0.9517
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7463281055514065, 'ACC_ID': 0.6746328105551407, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7454; Top5: 0.9508
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7458980044345898, 'ACC_ID': 0.6689578713968958, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7495; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7499499499499499, 'ACC_ID': 0.6716716716716716, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7485; Top5: 0.9525
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7489082969432315, 'ACC_ID': 0.6713973799126638, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7463; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7466622162883845, 'ACC_ID': 0.6692256341789052, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7468; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7469563877330868, 'ACC_ID': 0.6694405917706888, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7431; Top5: 0.9507
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7433956875624732, 'ACC_ID': 0.6665714693702699, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7421; Top5: 0.9500
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7424040511727079, 'ACC_ID': 0.6627132196162047, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7388; Top5: 0.9489
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7390814666499812, 'ACC_ID': 0.6577399574521337, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7375; Top5: 0.9475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.737677920244677, 'ACC_ID': 0.6548641336313374, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7350; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7353006681514477, 'ACC_ID': 0.6531180400890868, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7300; Top5: 0.9452
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7301637612255679, 'ACC_ID': 0.6492340200739567, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7263; Top5: 0.9431
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7265, 'ACC_ID': 0.6445, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32722306 0.32622865 ... 0.16255982 0.16244452 0.14608903]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 72.6300; Top-5 accuracy: 94.3100
{'Method': 'rosita_knn_txt', 'AUC': 0.85819459, 'FPR95': 0.4993, 'ACC_ALL': 0.7265, 'ACC_ID': 0.6445, 'ACC_OOD': 0.7754, 'ACC_HM': 0.7039161912810761, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp1_kn10

Step 999: Top1: 0.5110; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150300601202404, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5077; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5097636176772867, 'ACC_ID': 0.34635149023638234, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4830; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48464619492656874, 'ACC_ID': 0.34512683578104136, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4789; Top5: 0.7399
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4796380090497738, 'ACC_ID': 0.35947712418300654, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4747; Top5: 0.7342
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4755412991178829, 'ACC_ID': 0.3668805132317562, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4712; Top5: 0.7295
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4718801996672213, 'ACC_ID': 0.37437603993344426, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4671; Top5: 0.7268
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4678714859437751, 'ACC_ID': 0.37119908204245555, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4553; Top5: 0.7130
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4563106796116505, 'ACC_ID': 0.3579785909882997, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4400; Top5: 0.6893
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4407982261640798, 'ACC_ID': 0.34456762749445674, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4347; Top5: 0.6836
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43543543543543545, 'ACC_ID': 0.3425425425425425, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4325; Top5: 0.6818
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4328602620087336, 'ACC_ID': 0.3413391557496361, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4266; Top5: 0.6775
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42690253671562084, 'ACC_ID': 0.3391188251001335, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4269; Top5: 0.6782
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.427030359069194, 'ACC_ID': 0.3431961781476345, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4273; Top5: 0.6779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42753105811794945, 'ACC_ID': 0.3477081250892475, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4271; Top5: 0.6774
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4273720682302772, 'ACC_ID': 0.3508795309168444, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4223; Top5: 0.6733
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42247528469528217, 'ACC_ID': 0.3500187711175072, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4207; Top5: 0.6727
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42089165980472887, 'ACC_ID': 0.352311492765557, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4198; Top5: 0.6728
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4198218262806236, 'ACC_ID': 0.3547884187082405, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4159; Top5: 0.6706
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4160591653460116, 'ACC_ID': 0.3543581616481775, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4145; Top5: 0.6714
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4148, 'ACC_ID': 0.3564, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35309115 0.30802524 ... 0.16976635 0.16974871 0.10141562]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 41.4600; Top-5 accuracy: 67.1400
{'Method': 'rosita_knn_txt', 'AUC': 0.87727532, 'FPR95': 0.4853, 'ACC_ALL': 0.4148, 'ACC_ID': 0.3564, 'ACC_OOD': 0.9544, 'ACC_HM': 0.5189932255111382, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp1_kn10

Step 999: Top1: 0.5190; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3466933867735471, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5087; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5077081192189106, 'ACC_ID': 0.3442959917780062, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4983; Top5: 0.7508
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4979973297730307, 'ACC_ID': 0.35046728971962615, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4995; Top5: 0.7470
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4987430869783811, 'ACC_ID': 0.36048265460030166, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4651; Top5: 0.7077
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46471531676022454, 'ACC_ID': 0.33079390537289494, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4353; Top5: 0.6692
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43494176372712146, 'ACC_ID': 0.31148086522462565, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4281; Top5: 0.6582
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42771084337349397, 'ACC_ID': 0.3089500860585198, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4222; Top5: 0.6582
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42195668409260645, 'ACC_ID': 0.30893701767488174, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4152; Top5: 0.6529
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4150776053215078, 'ACC_ID': 0.30643015521064304, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4071; Top5: 0.6476
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4072072072072072, 'ACC_ID': 0.3009009009009009, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.3985; Top5: 0.6396
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.39865356622998543, 'ACC_ID': 0.29767103347889373, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.3894; Top5: 0.6291
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3895193591455274, 'ACC_ID': 0.2923898531375167, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.3870; Top5: 0.6259
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.38711665896131914, 'ACC_ID': 0.2912621359223301, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.3857; Top5: 0.6255
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.38583464229615877, 'ACC_ID': 0.2917321148079395, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.3847; Top5: 0.6239
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.384728144989339, 'ACC_ID': 0.29357675906183367, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.3807; Top5: 0.6207
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.380803403829308, 'ACC_ID': 0.2932048554623952, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.3784; Top5: 0.6188
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.37842606752146807, 'ACC_ID': 0.2920832843194918, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.3754; Top5: 0.6176
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.37538975501113586, 'ACC_ID': 0.2913140311804009, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.3735; Top5: 0.6192
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3734812466983624, 'ACC_ID': 0.29117802430005285, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.3734; Top5: 0.6201
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3734, 'ACC_ID': 0.2929, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35117131 0.31541738 ... 0.1688665  0.16877653 0.13957253]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 37.3400; Top-5 accuracy: 62.0100
{'Method': 'rosita_knn_txt', 'AUC': 0.8054105699999999, 'FPR95': 0.7193, 'ACC_ALL': 0.3734, 'ACC_ID': 0.2929, 'ACC_OOD': 0.8873, 'ACC_HM': 0.44041716658193525, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp1_kn10

Step 999: Top1: 0.5170; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.342685370741483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5077; Top5: 0.7626
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5077081192189106, 'ACC_ID': 0.35354573484069884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4963; Top5: 0.7515
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49666221628838453, 'ACC_ID': 0.35714285714285715, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5020; Top5: 0.7490
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5017596782302665, 'ACC_ID': 0.37104072398190047, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4988; Top5: 0.7418
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4987971130713713, 'ACC_ID': 0.3628708901363272, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4745; Top5: 0.7211
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4745424292845258, 'ACC_ID': 0.33710482529118135, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4439; Top5: 0.6835
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44377510040160645, 'ACC_ID': 0.31554790590935167, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4329; Top5: 0.6756
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43315907393577296, 'ACC_ID': 0.31341797361214835, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4291; Top5: 0.6702
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4292682926829268, 'ACC_ID': 0.311529933481153, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4229; Top5: 0.6684
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4232232232232232, 'ACC_ID': 0.3063063063063063, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4165; Top5: 0.6614
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4168486171761281, 'ACC_ID': 0.3027656477438137, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4071; Top5: 0.6516
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.40720961281708945, 'ACC_ID': 0.29572763684913217, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4037; Top5: 0.6463
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.40360610263522884, 'ACC_ID': 0.2918785637232239, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.3972; Top5: 0.6405
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3971155219191775, 'ACC_ID': 0.2851635013565615, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.3902; Top5: 0.6334
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.39019189765458423, 'ACC_ID': 0.2794509594882729, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.3846; Top5: 0.6249
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3846827681141284, 'ACC_ID': 0.2758102865723939, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.3809; Top5: 0.6211
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.38101399835313493, 'ACC_ID': 0.2733796023997177, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.3788; Top5: 0.6179
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.37884187082405346, 'ACC_ID': 0.27093541202672605, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.3756; Top5: 0.6159
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3756999471737982, 'ACC_ID': 0.26920232435287905, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.3749; Top5: 0.6152
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3751, 'ACC_ID': 0.2682, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35691851 0.3356849  ... 0.15636578 0.15336658 0.14324281]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 37.5000; Top-5 accuracy: 61.5200
{'Method': 'rosita_knn_txt', 'AUC': 0.5919240050000001, 'FPR95': 0.9488, 'ACC_ALL': 0.3751, 'ACC_ID': 0.2682, 'ACC_OOD': 0.6708, 'ACC_HM': 0.383191821086262, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=1, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp1_kn10

Step 999: Top1: 0.5190; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5190380761523046, 'ACC_ID': 0.342685370741483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5046; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5046248715313464, 'ACC_ID': 0.3710174717368962, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4876; Top5: 0.7515
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48798397863818427, 'ACC_ID': 0.3691588785046729, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4925; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4922071392659628, 'ACC_ID': 0.36752136752136755, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4932; Top5: 0.7418
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49318364073777066, 'ACC_ID': 0.3572574178027265, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4865; Top5: 0.7364
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.486522462562396, 'ACC_ID': 0.33976705490848585, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4732; Top5: 0.7211
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47332185886402756, 'ACC_ID': 0.3313253012048193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4693; Top5: 0.7179
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4695046054269355, 'ACC_ID': 0.3303460293751556, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4708; Top5: 0.7188
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47095343680709534, 'ACC_ID': 0.3321507760532151, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4692; Top5: 0.7187
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4694694694694695, 'ACC_ID': 0.33133133133133136, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4714; Top5: 0.7191
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47161572052401746, 'ACC_ID': 0.3380640465793304, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4665; Top5: 0.7166
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4666221628838451, 'ACC_ID': 0.3364485981308411, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4673; Top5: 0.7162
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46740638002773927, 'ACC_ID': 0.337956541840037, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4624; Top5: 0.7104
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46265886048836213, 'ACC_ID': 0.3347136941310867, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4583; Top5: 0.7046
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4584221748400853, 'ACC_ID': 0.33168976545842216, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4494; Top5: 0.6984
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44963083468902515, 'ACC_ID': 0.32649230384182204, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4455; Top5: 0.6954
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4455946359251853, 'ACC_ID': 0.32513821903305495, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4411; Top5: 0.6913
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4410913140311804, 'ACC_ID': 0.3208240534521158, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4360; Top5: 0.6868
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43592181722134177, 'ACC_ID': 0.31716851558372955, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4327; Top5: 0.6836
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4327, 'ACC_ID': 0.3135, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35059571 0.34866604 ... 0.18008439 0.18004622 0.17489401]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 43.2700; Top-5 accuracy: 68.3600
{'Method': 'rosita_knn_txt', 'AUC': 0.649050835, 'FPR95': 0.8618, 'ACC_ALL': 0.4327, 'ACC_ID': 0.3135, 'ACC_OOD': 0.6857, 'ACC_HM': 0.4302781224979984, 'kp': 1, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




2 1
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp2_kn1

Step 999: Top1: 0.7315; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7314629258517034, 'ACC_ID': 0.593186372745491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7503; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.750256937307297, 'ACC_ID': 0.6084275436793423, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7548; Top5: 0.9492
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7536715620827771, 'ACC_ID': 0.6048064085447263, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7596; Top5: 0.9527
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7586726998491704, 'ACC_ID': 0.6244343891402715, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7634; Top5: 0.9547
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7626303127506014, 'ACC_ID': 0.6319165998396151, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7521; Top5: 0.9551
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.751414309484193, 'ACC_ID': 0.63261231281198, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7535; Top5: 0.9535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7530120481927711, 'ACC_ID': 0.6408491107286288, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7493; Top5: 0.9532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7488175255165547, 'ACC_ID': 0.6427682350012447, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7481; Top5: 0.9536
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7476718403547672, 'ACC_ID': 0.6456762749445676, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7489; Top5: 0.9547
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7485485485485486, 'ACC_ID': 0.6518518518518519, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7464; Top5: 0.9554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7459970887918487, 'ACC_ID': 0.6499272197962155, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7438; Top5: 0.9556
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7434913217623498, 'ACC_ID': 0.6490320427236315, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7443; Top5: 0.9553
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7438742487286176, 'ACC_ID': 0.6512559716443211, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7424; Top5: 0.9559
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7422533200057119, 'ACC_ID': 0.6515778951877766, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7437; Top5: 0.9562
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7436034115138592, 'ACC_ID': 0.6536513859275054, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7447; Top5: 0.9566
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7445876611187586, 'ACC_ID': 0.6561131272681767, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7459; Top5: 0.9568
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7456769791789202, 'ACC_ID': 0.6586283966592166, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7447; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.744543429844098, 'ACC_ID': 0.6597995545657016, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7433; Top5: 0.9568
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.743053354463814, 'ACC_ID': 0.6600105652403592, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7411; Top5: 0.9566
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7409, 'ACC_ID': 0.6576, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33516595 0.30913162 ... 0.18799843 0.18551035 0.18298081]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 74.1100; Top-5 accuracy: 95.6600
{'Method': 'rosita_knn_txt', 'AUC': 0.96042435, 'FPR95': 0.257, 'ACC_ALL': 0.7409, 'ACC_ID': 0.6576, 'ACC_OOD': 0.9827, 'ACC_HM': 0.7879333292690361, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp2_kn1

Step 999: Top1: 0.7315; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.5991983967935872, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7461; Top5: 0.9404
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7492291880781089, 'ACC_ID': 0.6269270298047277, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7475; Top5: 0.9499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7496662216288384, 'ACC_ID': 0.6335113484646195, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7505; Top5: 0.9547
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7521367521367521, 'ACC_ID': 0.6410256410256411, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7558; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7566158781074579, 'ACC_ID': 0.6475541299117883, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7494; Top5: 0.9564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7500831946755407, 'ACC_ID': 0.6459234608985025, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7504; Top5: 0.9572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.751004016064257, 'ACC_ID': 0.6508892713711991, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7543; Top5: 0.9577
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7547921334329102, 'ACC_ID': 0.6564600448095593, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7558; Top5: 0.9574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.756319290465632, 'ACC_ID': 0.6556541019955654, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7569; Top5: 0.9575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7573573573573573, 'ACC_ID': 0.6552552552552553, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7522; Top5: 0.9547
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.75254730713246, 'ACC_ID': 0.649745269286754, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7473; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7476635514018691, 'ACC_ID': 0.6476969292389854, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7482; Top5: 0.9508
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7484974572353214, 'ACC_ID': 0.6497149021420866, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7464; Top5: 0.9504
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7466799942881622, 'ACC_ID': 0.6491503641296588, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7449; Top5: 0.9491
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7452025586353944, 'ACC_ID': 0.6472547974413646, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7447; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7449630834689025, 'ACC_ID': 0.6498560880991116, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7453; Top5: 0.9474
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7454417127396776, 'ACC_ID': 0.6516880367015645, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7438; Top5: 0.9464
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7439866369710467, 'ACC_ID': 0.6514476614699332, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7418; Top5: 0.9464
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7418911780243, 'ACC_ID': 0.65229793977813, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7403; Top5: 0.9455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7405, 'ACC_ID': 0.6518, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32109767 0.29832438 ... 0.1777861  0.17762226 0.15183382]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 74.0300; Top-5 accuracy: 94.5500
{'Method': 'rosita_knn_txt', 'AUC': 0.933043375, 'FPR95': 0.3904, 'ACC_ALL': 0.7405, 'ACC_ID': 0.6518, 'ACC_OOD': 0.9476, 'ACC_HM': 0.772346730023759, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp2_kn1

Step 999: Top1: 0.7335; Top5: 0.9439
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.591182364729459, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7482; Top5: 0.9383
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7492291880781089, 'ACC_ID': 0.6207605344295992, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7495; Top5: 0.9486
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7503337783711616, 'ACC_ID': 0.6288384512683578, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7540; Top5: 0.9537
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7551533433886375, 'ACC_ID': 0.6470588235294118, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7602; Top5: 0.9563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7614274258219728, 'ACC_ID': 0.6543704891740176, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7527; Top5: 0.9554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7537437603993344, 'ACC_ID': 0.648585690515807, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7541; Top5: 0.9558
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7550200803212851, 'ACC_ID': 0.6520367183017786, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7573; Top5: 0.9569
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7580283793876027, 'ACC_ID': 0.6544685088374409, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7598; Top5: 0.9579
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7605321507760532, 'ACC_ID': 0.6521064301552106, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7649; Top5: 0.9594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7655655655655655, 'ACC_ID': 0.6526526526526526, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7675; Top5: 0.9605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7681950509461426, 'ACC_ID': 0.6515647743813683, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7658; Top5: 0.9609
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7665220293724967, 'ACC_ID': 0.6468624833110814, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7670; Top5: 0.9612
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7676067190630298, 'ACC_ID': 0.646786870087841, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7684; Top5: 0.9619
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7690989575896044, 'ACC_ID': 0.6474368127945166, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7697; Top5: 0.9627
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7703891257995735, 'ACC_ID': 0.6471215351812367, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7705; Top5: 0.9630
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.771117507195595, 'ACC_ID': 0.6469778500813415, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7719; Top5: 0.9634
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7723797200329373, 'ACC_ID': 0.6469827079167156, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7717; Top5: 0.9635
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.772271714922049, 'ACC_ID': 0.6459910913140312, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7706; Top5: 0.9634
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7710512414157422, 'ACC_ID': 0.6438457474907554, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7708; Top5: 0.9632
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7714, 'ACC_ID': 0.6421, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.3237868  0.31281304 ... 0.17894822 0.17843986 0.15792313]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 77.0800; Top-5 accuracy: 96.3200
{'Method': 'rosita_knn_txt', 'AUC': 0.823336195, 'FPR95': 0.6469, 'ACC_ALL': 0.7714, 'ACC_ID': 0.6421, 'ACC_OOD': 0.752, 'ACC_HM': 0.692718169428305, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp2_kn1

Step 999: Top1: 0.7335; Top5: 0.9439
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.657314629258517, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7461; Top5: 0.9404
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7461459403905447, 'ACC_ID': 0.6834532374100719, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7508; Top5: 0.9499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7510013351134847, 'ACC_ID': 0.6955941255006676, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7555; Top5: 0.9542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.755656108597285, 'ACC_ID': 0.7058823529411765, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7586; Top5: 0.9563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7586206896551724, 'ACC_ID': 0.710906174819567, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7534; Top5: 0.9551
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7534109816971714, 'ACC_ID': 0.7011647254575707, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7538; Top5: 0.9555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7538726333907056, 'ACC_ID': 0.7016637980493402, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7580; Top5: 0.9572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7580283793876027, 'ACC_ID': 0.7052526761264626, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7611; Top5: 0.9579
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7609756097560976, 'ACC_ID': 0.7062084257206208, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7647; Top5: 0.9598
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7647647647647647, 'ACC_ID': 0.710910910910911, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7660; Top5: 0.9603
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7660116448326055, 'ACC_ID': 0.714155749636099, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7638; Top5: 0.9608
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7638518024032043, 'ACC_ID': 0.7127837116154874, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7648; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7648327939590076, 'ACC_ID': 0.715518569887502, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7645; Top5: 0.9612
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7645294873625589, 'ACC_ID': 0.7142653148650578, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7656; Top5: 0.9616
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7655916844349681, 'ACC_ID': 0.7138859275053305, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7663; Top5: 0.9621
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7663621574271055, 'ACC_ID': 0.7151795770241521, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7676; Top5: 0.9628
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7675567580284672, 'ACC_ID': 0.7156805081755088, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7673; Top5: 0.9629
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7673719376391982, 'ACC_ID': 0.7152561247216036, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7661; Top5: 0.9628
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7660855784469097, 'ACC_ID': 0.7147385103011094, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7662; Top5: 0.9624
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7663, 'ACC_ID': 0.7146, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32432169 0.31219536 ... 0.18453664 0.18452662 0.1426392 ]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.6200; Top-5 accuracy: 96.2400
{'Method': 'rosita_knn_txt', 'AUC': 0.894822915, 'FPR95': 0.3694, 'ACC_ALL': 0.7663, 'ACC_ID': 0.7146, 'ACC_OOD': 0.7592, 'ACC_HM': 0.7362251594517573, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp2_kn1

Step 999: Top1: 0.5150; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3366733466933868, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5005; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5015416238437821, 'ACC_ID': 0.3432682425488181, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4896; Top5: 0.7448
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48998664886515353, 'ACC_ID': 0.34512683578104136, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4920; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4922071392659628, 'ACC_ID': 0.35093011563599796, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4972; Top5: 0.7522
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49759422614274257, 'ACC_ID': 0.34643143544506816, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5015; Top5: 0.7584
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5018302828618968, 'ACC_ID': 0.3524126455906822, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4990; Top5: 0.7604
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49885255306942056, 'ACC_ID': 0.35197934595524955, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4954; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.495394573064476, 'ACC_ID': 0.3594722429673886, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4970; Top5: 0.7578
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49689578713968957, 'ACC_ID': 0.36851441241685146, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4924; Top5: 0.7533
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4924924924924925, 'ACC_ID': 0.37497497497497495, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4905; Top5: 0.7505
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49053857350800584, 'ACC_ID': 0.38355167394468703, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4839; Top5: 0.7450
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48397863818424564, 'ACC_ID': 0.3855140186915888, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4837; Top5: 0.7434
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.483587609801202, 'ACC_ID': 0.3925104022191401, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4816; Top5: 0.7434
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48165072111952023, 'ACC_ID': 0.3972583178637727, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4815; Top5: 0.7415
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4814765458422175, 'ACC_ID': 0.4025852878464819, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4795; Top5: 0.7406
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4796646227005381, 'ACC_ID': 0.40558127893880613, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4800; Top5: 0.7389
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48006116927420306, 'ACC_ID': 0.410304670038819, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4783; Top5: 0.7392
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4782850779510022, 'ACC_ID': 0.412249443207127, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4743; Top5: 0.7378
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47427363972530373, 'ACC_ID': 0.41162176439514, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4750; Top5: 0.7390
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.475, 'ACC_ID': 0.4157, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34867689 0.29417339 ... 0.15539008 0.1553776  0.1278118 ]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 47.5000; Top-5 accuracy: 73.9000
{'Method': 'rosita_knn_txt', 'AUC': 0.943661965, 'FPR95': 0.3581, 'ACC_ALL': 0.475, 'ACC_ID': 0.4157, 'ACC_OOD': 0.9738, 'ACC_HM': 0.5826680964375675, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp2_kn1

Step 999: Top1: 0.5150; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150300601202404, 'ACC_ID': 0.3366733466933868, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5026; Top5: 0.7533
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5025693730729702, 'ACC_ID': 0.3329907502569373, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4963; Top5: 0.7422
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4953271028037383, 'ACC_ID': 0.342456608811749, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5040; Top5: 0.7460
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5032679738562091, 'ACC_ID': 0.3403720462543992, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5076; Top5: 0.7514
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5072173215717722, 'ACC_ID': 0.3384121892542101, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5088; Top5: 0.7557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.508485856905158, 'ACC_ID': 0.3410981697171381, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5096; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5088927137119909, 'ACC_ID': 0.3427997705106139, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5113; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5108289768483943, 'ACC_ID': 0.34627831715210355, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5108; Top5: 0.7538
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51019955654102, 'ACC_ID': 0.35210643015521065, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4998; Top5: 0.7415
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4994994994994995, 'ACC_ID': 0.34434434434434436, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4904; Top5: 0.7309
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48999272197962157, 'ACC_ID': 0.3422489082969432, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4787; Top5: 0.7194
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47830440587449935, 'ACC_ID': 0.3371161548731642, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4778; Top5: 0.7181
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4774233317922638, 'ACC_ID': 0.3388811835413777, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4751; Top5: 0.7201
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47493931172354703, 'ACC_ID': 0.34185349136084536, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4753; Top5: 0.7205
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4750799573560768, 'ACC_ID': 0.3463486140724947, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4736; Top5: 0.7203
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4734075835314729, 'ACC_ID': 0.34889250406707545, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4731; Top5: 0.7201
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47288554287730855, 'ACC_ID': 0.3520762263263146, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4704; Top5: 0.7192
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4702672605790646, 'ACC_ID': 0.3538975501113586, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4680; Top5: 0.7166
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46782884310618067, 'ACC_ID': 0.35404120443740095, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4646; Top5: 0.7140
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4644, 'ACC_ID': 0.3531, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34445459 0.30401096 ... 0.18172294 0.18154863 0.15179752]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 46.4600; Top-5 accuracy: 71.4000
{'Method': 'rosita_knn_txt', 'AUC': 0.8226801450000001, 'FPR95': 0.7053, 'ACC_ALL': 0.4644, 'ACC_ID': 0.3531, 'ACC_OOD': 0.9167, 'ACC_HM': 0.5098232320050402, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp2_kn1

Step 999: Top1: 0.5150; Top5: 0.7515
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3406813627254509, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5036; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5046248715313464, 'ACC_ID': 0.3566289825282631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4950; Top5: 0.7442
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4959946595460614, 'ACC_ID': 0.3658210947930574, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5055; Top5: 0.7500
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5062845651080945, 'ACC_ID': 0.3740573152337858, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5108; Top5: 0.7534
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5116279069767442, 'ACC_ID': 0.37169206094627105, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5131; Top5: 0.7591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.513810316139767, 'ACC_ID': 0.37337770382695507, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5116; Top5: 0.7601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5120481927710844, 'ACC_ID': 0.3743545611015491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5128; Top5: 0.7603
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5133183968135424, 'ACC_ID': 0.37316405277570325, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5159; Top5: 0.7611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5161862527716187, 'ACC_ID': 0.3729490022172949, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5132; Top5: 0.7611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5137137137137137, 'ACC_ID': 0.37497497497497495, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5155; Top5: 0.7627
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5156477438136827, 'ACC_ID': 0.37390829694323147, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5093; Top5: 0.7603
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5093457943925234, 'ACC_ID': 0.37066088117489987, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5113; Top5: 0.7620
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.511326860841424, 'ACC_ID': 0.37555863769456005, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5099; Top5: 0.7634
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5100671140939598, 'ACC_ID': 0.37583892617449666, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5099; Top5: 0.7632
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5101279317697228, 'ACC_ID': 0.37593283582089554, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5081; Top5: 0.7623
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5083218620948567, 'ACC_ID': 0.37504692779376797, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5085; Top5: 0.7622
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5086460416421598, 'ACC_ID': 0.3764263027879073, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5082; Top5: 0.7623
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5082405345211581, 'ACC_ID': 0.37739420935412027, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5075; Top5: 0.7623
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.507554146856841, 'ACC_ID': 0.3763338615953513, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5077; Top5: 0.7643
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5077, 'ACC_ID': 0.3777, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34501562 0.33306921 ... 0.18564215 0.18280287 0.17926127]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 50.7600; Top-5 accuracy: 76.4200
{'Method': 'rosita_knn_txt', 'AUC': 0.702613015, 'FPR95': 0.8575, 'ACC_ALL': 0.5077, 'ACC_ID': 0.3777, 'ACC_OOD': 0.6732, 'ACC_HM': 0.48390453896660013, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp2_kn1

Step 999: Top1: 0.5150; Top5: 0.7495
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150300601202404, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5026; Top5: 0.7544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5046248715313464, 'ACC_ID': 0.35354573484069884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4950; Top5: 0.7442
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49666221628838453, 'ACC_ID': 0.3644859813084112, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5040; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5052790346907994, 'ACC_ID': 0.3745600804424334, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5092; Top5: 0.7514
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5104250200481155, 'ACC_ID': 0.3769045709703288, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5101; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5111480865224626, 'ACC_ID': 0.3790349417637271, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5099; Top5: 0.7572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5100401606425703, 'ACC_ID': 0.3815261044176707, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5103; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5105800348518795, 'ACC_ID': 0.3793876026885736, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5123; Top5: 0.7587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5124168514412417, 'ACC_ID': 0.38203991130820397, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5098; Top5: 0.7581
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5101101101101101, 'ACC_ID': 0.38238238238238237, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5126; Top5: 0.7582
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5127365356622998, 'ACC_ID': 0.3864628820960699, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5071; Top5: 0.7550
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5071762349799733, 'ACC_ID': 0.38067423230974634, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5099; Top5: 0.7574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5100940052396363, 'ACC_ID': 0.38480505470796733, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5080; Top5: 0.7599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5082107668142225, 'ACC_ID': 0.38497786662858774, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5084; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5085287846481876, 'ACC_ID': 0.38699360341151384, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5065; Top5: 0.7591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066950319108997, 'ACC_ID': 0.3850581904642723, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5068; Top5: 0.7587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5069991765674626, 'ACC_ID': 0.3853664274791201, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5065; Top5: 0.7594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5065701559020045, 'ACC_ID': 0.38552338530066815, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5058; Top5: 0.7591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5058637083993661, 'ACC_ID': 0.384891706286318, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5060; Top5: 0.7612
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.506, 'ACC_ID': 0.385, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34907004 0.34453151 ... 0.18244798 0.18203901 0.1712881 ]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 50.5900; Top-5 accuracy: 76.1100
{'Method': 'rosita_knn_txt', 'AUC': 0.69804221, 'FPR95': 0.8081, 'ACC_ALL': 0.506, 'ACC_ID': 0.385, 'ACC_OOD': 0.6626, 'ACC_HM': 0.4870198549064527, 'kp': 2, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




2 3
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp2_kn3

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7503; Top5: 0.9466
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7512846865364851, 'ACC_ID': 0.6094552929085303, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7535; Top5: 0.9532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7536715620827771, 'ACC_ID': 0.6188251001335113, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7570; Top5: 0.9527
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7566616390145802, 'ACC_ID': 0.637506284565108, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7542; Top5: 0.9543
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7542101042502005, 'ACC_ID': 0.6479550922213312, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7438; Top5: 0.9524
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7437603993344426, 'ACC_ID': 0.6455906821963394, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7443; Top5: 0.9512
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7444061962134251, 'ACC_ID': 0.6483075157773953, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7409; Top5: 0.9507
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7408513816280806, 'ACC_ID': 0.6519790888722927, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7412; Top5: 0.9512
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7412416851441241, 'ACC_ID': 0.6556541019955654, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7419; Top5: 0.9521
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.741941941941942, 'ACC_ID': 0.6598598598598598, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7387; Top5: 0.9518
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7387190684133915, 'ACC_ID': 0.6561135371179039, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7358; Top5: 0.9516
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7358144192256342, 'ACC_ID': 0.6538718291054739, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7371; Top5: 0.9511
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7369394359685622, 'ACC_ID': 0.6527970411465557, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7354; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7355419106097387, 'ACC_ID': 0.6521490789661574, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7376; Top5: 0.9527
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7377398720682303, 'ACC_ID': 0.654184434968017, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7375; Top5: 0.9531
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7377049180327869, 'ACC_ID': 0.6552371417845075, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7372; Top5: 0.9541
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7372073873661922, 'ACC_ID': 0.6585107634395954, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7355; Top5: 0.9538
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7356347438752784, 'ACC_ID': 0.6593541202672606, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7333; Top5: 0.9536
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7333333333333333, 'ACC_ID': 0.6591653460116218, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7311; Top5: 0.9531
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7312, 'ACC_ID': 0.6596, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33634567 0.29982066 ... 0.17853969 0.17853421 0.1548678 ]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 73.1100; Top-5 accuracy: 95.3100
{'Method': 'rosita_knn_txt', 'AUC': 0.96281416, 'FPR95': 0.2503, 'ACC_ALL': 0.7312, 'ACC_ID': 0.6596, 'ACC_OOD': 0.9801, 'ACC_HM': 0.7885271208147832, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp2_kn3

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7523; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7523124357656732, 'ACC_ID': 0.6351490236382322, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7535; Top5: 0.9499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7536715620827771, 'ACC_ID': 0.6308411214953271, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7580; Top5: 0.9552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7581699346405228, 'ACC_ID': 0.6520864756158874, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7594; Top5: 0.9571
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7594226142742582, 'ACC_ID': 0.6583801122694467, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7524; Top5: 0.9571
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7524126455906822, 'ACC_ID': 0.6475873544093178, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7524; Top5: 0.9575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7524383247274814, 'ACC_ID': 0.6485943775100401, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7498; Top5: 0.9529
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7498132935026139, 'ACC_ID': 0.6415235250186706, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7438; Top5: 0.9472
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7439024390243902, 'ACC_ID': 0.6399113082039911, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7403; Top5: 0.9455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7403403403403404, 'ACC_ID': 0.6410410410410411, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7354; Top5: 0.9440
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354439592430859, 'ACC_ID': 0.637372634643377, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7326; Top5: 0.9436
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7326435246995995, 'ACC_ID': 0.6373497997329773, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7330; Top5: 0.9431
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7329326552627523, 'ACC_ID': 0.6404684851286793, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7296; Top5: 0.9430
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7296872768813366, 'ACC_ID': 0.6388690561188062, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7297; Top5: 0.9428
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7297441364605544, 'ACC_ID': 0.6417910447761194, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7293; Top5: 0.9428
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7293204855462395, 'ACC_ID': 0.6398448254286072, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7284; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7282672626749794, 'ACC_ID': 0.6374544171273968, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7271; Top5: 0.9429
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7270601336302895, 'ACC_ID': 0.6380846325167038, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7234; Top5: 0.9429
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7232963549920761, 'ACC_ID': 0.6369783412572636, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7218; Top5: 0.9426
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7218, 'ACC_ID': 0.6373, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33125445 0.29031521 ... 0.16560112 0.15660088 0.15396416]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 72.1800; Top-5 accuracy: 94.2600
{'Method': 'rosita_knn_txt', 'AUC': 0.934455265, 'FPR95': 0.3879, 'ACC_ALL': 0.7218, 'ACC_ID': 0.6373, 'ACC_OOD': 0.9467, 'ACC_HM': 0.7617827146464645, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp2_kn3

Step 999: Top1: 0.7355; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7394789579158316, 'ACC_ID': 0.5971943887775552, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7513; Top5: 0.9424
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7533401849948612, 'ACC_ID': 0.6289825282631039, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7542; Top5: 0.9506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7563417890520694, 'ACC_ID': 0.6461949265687583, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7591; Top5: 0.9557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7606837606837606, 'ACC_ID': 0.6621417797888386, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7618; Top5: 0.9579
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7626303127506014, 'ACC_ID': 0.6591820368885325, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7531; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7537437603993344, 'ACC_ID': 0.6455906821963394, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7544; Top5: 0.9575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7550200803212851, 'ACC_ID': 0.6477337923121056, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7565; Top5: 0.9589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7570326114015434, 'ACC_ID': 0.6492407269106298, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7596; Top5: 0.9594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7600886917960089, 'ACC_ID': 0.6505543237250554, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7645; Top5: 0.9606
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7649649649649649, 'ACC_ID': 0.6528528528528529, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7664; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7667394468704513, 'ACC_ID': 0.6486535662299855, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7643; Top5: 0.9603
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7646862483311081, 'ACC_ID': 0.6430240320427236, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7653; Top5: 0.9599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7654492217599014, 'ACC_ID': 0.6433965171829249, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7645; Top5: 0.9597
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7648150792517493, 'ACC_ID': 0.6441525060688277, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7652; Top5: 0.9602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7654584221748401, 'ACC_ID': 0.6384594882729211, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7667; Top5: 0.9605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.766987861344012, 'ACC_ID': 0.6403453885621324, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7682; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7683801905658157, 'ACC_ID': 0.6426302787907305, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7675; Top5: 0.9608
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7677060133630289, 'ACC_ID': 0.6442093541202673, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7653; Top5: 0.9605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7654516640253566, 'ACC_ID': 0.6424722662440571, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7657; Top5: 0.9608
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7659, 'ACC_ID': 0.6417, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32313177 0.31184119 ... 0.17374983 0.17343339 0.16051513]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.5700; Top-5 accuracy: 96.0800
{'Method': 'rosita_knn_txt', 'AUC': 0.818096565, 'FPR95': 0.6669, 'ACC_ALL': 0.7659, 'ACC_ID': 0.6417, 'ACC_OOD': 0.7441, 'ACC_HM': 0.6891167123683071, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp2_kn3

Step 999: Top1: 0.7315; Top5: 0.9439
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.6593186372745491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7492; Top5: 0.9445
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7512846865364851, 'ACC_ID': 0.6947584789311408, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7528; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7543391188251002, 'ACC_ID': 0.705607476635514, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7575; Top5: 0.9557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7586726998491704, 'ACC_ID': 0.7149321266968326, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7594; Top5: 0.9587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7602245388933441, 'ACC_ID': 0.7169206094627105, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7547; Top5: 0.9581
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7554076539101497, 'ACC_ID': 0.7051580698835275, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7561; Top5: 0.9587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7567412507171544, 'ACC_ID': 0.708548479632817, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7588; Top5: 0.9597
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7592730893701768, 'ACC_ID': 0.7114762260393328, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7607; Top5: 0.9594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7611973392461198, 'ACC_ID': 0.7126385809312639, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7635; Top5: 0.9606
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7639639639639639, 'ACC_ID': 0.7151151151151152, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7636; Top5: 0.9605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7640101892285298, 'ACC_ID': 0.7136098981077147, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7611; Top5: 0.9599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7615153538050734, 'ACC_ID': 0.709279038718291, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7614; Top5: 0.9598
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7617506549545384, 'ACC_ID': 0.7095083988287871, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7618; Top5: 0.9602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.762101956304441, 'ACC_ID': 0.7085534770812509, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7629; Top5: 0.9606
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7631929637526652, 'ACC_ID': 0.7088219616204691, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7643; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7646101864597672, 'ACC_ID': 0.7100488049055187, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7654; Top5: 0.9606
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7655569932949065, 'ACC_ID': 0.7113280790495236, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7649; Top5: 0.9606
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7649220489977728, 'ACC_ID': 0.7116926503340757, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7626; Top5: 0.9606
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7625990491283676, 'ACC_ID': 0.7107237189646064, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7620; Top5: 0.9601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.762, 'ACC_ID': 0.7102, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32340789 0.30870637 ... 0.18275249 0.18273142 0.13379523]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.2000; Top-5 accuracy: 96.0100
{'Method': 'rosita_knn_txt', 'AUC': 0.8963297899999999, 'FPR95': 0.3676, 'ACC_ALL': 0.762, 'ACC_ID': 0.7102, 'ACC_OOD': 0.7685, 'ACC_HM': 0.7382007168458782, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp2_kn3

Step 999: Top1: 0.5170; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.33266533066132264, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5036; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5046248715313464, 'ACC_ID': 0.32065775950668035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4903; Top5: 0.7482
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49132176234979974, 'ACC_ID': 0.3164218958611482, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4980; Top5: 0.7485
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4987430869783811, 'ACC_ID': 0.33283056812468576, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5012; Top5: 0.7502
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5020048115477145, 'ACC_ID': 0.3440256615878107, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5038; Top5: 0.7494
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5044925124792013, 'ACC_ID': 0.3560732113144759, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5001; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5005737234652897, 'ACC_ID': 0.3608720596672404, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4956; Top5: 0.7441
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49614139905402044, 'ACC_ID': 0.3656957928802589, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4921; Top5: 0.7414
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4924611973392461, 'ACC_ID': 0.3696230598669623, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4888; Top5: 0.7399
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4892892892892893, 'ACC_ID': 0.3705705705705706, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4900; Top5: 0.7422
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4903566229985444, 'ACC_ID': 0.3748180494905386, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4862; Top5: 0.7399
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48664886515353806, 'ACC_ID': 0.37232977303070763, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4875; Top5: 0.7398
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4877484974572353, 'ACC_ID': 0.37540453074433655, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4887; Top5: 0.7395
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4892189061830644, 'ACC_ID': 0.37683849778666284, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4880; Top5: 0.7388
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48840618336886993, 'ACC_ID': 0.3781982942430704, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4844; Top5: 0.7379
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48479539481917155, 'ACC_ID': 0.3775497434613941, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4835; Top5: 0.7371
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48394306552170335, 'ACC_ID': 0.3779555346429832, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4819; Top5: 0.7371
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48229398663697104, 'ACC_ID': 0.37917594654788417, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4794; Top5: 0.7348
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4797675647120972, 'ACC_ID': 0.37823560486001057, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4775; Top5: 0.7344
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4779, 'ACC_ID': 0.3788, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.3592689  0.30977714 ... 0.19278771 0.19224599 0.18475191]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 47.7500; Top-5 accuracy: 73.4400
{'Method': 'rosita_knn_txt', 'AUC': 0.87354217, 'FPR95': 0.6801, 'ACC_ALL': 0.4779, 'ACC_ID': 0.3788, 'ACC_OOD': 0.9303, 'ACC_HM': 0.5383815445726072, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp2_kn3

Step 999: Top1: 0.5150; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150300601202404, 'ACC_ID': 0.3406813627254509, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5015; Top5: 0.7585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5015416238437821, 'ACC_ID': 0.3329907502569373, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4957; Top5: 0.7462
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4959946595460614, 'ACC_ID': 0.3444592790387183, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5015; Top5: 0.7485
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5017596782302665, 'ACC_ID': 0.3464052287581699, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5068; Top5: 0.7526
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5076182838813151, 'ACC_ID': 0.3448275862068966, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5068; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5074875207986689, 'ACC_ID': 0.3507487520798669, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4867; Top5: 0.7352
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48709122203098104, 'ACC_ID': 0.3373493975903614, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4712; Top5: 0.7177
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4719940253920836, 'ACC_ID': 0.329848145382126, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4582; Top5: 0.7030
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4587583148558758, 'ACC_ID': 0.3254988913525499, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4453; Top5: 0.6896
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44584584584584586, 'ACC_ID': 0.3157157157157157, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4347; Top5: 0.6792
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43504366812227074, 'ACC_ID': 0.3111353711790393, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4261; Top5: 0.6688
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4264018691588785, 'ACC_ID': 0.3074098798397864, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4276; Top5: 0.6700
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4278008938203113, 'ACC_ID': 0.3125288950531669, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4284; Top5: 0.6714
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42867342567471084, 'ACC_ID': 0.3137226902755962, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4270; Top5: 0.6715
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42723880597014924, 'ACC_ID': 0.3138326226012793, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4212; Top5: 0.6648
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42147415842823177, 'ACC_ID': 0.31072456513577773, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4142; Top5: 0.6566
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.41453946594518293, 'ACC_ID': 0.3066698035525232, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4117; Top5: 0.6545
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4119153674832962, 'ACC_ID': 0.30679287305122493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4106; Top5: 0.6537
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4106708927628104, 'ACC_ID': 0.3071315372424723, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4109; Top5: 0.6560
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4111, 'ACC_ID': 0.3103, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33840704 0.30405277 ... 0.174465   0.17438982 0.16157781]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 41.1000; Top-5 accuracy: 65.6000
{'Method': 'rosita_knn_txt', 'AUC': 0.805637485, 'FPR95': 0.6883, 'ACC_ALL': 0.4111, 'ACC_ID': 0.3103, 'ACC_OOD': 0.9196, 'ACC_HM': 0.46402452231888774, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp2_kn3

Step 999: Top1: 0.5170; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3406813627254509, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5077; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066803699897225, 'ACC_ID': 0.35765673175745116, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4997; Top5: 0.7482
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4986648865153538, 'ACC_ID': 0.3638184245660881, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5075; Top5: 0.7515
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5072900955253896, 'ACC_ID': 0.37355455002513827, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5116; Top5: 0.7558
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5120288692862871, 'ACC_ID': 0.37570168404170007, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5131; Top5: 0.7597
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.513810316139767, 'ACC_ID': 0.37271214642262895, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5122; Top5: 0.7613
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5126219162363741, 'ACC_ID': 0.37464142283419394, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5123; Top5: 0.7593
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5128205128205128, 'ACC_ID': 0.3739108787652477, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5134; Top5: 0.7589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5137472283813748, 'ACC_ID': 0.3740576496674058, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5096; Top5: 0.7583
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5101101101101101, 'ACC_ID': 0.37357357357357357, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5113; Top5: 0.7586
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5116448326055313, 'ACC_ID': 0.37590975254730713, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5054; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5056742323097463, 'ACC_ID': 0.371328437917223, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5079; Top5: 0.7568
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5080906148867314, 'ACC_ID': 0.3749422098936662, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5054; Top5: 0.7584
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5057832357561045, 'ACC_ID': 0.373696987005569, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5044; Top5: 0.7587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5047974413646056, 'ACC_ID': 0.37406716417910446, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5029; Top5: 0.7578
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5033162307596045, 'ACC_ID': 0.3717932674258541, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5022; Top5: 0.7576
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5026467474414775, 'ACC_ID': 0.3713680743441948, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5015; Top5: 0.7573
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.501781737193764, 'ACC_ID': 0.3712694877505568, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5000; Top5: 0.7573
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5002641310089805, 'ACC_ID': 0.369783412572636, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5005; Top5: 0.7592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5007, 'ACC_ID': 0.3701, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35006002 0.32813072 ... 0.18648888 0.1827084  0.17492902]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 50.0400; Top-5 accuracy: 75.9100
{'Method': 'rosita_knn_txt', 'AUC': 0.70376993, 'FPR95': 0.8582, 'ACC_ALL': 0.5007, 'ACC_ID': 0.3701, 'ACC_OOD': 0.7051, 'ACC_HM': 0.48541203497023805, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp2_kn3

Step 999: Top1: 0.5150; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150300601202404, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5067; Top5: 0.7585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066803699897225, 'ACC_ID': 0.3545734840698869, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4970; Top5: 0.7468
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49666221628838453, 'ACC_ID': 0.3684913217623498, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5060; Top5: 0.7495
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5057817998994469, 'ACC_ID': 0.37858220211161386, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5100; Top5: 0.7522
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5100240577385726, 'ACC_ID': 0.37610264635124296, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5115; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5114808652246257, 'ACC_ID': 0.3773710482529118, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5093; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5091795754446357, 'ACC_ID': 0.38095238095238093, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5083; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5083395568832462, 'ACC_ID': 0.3786407766990291, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5101; Top5: 0.7558
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51019955654102, 'ACC_ID': 0.38181818181818183, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5078; Top5: 0.7549
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5081081081081081, 'ACC_ID': 0.3835835835835836, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5102; Top5: 0.7540
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5103711790393013, 'ACC_ID': 0.3859170305676856, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5036; Top5: 0.7506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5038384512683578, 'ACC_ID': 0.37983978638184246, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5060; Top5: 0.7525
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5063954384342734, 'ACC_ID': 0.38295577130528585, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5039; Top5: 0.7541
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5043552763101528, 'ACC_ID': 0.3821219477366843, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5037; Top5: 0.7551
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5041311300639659, 'ACC_ID': 0.38232942430703626, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5015; Top5: 0.7548
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5018145413590289, 'ACC_ID': 0.37955199599549494, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5007; Top5: 0.7546
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5009998823667804, 'ACC_ID': 0.3777202682037407, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5005; Top5: 0.7549
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5006681514476615, 'ACC_ID': 0.37839643652561245, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4988; Top5: 0.7542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49899630216587426, 'ACC_ID': 0.37707342842049657, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4985; Top5: 0.7556
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4987, 'ACC_ID': 0.3779, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34991565 0.34976989 ... 0.1821692  0.18168402 0.17103457]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 49.8500; Top-5 accuracy: 75.5600
{'Method': 'rosita_knn_txt', 'AUC': 0.701566525, 'FPR95': 0.8028, 'ACC_ALL': 0.4987, 'ACC_ID': 0.3779, 'ACC_OOD': 0.6726, 'ACC_HM': 0.4839134507377439, 'kp': 2, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




2 5
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp2_kn5

Step 999: Top1: 0.7355; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.5991983967935872, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7513; Top5: 0.9466
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7523124357656732, 'ACC_ID': 0.6115107913669064, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7562; Top5: 0.9526
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7570093457943925, 'ACC_ID': 0.6248331108144193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7535; Top5: 0.9522
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7536450477626948, 'ACC_ID': 0.6405228758169934, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7510; Top5: 0.9543
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7514033680834001, 'ACC_ID': 0.6499599037690457, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7421; Top5: 0.9517
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7424292845257904, 'ACC_ID': 0.6465890183028287, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7418; Top5: 0.9501
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7421113023522662, 'ACC_ID': 0.6500286861732645, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7381; Top5: 0.9497
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7383619616629326, 'ACC_ID': 0.6499875529001743, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7363; Top5: 0.9499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7365853658536585, 'ACC_ID': 0.6496674057649667, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7367; Top5: 0.9509
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.736936936936937, 'ACC_ID': 0.6498498498498498, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7336; Top5: 0.9509
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.733806404657933, 'ACC_ID': 0.644650655021834, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7309; Top5: 0.9508
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7309746328437917, 'ACC_ID': 0.640520694259012, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7312; Top5: 0.9510
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7310833718600709, 'ACC_ID': 0.6407766990291263, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7301; Top5: 0.9526
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7301156647151221, 'ACC_ID': 0.6424389547336856, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7328; Top5: 0.9531
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7328091684434968, 'ACC_ID': 0.6475213219616205, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7314; Top5: 0.9529
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7314478788637216, 'ACC_ID': 0.6491052433988237, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7312; Top5: 0.9538
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7310904599458887, 'ACC_ID': 0.6522762027996706, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7299; Top5: 0.9531
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7299554565701559, 'ACC_ID': 0.6538975501113585, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7275; Top5: 0.9531
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7274167987321711, 'ACC_ID': 0.654622292657158, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7259; Top5: 0.9527
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7259, 'ACC_ID': 0.6558, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33912489 0.2961297  ... 0.1716834  0.17166713 0.14946505]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 72.5900; Top-5 accuracy: 95.2700
{'Method': 'rosita_knn_txt', 'AUC': 0.9617427000000001, 'FPR95': 0.2878, 'ACC_ALL': 0.7259, 'ACC_ID': 0.6558, 'ACC_OOD': 0.9833, 'ACC_HM': 0.7868319687633457, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp2_kn5

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7523; Top5: 0.9424
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7523124357656732, 'ACC_ID': 0.6269270298047277, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7535; Top5: 0.9492
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7543391188251002, 'ACC_ID': 0.6281708945260347, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7575; Top5: 0.9542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7581699346405228, 'ACC_ID': 0.6495726495726496, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7582; Top5: 0.9571
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7586206896551724, 'ACC_ID': 0.6503608660785886, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7507; Top5: 0.9564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.751414309484193, 'ACC_ID': 0.6422628951747088, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7509; Top5: 0.9535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7515777395295468, 'ACC_ID': 0.6371199082042456, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7431; Top5: 0.9450
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7435897435897436, 'ACC_ID': 0.633059497137167, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7365; Top5: 0.9412
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7370288248337029, 'ACC_ID': 0.634589800443459, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7357; Top5: 0.9423
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7363363363363363, 'ACC_ID': 0.6374374374374374, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7324; Top5: 0.9416
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7327147016011645, 'ACC_ID': 0.6355531295487628, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7286; Top5: 0.9409
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7289719626168224, 'ACC_ID': 0.6350133511348465, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7275; Top5: 0.9396
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7278471259053784, 'ACC_ID': 0.6372322391739867, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7254; Top5: 0.9397
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7256889904326718, 'ACC_ID': 0.63786948450664, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7257; Top5: 0.9392
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7260127931769723, 'ACC_ID': 0.6409914712153518, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7248; Top5: 0.9399
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7250656989112751, 'ACC_ID': 0.6397196846452259, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7239; Top5: 0.9401
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7240324667686154, 'ACC_ID': 0.6382778496647453, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7230; Top5: 0.9393
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7231625835189309, 'ACC_ID': 0.6393095768374165, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7198; Top5: 0.9393
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7199154780771263, 'ACC_ID': 0.6387744321183307, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7186; Top5: 0.9389
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7188, 'ACC_ID': 0.6389, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.3325302  0.29112709 ... 0.1762061  0.15349209 0.15130261]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 71.8600; Top-5 accuracy: 93.8900
{'Method': 'rosita_knn_txt', 'AUC': 0.9413126350000001, 'FPR95': 0.3456, 'ACC_ALL': 0.7188, 'ACC_ID': 0.6389, 'ACC_OOD': 0.9565, 'ACC_HM': 0.7660873135263883, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp2_kn5

Step 999: Top1: 0.7395; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7394789579158316, 'ACC_ID': 0.5991983967935872, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7544; Top5: 0.9424
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7553956834532374, 'ACC_ID': 0.6330935251798561, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7568; Top5: 0.9499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7576769025367156, 'ACC_ID': 0.6488651535380507, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7596; Top5: 0.9552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7601809954751131, 'ACC_ID': 0.6671694318753142, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7622; Top5: 0.9587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7622293504410586, 'ACC_ID': 0.665196471531676, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7531; Top5: 0.9587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7530782029950083, 'ACC_ID': 0.6495840266222962, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7547; Top5: 0.9593
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7547332185886403, 'ACC_ID': 0.6520367183017786, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7575; Top5: 0.9602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7577794373910879, 'ACC_ID': 0.6514812048792631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7605; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7605321507760532, 'ACC_ID': 0.6492239467849223, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7651; Top5: 0.9614
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7651651651651652, 'ACC_ID': 0.6452452452452453, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7656; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7656477438136827, 'ACC_ID': 0.6395560407569141, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7631; Top5: 0.9606
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7631842456608812, 'ACC_ID': 0.6380173564753004, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7646; Top5: 0.9601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7645245800585606, 'ACC_ID': 0.6393897364771152, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7642; Top5: 0.9600
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7641010995287734, 'ACC_ID': 0.6410109952877339, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7657; Top5: 0.9606
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7655916844349681, 'ACC_ID': 0.636727078891258, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7675; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7672381429107746, 'ACC_ID': 0.6378425728945063, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7686; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7682625573461945, 'ACC_ID': 0.6401599811786849, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7681; Top5: 0.9609
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7679287305122494, 'ACC_ID': 0.6417594654788419, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7661; Top5: 0.9608
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7657686212361331, 'ACC_ID': 0.6409931325937666, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7656; Top5: 0.9608
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7654, 'ACC_ID': 0.6397, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32535407 0.31259707 ... 0.16121772 0.15997185 0.15989624]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.5600; Top-5 accuracy: 96.0800
{'Method': 'rosita_knn_txt', 'AUC': 0.81501207, 'FPR95': 0.666, 'ACC_ALL': 0.7654, 'ACC_ID': 0.6397, 'ACC_OOD': 0.7468, 'ACC_HM': 0.689113537684818, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp2_kn5

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.6593186372745491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7492; Top5: 0.9445
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7482014388489209, 'ACC_ID': 0.6927029804727647, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7502; Top5: 0.9526
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7503337783711616, 'ACC_ID': 0.7062750333778371, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7565; Top5: 0.9557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7566616390145802, 'ACC_ID': 0.7169431875314228, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7574; Top5: 0.9591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7574178027265437, 'ACC_ID': 0.7177225340817963, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7521; Top5: 0.9581
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7520798668885191, 'ACC_ID': 0.7044925124792013, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7529; Top5: 0.9590
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7527251864601262, 'ACC_ID': 0.7059667240390132, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7550; Top5: 0.9592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7547921334329102, 'ACC_ID': 0.7064973861090366, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7565; Top5: 0.9590
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7560975609756098, 'ACC_ID': 0.7066518847006652, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7599; Top5: 0.9600
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7595595595595596, 'ACC_ID': 0.7095095095095095, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7602; Top5: 0.9592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.759825327510917, 'ACC_ID': 0.7077874818049491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7583; Top5: 0.9584
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7578437917222964, 'ACC_ID': 0.7029372496662216, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7588; Top5: 0.9582
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7583603020496225, 'ACC_ID': 0.7030359069194021, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7591; Top5: 0.9589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7586748536341568, 'ACC_ID': 0.7029844352420391, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7608; Top5: 0.9592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7603944562899787, 'ACC_ID': 0.7030916844349681, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7626; Top5: 0.9596
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7622325115755224, 'ACC_ID': 0.7057940182705543, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7636; Top5: 0.9599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.763204328902482, 'ACC_ID': 0.7073285495824021, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7638; Top5: 0.9599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7633630289532294, 'ACC_ID': 0.7084632516703786, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7613; Top5: 0.9595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7609086106708928, 'ACC_ID': 0.7074484944532489, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7606; Top5: 0.9590
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7603, 'ACC_ID': 0.7068, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32399809 0.31281573 ... 0.18376225 0.18375945 0.13315484]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.0600; Top-5 accuracy: 95.9000
{'Method': 'rosita_knn_txt', 'AUC': 0.8936371399999999, 'FPR95': 0.3767, 'ACC_ALL': 0.7603, 'ACC_ID': 0.7068, 'ACC_OOD': 0.7688, 'ACC_HM': 0.7364974789915967, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp2_kn5

Step 999: Top1: 0.5170; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5190380761523046, 'ACC_ID': 0.3346693386773547, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5015; Top5: 0.7544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5025693730729702, 'ACC_ID': 0.31654676258992803, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4870; Top5: 0.7428
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48731642189586116, 'ACC_ID': 0.3184245660881175, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4904; Top5: 0.7450
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49019607843137253, 'ACC_ID': 0.3358471593765711, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4928; Top5: 0.7494
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49278267842822776, 'ACC_ID': 0.3504410585404972, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4915; Top5: 0.7484
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4915141430948419, 'ACC_ID': 0.3580698835274542, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4838; Top5: 0.7449
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4836488812392427, 'ACC_ID': 0.36259323006310956, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4795; Top5: 0.7399
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.479462285287528, 'ACC_ID': 0.37440876275827734, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4728; Top5: 0.7363
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4727272727272727, 'ACC_ID': 0.3782705099778271, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4676; Top5: 0.7343
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46766766766766765, 'ACC_ID': 0.3821821821821822, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4672; Top5: 0.7331
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4670669577874818, 'ACC_ID': 0.38919213973799127, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4629; Top5: 0.7289
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46261682242990654, 'ACC_ID': 0.39102136181575436, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4632; Top5: 0.7278
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46293727847125904, 'ACC_ID': 0.3965171829249499, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4619; Top5: 0.7275
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4618020848207911, 'ACC_ID': 0.40011423675567614, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4623; Top5: 0.7260
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4621535181236674, 'ACC_ID': 0.404317697228145, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4608; Top5: 0.7253
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4607683644099612, 'ACC_ID': 0.406332123639094, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4605; Top5: 0.7234
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4604164215974591, 'ACC_ID': 0.409245971062228, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4599; Top5: 0.7226
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45968819599109134, 'ACC_ID': 0.4111358574610245, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4572; Top5: 0.7216
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45684099313259374, 'ACC_ID': 0.41077654516640255, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4574; Top5: 0.7221
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4572, 'ACC_ID': 0.4136, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35095641 0.2886298  ... 0.16145827 0.16144091 0.10806395]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 45.7500; Top-5 accuracy: 72.2100
{'Method': 'rosita_knn_txt', 'AUC': 0.961682175, 'FPR95': 0.2079, 'ACC_ALL': 0.4572, 'ACC_ID': 0.4136, 'ACC_OOD': 0.9789, 'ACC_HM': 0.5815052639138241, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp2_kn5

Step 999: Top1: 0.5150; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.342685370741483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5026; Top5: 0.7585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5035971223021583, 'ACC_ID': 0.3319630010277492, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4923; Top5: 0.7468
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.493324432576769, 'ACC_ID': 0.3404539385847797, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4985; Top5: 0.7505
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4997486173956762, 'ACC_ID': 0.3464052287581699, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5028; Top5: 0.7546
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5040096230954291, 'ACC_ID': 0.3528468323977546, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4998; Top5: 0.7541
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5008319467554077, 'ACC_ID': 0.3607321131447587, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4818; Top5: 0.7331
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4825014343086632, 'ACC_ID': 0.34853700516351116, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4600; Top5: 0.7072
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4605426935524023, 'ACC_ID': 0.33283544934030374, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4493; Top5: 0.6939
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4496674057649667, 'ACC_ID': 0.32882483370288246, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4397; Top5: 0.6902
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4402402402402402, 'ACC_ID': 0.3245245245245245, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4372; Top5: 0.6890
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43759097525473073, 'ACC_ID': 0.32514556040756915, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4313; Top5: 0.6840
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4317423230974633, 'ACC_ID': 0.3235981308411215, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4291; Top5: 0.6822
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42934196332254587, 'ACC_ID': 0.3251656649714902, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4266; Top5: 0.6811
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42681707839497357, 'ACC_ID': 0.32514636584321005, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4242; Top5: 0.6791
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42430703624733473, 'ACC_ID': 0.3250266524520256, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4180; Top5: 0.6752
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.41822049806031786, 'ACC_ID': 0.32098610937304467, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4128; Top5: 0.6701
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.41301023409010706, 'ACC_ID': 0.31702152687919066, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4082; Top5: 0.6654
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.40835189309576836, 'ACC_ID': 0.3149220489977728, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4037; Top5: 0.6618
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.40390913893291075, 'ACC_ID': 0.3125198098256735, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4004; Top5: 0.6586
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4007, 'ACC_ID': 0.3125, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35548615 0.31618226 ... 0.17843749 0.17763206 0.16399126]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 40.0500; Top-5 accuracy: 65.8600
{'Method': 'rosita_knn_txt', 'AUC': 0.8260875299999999, 'FPR95': 0.7387, 'ACC_ALL': 0.4007, 'ACC_ID': 0.3125, 'ACC_OOD': 0.9166, 'ACC_HM': 0.4660930762346433, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp2_kn5

Step 999: Top1: 0.5170; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5067; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066803699897225, 'ACC_ID': 0.3566289825282631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4970; Top5: 0.7488
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49666221628838453, 'ACC_ID': 0.36181575433911883, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5045; Top5: 0.7520
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5042735042735043, 'ACC_ID': 0.3740573152337858, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5084; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5084202085004009, 'ACC_ID': 0.3777064955894146, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5098; Top5: 0.7587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5098169717138104, 'ACC_ID': 0.37703826955074876, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5093; Top5: 0.7601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5091795754446357, 'ACC_ID': 0.3755020080321285, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5098; Top5: 0.7583
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5098332088623351, 'ACC_ID': 0.3741598207617625, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5112; Top5: 0.7583
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5110864745011087, 'ACC_ID': 0.37738359201773836, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5078; Top5: 0.7573
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.507907907907908, 'ACC_ID': 0.3755755755755756, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5096; Top5: 0.7580
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.509825327510917, 'ACC_ID': 0.37827510917030566, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5034; Top5: 0.7551
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5035046728971962, 'ACC_ID': 0.37216288384512686, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5065; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5065495453844968, 'ACC_ID': 0.3746339959932193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5046; Top5: 0.7561
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5047836641439383, 'ACC_ID': 0.37298300728259315, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5036; Top5: 0.7565
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5035980810234542, 'ACC_ID': 0.3726012793176972, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5010; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5010636966587411, 'ACC_ID': 0.37054185959204106, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5005; Top5: 0.7547
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5005293494882955, 'ACC_ID': 0.37007410892836134, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4996; Top5: 0.7542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49955456570155904, 'ACC_ID': 0.36937639198218264, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4976; Top5: 0.7544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4976228209191759, 'ACC_ID': 0.36735340729001587, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4974; Top5: 0.7559
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4974, 'ACC_ID': 0.3666, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35226774 0.32779855 ... 0.18305762 0.18276396 0.17060502]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 49.7400; Top-5 accuracy: 75.5900
{'Method': 'rosita_knn_txt', 'AUC': 0.70131803, 'FPR95': 0.864, 'ACC_ALL': 0.4974, 'ACC_ID': 0.3666, 'ACC_OOD': 0.7119, 'ACC_HM': 0.48397318497913766, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp2_kn5

Step 999: Top1: 0.5170; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3406813627254509, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5067; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066803699897225, 'ACC_ID': 0.3566289825282631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4983; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4986648865153538, 'ACC_ID': 0.37383177570093457, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5055; Top5: 0.7500
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5057817998994469, 'ACC_ID': 0.3815987933634992, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5088; Top5: 0.7534
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5092221331194867, 'ACC_ID': 0.3813151563753007, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5095; Top5: 0.7574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5098169717138104, 'ACC_ID': 0.37870216306156407, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5085; Top5: 0.7578
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5086058519793459, 'ACC_ID': 0.38209982788296043, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5059; Top5: 0.7563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5060990789146129, 'ACC_ID': 0.3843664426188698, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5059; Top5: 0.7567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5057649667405765, 'ACC_ID': 0.38824833702882483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5038; Top5: 0.7547
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5039039039039039, 'ACC_ID': 0.3891891891891892, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5064; Top5: 0.7540
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.50636826783115, 'ACC_ID': 0.39064774381368267, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4999; Top5: 0.7510
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4998331108144192, 'ACC_ID': 0.38317757009345793, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5023; Top5: 0.7528
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5022345507782401, 'ACC_ID': 0.3855755894590846, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5011; Top5: 0.7544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5010709695844638, 'ACC_ID': 0.3846922747393974, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5005; Top5: 0.7552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5003997867803838, 'ACC_ID': 0.38392857142857145, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4980; Top5: 0.7549
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4978100362908272, 'ACC_ID': 0.380803403829308, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4976; Top5: 0.7540
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49747088577814375, 'ACC_ID': 0.37913186683919536, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4966; Top5: 0.7545
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4963251670378619, 'ACC_ID': 0.37984409799554564, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4947; Top5: 0.7538
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49445324881141045, 'ACC_ID': 0.3786582144743793, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4946; Top5: 0.7551
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4943, 'ACC_ID': 0.3799, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35144326 0.34357652 ... 0.18182127 0.18171778 0.1720337 ]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 49.4600; Top-5 accuracy: 75.5100
{'Method': 'rosita_knn_txt', 'AUC': 0.7072695099999999, 'FPR95': 0.7963, 'ACC_ALL': 0.4943, 'ACC_ID': 0.3799, 'ACC_OOD': 0.6779, 'ACC_HM': 0.48692420117224433, 'kp': 2, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




2 7
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp2_kn7

Step 999: Top1: 0.7315; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7492; Top5: 0.9455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.750256937307297, 'ACC_ID': 0.6125385405960946, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7555; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7563417890520694, 'ACC_ID': 0.6255006675567423, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7545; Top5: 0.9517
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7546505781799899, 'ACC_ID': 0.6410256410256411, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7522; Top5: 0.9543
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7526062550120288, 'ACC_ID': 0.6495589414595028, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7414; Top5: 0.9511
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7417637271214642, 'ACC_ID': 0.643261231281198, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7412; Top5: 0.9492
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7415375788869765, 'ACC_ID': 0.6428571428571429, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7366; Top5: 0.9485
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7368683096838436, 'ACC_ID': 0.6407766990291263, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7350; Top5: 0.9488
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7352549889135255, 'ACC_ID': 0.6396895787139689, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7355; Top5: 0.9499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7357357357357357, 'ACC_ID': 0.64004004004004, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7316; Top5: 0.9496
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7318049490538574, 'ACC_ID': 0.634825327510917, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7291; Top5: 0.9496
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7291388518024032, 'ACC_ID': 0.6308411214953271, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7290; Top5: 0.9496
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.729079981507166, 'ACC_ID': 0.6324549237170597, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7279; Top5: 0.9507
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7281165214907896, 'ACC_ID': 0.6357275453377124, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7307; Top5: 0.9512
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7308102345415778, 'ACC_ID': 0.6404584221748401, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7285; Top5: 0.9511
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.728694781629333, 'ACC_ID': 0.6413465148291828, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7288; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7288554287730855, 'ACC_ID': 0.6459240089401247, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7278; Top5: 0.9514
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7279510022271715, 'ACC_ID': 0.6484409799554566, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7258; Top5: 0.9515
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7258320126782885, 'ACC_ID': 0.649973586899102, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7240; Top5: 0.9511
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.724, 'ACC_ID': 0.652, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33803135 0.29911834 ... 0.17035608 0.1703421  0.13549015]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 72.4000; Top-5 accuracy: 95.1100
{'Method': 'rosita_knn_txt', 'AUC': 0.9606248650000001, 'FPR95': 0.2874, 'ACC_ALL': 0.724, 'ACC_ID': 0.652, 'ACC_OOD': 0.9839, 'ACC_HM': 0.7842811907818327, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp2_kn7

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7482; Top5: 0.9455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7482014388489209, 'ACC_ID': 0.6207605344295992, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7548; Top5: 0.9499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7550066755674232, 'ACC_ID': 0.6375166889185581, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7601; Top5: 0.9527
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7596782302664655, 'ACC_ID': 0.6520864756158874, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7634; Top5: 0.9547
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7634322373696872, 'ACC_ID': 0.6503608660785886, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7547; Top5: 0.9534
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7550748752079867, 'ACC_ID': 0.6405990016638935, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7452; Top5: 0.9438
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7455536431440046, 'ACC_ID': 0.6244979919678715, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7361; Top5: 0.9388
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.736370425690814, 'ACC_ID': 0.6186208613393079, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7330; Top5: 0.9383
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.733259423503326, 'ACC_ID': 0.6239467849223946, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7353; Top5: 0.9399
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7355355355355355, 'ACC_ID': 0.6276276276276276, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7305; Top5: 0.9407
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7307132459970888, 'ACC_ID': 0.6240902474526928, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7271; Top5: 0.9397
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7271361815754339, 'ACC_ID': 0.6221628838451269, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7243; Top5: 0.9393
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7244567730004623, 'ACC_ID': 0.6210510094005239, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7207; Top5: 0.9390
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7206911323718407, 'ACC_ID': 0.6185920319862915, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7203; Top5: 0.9394
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7202825159914712, 'ACC_ID': 0.6207356076759062, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7190; Top5: 0.9403
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7190589413089726, 'ACC_ID': 0.6219496934050807, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7198; Top5: 0.9407
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7196800376426303, 'ACC_ID': 0.625338195506411, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7183; Top5: 0.9402
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7182628062360802, 'ACC_ID': 0.6260579064587973, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7160; Top5: 0.9400
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7159006867406233, 'ACC_ID': 0.6260961436872688, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7143; Top5: 0.9394
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7143, 'ACC_ID': 0.6259, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.334084   0.29403788 ... 0.16060947 0.16013785 0.14955926]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 71.4300; Top-5 accuracy: 93.9400
{'Method': 'rosita_knn_txt', 'AUC': 0.93967538, 'FPR95': 0.3654, 'ACC_ALL': 0.7143, 'ACC_ID': 0.6259, 'ACC_OOD': 0.9705, 'ACC_HM': 0.7610072037083438, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp2_kn7

Step 999: Top1: 0.7375; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7374749498997996, 'ACC_ID': 0.5991983967935872, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7533; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7543679342240494, 'ACC_ID': 0.6341212744090442, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7562; Top5: 0.9512
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7576769025367156, 'ACC_ID': 0.6508678237650201, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7601; Top5: 0.9557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7611865258924082, 'ACC_ID': 0.6681749622926093, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7638; Top5: 0.9591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7646351242983159, 'ACC_ID': 0.6680032076984763, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7561; Top5: 0.9594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.756738768718802, 'ACC_ID': 0.648585690515807, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7575; Top5: 0.9601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7584624211130235, 'ACC_ID': 0.6500286861732645, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7600; Top5: 0.9614
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7607667413492656, 'ACC_ID': 0.6479960169280558, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7627; Top5: 0.9614
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7634146341463415, 'ACC_ID': 0.6501108647450111, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7669; Top5: 0.9620
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7677677677677678, 'ACC_ID': 0.649049049049049, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7658; Top5: 0.9616
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7665574963609898, 'ACC_ID': 0.6401018922852983, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7620; Top5: 0.9609
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7626835781041389, 'ACC_ID': 0.6355140186915887, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7637; Top5: 0.9604
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7642163661581137, 'ACC_ID': 0.6344583140699646, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7635; Top5: 0.9599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7641010995287734, 'ACC_ID': 0.6360131372269028, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7648; Top5: 0.9604
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7653251599147122, 'ACC_ID': 0.6356609808102346, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7663; Top5: 0.9605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7668627205606308, 'ACC_ID': 0.6368414466274559, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7675; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7679096576873309, 'ACC_ID': 0.639218915421715, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7671; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7677060133630289, 'ACC_ID': 0.640423162583519, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7649; Top5: 0.9605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7654516640253566, 'ACC_ID': 0.6382461701003698, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7644; Top5: 0.9604
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.765, 'ACC_ID': 0.6363, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32561377 0.31145397 ... 0.16271165 0.16263084 0.15950313]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.4400; Top-5 accuracy: 96.0400
{'Method': 'rosita_knn_txt', 'AUC': 0.81259186, 'FPR95': 0.6837, 'ACC_ALL': 0.765, 'ACC_ID': 0.6363, 'ACC_OOD': 0.7499, 'ACC_HM': 0.6884452027124512, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp2_kn7

Step 999: Top1: 0.7355; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.6593186372745491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7503; Top5: 0.9445
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.750256937307297, 'ACC_ID': 0.6937307297019527, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7515; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7516688918558078, 'ACC_ID': 0.7042723631508678, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7591; Top5: 0.9542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.759175465057818, 'ACC_ID': 0.7164404223227753, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7598; Top5: 0.9579
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7598235765838012, 'ACC_ID': 0.7177225340817963, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7534; Top5: 0.9577
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7537437603993344, 'ACC_ID': 0.7048252911813644, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7541; Top5: 0.9584
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7544463568559954, 'ACC_ID': 0.7056798623063684, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7555; Top5: 0.9584
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7557879014189693, 'ACC_ID': 0.7050037341299478, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7567; Top5: 0.9581
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7569844789356984, 'ACC_ID': 0.7035476718403547, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7601; Top5: 0.9592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7603603603603604, 'ACC_ID': 0.7065065065065065, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7602; Top5: 0.9583
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7603711790393013, 'ACC_ID': 0.7048762736535662, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7580; Top5: 0.9574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7580106809078772, 'ACC_ID': 0.7001001335113485, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7586; Top5: 0.9573
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7586685159500693, 'ACC_ID': 0.7008784096162737, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7588; Top5: 0.9576
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.758817649578752, 'ACC_ID': 0.700414108239326, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7603; Top5: 0.9582
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7602611940298507, 'ACC_ID': 0.7010927505330491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7616; Top5: 0.9586
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.761606807658616, 'ACC_ID': 0.7035414841696909, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7625; Top5: 0.9587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7623808963651335, 'ACC_ID': 0.7053287848488413, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7619; Top5: 0.9590
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7620267260579064, 'ACC_ID': 0.7063474387527839, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7596; Top5: 0.9588
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7597464342313788, 'ACC_ID': 0.705229793977813, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7587; Top5: 0.9584
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7589, 'ACC_ID': 0.7044, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32481271 0.31414357 ... 0.18407303 0.18406756 0.13286686]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 75.8700; Top-5 accuracy: 95.8400
{'Method': 'rosita_knn_txt', 'AUC': 0.8929472600000001, 'FPR95': 0.3791, 'ACC_ALL': 0.7589, 'ACC_ID': 0.7044, 'ACC_OOD': 0.7661, 'ACC_HM': 0.7339555797347841, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp2_kn7

Step 999: Top1: 0.5190; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5190380761523046, 'ACC_ID': 0.3306613226452906, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4995; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.499486125385406, 'ACC_ID': 0.32065775950668035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4883; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48731642189586116, 'ACC_ID': 0.3170894526034713, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4970; Top5: 0.7480
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4962292609351433, 'ACC_ID': 0.33735545500251385, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4952; Top5: 0.7470
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49478748997594224, 'ACC_ID': 0.34202085004009625, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4935; Top5: 0.7434
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49317803660565723, 'ACC_ID': 0.3517470881863561, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4901; Top5: 0.7392
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4899598393574297, 'ACC_ID': 0.3577165806081469, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4859; Top5: 0.7361
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48593477719691314, 'ACC_ID': 0.3617127209360219, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4813; Top5: 0.7330
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4811529933481153, 'ACC_ID': 0.36363636363636365, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4754; Top5: 0.7305
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4756756756756757, 'ACC_ID': 0.36156156156156155, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4734; Top5: 0.7293
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4736171761280932, 'ACC_ID': 0.3624454148471616, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4680; Top5: 0.7251
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4681241655540721, 'ACC_ID': 0.36031375166889185, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4658; Top5: 0.7232
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46586531052550473, 'ACC_ID': 0.36184311912467254, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4637; Top5: 0.7197
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4636584321005284, 'ACC_ID': 0.36213051549336, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4610; Top5: 0.7179
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46095415778251597, 'ACC_ID': 0.3607409381663113, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4564; Top5: 0.7145
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45651357777499685, 'ACC_ID': 0.35715179577024153, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4535; Top5: 0.7120
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4535936948594283, 'ACC_ID': 0.3561933890130573, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4506; Top5: 0.7108
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4505567928730512, 'ACC_ID': 0.355902004454343, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4475; Top5: 0.7082
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4474379292128896, 'ACC_ID': 0.3556259904912837, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4452; Top5: 0.7073
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4453, 'ACC_ID': 0.3573, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35307148 0.32699588 ... 0.17639472 0.17487735 0.17154707]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 44.5300; Top-5 accuracy: 70.7300
{'Method': 'rosita_knn_txt', 'AUC': 0.87484563, 'FPR95': 0.6497, 'ACC_ALL': 0.4453, 'ACC_ID': 0.3573, 'ACC_OOD': 0.9404, 'ACC_HM': 0.5178468367111042, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp2_kn7

Step 999: Top1: 0.5170; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.342685370741483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5057; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5056526207605344, 'ACC_ID': 0.3329907502569373, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4950; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4959946595460614, 'ACC_ID': 0.3417890520694259, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5020; Top5: 0.7485
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5027652086475616, 'ACC_ID': 0.35193564605329314, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5032; Top5: 0.7506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5032076984763433, 'ACC_ID': 0.3528468323977546, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4955; Top5: 0.7474
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49550748752079865, 'ACC_ID': 0.3570715474209651, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4723; Top5: 0.7194
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47217441193344806, 'ACC_ID': 0.33706253585771656, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4531; Top5: 0.7008
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45307443365695793, 'ACC_ID': 0.32586507343788895, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4436; Top5: 0.6884
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4434589800443459, 'ACC_ID': 0.32195121951219513, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4333; Top5: 0.6810
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43343343343343343, 'ACC_ID': 0.3187187187187187, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4310; Top5: 0.6779
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43104075691411936, 'ACC_ID': 0.3207787481804949, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4245; Top5: 0.6727
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42456608811748997, 'ACC_ID': 0.3182576769025367, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4217; Top5: 0.6711
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42163661581137307, 'ACC_ID': 0.3191554939127755, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4180; Top5: 0.6704
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.41796372983007285, 'ACC_ID': 0.3195773240039983, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4156; Top5: 0.6683
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.41564498933901917, 'ACC_ID': 0.32022921108742003, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4106; Top5: 0.6642
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.41071205105743963, 'ACC_ID': 0.3184832937054186, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4065; Top5: 0.6608
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4065404070109399, 'ACC_ID': 0.31690389365956945, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4034; Top5: 0.6583
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.40334075723830737, 'ACC_ID': 0.3167037861915368, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.3998; Top5: 0.6563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3997886951928156, 'ACC_ID': 0.31494981510829373, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.3964; Top5: 0.6543
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3965, 'ACC_ID': 0.3142, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35258335 0.30720937 ... 0.18189467 0.18187459 0.16906695]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 39.6500; Top-5 accuracy: 65.4300
{'Method': 'rosita_knn_txt', 'AUC': 0.8394452299999999, 'FPR95': 0.6885, 'ACC_ALL': 0.3965, 'ACC_ID': 0.3142, 'ACC_OOD': 0.9116, 'ACC_HM': 0.46732700277369876, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp2_kn7

Step 999: Top1: 0.5170; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5067; Top5: 0.7605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066803699897225, 'ACC_ID': 0.3566289825282631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4970; Top5: 0.7502
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4959946595460614, 'ACC_ID': 0.36114819759679573, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5040; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5032679738562091, 'ACC_ID': 0.3740573152337858, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5072; Top5: 0.7570
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5068163592622293, 'ACC_ID': 0.3773055332798717, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5082; Top5: 0.7601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.507820299500832, 'ACC_ID': 0.3767054908485857, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5076; Top5: 0.7615
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5071715433161216, 'ACC_ID': 0.3755020080321285, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5086; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5083395568832462, 'ACC_ID': 0.37515558874782173, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5099; Top5: 0.7585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5095343680709534, 'ACC_ID': 0.37893569844789354, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5056; Top5: 0.7569
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5055055055055055, 'ACC_ID': 0.37537537537537535, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5076; Top5: 0.7569
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5074599708879185, 'ACC_ID': 0.3773653566229985, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5019; Top5: 0.7540
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5015020026702269, 'ACC_ID': 0.3718291054739653, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5043; Top5: 0.7545
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5039297272306981, 'ACC_ID': 0.37340114039143163, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5024; Top5: 0.7552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5023561330858204, 'ACC_ID': 0.37141225189204624, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5012; Top5: 0.7559
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5010660980810234, 'ACC_ID': 0.37193496801705755, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4987; Top5: 0.7543
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4988111625578776, 'ACC_ID': 0.37041671880865973, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4982; Top5: 0.7542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4982943183154923, 'ACC_ID': 0.37007410892836134, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4969; Top5: 0.7538
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49699331848552336, 'ACC_ID': 0.3690423162583519, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4948; Top5: 0.7534
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4948758584257792, 'ACC_ID': 0.36682514527205495, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4939; Top5: 0.7537
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.494, 'ACC_ID': 0.366, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35330185 0.32708126 ... 0.18386443 0.18281646 0.1718421 ]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 49.3900; Top-5 accuracy: 75.3700
{'Method': 'rosita_knn_txt', 'AUC': 0.701067465, 'FPR95': 0.8637, 'ACC_ALL': 0.494, 'ACC_ID': 0.366, 'ACC_OOD': 0.7101, 'ACC_HM': 0.4830342904934486, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp2_kn7

Step 999: Top1: 0.5170; Top5: 0.7515
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3406813627254509, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5067; Top5: 0.7544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066803699897225, 'ACC_ID': 0.35868448098663924, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4997; Top5: 0.7442
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4993324432576769, 'ACC_ID': 0.3724966622162884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5055; Top5: 0.7465
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5052790346907994, 'ACC_ID': 0.38310708898944196, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5080; Top5: 0.7494
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.508019246190858, 'ACC_ID': 0.38011226944667204, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5072; Top5: 0.7541
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5071547420965058, 'ACC_ID': 0.37603993344425957, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5056; Top5: 0.7544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5054503729202524, 'ACC_ID': 0.3789443488238669, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5041; Top5: 0.7530
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5041075429424944, 'ACC_ID': 0.3796365446850884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5034; Top5: 0.7529
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5031042128603104, 'ACC_ID': 0.38226164079822617, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5010; Top5: 0.7509
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5009009009009009, 'ACC_ID': 0.38158158158158156, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5036; Top5: 0.7504
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5034570596797671, 'ACC_ID': 0.38300582241630277, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4981; Top5: 0.7478
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4974966622162884, 'ACC_ID': 0.37683578104138854, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5005; Top5: 0.7495
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4999229465248883, 'ACC_ID': 0.37925720449992295, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4983; Top5: 0.7512
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4980722547479652, 'ACC_ID': 0.3782664572326146, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4979; Top5: 0.7525
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4976012793176972, 'ACC_ID': 0.3776652452025586, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4954; Top5: 0.7524
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4951820798398198, 'ACC_ID': 0.3755474909272932, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4954; Top5: 0.7521
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4951182213857193, 'ACC_ID': 0.37336783907775556, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4936; Top5: 0.7523
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49320712694877505, 'ACC_ID': 0.37427616926503343, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4914; Top5: 0.7519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49107237189646064, 'ACC_ID': 0.37305863708399367, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4909; Top5: 0.7529
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4906, 'ACC_ID': 0.3737, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35292557 0.34365675 ... 0.18320741 0.18236056 0.17178649]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 49.0900; Top-5 accuracy: 75.2900
{'Method': 'rosita_knn_txt', 'AUC': 0.7052413049999999, 'FPR95': 0.802, 'ACC_ALL': 0.4906, 'ACC_ID': 0.3737, 'ACC_OOD': 0.686, 'ACC_HM': 0.48383165046711324, 'kp': 2, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




2 10
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp2_kn10

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7503; Top5: 0.9455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.750256937307297, 'ACC_ID': 0.6115107913669064, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7555; Top5: 0.9526
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7556742323097463, 'ACC_ID': 0.6221628838451269, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7646; Top5: 0.9552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7647058823529411, 'ACC_ID': 0.6400201106083458, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7618; Top5: 0.9559
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7622293504410586, 'ACC_ID': 0.6391339214113874, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7531; Top5: 0.9547
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7534109816971714, 'ACC_ID': 0.64891846921797, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7532; Top5: 0.9549
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7538726333907056, 'ACC_ID': 0.6632243258749283, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7518; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.752302713467762, 'ACC_ID': 0.6736370425690814, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7532; Top5: 0.9574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7536585365853659, 'ACC_ID': 0.6835920177383592, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7565; Top5: 0.9586
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.756956956956957, 'ACC_ID': 0.6936936936936937, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7533; Top5: 0.9589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7536390101892285, 'ACC_ID': 0.6961426491994177, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7513; Top5: 0.9589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7516688918558078, 'ACC_ID': 0.6989319092122831, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7511; Top5: 0.9585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.751425489289567, 'ACC_ID': 0.7025735860687317, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7498; Top5: 0.9594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7501070969584464, 'ACC_ID': 0.7046979865771812, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7507; Top5: 0.9602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7510660980810234, 'ACC_ID': 0.7085554371002132, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7504; Top5: 0.9608
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7508447002878238, 'ACC_ID': 0.7109247903891879, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7505; Top5: 0.9620
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7507352076226327, 'ACC_ID': 0.7132102105634631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7499; Top5: 0.9616
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7501113585746102, 'ACC_ID': 0.7145879732739421, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7486; Top5: 0.9617
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.748864236661384, 'ACC_ID': 0.715161119915478, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7480; Top5: 0.9615
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7483, 'ACC_ID': 0.7164, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34267631 0.2975058  ... 0.12572499 0.12572484 0.09366959]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 74.8000; Top-5 accuracy: 96.1500
{'Method': 'rosita_knn_txt', 'AUC': 0.9876963999999999, 'FPR95': 0.0923, 'ACC_ALL': 0.7483, 'ACC_ID': 0.7164, 'ACC_OOD': 0.992, 'ACC_HM': 0.8319700304378365, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp2_kn10

Step 999: Top1: 0.7315; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7314629258517034, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7461; Top5: 0.9466
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7461459403905447, 'ACC_ID': 0.6187050359712231, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7528; Top5: 0.9506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.753004005340454, 'ACC_ID': 0.6341789052069426, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7580; Top5: 0.9532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7576671694318753, 'ACC_ID': 0.6470588235294118, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7602; Top5: 0.9555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.760625501202887, 'ACC_ID': 0.6435445068163592, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7494; Top5: 0.9527
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7500831946755407, 'ACC_ID': 0.6292845257903494, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7372; Top5: 0.9412
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7378083763625932, 'ACC_ID': 0.6161790017211703, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7284; Top5: 0.9375
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7289021657953697, 'ACC_ID': 0.6114015434403783, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7272; Top5: 0.9377
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7277161862527716, 'ACC_ID': 0.6164079822616408, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7293; Top5: 0.9401
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7297297297297297, 'ACC_ID': 0.6182182182182182, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7245; Top5: 0.9405
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7248908296943232, 'ACC_ID': 0.6146288209606987, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7221; Top5: 0.9394
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7222963951935915, 'ACC_ID': 0.6133177570093458, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7209; Top5: 0.9393
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7212205270457698, 'ACC_ID': 0.6151949452920327, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7179; Top5: 0.9390
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7182636013137227, 'ACC_ID': 0.6148793374268171, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7179; Top5: 0.9395
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7181503198294243, 'ACC_ID': 0.6174040511727079, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7169; Top5: 0.9403
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.717181829558253, 'ACC_ID': 0.6189463146039295, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7173; Top5: 0.9404
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7174450064698271, 'ACC_ID': 0.6216915656981532, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7161; Top5: 0.9397
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7162583518930957, 'ACC_ID': 0.6223830734966592, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7138; Top5: 0.9398
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7138932910723719, 'ACC_ID': 0.6222926571579503, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7120; Top5: 0.9392
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7122, 'ACC_ID': 0.6225, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33594769 0.29230201 ... 0.16040687 0.16032442 0.14731155]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 71.2000; Top-5 accuracy: 93.9200
{'Method': 'rosita_knn_txt', 'AUC': 0.9429835, 'FPR95': 0.3488, 'ACC_ALL': 0.7122, 'ACC_ID': 0.6225, 'ACC_OOD': 0.974, 'ACC_HM': 0.7595552771688068, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp2_kn10

Step 999: Top1: 0.7395; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7394789579158316, 'ACC_ID': 0.5991983967935872, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7533; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7543679342240494, 'ACC_ID': 0.6330935251798561, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7582; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7590120160213618, 'ACC_ID': 0.6515353805073432, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7636; Top5: 0.9562
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7642031171442936, 'ACC_ID': 0.6681749622926093, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7662; Top5: 0.9595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7666399358460305, 'ACC_ID': 0.6684041700080192, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7587; Top5: 0.9597
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7590682196339434, 'ACC_ID': 0.64891846921797, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7610; Top5: 0.9601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7616179001721171, 'ACC_ID': 0.6500286861732645, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7625; Top5: 0.9612
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7630072193178989, 'ACC_ID': 0.6499875529001743, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7636; Top5: 0.9612
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7640798226164079, 'ACC_ID': 0.6509977827050998, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7679; Top5: 0.9622
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7683683683683684, 'ACC_ID': 0.6508508508508508, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7675; Top5: 0.9614
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7678311499272198, 'ACC_ID': 0.6439228529839883, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7645; Top5: 0.9608
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7648531375166889, 'ACC_ID': 0.6411882510013351, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7662; Top5: 0.9598
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7663738634612421, 'ACC_ID': 0.6409308059793497, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7656; Top5: 0.9593
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7659574468085106, 'ACC_ID': 0.6421533628444952, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7668; Top5: 0.9600
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7670575692963753, 'ACC_ID': 0.6421908315565032, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7685; Top5: 0.9603
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7687398323113502, 'ACC_ID': 0.643473908146665, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7695; Top5: 0.9605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7696741559816492, 'ACC_ID': 0.6451005764027762, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7686; Top5: 0.9600
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7688195991091314, 'ACC_ID': 0.6463251670378619, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7662; Top5: 0.9598
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7662968832540941, 'ACC_ID': 0.6438457474907554, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7658; Top5: 0.9592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.766, 'ACC_ID': 0.6418, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32578531 0.31311461 ... 0.17118284 0.15962508 0.1580316 ]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.5800; Top-5 accuracy: 95.9200
{'Method': 'rosita_knn_txt', 'AUC': 0.81283523, 'FPR95': 0.6802, 'ACC_ALL': 0.766, 'ACC_ID': 0.6418, 'ACC_OOD': 0.7414, 'ACC_HM': 0.688014054366686, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp2_kn10

Step 999: Top1: 0.7355; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.6593186372745491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7482; Top5: 0.9445
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7482014388489209, 'ACC_ID': 0.6916752312435765, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7495; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7496662216288384, 'ACC_ID': 0.6975967957276369, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7580; Top5: 0.9542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7586726998491704, 'ACC_ID': 0.7124183006535948, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7586; Top5: 0.9579
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7594226142742582, 'ACC_ID': 0.714915797914996, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7531; Top5: 0.9574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7534109816971714, 'ACC_ID': 0.7018302828618969, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7538; Top5: 0.9581
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7541594951233506, 'ACC_ID': 0.7008032128514057, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7543; Top5: 0.9582
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7545431914363954, 'ACC_ID': 0.6982823002240478, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7547; Top5: 0.9574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7552106430155211, 'ACC_ID': 0.6962305986696231, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7581; Top5: 0.9588
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7585585585585586, 'ACC_ID': 0.6996996996996997, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7587; Top5: 0.9578
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7590975254730713, 'ACC_ID': 0.6988719068413392, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7566; Top5: 0.9569
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7570093457943925, 'ACC_ID': 0.6945927903871829, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7572; Top5: 0.9568
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7575897672985051, 'ACC_ID': 0.6959469872091232, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7579; Top5: 0.9570
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7582464658003712, 'ACC_ID': 0.696273025846066, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7593; Top5: 0.9574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.759594882729211, 'ACC_ID': 0.6984275053304904, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7606; Top5: 0.9576
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7608559629583281, 'ACC_ID': 0.7009135277186835, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7615; Top5: 0.9578
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7616750970474062, 'ACC_ID': 0.702505587577932, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7610; Top5: 0.9579
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7611358574610245, 'ACC_ID': 0.7032293986636972, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7587; Top5: 0.9576
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7587955625990491, 'ACC_ID': 0.7018489170628632, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7576; Top5: 0.9571
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7578, 'ACC_ID': 0.7006, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32482386 0.31643498 ... 0.18130645 0.18129164 0.1337167 ]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 75.7600; Top-5 accuracy: 95.7100
{'Method': 'rosita_knn_txt', 'AUC': 0.891454145, 'FPR95': 0.3872, 'ACC_ALL': 0.7578, 'ACC_ID': 0.7006, 'ACC_OOD': 0.7707, 'ACC_HM': 0.7339800448582885, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp2_kn10

Step 999: Top1: 0.5190; Top5: 0.7635
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5210420841683366, 'ACC_ID': 0.3346693386773547, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5026; Top5: 0.7605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5025693730729702, 'ACC_ID': 0.32476875642343267, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4903; Top5: 0.7502
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48998664886515353, 'ACC_ID': 0.3257676902536716, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4980; Top5: 0.7495
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.497737556561086, 'ACC_ID': 0.3489190548014077, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4944; Top5: 0.7466
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49438652766639934, 'ACC_ID': 0.35525260625501204, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4872; Top5: 0.7404
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4871880199667221, 'ACC_ID': 0.3643926788685524, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4844; Top5: 0.7357
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48422260470453243, 'ACC_ID': 0.36919104991394147, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4807; Top5: 0.7316
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48045805327358726, 'ACC_ID': 0.3714214588000996, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4755; Top5: 0.7281
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4751662971175166, 'ACC_ID': 0.3694013303769401, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4700; Top5: 0.7241
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47007007007007007, 'ACC_ID': 0.3655655655655656, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4682; Top5: 0.7223
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46815866084425034, 'ACC_ID': 0.36772197962154296, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4620; Top5: 0.7181
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46194926568758343, 'ACC_ID': 0.3636515353805073, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4602; Top5: 0.7158
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4603174603174603, 'ACC_ID': 0.36369240252735396, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4583; Top5: 0.7135
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4583749821505069, 'ACC_ID': 0.3619877195487648, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4564; Top5: 0.7115
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45642324093816633, 'ACC_ID': 0.36100746268656714, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4508; Top5: 0.7075
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4508822425228382, 'ACC_ID': 0.359404329871105, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4482; Top5: 0.7052
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44830019997647336, 'ACC_ID': 0.35866368662510295, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4454; Top5: 0.7045
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4452115812917595, 'ACC_ID': 0.35812917594654786, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4418; Top5: 0.7025
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4416270470153196, 'ACC_ID': 0.35742208135235076, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4401; Top5: 0.7012
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4401, 'ACC_ID': 0.3589, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35455042 0.30145499 ... 0.17341946 0.17238627 0.17094019]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 44.0200; Top-5 accuracy: 70.1200
{'Method': 'rosita_knn_txt', 'AUC': 0.876385675, 'FPR95': 0.628, 'ACC_ALL': 0.4401, 'ACC_ID': 0.3589, 'ACC_OOD': 0.9437, 'ACC_HM': 0.5200275295562721, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp2_kn10

Step 999: Top1: 0.5170; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.342685370741483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5077; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5077081192189106, 'ACC_ID': 0.3329907502569373, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4963; Top5: 0.7462
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4959946595460614, 'ACC_ID': 0.3371161548731642, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5035; Top5: 0.7505
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5032679738562091, 'ACC_ID': 0.35093011563599796, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5040; Top5: 0.7502
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5040096230954291, 'ACC_ID': 0.35966319165998395, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4908; Top5: 0.7394
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4908485856905158, 'ACC_ID': 0.356738768718802, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4631; Top5: 0.7056
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4629948364888124, 'ACC_ID': 0.331899024670109, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4416; Top5: 0.6873
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4416231018172766, 'ACC_ID': 0.3183968135424446, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4331; Top5: 0.6775
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4330376940133038, 'ACC_ID': 0.31529933481152994, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4239; Top5: 0.6720
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.424024024024024, 'ACC_ID': 0.3115115115115115, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4212; Top5: 0.6687
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42121542940320233, 'ACC_ID': 0.31477438136826785, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4150; Top5: 0.6622
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.41488651535380505, 'ACC_ID': 0.31108144192256343, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4123; Top5: 0.6588
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4120819848975189, 'ACC_ID': 0.31283710895361383, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4080; Top5: 0.6557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.40782521776381553, 'ACC_ID': 0.31229473082964443, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4037; Top5: 0.6531
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4036513859275053, 'ACC_ID': 0.3109008528784648, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.3986; Top5: 0.6484
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.39869853585283443, 'ACC_ID': 0.3088474533850582, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.3949; Top5: 0.6444
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.39501235148806024, 'ACC_ID': 0.307610869309493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.3925; Top5: 0.6422
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3925389755011136, 'ACC_ID': 0.30879732739420934, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.3906; Top5: 0.6412
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.39059693608029583, 'ACC_ID': 0.3081880612783941, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.3897; Top5: 0.6415
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.3898, 'ACC_ID': 0.3102, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35385281 0.3066245  ... 0.18232153 0.18191271 0.16624118]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 38.9800; Top-5 accuracy: 64.1500
{'Method': 'rosita_knn_txt', 'AUC': 0.8443905249999999, 'FPR95': 0.6716, 'ACC_ALL': 0.3898, 'ACC_ID': 0.3102, 'ACC_OOD': 0.9213, 'ACC_HM': 0.46412872107186354, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp2_kn10

Step 999: Top1: 0.5190; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5190380761523046, 'ACC_ID': 0.3406813627254509, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5098; Top5: 0.7605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5087358684480987, 'ACC_ID': 0.35765673175745116, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4990; Top5: 0.7502
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4979973297730307, 'ACC_ID': 0.36181575433911883, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5050; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5042735042735043, 'ACC_ID': 0.37254901960784315, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5076; Top5: 0.7570
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5072173215717722, 'ACC_ID': 0.37650360866078586, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5075; Top5: 0.7604
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5071547420965058, 'ACC_ID': 0.37537437603993346, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5067; Top5: 0.7618
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.506310958118187, 'ACC_ID': 0.3749282845668388, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5076; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5070948469006722, 'ACC_ID': 0.376151356733881, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5083; Top5: 0.7585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5079822616407982, 'ACC_ID': 0.3782705099778271, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5038; Top5: 0.7567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5037037037037037, 'ACC_ID': 0.37457457457457455, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5053; Top5: 0.7562
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.50509461426492, 'ACC_ID': 0.3742721979621543, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4996; Top5: 0.7533
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4993324432576769, 'ACC_ID': 0.37066088117489987, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5022; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5019263368777932, 'ACC_ID': 0.37417167514254895, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4999; Top5: 0.7544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49978580608310724, 'ACC_ID': 0.37198343567042697, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4988; Top5: 0.7549
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4986673773987207, 'ACC_ID': 0.3716684434968017, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4964; Top5: 0.7537
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49630834689025155, 'ACC_ID': 0.3695407333249906, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4960; Top5: 0.7536
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4959416539230679, 'ACC_ID': 0.36925067639101283, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4945; Top5: 0.7532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4943207126948775, 'ACC_ID': 0.3675946547884187, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4927; Top5: 0.7525
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4925515055467512, 'ACC_ID': 0.3652403592181722, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4920; Top5: 0.7529
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4919, 'ACC_ID': 0.365, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.3543618  0.32673436 ... 0.18397382 0.18295792 0.16771868]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 49.2100; Top-5 accuracy: 75.2900
{'Method': 'rosita_knn_txt', 'AUC': 0.7013344949999999, 'FPR95': 0.8619, 'ACC_ALL': 0.4919, 'ACC_ID': 0.365, 'ACC_OOD': 0.7052, 'ACC_HM': 0.48102784526256775, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=2, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp2_kn10

Step 999: Top1: 0.5170; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3406813627254509, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5057; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5056526207605344, 'ACC_ID': 0.35868448098663924, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4970; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4953271028037383, 'ACC_ID': 0.3691588785046729, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5035; Top5: 0.7490
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.502262443438914, 'ACC_ID': 0.3815987933634992, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5056; Top5: 0.7522
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5048115477145149, 'ACC_ID': 0.38051323175621493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5062; Top5: 0.7571
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5054908485856905, 'ACC_ID': 0.37803660565723796, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5050; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.504302925989673, 'ACC_ID': 0.38181296615031557, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5029; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5023649489668908, 'ACC_ID': 0.38361961662932537, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5030; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5022172949002217, 'ACC_ID': 0.38558758314855873, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5006; Top5: 0.7525
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5001001001001001, 'ACC_ID': 0.383983983983984, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5036; Top5: 0.7516
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5030931586608443, 'ACC_ID': 0.3840975254730713, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4981; Top5: 0.7483
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4974966622162884, 'ACC_ID': 0.37783711615487314, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5008; Top5: 0.7498
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5002311604253352, 'ACC_ID': 0.38064416705193405, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4993; Top5: 0.7516
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4989290304155362, 'ACC_ID': 0.37955162073397114, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4987; Top5: 0.7531
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49826759061833686, 'ACC_ID': 0.3787313432835821, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4960; Top5: 0.7528
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4958077837567263, 'ACC_ID': 0.3760480540608184, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4961; Top5: 0.7521
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4959416539230679, 'ACC_ID': 0.3741912716151041, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4944; Top5: 0.7526
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49409799554565703, 'ACC_ID': 0.3749443207126949, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4923; Top5: 0.7519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49212889593238246, 'ACC_ID': 0.3737982039091389, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4916; Top5: 0.7523
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4914, 'ACC_ID': 0.3741, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35293776 0.34726179 ... 0.18109304 0.18049122 0.16824161]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 49.1600; Top-5 accuracy: 75.2300
{'Method': 'rosita_knn_txt', 'AUC': 0.701414665, 'FPR95': 0.8025, 'ACC_ALL': 0.4914, 'ACC_ID': 0.3741, 'ACC_OOD': 0.6835, 'ACC_HM': 0.4835426437216339, 'kp': 2, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




3 1
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp3_kn1

Step 999: Top1: 0.7295; Top5: 0.9439
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7294589178356713, 'ACC_ID': 0.593186372745491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7492; Top5: 0.9414
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7482014388489209, 'ACC_ID': 0.6063720452209661, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7562; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7556742323097463, 'ACC_ID': 0.6034712950600801, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7601; Top5: 0.9507
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7596782302664655, 'ACC_ID': 0.6209150326797386, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7642; Top5: 0.9531
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.764234161988773, 'ACC_ID': 0.6343223736968725, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7541; Top5: 0.9534
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7540765391014975, 'ACC_ID': 0.6356073211314476, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7561; Top5: 0.9521
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7561675272518646, 'ACC_ID': 0.6445783132530121, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7518; Top5: 0.9520
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7518048294747324, 'ACC_ID': 0.646253422952452, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7503; Top5: 0.9528
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7503325942350333, 'ACC_ID': 0.6487804878048781, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7501; Top5: 0.9539
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7501501501501502, 'ACC_ID': 0.6542542542542542, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7480; Top5: 0.9547
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7479985443959243, 'ACC_ID': 0.653566229985444, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7453; Top5: 0.9549
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7453271028037384, 'ACC_ID': 0.6525367156208278, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7457; Top5: 0.9548
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7455694251810757, 'ACC_ID': 0.6549545384496841, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7439; Top5: 0.9557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7439668713408539, 'ACC_ID': 0.6557189775810367, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7455; Top5: 0.9559
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7454690831556503, 'ACC_ID': 0.6587153518123667, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7471; Top5: 0.9561
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7470904767863846, 'ACC_ID': 0.6623701664372419, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7478; Top5: 0.9564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7476767439124808, 'ACC_ID': 0.6655687566168687, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7456; Top5: 0.9559
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7455456570155902, 'ACC_ID': 0.6658129175946548, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7441; Top5: 0.9559
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7440042260961437, 'ACC_ID': 0.6658214474379293, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7423; Top5: 0.9555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7423, 'ACC_ID': 0.6644, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.3373937  0.31791124 ... 0.18738368 0.18231082 0.1800914 ]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 74.2300; Top-5 accuracy: 95.5500
{'Method': 'rosita_knn_txt', 'AUC': 0.96280211, 'FPR95': 0.2363, 'ACC_ALL': 0.7423, 'ACC_ID': 0.6644, 'ACC_OOD': 0.9828, 'ACC_HM': 0.7928270033997087, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp3_kn1

Step 999: Top1: 0.7315; Top5: 0.9439
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7314629258517034, 'ACC_ID': 0.5991983967935872, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7451; Top5: 0.9383
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7461459403905447, 'ACC_ID': 0.6258992805755396, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7475; Top5: 0.9486
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7483311081441922, 'ACC_ID': 0.6315086782376502, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7505; Top5: 0.9532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.751131221719457, 'ACC_ID': 0.6435394670688789, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7570; Top5: 0.9555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7574178027265437, 'ACC_ID': 0.6467522052927025, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7501; Top5: 0.9554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7507487520798669, 'ACC_ID': 0.6425956738768719, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7506; Top5: 0.9561
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7512908777969018, 'ACC_ID': 0.6454388984509466, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7548; Top5: 0.9569
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7552900174259397, 'ACC_ID': 0.6519790888722927, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7585; Top5: 0.9570
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.758980044345898, 'ACC_ID': 0.6543237250554323, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7617; Top5: 0.9575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.761961961961962, 'ACC_ID': 0.6556556556556556, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7616; Top5: 0.9569
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7618267831149927, 'ACC_ID': 0.6561135371179039, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7566; Top5: 0.9553
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7568424566088118, 'ACC_ID': 0.6518691588785047, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7565; Top5: 0.9538
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7566651255971645, 'ACC_ID': 0.6523347202958854, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7532; Top5: 0.9524
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7533914036841354, 'ACC_ID': 0.6498643438526346, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7520; Top5: 0.9512
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.752132196162047, 'ACC_ID': 0.6516524520255863, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7504; Top5: 0.9499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7505944187210611, 'ACC_ID': 0.6526091853335002, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7496; Top5: 0.9491
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7496765086460416, 'ACC_ID': 0.6542759675332314, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7477; Top5: 0.9485
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7477728285077951, 'ACC_ID': 0.655456570155902, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7450; Top5: 0.9488
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7450607501320655, 'ACC_ID': 0.6562070787110407, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7434; Top5: 0.9484
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7435, 'ACC_ID': 0.6566, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32066938 0.28707865 ... 0.18302949 0.18290102 0.16378403]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 74.3400; Top-5 accuracy: 94.8400
{'Method': 'rosita_knn_txt', 'AUC': 0.947585125, 'FPR95': 0.3239, 'ACC_ALL': 0.7435, 'ACC_ID': 0.6566, 'ACC_OOD': 0.9545, 'ACC_HM': 0.7780084414375272, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp3_kn1

Step 999: Top1: 0.7335; Top5: 0.9439
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.591182364729459, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7451; Top5: 0.9383
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7471736896197327, 'ACC_ID': 0.6187050359712231, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7468; Top5: 0.9492
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7483311081441922, 'ACC_ID': 0.6255006675567423, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7495; Top5: 0.9532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7506284565108094, 'ACC_ID': 0.6410256410256411, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7582; Top5: 0.9559
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7590216519647153, 'ACC_ID': 0.6459502806736167, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7504; Top5: 0.9561
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.75108153078203, 'ACC_ID': 0.643261231281198, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7527; Top5: 0.9564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7532989099254159, 'ACC_ID': 0.6511761331038439, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7563; Top5: 0.9574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7567836694050286, 'ACC_ID': 0.6554642768235002, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7591; Top5: 0.9585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7596452328159645, 'ACC_ID': 0.6541019955654102, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7633; Top5: 0.9600
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7637637637637638, 'ACC_ID': 0.6564564564564564, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7658; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.766193595342067, 'ACC_ID': 0.6552037845705968, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7646; Top5: 0.9613
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7650200267022697, 'ACC_ID': 0.6515353805073432, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7660; Top5: 0.9616
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7663738634612421, 'ACC_ID': 0.651872399445215, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7674; Top5: 0.9624
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7676709981436527, 'ACC_ID': 0.6545766100242754, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7693; Top5: 0.9634
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.769589552238806, 'ACC_ID': 0.6548507462686567, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7706; Top5: 0.9640
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7708672256288325, 'ACC_ID': 0.657489675885371, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7719; Top5: 0.9648
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7720268203740737, 'ACC_ID': 0.6596870956358075, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7718; Top5: 0.9650
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7720489977728285, 'ACC_ID': 0.6602449888641425, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7710; Top5: 0.9649
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7711568938193344, 'ACC_ID': 0.6597992604331748, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7711; Top5: 0.9648
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7713, 'ACC_ID': 0.6587, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32580751 0.31473273 ... 0.18633083 0.18608987 0.15770274]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 77.1100; Top-5 accuracy: 96.4800
{'Method': 'rosita_knn_txt', 'AUC': 0.8238957499999999, 'FPR95': 0.6304, 'ACC_ALL': 0.7713, 'ACC_ID': 0.6587, 'ACC_OOD': 0.7303, 'ACC_HM': 0.6926545860331174, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=1, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp3_kn1

Step 999: Top1: 0.7335; Top5: 0.9439
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.657314629258517, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7451; Top5: 0.9394
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7461459403905447, 'ACC_ID': 0.6813977389516958, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7488; Top5: 0.9492
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7503337783711616, 'ACC_ID': 0.692256341789052, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7535; Top5: 0.9532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7546505781799899, 'ACC_ID': 0.7003519356460532, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7562; Top5: 0.9563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7570168404170008, 'ACC_ID': 0.7052927024859663, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7501; Top5: 0.9554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7507487520798669, 'ACC_ID': 0.6961730449251248, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7512; Top5: 0.9549
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7518646012621917, 'ACC_ID': 0.6976477337923122, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7558; Top5: 0.9564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.756285785411999, 'ACC_ID': 0.7037590241473737, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7600; Top5: 0.9572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.760310421286031, 'ACC_ID': 0.7079822616407982, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7637; Top5: 0.9592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7639639639639639, 'ACC_ID': 0.7119119119119119, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7647; Top5: 0.9600
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.764919941775837, 'ACC_ID': 0.715429403202329, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7635; Top5: 0.9604
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7636849132176236, 'ACC_ID': 0.7119492656875834, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7645; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.764678687008784, 'ACC_ID': 0.7139775003852674, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7646; Top5: 0.9616
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7648150792517493, 'ACC_ID': 0.7135513351420819, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7656; Top5: 0.9623
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7657249466950959, 'ACC_ID': 0.7132196162046909, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7667; Top5: 0.9628
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7668627205606308, 'ACC_ID': 0.7151795770241521, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7681; Top5: 0.9635
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7681449241265733, 'ACC_ID': 0.7165039407128573, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7683; Top5: 0.9635
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7683741648106904, 'ACC_ID': 0.7169265033407572, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7670; Top5: 0.9637
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7670364500792393, 'ACC_ID': 0.7166402535657687, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7673; Top5: 0.9633
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7674, 'ACC_ID': 0.7172, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32540268 0.31375763 ... 0.18822275 0.18820515 0.14448215]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.7300; Top-5 accuracy: 96.3300
{'Method': 'rosita_knn_txt', 'AUC': 0.8972604000000001, 'FPR95': 0.3601, 'ACC_ALL': 0.7674, 'ACC_ID': 0.7172, 'ACC_OOD': 0.759, 'ACC_HM': 0.7375081967213114, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp3_kn1

Step 999: Top1: 0.5150; Top5: 0.7515
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.33266533066132264, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5026; Top5: 0.7533
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5035971223021583, 'ACC_ID': 0.34224049331963, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4890; Top5: 0.7442
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48998664886515353, 'ACC_ID': 0.3431241655540721, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4920; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4927099044746104, 'ACC_ID': 0.3494218200100553, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4972; Top5: 0.7506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49799518845228546, 'ACC_ID': 0.35445068163592625, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4998; Top5: 0.7551
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5004991680532446, 'ACC_ID': 0.35973377703826953, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4964; Top5: 0.7581
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4968445209409065, 'ACC_ID': 0.35800344234079173, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4974; Top5: 0.7573
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4976350510331093, 'ACC_ID': 0.36544685088374407, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4994; Top5: 0.7563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49955654101995567, 'ACC_ID': 0.3784922394678492, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4964; Top5: 0.7529
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4968968968968969, 'ACC_ID': 0.38738738738738737, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4958; Top5: 0.7511
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49617903930131, 'ACC_ID': 0.39665211062590977, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4889; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48915220293724965, 'ACC_ID': 0.3978638184245661, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4897; Top5: 0.7466
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49006010171058717, 'ACC_ID': 0.4057635999383572, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4879; Top5: 0.7471
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4883621305154934, 'ACC_ID': 0.41025274882193347, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4871; Top5: 0.7444
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4874733475479744, 'ACC_ID': 0.41457889125799574, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4847; Top5: 0.7427
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4851708171693155, 'ACC_ID': 0.4167188086597422, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4834; Top5: 0.7413
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4838254323020821, 'ACC_ID': 0.4194800611692742, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4820; Top5: 0.7416
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48229398663697104, 'ACC_ID': 0.42138084632516704, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4793; Top5: 0.7404
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4794506075013207, 'ACC_ID': 0.42165874273639725, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4780; Top5: 0.7408
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4782, 'ACC_ID': 0.4235, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34988734 0.2766194  ... 0.1514077  0.15140671 0.09918065]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 47.8000; Top-5 accuracy: 74.0800
{'Method': 'rosita_knn_txt', 'AUC': 0.95820275, 'FPR95': 0.3195, 'ACC_ALL': 0.4782, 'ACC_ID': 0.4235, 'ACC_OOD': 0.9818, 'ACC_HM': 0.5917488080836832, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp3_kn1

Step 999: Top1: 0.5170; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3366733466933868, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5036; Top5: 0.7544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5025693730729702, 'ACC_ID': 0.3391572456320658, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4957; Top5: 0.7442
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4939919893190921, 'ACC_ID': 0.34579439252336447, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5030; Top5: 0.7465
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5017596782302665, 'ACC_ID': 0.3438914027149321, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5080; Top5: 0.7510
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5072173215717722, 'ACC_ID': 0.3392141138732959, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5085; Top5: 0.7544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.507820299500832, 'ACC_ID': 0.3410981697171381, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5088; Top5: 0.7567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5080321285140562, 'ACC_ID': 0.3419391853126793, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5106; Top5: 0.7568
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5100821508588499, 'ACC_ID': 0.34777196913119246, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5114; Top5: 0.7572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5108647450110865, 'ACC_ID': 0.352549889135255, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5056; Top5: 0.7529
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5053053053053053, 'ACC_ID': 0.35195195195195195, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5025; Top5: 0.7478
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5021834061135371, 'ACC_ID': 0.3535298398835517, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4907; Top5: 0.7381
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4903204272363151, 'ACC_ID': 0.34813084112149534, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4895; Top5: 0.7350
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4891354600092464, 'ACC_ID': 0.3522884882108183, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4869; Top5: 0.7354
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48664857918035126, 'ACC_ID': 0.3558474939311724, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4868; Top5: 0.7352
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4865405117270789, 'ACC_ID': 0.359408315565032, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4839; Top5: 0.7334
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48354398698535855, 'ACC_ID': 0.3615317231885872, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4832; Top5: 0.7328
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48288436654511235, 'ACC_ID': 0.3638395482884367, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4817; Top5: 0.7307
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48129175946547886, 'ACC_ID': 0.36570155902004453, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4792; Top5: 0.7274
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4786053882725832, 'ACC_ID': 0.36450079239302696, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4740; Top5: 0.7219
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4735, 'ACC_ID': 0.3621, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33853981 0.30313638 ... 0.1805167  0.17978469 0.15989132]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 47.4000; Top-5 accuracy: 72.1900
{'Method': 'rosita_knn_txt', 'AUC': 0.84117325, 'FPR95': 0.656, 'ACC_ALL': 0.4735, 'ACC_ID': 0.3621, 'ACC_OOD': 0.9244, 'ACC_HM': 0.5203657054022541, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp3_kn1

Step 999: Top1: 0.5150; Top5: 0.7515
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3406813627254509, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5046; Top5: 0.7544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5056526207605344, 'ACC_ID': 0.35765673175745116, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4970; Top5: 0.7428
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49732977303070763, 'ACC_ID': 0.3658210947930574, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5070; Top5: 0.7470
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5067873303167421, 'ACC_ID': 0.371543489190548, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5116; Top5: 0.7518
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5116279069767442, 'ACC_ID': 0.3748997594226143, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5115; Top5: 0.7584
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5114808652246257, 'ACC_ID': 0.3757071547420965, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5131; Top5: 0.7587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5129087779690189, 'ACC_ID': 0.38009179575444635, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5136; Top5: 0.7590
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5135673388100572, 'ACC_ID': 0.3828727906397809, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5174; Top5: 0.7605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5172949002217295, 'ACC_ID': 0.3831485587583149, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5150; Top5: 0.7609
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5151151151151151, 'ACC_ID': 0.3847847847847848, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5171; Top5: 0.7626
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5171033478893741, 'ACC_ID': 0.38300582241630277, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5113; Top5: 0.7605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5110146862483311, 'ACC_ID': 0.37917222963951935, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5131; Top5: 0.7625
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5128679303436585, 'ACC_ID': 0.38110648790260443, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5116; Top5: 0.7638
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5114950735399114, 'ACC_ID': 0.38155076395830356, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5123; Top5: 0.7640
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5121268656716418, 'ACC_ID': 0.3820628997867804, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5105; Top5: 0.7633
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5105743961957202, 'ACC_ID': 0.38142910774621447, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5111; Top5: 0.7636
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5111163392542054, 'ACC_ID': 0.3827784966474532, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5109; Top5: 0.7641
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5108017817371938, 'ACC_ID': 0.38374164810690425, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5105; Top5: 0.7639
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5104067617538299, 'ACC_ID': 0.3820390913893291, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5110; Top5: 0.7661
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5109, 'ACC_ID': 0.3836, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34306109 0.33940014 ... 0.18484983 0.18262438 0.1767959 ]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 51.0900; Top-5 accuracy: 76.6000
{'Method': 'rosita_knn_txt', 'AUC': 0.7004917250000001, 'FPR95': 0.8594, 'ACC_ALL': 0.5109, 'ACC_ID': 0.3836, 'ACC_OOD': 0.6672, 'ACC_HM': 0.48712965359725924, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=1, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp3_kn1

Step 999: Top1: 0.5150; Top5: 0.7515
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150300601202404, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5036; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5046248715313464, 'ACC_ID': 0.3545734840698869, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4957; Top5: 0.7435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49666221628838453, 'ACC_ID': 0.3638184245660881, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5045; Top5: 0.7460
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5057817998994469, 'ACC_ID': 0.37757667169431874, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5092; Top5: 0.7518
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5104250200481155, 'ACC_ID': 0.3785084202085004, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5092; Top5: 0.7567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5101497504159733, 'ACC_ID': 0.3767054908485857, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5093; Top5: 0.7581
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5100401606425703, 'ACC_ID': 0.37521514629948366, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5098; Top5: 0.7585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5100821508588499, 'ACC_ID': 0.376151356733881, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5130; Top5: 0.7594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5130820399113082, 'ACC_ID': 0.38137472283813745, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5106; Top5: 0.7585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5109109109109109, 'ACC_ID': 0.3841841841841842, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5135; Top5: 0.7593
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.513646288209607, 'ACC_ID': 0.3890101892285298, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5078; Top5: 0.7565
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5078437917222964, 'ACC_ID': 0.3840120160213618, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5103; Top5: 0.7585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5105563260903067, 'ACC_ID': 0.3880413006626599, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5091; Top5: 0.7609
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5093531343709838, 'ACC_ID': 0.3889761530772526, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5096; Top5: 0.7601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.509728144989339, 'ACC_ID': 0.39112473347547977, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5080; Top5: 0.7596
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5079464397447128, 'ACC_ID': 0.38943811788261795, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5082; Top5: 0.7593
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5081755087636749, 'ACC_ID': 0.38995412304434773, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5080; Top5: 0.7601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5077951002227171, 'ACC_ID': 0.3900890868596882, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5072; Top5: 0.7597
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5070258848388801, 'ACC_ID': 0.38943475964078184, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5076; Top5: 0.7620
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5074, 'ACC_ID': 0.3902, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35064697 0.3431783  ... 0.18228135 0.18198526 0.16944937]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 50.7500; Top-5 accuracy: 76.1900
{'Method': 'rosita_knn_txt', 'AUC': 0.70396847, 'FPR95': 0.7956, 'ACC_ALL': 0.5074, 'ACC_ID': 0.3902, 'ACC_OOD': 0.6671, 'ACC_HM': 0.49239084460418037, 'kp': 3, 'kn': 1, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




3 3
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp3_kn3

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.5991983967935872, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7523; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7523124357656732, 'ACC_ID': 0.6084275436793423, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7562; Top5: 0.9499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7563417890520694, 'ACC_ID': 0.6081441922563418, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7621; Top5: 0.9532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7621920563097033, 'ACC_ID': 0.6259426847662142, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7654; Top5: 0.9543
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7654370489174017, 'ACC_ID': 0.6375300721732157, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7537; Top5: 0.9544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7534109816971714, 'ACC_ID': 0.6366056572379367, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7552; Top5: 0.9527
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7547332185886403, 'ACC_ID': 0.6431440045897877, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7501; Top5: 0.9522
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7495643515060991, 'ACC_ID': 0.6420214090117002, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7492; Top5: 0.9525
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7485587583148559, 'ACC_ID': 0.6450110864745011, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7497; Top5: 0.9541
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7491491491491491, 'ACC_ID': 0.6510510510510511, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7467; Top5: 0.9540
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.74617903930131, 'ACC_ID': 0.6524745269286754, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7436; Top5: 0.9539
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7431575433911882, 'ACC_ID': 0.6528704939919893, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7445; Top5: 0.9536
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7438742487286176, 'ACC_ID': 0.653567575897673, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7426; Top5: 0.9539
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7422533200057119, 'ACC_ID': 0.6534342424675139, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7444; Top5: 0.9542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7440031982942431, 'ACC_ID': 0.6557835820895522, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7441; Top5: 0.9546
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7437116756350894, 'ACC_ID': 0.6569891127518458, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7431; Top5: 0.9551
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7426185154687683, 'ACC_ID': 0.6589812963180802, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7415; Top5: 0.9548
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7412026726057906, 'ACC_ID': 0.6605790645879732, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7391; Top5: 0.9546
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7387216059165346, 'ACC_ID': 0.6605388272583201, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7367; Top5: 0.9545
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7363, 'ACC_ID': 0.6608, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33770406 0.30345887 ... 0.17593718 0.17593098 0.15715176]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 73.6700; Top-5 accuracy: 95.4500
{'Method': 'rosita_knn_txt', 'AUC': 0.96309374, 'FPR95': 0.2436, 'ACC_ALL': 0.7363, 'ACC_ID': 0.6608, 'ACC_OOD': 0.9819, 'ACC_HM': 0.7899671516405917, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp3_kn3

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7492; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.750256937307297, 'ACC_ID': 0.6310380267214799, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7495; Top5: 0.9506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7503337783711616, 'ACC_ID': 0.6381842456608812, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7510; Top5: 0.9562
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7516339869281046, 'ACC_ID': 0.652589240824535, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7538; Top5: 0.9583
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7542101042502005, 'ACC_ID': 0.6551724137931034, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7481; Top5: 0.9577
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7484193011647254, 'ACC_ID': 0.6449251247920134, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7484; Top5: 0.9581
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7487091222030982, 'ACC_ID': 0.6457257601835915, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7508; Top5: 0.9574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7510580034851879, 'ACC_ID': 0.6472491909385113, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7465; Top5: 0.9530
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7467849223946785, 'ACC_ID': 0.6456762749445676, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7437; Top5: 0.9499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7439439439439439, 'ACC_ID': 0.6462462462462463, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7394; Top5: 0.9476
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7398107714701602, 'ACC_ID': 0.648471615720524, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7356; Top5: 0.9464
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.735981308411215, 'ACC_ID': 0.6470293724966623, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7357; Top5: 0.9448
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7358606873169979, 'ACC_ID': 0.648482046540299, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7332; Top5: 0.9444
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7335427673854062, 'ACC_ID': 0.6474368127945166, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7329; Top5: 0.9438
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7332089552238806, 'ACC_ID': 0.6488539445628998, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7322; Top5: 0.9434
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7324490051307722, 'ACC_ID': 0.6497309473157302, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7318; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7319138924832372, 'ACC_ID': 0.6505117045053523, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7303; Top5: 0.9425
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7304008908685968, 'ACC_ID': 0.6510022271714923, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7271; Top5: 0.9425
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7272054939249868, 'ACC_ID': 0.649973586899102, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7251; Top5: 0.9425
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7253, 'ACC_ID': 0.65, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32963765 0.29133517 ... 0.17726585 0.1772282  0.15446031]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 72.5100; Top-5 accuracy: 94.2500
{'Method': 'rosita_knn_txt', 'AUC': 0.9390996299999999, 'FPR95': 0.3487, 'ACC_ALL': 0.7253, 'ACC_ID': 0.65, 'ACC_OOD': 0.9504, 'ACC_HM': 0.7720069982504375, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp3_kn3

Step 999: Top1: 0.7375; Top5: 0.9439
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7374749498997996, 'ACC_ID': 0.5951903807615231, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7544; Top5: 0.9414
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7533401849948612, 'ACC_ID': 0.6269270298047277, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7555; Top5: 0.9506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7550066755674232, 'ACC_ID': 0.6361815754339119, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7631; Top5: 0.9552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7626948215183509, 'ACC_ID': 0.6606334841628959, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7638; Top5: 0.9571
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7634322373696872, 'ACC_ID': 0.6635926222935045, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7557; Top5: 0.9564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7557404326123128, 'ACC_ID': 0.6515806988352746, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7564; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7564543889845095, 'ACC_ID': 0.6534710269650029, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7593; Top5: 0.9579
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7592730893701768, 'ACC_ID': 0.6539706248444113, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7620; Top5: 0.9590
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7618625277161862, 'ACC_ID': 0.6536585365853659, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7669; Top5: 0.9602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7665665665665665, 'ACC_ID': 0.6552552552552553, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7691; Top5: 0.9609
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.768740902474527, 'ACC_ID': 0.6559315866084425, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7675; Top5: 0.9613
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7671895861148198, 'ACC_ID': 0.6533711615487316, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7683; Top5: 0.9615
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7677608260132532, 'ACC_ID': 0.6503313299429804, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7681; Top5: 0.9617
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7676709981436527, 'ACC_ID': 0.6471512209053263, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7699; Top5: 0.9623
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.769456289978678, 'ACC_ID': 0.6431236673773987, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7712; Top5: 0.9622
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7708672256288325, 'ACC_ID': 0.6457264422475285, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7731; Top5: 0.9625
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7726149864721797, 'ACC_ID': 0.6467474414774732, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7729; Top5: 0.9626
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7724944320712694, 'ACC_ID': 0.6481069042316259, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7711; Top5: 0.9624
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7706286318013735, 'ACC_ID': 0.6463814051769677, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7710; Top5: 0.9620
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7706, 'ACC_ID': 0.6459, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32293701 0.31083077 ... 0.17466694 0.17414698 0.15942976]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 77.1000; Top-5 accuracy: 96.2000
{'Method': 'rosita_knn_txt', 'AUC': 0.8206087549999999, 'FPR95': 0.6547, 'ACC_ALL': 0.7706, 'ACC_ID': 0.6459, 'ACC_OOD': 0.7437, 'ACC_HM': 0.6913584196891192, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp3_kn3

Step 999: Top1: 0.7315; Top5: 0.9439
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.6593186372745491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7472; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7482014388489209, 'ACC_ID': 0.6906474820143885, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7508; Top5: 0.9506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7516688918558078, 'ACC_ID': 0.7022696929238985, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7555; Top5: 0.9552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7566616390145802, 'ACC_ID': 0.7149321266968326, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7558; Top5: 0.9583
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7566158781074579, 'ACC_ID': 0.714514835605453, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7511; Top5: 0.9577
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.751747088186356, 'ACC_ID': 0.7034941763727122, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7521; Top5: 0.9584
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7527251864601262, 'ACC_ID': 0.7062535857716581, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7558; Top5: 0.9597
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7560368434154842, 'ACC_ID': 0.7109783420463032, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7585; Top5: 0.9599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7587583148558759, 'ACC_ID': 0.7141906873614191, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7623; Top5: 0.9614
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7625625625625626, 'ACC_ID': 0.7179179179179179, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7626; Top5: 0.9616
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7627365356622998, 'ACC_ID': 0.7172489082969432, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7600; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7600133511348465, 'ACC_ID': 0.7137850467289719, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7606; Top5: 0.9610
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7606719063029742, 'ACC_ID': 0.7145939281861612, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7615; Top5: 0.9616
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7615307725260603, 'ACC_ID': 0.7145509067542481, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7628; Top5: 0.9619
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7627931769722814, 'ACC_ID': 0.7138859275053305, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7642; Top5: 0.9622
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7642347641096233, 'ACC_ID': 0.7153047178075335, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7655; Top5: 0.9625
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7654393600752852, 'ACC_ID': 0.7159157746147512, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7652; Top5: 0.9625
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7652561247216035, 'ACC_ID': 0.7155902004454343, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7634; Top5: 0.9624
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7634442683571051, 'ACC_ID': 0.7148441627047015, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7632; Top5: 0.9619
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7632, 'ACC_ID': 0.7147, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.3237288  0.30881253 ... 0.18660776 0.18660718 0.1360143 ]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.3200; Top-5 accuracy: 96.1900
{'Method': 'rosita_knn_txt', 'AUC': 0.901464005, 'FPR95': 0.3456, 'ACC_ALL': 0.7632, 'ACC_ID': 0.7147, 'ACC_OOD': 0.77, 'ACC_HM': 0.7413201320132012, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp3_kn3

Step 999: Top1: 0.5150; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3346693386773547, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4964; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49743062692702983, 'ACC_ID': 0.31346351490236385, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4843; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48464619492656874, 'ACC_ID': 0.32309746328437916, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4869; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48717948717948717, 'ACC_ID': 0.33283056812468576, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4920; Top5: 0.7514
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49238171611868486, 'ACC_ID': 0.34322373696872494, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4938; Top5: 0.7537
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49417637271214643, 'ACC_ID': 0.3560732113144759, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4861; Top5: 0.7512
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48623063683304646, 'ACC_ID': 0.36460126219162364, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4802; Top5: 0.7478
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48045805327358726, 'ACC_ID': 0.37465770475479215, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4804; Top5: 0.7458
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48048780487804876, 'ACC_ID': 0.3858093126385809, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4762; Top5: 0.7437
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47647647647647645, 'ACC_ID': 0.390990990990991, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4760; Top5: 0.7409
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4761644832605531, 'ACC_ID': 0.39847161572052403, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4682; Top5: 0.7358
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46845794392523366, 'ACC_ID': 0.397196261682243, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4667; Top5: 0.7341
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4669440591770689, 'ACC_ID': 0.4011403914316536, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4646; Top5: 0.7331
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4648007996572897, 'ACC_ID': 0.40382693131515063, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4644; Top5: 0.7291
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46455223880597013, 'ACC_ID': 0.4076492537313433, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4607; Top5: 0.7259
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4608935051933425, 'ACC_ID': 0.4074583906895257, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4593; Top5: 0.7242
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4594753558404894, 'ACC_ID': 0.409245971062228, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4584; Top5: 0.7239
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4584632516703786, 'ACC_ID': 0.410913140311804, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4552; Top5: 0.7204
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45525620707871106, 'ACC_ID': 0.41014263074484947, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4555; Top5: 0.7202
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4556, 'ACC_ID': 0.4129, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34736684 0.28648114 ... 0.14318898 0.14318737 0.09083455]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 45.5500; Top-5 accuracy: 72.0200
{'Method': 'rosita_knn_txt', 'AUC': 0.9702934899999999, 'FPR95': 0.2067, 'ACC_ALL': 0.4556, 'ACC_ID': 0.4129, 'ACC_OOD': 0.9886, 'ACC_HM': 0.5825086550124866, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp3_kn3

Step 999: Top1: 0.5150; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5015; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5035971223021583, 'ACC_ID': 0.3340184994861254, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4970; Top5: 0.7448
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4979973297730307, 'ACC_ID': 0.3464619492656876, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5035; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5037707390648567, 'ACC_ID': 0.34741075917546504, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5068; Top5: 0.7538
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5072173215717722, 'ACC_ID': 0.34282277465918204, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5078; Top5: 0.7584
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.508153078202995, 'ACC_ID': 0.35108153078202997, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5016; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5020080321285141, 'ACC_ID': 0.34796328169822144, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4847; Top5: 0.7374
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48493900921085387, 'ACC_ID': 0.33632063729151107, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4671; Top5: 0.7152
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46696230598669625, 'ACC_ID': 0.32749445676274946, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4549; Top5: 0.7010
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45505505505505506, 'ACC_ID': 0.32232232232232233, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4474; Top5: 0.6932
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44741630276564776, 'ACC_ID': 0.3207787481804949, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4405; Top5: 0.6847
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44042056074766356, 'ACC_ID': 0.3180907877169559, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4391; Top5: 0.6843
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43905070118662354, 'ACC_ID': 0.3225458468176915, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4372; Top5: 0.6827
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4370983864058261, 'ACC_ID': 0.3227188347850921, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4338; Top5: 0.6802
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4337686567164179, 'ACC_ID': 0.3234275053304904, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4297; Top5: 0.6763
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4297334501313978, 'ACC_ID': 0.32261293955700165, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4274; Top5: 0.6753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42747912010351724, 'ACC_ID': 0.32513821903305495, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4272; Top5: 0.6758
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42717149220489975, 'ACC_ID': 0.32761692650334073, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4269; Top5: 0.6753
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42683571051241415, 'ACC_ID': 0.32921288959323824, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4245; Top5: 0.6733
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4245, 'ACC_ID': 0.33, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34254825 0.30336967 ... 0.17545007 0.175446   0.15681782]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 42.4500; Top-5 accuracy: 67.3300
{'Method': 'rosita_knn_txt', 'AUC': 0.8344754050000001, 'FPR95': 0.6521, 'ACC_ALL': 0.4245, 'ACC_ID': 0.33, 'ACC_OOD': 0.9298, 'ACC_HM': 0.48711541514526113, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp3_kn3

Step 999: Top1: 0.5170; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5077; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066803699897225, 'ACC_ID': 0.3566289825282631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4983; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49732977303070763, 'ACC_ID': 0.36181575433911883, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5075; Top5: 0.7500
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5067873303167421, 'ACC_ID': 0.3695324283559578, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5128; Top5: 0.7542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5128307939053729, 'ACC_ID': 0.36808340016038493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5151; Top5: 0.7587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5148086522462563, 'ACC_ID': 0.37204658901830284, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5139; Top5: 0.7593
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5134825014343086, 'ACC_ID': 0.37779690189328746, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5138; Top5: 0.7588
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5133183968135424, 'ACC_ID': 0.37565347274085137, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5170; Top5: 0.7594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5164079822616408, 'ACC_ID': 0.3760532150776053, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5138; Top5: 0.7591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5135135135135135, 'ACC_ID': 0.37697697697697696, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5156; Top5: 0.7600
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5152838427947598, 'ACC_ID': 0.37663755458515286, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5096; Top5: 0.7571
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5090120160213618, 'ACC_ID': 0.3728304405874499, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5113; Top5: 0.7585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5107104330405301, 'ACC_ID': 0.3770997071967946, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5094; Top5: 0.7602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5090675424817935, 'ACC_ID': 0.3771240896758532, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5089; Top5: 0.7608
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5085287846481876, 'ACC_ID': 0.37699893390191896, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5073; Top5: 0.7601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5069453134776624, 'ACC_ID': 0.3755474909272932, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5069; Top5: 0.7598
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.506646276908599, 'ACC_ID': 0.37607340312904364, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5067; Top5: 0.7600
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.506347438752784, 'ACC_ID': 0.3765033407572383, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5064; Top5: 0.7602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5059693608029583, 'ACC_ID': 0.37548864236661383, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5067; Top5: 0.7622
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5063, 'ACC_ID': 0.3764, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34729683 0.33171275 ... 0.18397899 0.18260732 0.17652363]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 50.6600; Top-5 accuracy: 76.2100
{'Method': 'rosita_knn_txt', 'AUC': 0.70409633, 'FPR95': 0.856, 'ACC_ALL': 0.5063, 'ACC_ID': 0.3764, 'ACC_OOD': 0.6828, 'ACC_HM': 0.48528308157099703, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=3, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp3_kn3

Step 999: Top1: 0.5150; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5046; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5056526207605344, 'ACC_ID': 0.35354573484069884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4977; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4979973297730307, 'ACC_ID': 0.3658210947930574, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5065; Top5: 0.7495
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5067873303167421, 'ACC_ID': 0.37858220211161386, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5112; Top5: 0.7538
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5116279069767442, 'ACC_ID': 0.3793103448275862, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5115; Top5: 0.7591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5121464226289517, 'ACC_ID': 0.3793677204658902, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5108; Top5: 0.7595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5109007458405048, 'ACC_ID': 0.38209982788296043, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5111; Top5: 0.7578
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5110779188449092, 'ACC_ID': 0.3843664426188698, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5119; Top5: 0.7585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5117516629711751, 'ACC_ID': 0.38824833702882483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5096; Top5: 0.7573
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5095095095095095, 'ACC_ID': 0.388988988988989, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5124; Top5: 0.7571
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5121906841339156, 'ACC_ID': 0.3937409024745269, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5069; Top5: 0.7543
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066755674232309, 'ACC_ID': 0.3891855807743658, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5094; Top5: 0.7563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5094775774387424, 'ACC_ID': 0.39389736477115117, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5070; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.507068399257461, 'ACC_ID': 0.3938312151934885, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5075; Top5: 0.7576
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5074626865671642, 'ACC_ID': 0.39498933901918976, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5054; Top5: 0.7576
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5053184832937054, 'ACC_ID': 0.3914403704167188, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5052; Top5: 0.7576
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5051170450535231, 'ACC_ID': 0.3904246559228326, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5052; Top5: 0.7583
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.505011135857461, 'ACC_ID': 0.3906458797327394, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5041; Top5: 0.7583
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5039619651347068, 'ACC_ID': 0.3890121500264131, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5041; Top5: 0.7597
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5039, 'ACC_ID': 0.3897, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34880528 0.34831768 ... 0.18137571 0.1813139  0.16770217]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 50.4000; Top-5 accuracy: 75.9700
{'Method': 'rosita_knn_txt', 'AUC': 0.7090534100000001, 'FPR95': 0.7905, 'ACC_ALL': 0.5039, 'ACC_ID': 0.3897, 'ACC_OOD': 0.6693, 'ACC_HM': 0.4925896317280454, 'kp': 3, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




3 5
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp3_kn5

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7513; Top5: 0.9445
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7512846865364851, 'ACC_ID': 0.6104830421377184, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7555; Top5: 0.9512
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7556742323097463, 'ACC_ID': 0.6161548731642189, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7631; Top5: 0.9542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7631975867269984, 'ACC_ID': 0.6334841628959276, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7658; Top5: 0.9555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7650360866078588, 'ACC_ID': 0.6479550922213312, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7571; Top5: 0.9551
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7564059900166389, 'ACC_ID': 0.642928452579035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7570; Top5: 0.9529
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7567412507171544, 'ACC_ID': 0.6434308663224326, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7511; Top5: 0.9525
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7508090614886731, 'ACC_ID': 0.6420214090117002, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7489; Top5: 0.9525
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.748780487804878, 'ACC_ID': 0.6427937915742794, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7481; Top5: 0.9541
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7479479479479479, 'ACC_ID': 0.6474474474474474, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7436; Top5: 0.9536
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7434497816593887, 'ACC_ID': 0.6448326055312955, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7404; Top5: 0.9533
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7403204272363151, 'ACC_ID': 0.6433578104138852, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7403; Top5: 0.9531
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7400215749730313, 'ACC_ID': 0.6437047310833719, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7374; Top5: 0.9539
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7372554619448808, 'ACC_ID': 0.6437241182350422, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7399; Top5: 0.9543
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7397388059701493, 'ACC_ID': 0.6491204690831557, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7385; Top5: 0.9544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7384557627330747, 'ACC_ID': 0.6509823551495433, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7375; Top5: 0.9549
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7373250205858134, 'ACC_ID': 0.6539230678743677, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7361; Top5: 0.9548
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7359688195991091, 'ACC_ID': 0.6553452115812918, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7336; Top5: 0.9546
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334389857369256, 'ACC_ID': 0.6562070787110407, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7316; Top5: 0.9545
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7314, 'ACC_ID': 0.6573, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34063691 0.30128771 ... 0.16682261 0.16662242 0.14761892]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 73.1600; Top-5 accuracy: 95.4500
{'Method': 'rosita_knn_txt', 'AUC': 0.96068146, 'FPR95': 0.2906, 'ACC_ALL': 0.7314, 'ACC_ID': 0.6573, 'ACC_OOD': 0.983, 'ACC_HM': 0.7878143022617815, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp3_kn5

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7523; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7523124357656732, 'ACC_ID': 0.6351490236382322, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7522; Top5: 0.9506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7523364485981309, 'ACC_ID': 0.6321762349799733, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7560; Top5: 0.9552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7561588738059326, 'ACC_ID': 0.6515837104072398, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7570; Top5: 0.9571
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7570168404170008, 'ACC_ID': 0.6543704891740176, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7514; Top5: 0.9577
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.751414309484193, 'ACC_ID': 0.6449251247920134, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7521; Top5: 0.9575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7521514629948365, 'ACC_ID': 0.648881239242685, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7503; Top5: 0.9557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7503111774956435, 'ACC_ID': 0.6497386109036595, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7456; Top5: 0.9539
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7456762749445677, 'ACC_ID': 0.6492239467849223, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7453; Top5: 0.9535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7453453453453454, 'ACC_ID': 0.6512512512512513, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7420; Top5: 0.9521
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7419941775836972, 'ACC_ID': 0.651018922852984, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7384; Top5: 0.9511
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7384846461949266, 'ACC_ID': 0.6513684913217623, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7367; Top5: 0.9498
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7367853290183387, 'ACC_ID': 0.6523347202958854, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7346; Top5: 0.9492
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7346851349421677, 'ACC_ID': 0.6521490789661574, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7353; Top5: 0.9487
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7353411513859275, 'ACC_ID': 0.6544509594882729, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7342; Top5: 0.9494
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7342009760981104, 'ACC_ID': 0.6538605931673133, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7336; Top5: 0.9493
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334431243383132, 'ACC_ID': 0.6536878014351253, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7322; Top5: 0.9481
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7318485523385301, 'ACC_ID': 0.6540089086859688, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7286; Top5: 0.9482
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7282620179609086, 'ACC_ID': 0.6527205493924987, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7273; Top5: 0.9481
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7271, 'ACC_ID': 0.6529, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32860571 0.29040271 ... 0.16649093 0.16625698 0.15856749]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 72.7300; Top-5 accuracy: 94.8100
{'Method': 'rosita_knn_txt', 'AUC': 0.95268082, 'FPR95': 0.2685, 'ACC_ALL': 0.7271, 'ACC_ID': 0.6529, 'ACC_OOD': 0.9574, 'ACC_HM': 0.7763602558529467, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp3_kn5

Step 999: Top1: 0.7395; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7394789579158316, 'ACC_ID': 0.5991983967935872, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7544; Top5: 0.9424
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7543679342240494, 'ACC_ID': 0.6310380267214799, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7562; Top5: 0.9506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7576769025367156, 'ACC_ID': 0.6481975967957276, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7606; Top5: 0.9557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7616892911010558, 'ACC_ID': 0.6641528406234288, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7622; Top5: 0.9575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7630312750601443, 'ACC_ID': 0.6599839615076183, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7541; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7547420965058236, 'ACC_ID': 0.6449251247920134, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7558; Top5: 0.9575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7564543889845095, 'ACC_ID': 0.6483075157773953, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7583; Top5: 0.9589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7587752053771472, 'ACC_ID': 0.6502364948966891, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7607; Top5: 0.9592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7611973392461198, 'ACC_ID': 0.6516629711751663, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7651; Top5: 0.9604
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7655655655655655, 'ACC_ID': 0.6516516516516516, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7675; Top5: 0.9609
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7678311499272198, 'ACC_ID': 0.6519286754002911, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7661; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7666889185580774, 'ACC_ID': 0.647196261682243, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7670; Top5: 0.9610
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7672985051625828, 'ACC_ID': 0.6494066882416397, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7669; Top5: 0.9613
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7673854062544624, 'ACC_ID': 0.6484363844066828, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7685; Top5: 0.9619
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7689232409381663, 'ACC_ID': 0.6440565031982942, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7698; Top5: 0.9621
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.770241521711926, 'ACC_ID': 0.6457264422475285, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7711; Top5: 0.9626
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7714386542759676, 'ACC_ID': 0.6474532407952006, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7708; Top5: 0.9629
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7712694877505568, 'ACC_ID': 0.6494432071269488, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7690; Top5: 0.9625
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7693608029582673, 'ACC_ID': 0.6478605388272584, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7687; Top5: 0.9623
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7691, 'ACC_ID': 0.6476, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32261086 0.31096447 ... 0.17409965 0.17408663 0.16103375]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.8700; Top-5 accuracy: 96.2300
{'Method': 'rosita_knn_txt', 'AUC': 0.81980533, 'FPR95': 0.6612, 'ACC_ALL': 0.7691, 'ACC_ID': 0.6476, 'ACC_OOD': 0.7425, 'ACC_HM': 0.6918106611035179, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=5, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp3_kn5

Step 999: Top1: 0.7355; Top5: 0.9439
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.6593186372745491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7513; Top5: 0.9445
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7512846865364851, 'ACC_ID': 0.6937307297019527, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7548; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7550066755674232, 'ACC_ID': 0.7069425901201603, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7596; Top5: 0.9562
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7596782302664655, 'ACC_ID': 0.7164404223227753, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7590; Top5: 0.9591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7590216519647153, 'ACC_ID': 0.7161186848436247, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7541; Top5: 0.9587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7540765391014975, 'ACC_ID': 0.7058236272878535, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7558; Top5: 0.9590
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7558806655192197, 'ACC_ID': 0.7096959265633964, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7583; Top5: 0.9599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7585262633806323, 'ACC_ID': 0.7134677620114513, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7600; Top5: 0.9599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.760310421286031, 'ACC_ID': 0.7150776053215078, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7635; Top5: 0.9612
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7637637637637638, 'ACC_ID': 0.7179179179179179, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7636; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7638282387190685, 'ACC_ID': 0.7163391557496361, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7613; Top5: 0.9606
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7613484646194927, 'ACC_ID': 0.712283044058745, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7617; Top5: 0.9605
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7617506549545384, 'ACC_ID': 0.7125905378332563, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7625; Top5: 0.9610
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7625303441382265, 'ACC_ID': 0.7122661716407254, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7633; Top5: 0.9614
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7633262260127932, 'ACC_ID': 0.7117537313432836, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7646; Top5: 0.9613
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7646101864597672, 'ACC_ID': 0.71305218370667, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7652; Top5: 0.9613
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7649688271968004, 'ACC_ID': 0.7139160098811904, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7647; Top5: 0.9615
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7644766146993318, 'ACC_ID': 0.7140311804008909, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7625; Top5: 0.9614
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7622820919175911, 'ACC_ID': 0.71283676703645, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7616; Top5: 0.9609
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7615, 'ACC_ID': 0.7125, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32442266 0.30912971 ... 0.18928309 0.1892812  0.1347905 ]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.1600; Top-5 accuracy: 96.0900
{'Method': 'rosita_knn_txt', 'AUC': 0.901119515, 'FPR95': 0.3522, 'ACC_ALL': 0.7615, 'ACC_ID': 0.7125, 'ACC_OOD': 0.7712, 'ACC_HM': 0.7406888184943047, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp3_kn5

Step 999: Top1: 0.5150; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3346693386773547, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4974; Top5: 0.7544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4984583761562179, 'ACC_ID': 0.31346351490236385, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4850; Top5: 0.7435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48531375166889185, 'ACC_ID': 0.32443257676902537, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4874; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48768225238813473, 'ACC_ID': 0.33433886375062843, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4916; Top5: 0.7518
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49238171611868486, 'ACC_ID': 0.3400160384923817, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4932; Top5: 0.7531
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49384359400998334, 'ACC_ID': 0.3574043261231281, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4829; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48307515777395293, 'ACC_ID': 0.3628800917957544, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4805; Top5: 0.7428
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4807069952701021, 'ACC_ID': 0.3759024147373662, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4795; Top5: 0.7425
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4796008869179601, 'ACC_ID': 0.3853658536585366, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4756; Top5: 0.7413
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47607607607607605, 'ACC_ID': 0.39079079079079077, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4756; Top5: 0.7405
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4759825327510917, 'ACC_ID': 0.39828966521106257, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4697; Top5: 0.7368
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4699599465954606, 'ACC_ID': 0.39869826435246997, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4712; Top5: 0.7357
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4714131607335491, 'ACC_ID': 0.40560949298813376, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4677; Top5: 0.7364
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46808510638297873, 'ACC_ID': 0.40711123804083965, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4667; Top5: 0.7335
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4672174840085288, 'ACC_ID': 0.4103144989339019, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4628; Top5: 0.7304
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4633963208609686, 'ACC_ID': 0.4099612063571518, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4620; Top5: 0.7287
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4624161863310199, 'ACC_ID': 0.4121868015527585, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4599; Top5: 0.7285
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46024498886414256, 'ACC_ID': 0.41269487750556794, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4567; Top5: 0.7262
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4571579503433703, 'ACC_ID': 0.4120443740095087, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4558; Top5: 0.7250
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4563, 'ACC_ID': 0.4136, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34765738 0.28601339 ... 0.13373248 0.13372469 0.08293102]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 45.5800; Top-5 accuracy: 72.5000
{'Method': 'rosita_knn_txt', 'AUC': 0.9616319150000001, 'FPR95': 0.2184, 'ACC_ALL': 0.4563, 'ACC_ID': 0.4136, 'ACC_OOD': 0.9905, 'ACC_HM': 0.5835350758492985, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp3_kn5

Step 999: Top1: 0.5150; Top5: 0.7515
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3406813627254509, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5026; Top5: 0.7544
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5035971223021583, 'ACC_ID': 0.33504624871531347, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4963; Top5: 0.7435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4979973297730307, 'ACC_ID': 0.34913217623498, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5020; Top5: 0.7470
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5027652086475616, 'ACC_ID': 0.3504273504273504, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5076; Top5: 0.7510
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5084202085004009, 'ACC_ID': 0.3480352846832398, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5078; Top5: 0.7547
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.508485856905158, 'ACC_ID': 0.3560732113144759, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4904; Top5: 0.7377
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4911072862880092, 'ACC_ID': 0.34566838783706255, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4747; Top5: 0.7182
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47572815533980584, 'ACC_ID': 0.33831217326362956, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4666; Top5: 0.7079
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4674057649667406, 'ACC_ID': 0.3376940133037694, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4608; Top5: 0.7032
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46166166166166167, 'ACC_ID': 0.3375375375375375, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4591; Top5: 0.7016
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45978893740902477, 'ACC_ID': 0.3411572052401747, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4533; Top5: 0.6967
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4539385847797063, 'ACC_ID': 0.3379506008010681, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4514; Top5: 0.6954
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4519956850053937, 'ACC_ID': 0.33980582524271846, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4484; Top5: 0.6922
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.44909324575182064, 'ACC_ID': 0.33756961302299016, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4439; Top5: 0.6882
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4445628997867804, 'ACC_ID': 0.3363539445628998, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4387; Top5: 0.6821
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4393692904517582, 'ACC_ID': 0.3346264547616068, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4355; Top5: 0.6795
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4360663451358664, 'ACC_ID': 0.33407834372426776, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4331; Top5: 0.6785
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.433630289532294, 'ACC_ID': 0.33474387527839644, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4314; Top5: 0.6777
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43190702588483887, 'ACC_ID': 0.33555203380876913, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4302; Top5: 0.6772
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4307, 'ACC_ID': 0.3374, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34389177 0.30396625 ... 0.17290692 0.17282596 0.15614817]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 43.0200; Top-5 accuracy: 67.7200
{'Method': 'rosita_knn_txt', 'AUC': 0.8468067399999999, 'FPR95': 0.6376, 'ACC_ALL': 0.4307, 'ACC_ID': 0.3374, 'ACC_OOD': 0.9273, 'ACC_HM': 0.49477507709338187, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp3_kn5

Step 999: Top1: 0.5170; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5067; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066803699897225, 'ACC_ID': 0.35868448098663924, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4990; Top5: 0.7462
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4986648865153538, 'ACC_ID': 0.36248331108144194, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5080; Top5: 0.7500
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5077928607340372, 'ACC_ID': 0.3705379587732529, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5124; Top5: 0.7550
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5128307939053729, 'ACC_ID': 0.3688853247794707, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5145; Top5: 0.7594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5148086522462563, 'ACC_ID': 0.36938435940099834, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5136; Top5: 0.7598
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5137693631669535, 'ACC_ID': 0.3757888697647734, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5131; Top5: 0.7593
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5133183968135424, 'ACC_ID': 0.37465770475479215, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5156; Top5: 0.7591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5157427937915743, 'ACC_ID': 0.375609756097561, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5116; Top5: 0.7587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5121121121121122, 'ACC_ID': 0.37537537537537535, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5127; Top5: 0.7589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5129184861717613, 'ACC_ID': 0.37791120815138285, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5064; Top5: 0.7561
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066755674232309, 'ACC_ID': 0.37383177570093457, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5086; Top5: 0.7574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5088611496378487, 'ACC_ID': 0.37787024194791186, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5063; Top5: 0.7594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066400114236755, 'ACC_ID': 0.37683849778666284, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5057; Top5: 0.7599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5059968017057569, 'ACC_ID': 0.3776652452025586, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5039; Top5: 0.7592
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5041922162432737, 'ACC_ID': 0.37529720936053057, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5036; Top5: 0.7588
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5039407128573109, 'ACC_ID': 0.37536760381131634, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5032; Top5: 0.7587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5033407572383074, 'ACC_ID': 0.37561247216035637, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5020; Top5: 0.7591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5021658742736397, 'ACC_ID': 0.374432118330692, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5024; Top5: 0.7614
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5026, 'ACC_ID': 0.3745, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34902108 0.32933453 ... 0.18285757 0.18250889 0.17440543]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 50.2300; Top-5 accuracy: 76.1300
{'Method': 'rosita_knn_txt', 'AUC': 0.704015765, 'FPR95': 0.8582, 'ACC_ALL': 0.5026, 'ACC_ID': 0.3745, 'ACC_OOD': 0.6938, 'ACC_HM': 0.4864328372180099, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=5, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp3_kn5

Step 999: Top1: 0.5150; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150300601202404, 'ACC_ID': 0.3366733466933868, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5057; Top5: 0.7585
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5046248715313464, 'ACC_ID': 0.35251798561151076, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4977; Top5: 0.7462
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49666221628838453, 'ACC_ID': 0.3658210947930574, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5080; Top5: 0.7495
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5072900955253896, 'ACC_ID': 0.3780794369029663, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5140; Top5: 0.7538
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5136327185244587, 'ACC_ID': 0.3793103448275862, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5151; Top5: 0.7587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5148086522462563, 'ACC_ID': 0.3793677204658902, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5136; Top5: 0.7578
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5131956397016638, 'ACC_ID': 0.38209982788296043, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5121; Top5: 0.7565
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5118247448344536, 'ACC_ID': 0.3843664426188698, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5123; Top5: 0.7572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5119733924611973, 'ACC_ID': 0.388470066518847, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5102; Top5: 0.7561
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5101101101101101, 'ACC_ID': 0.3891891891891892, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5124; Top5: 0.7560
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.512372634643377, 'ACC_ID': 0.39246724890829693, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5064; Top5: 0.7525
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5063417890520694, 'ACC_ID': 0.38701602136181573, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5089; Top5: 0.7545
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5087070426876252, 'ACC_ID': 0.39050701186623515, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5066; Top5: 0.7564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5063544195344852, 'ACC_ID': 0.3889761530772526, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5067; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5063965884861408, 'ACC_ID': 0.3895255863539446, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5045; Top5: 0.7574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.504317357026655, 'ACC_ID': 0.38605931673132277, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5038; Top5: 0.7573
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5035878131984473, 'ACC_ID': 0.384778261381014, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5037; Top5: 0.7578
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5034521158129176, 'ACC_ID': 0.38496659242761694, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5021; Top5: 0.7574
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5018489170628632, 'ACC_ID': 0.38362387744321186, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5019; Top5: 0.7589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5016, 'ACC_ID': 0.3844, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34899828 0.34200376 ... 0.18165872 0.1811236  0.16953872]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 50.1800; Top-5 accuracy: 75.8900
{'Method': 'rosita_knn_txt', 'AUC': 0.708424045, 'FPR95': 0.7922, 'ACC_ALL': 0.5016, 'ACC_ID': 0.3844, 'ACC_OOD': 0.6714, 'ACC_HM': 0.4888921386626255, 'kp': 3, 'kn': 5, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




3 7
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp3_kn7

Step 999: Top1: 0.7315; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7314629258517034, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7503; Top5: 0.9445
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.750256937307297, 'ACC_ID': 0.6125385405960946, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7555; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7556742323097463, 'ACC_ID': 0.6181575433911882, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7641; Top5: 0.9547
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7642031171442936, 'ACC_ID': 0.6344896933132227, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7658; Top5: 0.9563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7654370489174017, 'ACC_ID': 0.6415396952686447, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7571; Top5: 0.9577
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.757071547420965, 'ACC_ID': 0.642928452579035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7578; Top5: 0.9581
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7578886976477338, 'ACC_ID': 0.6586345381526104, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7563; Top5: 0.9594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7565347274085138, 'ACC_ID': 0.6704007966143889, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7563; Top5: 0.9601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7565410199556541, 'ACC_ID': 0.6793791574279379, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7591; Top5: 0.9606
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7593593593593594, 'ACC_ID': 0.6896896896896897, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7558; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7561863173216885, 'ACC_ID': 0.6928675400291121, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7543; Top5: 0.9604
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7546728971962616, 'ACC_ID': 0.6965954606141522, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7539; Top5: 0.9601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7541994143935892, 'ACC_ID': 0.7004160887656034, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7519; Top5: 0.9609
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.752249036127374, 'ACC_ID': 0.7022704555190633, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7531; Top5: 0.9616
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7533315565031983, 'ACC_ID': 0.7065565031982942, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7524; Top5: 0.9620
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7527218120385434, 'ACC_ID': 0.7087973970717056, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7528; Top5: 0.9631
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7529702387954358, 'ACC_ID': 0.7116809787083872, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7523; Top5: 0.9627
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7524498886414254, 'ACC_ID': 0.7133630289532294, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7510; Top5: 0.9629
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7510829371368198, 'ACC_ID': 0.713998943475964, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7502; Top5: 0.9628
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7504, 'ACC_ID': 0.7153, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34212199 0.30070531 ... 0.13541108 0.13537923 0.09668586]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 75.0200; Top-5 accuracy: 96.2800
{'Method': 'rosita_knn_txt', 'AUC': 0.98634983, 'FPR95': 0.0994, 'ACC_ALL': 0.7504, 'ACC_ID': 0.7153, 'ACC_OOD': 0.9931, 'ACC_HM': 0.8316137087333177, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp3_kn7

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7513; Top5: 0.9424
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7512846865364851, 'ACC_ID': 0.6289825282631039, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7528; Top5: 0.9492
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.753004005340454, 'ACC_ID': 0.6321762349799733, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7591; Top5: 0.9542
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7596782302664655, 'ACC_ID': 0.6551030668677728, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7610; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7610264635124299, 'ACC_ID': 0.6587810745789896, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7547; Top5: 0.9571
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7547420965058236, 'ACC_ID': 0.6495840266222962, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7555; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7555938037865749, 'ACC_ID': 0.6523235800344234, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7528; Top5: 0.9539
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7528005974607916, 'ACC_ID': 0.6539706248444113, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7467; Top5: 0.9521
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7467849223946785, 'ACC_ID': 0.6523281596452328, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7463; Top5: 0.9521
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7463463463463463, 'ACC_ID': 0.6548548548548548, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7436; Top5: 0.9509
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7438136826783115, 'ACC_ID': 0.6555676855895196, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7394; Top5: 0.9503
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.739652870493992, 'ACC_ID': 0.6552069425901201, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7375; Top5: 0.9491
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.737555863769456, 'ACC_ID': 0.6555709662505779, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7356; Top5: 0.9487
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7356847065543338, 'ACC_ID': 0.6552905897472512, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7364; Top5: 0.9479
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7364072494669509, 'ACC_ID': 0.6580490405117271, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7355; Top5: 0.9486
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.735702665498686, 'ACC_ID': 0.6579902390188963, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7351; Top5: 0.9485
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7350899894130102, 'ACC_ID': 0.6579225973414893, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7336; Top5: 0.9473
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7337416481069042, 'ACC_ID': 0.6582405345211582, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7302; Top5: 0.9477
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7303750660327523, 'ACC_ID': 0.6568409931325938, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7288; Top5: 0.9476
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.729, 'ACC_ID': 0.6562, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32710439 0.29389995 ... 0.16407286 0.15796328 0.15789191]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 72.8800; Top-5 accuracy: 94.7600
{'Method': 'rosita_knn_txt', 'AUC': 0.95365627, 'FPR95': 0.2675, 'ACC_ALL': 0.729, 'ACC_ID': 0.6562, 'ACC_OOD': 0.9592, 'ACC_HM': 0.7792831992076266, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp3_kn7

Step 999: Top1: 0.7375; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7394789579158316, 'ACC_ID': 0.5971943887775552, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7544; Top5: 0.9424
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7553956834532374, 'ACC_ID': 0.6310380267214799, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7568; Top5: 0.9506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7576769025367156, 'ACC_ID': 0.6488651535380507, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7601; Top5: 0.9557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7606837606837606, 'ACC_ID': 0.6646556058320764, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7614; Top5: 0.9587
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7618283881315157, 'ACC_ID': 0.6615878107457899, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7521; Top5: 0.9577
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7524126455906822, 'ACC_ID': 0.6472545757071547, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7538; Top5: 0.9584
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7538726333907056, 'ACC_ID': 0.6491681009753298, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7563; Top5: 0.9594
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.756285785411999, 'ACC_ID': 0.6509833208862336, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7591; Top5: 0.9599
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7592017738359201, 'ACC_ID': 0.6521064301552106, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7647; Top5: 0.9610
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7647647647647647, 'ACC_ID': 0.6538538538538539, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7666; Top5: 0.9612
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7663755458515283, 'ACC_ID': 0.6477438136826783, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7646; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7645193591455274, 'ACC_ID': 0.6440253671562083, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7662; Top5: 0.9609
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7659115426105717, 'ACC_ID': 0.6446293727847126, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7658; Top5: 0.9612
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7656718549193203, 'ACC_ID': 0.6458660574039697, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7671; Top5: 0.9618
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7670575692963753, 'ACC_ID': 0.6413912579957356, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7686; Top5: 0.9620
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.768614691527969, 'ACC_ID': 0.6424727818796145, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7695; Top5: 0.9626
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.769556522762028, 'ACC_ID': 0.6451005764027762, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7692; Top5: 0.9629
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7693763919821827, 'ACC_ID': 0.6471046770601336, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7673; Top5: 0.9625
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7673534072900159, 'ACC_ID': 0.645958795562599, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7672; Top5: 0.9624
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7673, 'ACC_ID': 0.6451, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32432759 0.31180838 ... 0.17364097 0.17299098 0.15997249]
cifar10OOD cifar100 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.7200; Top-5 accuracy: 96.2400
{'Method': 'rosita_knn_txt', 'AUC': 0.8175387949999999, 'FPR95': 0.6612, 'ACC_ALL': 0.7673, 'ACC_ID': 0.6451, 'ACC_OOD': 0.7423, 'ACC_HM': 0.6902951275767623, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=7, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
clip_kp3_kn7

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354709418837675, 'ACC_ID': 0.6593186372745491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7482; Top5: 0.9445
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7492291880781089, 'ACC_ID': 0.6927029804727647, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7508; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7516688918558078, 'ACC_ID': 0.7049399198931909, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7565; Top5: 0.9562
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7576671694318753, 'ACC_ID': 0.7154348919054802, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7566; Top5: 0.9595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7574178027265437, 'ACC_ID': 0.714915797914996, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7514; Top5: 0.9591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7520798668885191, 'ACC_ID': 0.7031613976705491, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7529; Top5: 0.9595
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7535857716580608, 'ACC_ID': 0.7059667240390132, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7550; Top5: 0.9602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7555389594224545, 'ACC_ID': 0.7087378640776699, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7572; Top5: 0.9601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.757649667405765, 'ACC_ID': 0.7097560975609756, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7611; Top5: 0.9614
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7615615615615615, 'ACC_ID': 0.7127127127127127, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7616; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7620087336244541, 'ACC_ID': 0.7108806404657934, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7595; Top5: 0.9603
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7596795727636849, 'ACC_ID': 0.7067757009345794, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7599; Top5: 0.9602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7600554785020804, 'ACC_ID': 0.7070426876252119, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7604; Top5: 0.9607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.760531200913894, 'ACC_ID': 0.7072683135798943, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7613; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7614605543710021, 'ACC_ID': 0.706956289978678, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7626; Top5: 0.9612
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7627330747090477, 'ACC_ID': 0.7081716931547991, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7636; Top5: 0.9611
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.763674861780967, 'ACC_ID': 0.7101517468533114, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7629; Top5: 0.9610
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7629175946547884, 'ACC_ID': 0.7104677060133631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7608; Top5: 0.9608
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7608029582673006, 'ACC_ID': 0.7093502377179081, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7600; Top5: 0.9602
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7601, 'ACC_ID': 0.7091, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.32394776 0.30925822 ... 0.18761548 0.18759713 0.13385248]
cifar10OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 76.0000; Top-5 accuracy: 96.0200
{'Method': 'rosita_knn_txt', 'AUC': 0.9013758699999999, 'FPR95': 0.3522, 'ACC_ALL': 0.7601, 'ACC_ID': 0.7091, 'ACC_OOD': 0.7725, 'ACC_HM': 0.7394435070194384, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp3_kn7

Step 999: Top1: 0.5170; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5190380761523046, 'ACC_ID': 0.3346693386773547, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4995; Top5: 0.7533
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5005138746145941, 'ACC_ID': 0.3175745118191161, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4890; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4886515353805073, 'ACC_ID': 0.3137516688918558, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4935; Top5: 0.7450
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49321266968325794, 'ACC_ID': 0.31724484665661135, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4972; Top5: 0.7490
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4967923015236568, 'ACC_ID': 0.33079390537289494, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4968; Top5: 0.7511
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49650582362728785, 'ACC_ID': 0.3437603993344426, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4890; Top5: 0.7489
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4885255306942054, 'ACC_ID': 0.34509466437177283, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4824; Top5: 0.7433
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48220064724919093, 'ACC_ID': 0.3569828230022405, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4768; Top5: 0.7401
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.47649667405764967, 'ACC_ID': 0.36430155210643017, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4730; Top5: 0.7361
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4728728728728729, 'ACC_ID': 0.37157157157157156, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4720; Top5: 0.7345
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4717976710334789, 'ACC_ID': 0.37954876273653565, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4665; Top5: 0.7303
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46628838451268356, 'ACC_ID': 0.381675567423231, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4659; Top5: 0.7283
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46571120357528123, 'ACC_ID': 0.3874248728617661, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4657; Top5: 0.7272
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4656575753248608, 'ACC_ID': 0.3929744395259175, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4654; Top5: 0.7260
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4652185501066098, 'ACC_ID': 0.39738805970149255, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4646; Top5: 0.7253
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46452258791140033, 'ACC_ID': 0.4008259291703166, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4641; Top5: 0.7235
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46406305140571696, 'ACC_ID': 0.4041877426185155, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4630; Top5: 0.7228
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46291759465478843, 'ACC_ID': 0.4062360801781737, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4605; Top5: 0.7223
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4603275224511358, 'ACC_ID': 0.40655044902271525, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4610; Top5: 0.7231
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4611, 'ACC_ID': 0.4102, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35012877 0.2888186  ... 0.14424497 0.14422619 0.10782812]
cifar100OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 46.1100; Top-5 accuracy: 72.3100
{'Method': 'rosita_knn_txt', 'AUC': 0.955453265, 'FPR95': 0.2433, 'ACC_ALL': 0.4611, 'ACC_ID': 0.4102, 'ACC_OOD': 0.9814, 'ACC_HM': 0.5785718309859155, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp3_kn7

Step 999: Top1: 0.5170; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.342685370741483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5036; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5035971223021583, 'ACC_ID': 0.3329907502569373, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4957; Top5: 0.7448
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49666221628838453, 'ACC_ID': 0.3437917222963952, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5025; Top5: 0.7480
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5032679738562091, 'ACC_ID': 0.3469079939668175, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5068; Top5: 0.7530
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5076182838813151, 'ACC_ID': 0.351242983159583, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5075; Top5: 0.7557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.508153078202995, 'ACC_ID': 0.3590682196339434, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4996; Top5: 0.7463
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5, 'ACC_ID': 0.3542742398164085, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4725; Top5: 0.7142
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4729897933781429, 'ACC_ID': 0.33507592730893704, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4562; Top5: 0.6933
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4565410199556541, 'ACC_ID': 0.32749445676274946, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4451; Top5: 0.6836
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4456456456456456, 'ACC_ID': 0.3229229229229229, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4429; Top5: 0.6821
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4432314410480349, 'ACC_ID': 0.32787481804949054, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4367; Top5: 0.6804
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4370827770360481, 'ACC_ID': 0.3274365821094793, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4356; Top5: 0.6800
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.43581445523193096, 'ACC_ID': 0.33086762212975807, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4330; Top5: 0.6801
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4335284877909467, 'ACC_ID': 0.330858203627017, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4326; Top5: 0.6786
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4329690831556503, 'ACC_ID': 0.3334221748400853, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4295; Top5: 0.6775
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42998373169816045, 'ACC_ID': 0.332248779877362, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4249; Top5: 0.6755
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42536172215033524, 'ACC_ID': 0.3305493471356311, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4213; Top5: 0.6726
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.42160356347438754, 'ACC_ID': 0.3301781737193764, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4183; Top5: 0.6705
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.418594823032224, 'ACC_ID': 0.3299524564183835, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4155; Top5: 0.6692
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4158, 'ACC_ID': 0.3301, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35189402 0.30464715 ... 0.1788395  0.17863275 0.16276476]
cifar100OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 41.5500; Top-5 accuracy: 66.9200
{'Method': 'rosita_knn_txt', 'AUC': 0.83509093, 'FPR95': 0.7174, 'ACC_ALL': 0.4158, 'ACC_ID': 0.3301, 'ACC_OOD': 0.9049, 'ACC_HM': 0.48373682591093115, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
clip_kp3_kn7

Step 999: Top1: 0.5170; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5067; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5066803699897225, 'ACC_ID': 0.35868448098663924, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4990; Top5: 0.7475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4979973297730307, 'ACC_ID': 0.36315086782376504, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5080; Top5: 0.7505
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5077928607340372, 'ACC_ID': 0.3720462543991956, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5128; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51242983159583, 'ACC_ID': 0.37169206094627105, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5148; Top5: 0.7601
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5144758735440932, 'ACC_ID': 0.36905158069883526, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5139; Top5: 0.7598
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5131956397016638, 'ACC_ID': 0.37521514629948366, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5138; Top5: 0.7578
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5133183968135424, 'ACC_ID': 0.3741598207617625, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5163; Top5: 0.7576
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5155210643015521, 'ACC_ID': 0.3764966740576497, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5120; Top5: 0.7569
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5115115115115115, 'ACC_ID': 0.3755755755755756, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5140; Top5: 0.7586
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5134643377001455, 'ACC_ID': 0.37827510917030566, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5076; Top5: 0.7561
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5070093457943925, 'ACC_ID': 0.37383177570093457, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5106; Top5: 0.7571
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5100940052396363, 'ACC_ID': 0.37787024194791186, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5081; Top5: 0.7589
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.507782378980437, 'ACC_ID': 0.37626731400828217, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5073; Top5: 0.7591
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5070628997867804, 'ACC_ID': 0.37673240938166314, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5054; Top5: 0.7586
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5051933425103241, 'ACC_ID': 0.37454636466024277, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5047; Top5: 0.7584
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.504528878955417, 'ACC_ID': 0.37395600517586164, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5037; Top5: 0.7582
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5034521158129176, 'ACC_ID': 0.37316258351893095, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5022; Top5: 0.7586
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5019545694664553, 'ACC_ID': 0.3712625462229266, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5031; Top5: 0.7607
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5027, 'ACC_ID': 0.3723, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.35016498 0.32906249 ... 0.18375671 0.18239063 0.17144211]
cifar100OOD cifar10 rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 50.3000; Top-5 accuracy: 76.0600
{'Method': 'rosita_knn_txt', 'AUC': 0.703170055, 'FPR95': 0.8616, 'ACC_ALL': 0.5027, 'ACC_ID': 0.3723, 'ACC_OOD': 0.6979, 'ACC_HM': 0.4855693702111755, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=7, k_p=3, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
clip_kp3_kn7

Step 999: Top1: 0.5150; Top5: 0.7535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150300601202404, 'ACC_ID': 0.3366733466933868, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5057; Top5: 0.7575
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5046248715313464, 'ACC_ID': 0.35251798561151076, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4970; Top5: 0.7455
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4959946595460614, 'ACC_ID': 0.3644859813084112, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5070; Top5: 0.7480
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5062845651080945, 'ACC_ID': 0.3770739064856712, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5116; Top5: 0.7518
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5116279069767442, 'ACC_ID': 0.3785084202085004, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5135; Top5: 0.7567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.513477537437604, 'ACC_ID': 0.3790349417637271, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5122; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5117613310384395, 'ACC_ID': 0.3832472748135399, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5101; Top5: 0.7548
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5098332088623351, 'ACC_ID': 0.3843664426188698, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5119; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5113082039911309, 'ACC_ID': 0.38869179600886916, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5094; Top5: 0.7545
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5091091091091091, 'ACC_ID': 0.3893893893893894, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5115; Top5: 0.7540
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5107350800582242, 'ACC_ID': 0.39173944687045126, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5049; Top5: 0.7508
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5041722296395194, 'ACC_ID': 0.385347129506008, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5076; Top5: 0.7528
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5068577592849437, 'ACC_ID': 0.38819540761288335, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5053; Top5: 0.7546
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5047836641439383, 'ACC_ID': 0.3872626017421105, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5048; Top5: 0.7557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5042643923240938, 'ACC_ID': 0.38699360341151384, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5028; Top5: 0.7554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5023151044925541, 'ACC_ID': 0.3844324865473658, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5020; Top5: 0.7552
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5015880484648865, 'ACC_ID': 0.3827784966474532, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5014; Top5: 0.7555
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5008908685968819, 'ACC_ID': 0.38296213808463253, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4997; Top5: 0.7550
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49920760697305866, 'ACC_ID': 0.3815108293713682, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4995; Top5: 0.7566
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4991, 'ACC_ID': 0.3824, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.34957495 0.34249184 ... 0.18205446 0.18086214 0.17047079]
cifar100OOD Tiny rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 49.9500; Top-5 accuracy: 75.6600
{'Method': 'rosita_knn_txt', 'AUC': 0.7074055199999999, 'FPR95': 0.7927, 'ACC_ALL': 0.4991, 'ACC_ID': 0.3824, 'ACC_OOD': 0.6728, 'ACC_HM': 0.48763972706595915, 'kp': 3, 'kn': 7, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




3 10
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
4 1
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
4 3
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
4 5
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
4 7
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
4 10
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
5 1
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
5 3
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
5 5
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
5 7
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
5 10
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
Traceback (most recent call last):
  File "tta_ood.py", line 13, in <module>
    from utils.data_utils import prepare_ood_test_data, AugMixAugmenter
  File "/home/manogna/TTA/clip-owtta/utils/data_utils.py", line 304
    ID_OOD_loader = torch.utils.data.DataLoader(teset, batch_size=args.batch_size, shuffle=True)
    ^
IndentationError: expected an indented block
