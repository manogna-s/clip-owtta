5 3
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=5, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
clip_kp5_kn3

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.5971943887775552, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7513; Top5: 0.9435
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7512846865364851, 'ACC_ID': 0.6094552929085303, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7542; Top5: 0.9506
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7543391188251002, 'ACC_ID': 0.6061415220293725, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7586; Top5: 0.9532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7586726998491704, 'ACC_ID': 0.6239316239316239, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7634; Top5: 0.9551
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7634322373696872, 'ACC_ID': 0.6399358460304732, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7534; Top5: 0.9554
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7537437603993344, 'ACC_ID': 0.6389351081530782, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7555; Top5: 0.9535
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7558806655192197, 'ACC_ID': 0.6462994836488812, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7506; Top5: 0.9532
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7508090614886731, 'ACC_ID': 0.6457555389594225, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7498; Top5: 0.9539
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7501108647450111, 'ACC_ID': 0.6483370288248337, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7497; Top5: 0.9557
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7499499499499499, 'ACC_ID': 0.6542542542542542, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7480; Top5: 0.9556
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7481804949053857, 'ACC_ID': 0.6573871906841339, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7450; Top5: 0.9558
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7451602136181575, 'ACC_ID': 0.6578771695594126, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7454; Top5: 0.9553
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7454153182308522, 'ACC_ID': 0.6592695330559408, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7439; Top5: 0.9560
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7441096672854491, 'ACC_ID': 0.6601456518634871, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7455; Top5: 0.9560
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7456023454157783, 'ACC_ID': 0.6628464818763327, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7459; Top5: 0.9563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7460893505193342, 'ACC_ID': 0.6647478413214867, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7445; Top5: 0.9569
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7445006469827079, 'ACC_ID': 0.6658040230561111, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7420; Top5: 0.9569
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7419821826280624, 'ACC_ID': 0.6664810690423163, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7395; Top5: 0.9568
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.739566825145272, 'ACC_ID': 0.6665610142630745, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7372; Top5: 0.9565
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7373, 'ACC_ID': 0.6661, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.33545965 0.31542641 ... 0.17898706 0.16829751 0.15252334]
cifar10OOD MNIST rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 73.7200; Top-5 accuracy: 95.6500
{'Method': 'rosita_knn_txt', 'AUC': 0.96571489, 'FPR95': 0.2092, 'ACC_ALL': 0.7373, 'ACC_ID': 0.6661, 'ACC_OOD': 0.982, 'ACC_HM': 0.7937748923002245, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=3, k_p=5, level=5, loss_pl=1, loss_simclr=1, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_knn', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
clip_kp5_kn3

Step 999: Top1: 0.7335; Top5: 0.9459
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.6012024048096193, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7482; Top5: 0.9404
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7482014388489209, 'ACC_ID': 0.6269270298047277, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7482; Top5: 0.9499
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7489986648865153, 'ACC_ID': 0.6335113484646195, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7535; Top5: 0.9547
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7541478129713424, 'ACC_ID': 0.6425339366515838, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7586; Top5: 0.9567
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7590216519647153, 'ACC_ID': 0.6547714514835605, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7531; Top5: 0.9564
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7534109816971714, 'ACC_ID': 0.6519134775374376, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7524; Top5: 0.9572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7530120481927711, 'ACC_ID': 0.6534710269650029, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7553; Top5: 0.9577
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7560368434154842, 'ACC_ID': 0.6544685088374409, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7558; Top5: 0.9572
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7565410199556541, 'ACC_ID': 0.6569844789356984, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7555; Top5: 0.9563
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.755955955955956, 'ACC_ID': 0.6572572572572573, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7505; Top5: 0.9540
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7509097525473072, 'ACC_ID': 0.6544759825327511, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7461; Top5: 0.9519
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7464953271028038, 'ACC_ID': 0.6530373831775701, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7455; Top5: 0.9502
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7458776390815226, 'ACC_ID': 0.6551086453999075, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7432; Top5: 0.9496
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7435384835070684, 'ACC_ID': 0.6541482221904897, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7420; Top5: 0.9487
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7422707889125799, 'ACC_ID': 0.6556503198294243, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7406; Top5: 0.9483
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7408334376173195, 'ACC_ID': 0.6563634088349393, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7404; Top5: 0.9482
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7405011175155864, 'ACC_ID': 0.6579225973414893, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7388; Top5: 0.9472
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7389755011135858, 'ACC_ID': 0.6590200445434299, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7356; Top5: 0.9475
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7357633386159536, 'ACC_ID': 0.6582144743792921, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7333; Top5: 0.9477
{'Method': 'rosita_knn_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7335, 'ACC_ID': 0.6582, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}
[       inf 0.3282586  0.29153016 ... 0.18247157 0.18246305 0.15626591]
cifar10OOD SVHN rosita_knn_txt maxlogit


Final metrics: Top-1 accuracy: 73.3300; Top-5 accuracy: 94.7700
{'Method': 'rosita_knn_txt', 'AUC': 0.95066331, 'FPR95': 0.2838, 'ACC_ALL': 0.7335, 'ACC_ID': 0.6582, 'ACC_OOD': 0.9542, 'ACC_HM': 0.7790305631356983, 'kp': 5, 'kn': 3, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 1, 'OOD Detector': 'maxlogit'}




