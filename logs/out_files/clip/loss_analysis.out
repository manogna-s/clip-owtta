0 0
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='VisdaOOD', k_n=10, k_p=3, level=5, loss_pl=0, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_loss', workers=4)


10000 10000 20000

Step 999: Top1: 0.8737; Top5: 0.9840
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.87374749498998, 'ACC_ID': 0.6733466933867736, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8746; Top5: 0.9887
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8746145940390545, 'ACC_ID': 0.6690647482014388, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.8717; Top5: 0.9913
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8711615487316422, 'ACC_ID': 0.6602136181575434, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.8712; Top5: 0.9920
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8702865761689291, 'ACC_ID': 0.649069884364002, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8677; Top5: 0.9916
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8672814755412991, 'ACC_ID': 0.6479550922213312, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8656; Top5: 0.9913
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8652246256239601, 'ACC_ID': 0.6495840266222962, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.8657; Top5: 0.9914
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8654618473895582, 'ACC_ID': 0.6497418244406197, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.8671; Top5: 0.9915
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8668160318645756, 'ACC_ID': 0.6512322628827483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.8665; Top5: 0.9905
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8662971175166297, 'ACC_ID': 0.6527716186252772, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.8700; Top5: 0.9910
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8696696696696696, 'ACC_ID': 0.6538538538538539, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.8706; Top5: 0.9909
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8704512372634643, 'ACC_ID': 0.6544759825327511, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.8693; Top5: 0.9910
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8691588785046729, 'ACC_ID': 0.6522029372496663, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.8678; Top5: 0.9911
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8676221297580521, 'ACC_ID': 0.64986900909231, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.8662; Top5: 0.9899
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8660574039697273, 'ACC_ID': 0.6484363844066828, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.8667; Top5: 0.9895
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8663379530916845, 'ACC_ID': 0.6461886993603412, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.8652; Top5: 0.9895
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8648479539481917, 'ACC_ID': 0.6452258791140033, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.8641; Top5: 0.9893
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.863780731678626, 'ACC_ID': 0.6423950123514881, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.8644; Top5: 0.9892
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8640311804008909, 'ACC_ID': 0.6430957683741648, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.8639; Top5: 0.9894
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8634970945589012, 'ACC_ID': 0.6432118330692024, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.8631; Top5: 0.9889
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8628, 'ACC_ID': 0.6446, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.33722585 0.28926086 ... 0.2085001  0.20848513 0.16661465]
VisdaOOD MNIST rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 86.3100; Top-5 accuracy: 98.8900
{'Method': 'rosita_loss_txt', 'AUC': 0.9308336500000001, 'FPR95': 0.7442, 'ACC_ALL': 0.8628, 'ACC_ID': 0.6446, 'ACC_OOD': 0.9976, 'ACC_HM': 0.7831603458774815, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='VisdaOOD', k_n=10, k_p=3, level=5, loss_pl=0, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_loss', workers=4)


Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/train_32x32.mat
10000 10000 20000

Step 999: Top1: 0.8737; Top5: 0.9840
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.87374749498998, 'ACC_ID': 0.6733466933867736, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8746; Top5: 0.9887
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8746145940390545, 'ACC_ID': 0.6690647482014388, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.8717; Top5: 0.9913
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8711615487316422, 'ACC_ID': 0.6602136181575434, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.8712; Top5: 0.9920
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8702865761689291, 'ACC_ID': 0.649069884364002, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8677; Top5: 0.9916
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8672814755412991, 'ACC_ID': 0.6479550922213312, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8656; Top5: 0.9913
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8652246256239601, 'ACC_ID': 0.6495840266222962, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.8657; Top5: 0.9914
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8654618473895582, 'ACC_ID': 0.6497418244406197, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.8671; Top5: 0.9915
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8668160318645756, 'ACC_ID': 0.6512322628827483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.8665; Top5: 0.9905
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8662971175166297, 'ACC_ID': 0.6527716186252772, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.8700; Top5: 0.9910
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8696696696696696, 'ACC_ID': 0.6538538538538539, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.8706; Top5: 0.9909
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8704512372634643, 'ACC_ID': 0.6544759825327511, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.8693; Top5: 0.9910
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8691588785046729, 'ACC_ID': 0.6520360480640854, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.8678; Top5: 0.9911
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8676221297580521, 'ACC_ID': 0.6497149021420866, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.8662; Top5: 0.9899
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8660574039697273, 'ACC_ID': 0.6482935884620876, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.8667; Top5: 0.9895
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8663379530916845, 'ACC_ID': 0.6460554371002132, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.8652; Top5: 0.9895
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8648479539481917, 'ACC_ID': 0.645100738330622, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.8641; Top5: 0.9893
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.863780731678626, 'ACC_ID': 0.6422773791318669, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.8644; Top5: 0.9892
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8640311804008909, 'ACC_ID': 0.6429844097995545, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.8639; Top5: 0.9894
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8634970945589012, 'ACC_ID': 0.6431061806656101, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.8631; Top5: 0.9889
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8628, 'ACC_ID': 0.6445, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.33722585 0.28926086 ... 0.18697828 0.18668517 0.16661465]
VisdaOOD SVHN rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 86.3100; Top-5 accuracy: 98.8900
{'Method': 'rosita_loss_txt', 'AUC': 0.906209165, 'FPR95': 0.6472, 'ACC_ALL': 0.8628, 'ACC_ID': 0.6445, 'ACC_OOD': 0.9599, 'ACC_HM': 0.7711986412365992, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='ImagenetROOD', k_n=10, k_p=3, level=5, loss_pl=0, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_loss', workers=4)


len 10000
dict_values(['goldfish', 'great white shark', 'hammerhead shark', 'stingray', 'hen', 'ostrich', 'goldfinch', 'junco', 'bald eagle', 'vulture', 'smooth newt', 'axolotl', 'tree frog', 'green iguana', 'chameleon', 'Indian cobra', 'scorpion', 'tarantula', 'centipede', 'peafowl', 'lorikeet', 'hummingbird', 'toucan', 'duck', 'goose', 'black swan', 'koala', 'jellyfish', 'snail', 'American lobster', 'hermit crab', 'flamingo', 'great egret', 'pelican', 'king penguin', 'grey whale', 'killer whale', 'sea lion', 'Chihuahua', 'Shih Tzu', 'Afghan Hound', 'Basset Hound', 'Beagle', 'Bloodhound', 'Italian Greyhound', 'Whippet', 'Weimaraner', 'Yorkshire Terrier', 'Boston Terrier', 'Scottish Terrier', 'West Highland White Terrier', 'Golden Retriever', 'Labrador Retriever', 'Cocker Spaniel', 'collie', 'Border Collie', 'Rottweiler', 'German Shepherd Dog', 'Boxer', 'French Bulldog', 'St. Bernard', 'Siberian Husky', 'Dalmatian', 'pug', 'Pomeranian', 'Chow Chow', 'Pembroke Welsh Corgi', 'Toy Poodle', 'Standard Poodle', 'grey wolf', 'hyena', 'red fox', 'tabby cat', 'leopard', 'snow leopard', 'lion', 'tiger', 'cheetah', 'polar bear', 'meerkat', 'ladybug', 'fly', 'bee', 'ant', 'grasshopper', 'cockroach', 'praying mantis', 'dragonfly', 'monarch butterfly', 'starfish', 'cottontail rabbit', 'porcupine', 'fox squirrel', 'beaver', 'guinea pig', 'zebra', 'pig', 'hippopotamus', 'bison', 'gazelle', 'llama', 'skunk', 'badger', 'orangutan', 'gorilla', 'chimpanzee', 'gibbon', 'baboon', 'giant panda', 'eel', 'clownfish', 'pufferfish', 'accordion', 'ambulance', 'assault rifle', 'backpack', 'barn', 'wheelbarrow', 'basketball', 'bathtub', 'lighthouse', 'beer glass', 'binoculars', 'birdhouse', 'bow tie', 'broom', 'bucket', 'cauldron', 'candle', 'cannon', 'canoe', 'carousel', 'castle', 'mobile phone', 'cowboy hat', 'electric guitar', 'fire truck', 'flute', 'gas mask or respirator', 'grand piano', 'guillotine', 'hammer', 'harmonica', 'harp', 'hatchet', 'jeep', 'joystick', 'lab coat', 'lawn mower', 'lipstick', 'mailbox', 'missile', 'mitten', 'parachute', 'pickup truck', 'pirate ship', 'revolver', 'rugby ball', 'sandal', 'saxophone', 'school bus', 'schooner', 'shield', 'soccer ball', 'space shuttle', 'spider web', 'steam locomotive', 'scarf', 'submarine', 'tank', 'tennis ball', 'tractor', 'trombone', 'vase', 'violin', 'military aircraft', 'wine bottle', 'ice cream', 'bagel', 'pretzel', 'cheeseburger', 'hot dog', 'cabbage', 'broccoli', 'cucumber', 'bell pepper', 'mushroom', 'Granny Smith apple', 'strawberry', 'lemon', 'pineapple', 'banana', 'pomegranate', 'pizza', 'burrito', 'espresso', 'volcano', 'baseball player', 'scuba diver', 'acorn'])
len 10000
10000 10000 20000

Step 999: Top1: 0.7375; Top5: 0.9118
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7374749498997996, 'ACC_ID': 0.533066132264529, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7348; Top5: 0.9054
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7348406988694759, 'ACC_ID': 0.5292908530318602, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7328; Top5: 0.9071
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.732977303070761, 'ACC_ID': 0.5340453938584779, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7228; Top5: 0.9024
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7229763700351935, 'ACC_ID': 0.5173453996983409, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7265; Top5: 0.9054
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.726944667201283, 'ACC_ID': 0.5184442662389736, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7331; Top5: 0.9055
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334442595673877, 'ACC_ID': 0.5148086522462563, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7352; Top5: 0.9070
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7355134825014343, 'ACC_ID': 0.5154905335628227, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7339; Top5: 0.9049
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7341299477221808, 'ACC_ID': 0.516554642768235, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7383; Top5: 0.9060
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.738580931263858, 'ACC_ID': 0.517960088691796, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7365; Top5: 0.9071
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7367367367367368, 'ACC_ID': 0.5197197197197198, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7353; Top5: 0.9083
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354439592430859, 'ACC_ID': 0.5214701601164483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7353; Top5: 0.9109
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354806408544726, 'ACC_ID': 0.5223631508678238, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7378; Top5: 0.9121
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7378640776699029, 'ACC_ID': 0.5239636307597473, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7399; Top5: 0.9129
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7399685848921891, 'ACC_ID': 0.5243467085534771, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7391; Top5: 0.9143
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7392057569296375, 'ACC_ID': 0.5211886993603412, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7387; Top5: 0.9139
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7387060442998373, 'ACC_ID': 0.5218370667000375, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7382; Top5: 0.9131
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7382660863427832, 'ACC_ID': 0.5215856958004941, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7385; Top5: 0.9119
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7385300668151448, 'ACC_ID': 0.5210467706013363, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7398; Top5: 0.9123
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7396724775488642, 'ACC_ID': 0.5220285261489699, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7383; Top5: 0.9119
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7383, 'ACC_ID': 0.5215, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.33069381 0.25705737 ... 0.13043916 0.1303722  0.08850209]
ImagenetROOD MNIST rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 73.8300; Top-5 accuracy: 91.1900
{'Method': 'rosita_loss_txt', 'AUC': 0.878260115, 'FPR95': 0.9863, 'ACC_ALL': 0.7383, 'ACC_ID': 0.5215, 'ACC_OOD': 0.9958, 'ACC_HM': 0.6845181572530151, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='ImagenetROOD', k_n=10, k_p=3, level=5, loss_pl=0, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_loss', workers=4)


len 10000
dict_values(['goldfish', 'great white shark', 'hammerhead shark', 'stingray', 'hen', 'ostrich', 'goldfinch', 'junco', 'bald eagle', 'vulture', 'smooth newt', 'axolotl', 'tree frog', 'green iguana', 'chameleon', 'Indian cobra', 'scorpion', 'tarantula', 'centipede', 'peafowl', 'lorikeet', 'hummingbird', 'toucan', 'duck', 'goose', 'black swan', 'koala', 'jellyfish', 'snail', 'American lobster', 'hermit crab', 'flamingo', 'great egret', 'pelican', 'king penguin', 'grey whale', 'killer whale', 'sea lion', 'Chihuahua', 'Shih Tzu', 'Afghan Hound', 'Basset Hound', 'Beagle', 'Bloodhound', 'Italian Greyhound', 'Whippet', 'Weimaraner', 'Yorkshire Terrier', 'Boston Terrier', 'Scottish Terrier', 'West Highland White Terrier', 'Golden Retriever', 'Labrador Retriever', 'Cocker Spaniel', 'collie', 'Border Collie', 'Rottweiler', 'German Shepherd Dog', 'Boxer', 'French Bulldog', 'St. Bernard', 'Siberian Husky', 'Dalmatian', 'pug', 'Pomeranian', 'Chow Chow', 'Pembroke Welsh Corgi', 'Toy Poodle', 'Standard Poodle', 'grey wolf', 'hyena', 'red fox', 'tabby cat', 'leopard', 'snow leopard', 'lion', 'tiger', 'cheetah', 'polar bear', 'meerkat', 'ladybug', 'fly', 'bee', 'ant', 'grasshopper', 'cockroach', 'praying mantis', 'dragonfly', 'monarch butterfly', 'starfish', 'cottontail rabbit', 'porcupine', 'fox squirrel', 'beaver', 'guinea pig', 'zebra', 'pig', 'hippopotamus', 'bison', 'gazelle', 'llama', 'skunk', 'badger', 'orangutan', 'gorilla', 'chimpanzee', 'gibbon', 'baboon', 'giant panda', 'eel', 'clownfish', 'pufferfish', 'accordion', 'ambulance', 'assault rifle', 'backpack', 'barn', 'wheelbarrow', 'basketball', 'bathtub', 'lighthouse', 'beer glass', 'binoculars', 'birdhouse', 'bow tie', 'broom', 'bucket', 'cauldron', 'candle', 'cannon', 'canoe', 'carousel', 'castle', 'mobile phone', 'cowboy hat', 'electric guitar', 'fire truck', 'flute', 'gas mask or respirator', 'grand piano', 'guillotine', 'hammer', 'harmonica', 'harp', 'hatchet', 'jeep', 'joystick', 'lab coat', 'lawn mower', 'lipstick', 'mailbox', 'missile', 'mitten', 'parachute', 'pickup truck', 'pirate ship', 'revolver', 'rugby ball', 'sandal', 'saxophone', 'school bus', 'schooner', 'shield', 'soccer ball', 'space shuttle', 'spider web', 'steam locomotive', 'scarf', 'submarine', 'tank', 'tennis ball', 'tractor', 'trombone', 'vase', 'violin', 'military aircraft', 'wine bottle', 'ice cream', 'bagel', 'pretzel', 'cheeseburger', 'hot dog', 'cabbage', 'broccoli', 'cucumber', 'bell pepper', 'mushroom', 'Granny Smith apple', 'strawberry', 'lemon', 'pineapple', 'banana', 'pomegranate', 'pizza', 'burrito', 'espresso', 'volcano', 'baseball player', 'scuba diver', 'acorn'])
len 10000
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/train_32x32.mat
10000 10000 20000

Step 999: Top1: 0.7375; Top5: 0.9118
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7374749498997996, 'ACC_ID': 0.533066132264529, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7348; Top5: 0.9054
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7348406988694759, 'ACC_ID': 0.5323741007194245, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7328; Top5: 0.9071
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.732977303070761, 'ACC_ID': 0.5367156208277704, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7228; Top5: 0.9024
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7229763700351935, 'ACC_ID': 0.5258924082453494, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7265; Top5: 0.9054
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.726944667201283, 'ACC_ID': 0.5296712109061749, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7331; Top5: 0.9055
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334442595673877, 'ACC_ID': 0.5237936772046589, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7352; Top5: 0.9070
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7355134825014343, 'ACC_ID': 0.52122776821572, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7339; Top5: 0.9049
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7341299477221808, 'ACC_ID': 0.5252676126462534, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7383; Top5: 0.9060
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.738580931263858, 'ACC_ID': 0.5286031042128603, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7365; Top5: 0.9071
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7367367367367368, 'ACC_ID': 0.5293293293293293, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7353; Top5: 0.9083
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354439592430859, 'ACC_ID': 0.5302037845705968, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7353; Top5: 0.9109
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7354806408544726, 'ACC_ID': 0.5312082777036048, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7378; Top5: 0.9121
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7378640776699029, 'ACC_ID': 0.5332100477731546, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7399; Top5: 0.9129
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7399685848921891, 'ACC_ID': 0.5329144652291875, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7391; Top5: 0.9143
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7392057569296375, 'ACC_ID': 0.5295842217484008, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7387; Top5: 0.9139
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7387060442998373, 'ACC_ID': 0.5299712176198224, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7382; Top5: 0.9131
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7382660863427832, 'ACC_ID': 0.5295847547347371, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7385; Top5: 0.9119
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7385300668151448, 'ACC_ID': 0.5302895322939867, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7398; Top5: 0.9123
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7396724775488642, 'ACC_ID': 0.530797675647121, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7383; Top5: 0.9119
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7383, 'ACC_ID': 0.5301, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.33069381 0.25705737 ... 0.12731469 0.12716648 0.08850209]
ImagenetROOD SVHN rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 73.8300; Top-5 accuracy: 91.1900
{'Method': 'rosita_loss_txt', 'AUC': 0.87166739, 'FPR95': 0.8923, 'ACC_ALL': 0.7383, 'ACC_ID': 0.5301, 'ACC_OOD': 0.9843, 'ACC_HM': 0.6890879952456418, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=3, level=5, loss_pl=0, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified

Step 999: Top1: 0.7295; Top5: 0.9439
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7294589178356713, 'ACC_ID': 0.5811623246492986, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7328; Top5: 0.9373
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7327852004110997, 'ACC_ID': 0.593011305241521, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7281; Top5: 0.9432
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7283044058744993, 'ACC_ID': 0.5887850467289719, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7309; Top5: 0.9462
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7310206133735545, 'ACC_ID': 0.6013071895424836, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7362; Top5: 0.9451
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7361668003207699, 'ACC_ID': 0.603047313552526, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7251; Top5: 0.9444
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7247920133111481, 'ACC_ID': 0.5933444259567388, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7254; Top5: 0.9409
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7251864601262191, 'ACC_ID': 0.5929432013769363, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7277; Top5: 0.9405
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7274085138162808, 'ACC_ID': 0.5954692556634305, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7301; Top5: 0.9410
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7299334811529934, 'ACC_ID': 0.5968957871396896, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7329; Top5: 0.9421
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7329329329329329, 'ACC_ID': 0.6004004004004004, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7349; Top5: 0.9436
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7348981077147017, 'ACC_ID': 0.6013464337700145, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7324; Top5: 0.9432
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7324766355140186, 'ACC_ID': 0.6021361815754339, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7340; Top5: 0.9442
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7338572969640931, 'ACC_ID': 0.6027122823239328, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7356; Top5: 0.9446
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7356847065543338, 'ACC_ID': 0.6051692131943452, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7376; Top5: 0.9460
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7376066098081023, 'ACC_ID': 0.6059434968017058, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7369; Top5: 0.9466
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7369540733324991, 'ACC_ID': 0.606432236265799, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7389; Top5: 0.9475
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7389718856605105, 'ACC_ID': 0.6082813786613339, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7374; Top5: 0.9471
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7376391982182628, 'ACC_ID': 0.6076837416481069, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7375; Top5: 0.9480
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7376650818806127, 'ACC_ID': 0.6075013206550449, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7383; Top5: 0.9472
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7385, 'ACC_ID': 0.6075, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.30803016 0.26928973 ... 0.20561966 0.20558354 0.18196017]
cifar10OOD MNIST rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 73.8300; Top-5 accuracy: 94.7200
{'Method': 'rosita_loss_txt', 'AUC': 0.910495565, 'FPR95': 0.8881, 'ACC_ALL': 0.7385, 'ACC_ID': 0.6075, 'ACC_OOD': 0.9973, 'ACC_HM': 0.7550595089730808, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=3, level=5, loss_pl=0, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat

Step 999: Top1: 0.7295; Top5: 0.9439
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7294589178356713, 'ACC_ID': 0.5811623246492986, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7328; Top5: 0.9373
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7327852004110997, 'ACC_ID': 0.593011305241521, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7281; Top5: 0.9432
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7283044058744993, 'ACC_ID': 0.5887850467289719, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7309; Top5: 0.9462
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7310206133735545, 'ACC_ID': 0.6013071895424836, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7362; Top5: 0.9451
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7361668003207699, 'ACC_ID': 0.603047313552526, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7251; Top5: 0.9444
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7247920133111481, 'ACC_ID': 0.5933444259567388, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7254; Top5: 0.9409
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7251864601262191, 'ACC_ID': 0.5929432013769363, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7277; Top5: 0.9405
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7274085138162808, 'ACC_ID': 0.5954692556634305, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7301; Top5: 0.9410
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7299334811529934, 'ACC_ID': 0.5968957871396896, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7329; Top5: 0.9421
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7329329329329329, 'ACC_ID': 0.6004004004004004, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7349; Top5: 0.9436
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7348981077147017, 'ACC_ID': 0.6013464337700145, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7324; Top5: 0.9432
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7324766355140186, 'ACC_ID': 0.6021361815754339, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7340; Top5: 0.9442
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7338572969640931, 'ACC_ID': 0.6027122823239328, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7356; Top5: 0.9446
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7356847065543338, 'ACC_ID': 0.6051692131943452, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7376; Top5: 0.9460
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7376066098081023, 'ACC_ID': 0.6059434968017058, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7369; Top5: 0.9466
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7369540733324991, 'ACC_ID': 0.606432236265799, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7389; Top5: 0.9475
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7389718856605105, 'ACC_ID': 0.6082813786613339, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7374; Top5: 0.9471
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7376391982182628, 'ACC_ID': 0.6076837416481069, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7375; Top5: 0.9480
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7376650818806127, 'ACC_ID': 0.6075013206550449, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7383; Top5: 0.9472
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7385, 'ACC_ID': 0.6075, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.30803016 0.27778912 ... 0.18236437 0.18196017 0.18041292]
cifar10OOD SVHN rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 73.8300; Top-5 accuracy: 94.7200
{'Method': 'rosita_loss_txt', 'AUC': 0.903492825, 'FPR95': 0.626, 'ACC_ALL': 0.7385, 'ACC_ID': 0.6075, 'ACC_OOD': 0.9556, 'ACC_HM': 0.7427893288977033, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=3, level=5, loss_pl=0, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified

Step 999: Top1: 0.7295; Top5: 0.9439
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7294589178356713, 'ACC_ID': 0.5791583166332666, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7328; Top5: 0.9373
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7327852004110997, 'ACC_ID': 0.591983556012333, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7281; Top5: 0.9432
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7283044058744993, 'ACC_ID': 0.5881174899866488, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7309; Top5: 0.9462
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7310206133735545, 'ACC_ID': 0.6008044243338361, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7362; Top5: 0.9451
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7361668003207699, 'ACC_ID': 0.6026463512429832, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7251; Top5: 0.9444
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7247920133111481, 'ACC_ID': 0.5930116472545757, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7254; Top5: 0.9409
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7251864601262191, 'ACC_ID': 0.5926563396442914, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7277; Top5: 0.9405
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7274085138162808, 'ACC_ID': 0.5952203136669156, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7301; Top5: 0.9410
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7299334811529934, 'ACC_ID': 0.5966740576496674, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7329; Top5: 0.9421
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7329329329329329, 'ACC_ID': 0.6002002002002002, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7349; Top5: 0.9436
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7348981077147017, 'ACC_ID': 0.6011644832605532, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7324; Top5: 0.9432
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7324766355140186, 'ACC_ID': 0.6019692923898531, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7340; Top5: 0.9442
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7338572969640931, 'ACC_ID': 0.6025581753737094, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7356; Top5: 0.9446
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7356847065543338, 'ACC_ID': 0.6050264172497501, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7376; Top5: 0.9460
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7376066098081023, 'ACC_ID': 0.6058102345415778, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7369; Top5: 0.9466
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7369540733324991, 'ACC_ID': 0.6063070954824177, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7389; Top5: 0.9475
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7389718856605105, 'ACC_ID': 0.6081637454417127, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7374; Top5: 0.9471
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7376391982182628, 'ACC_ID': 0.6075723830734967, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7375; Top5: 0.9480
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7376650818806127, 'ACC_ID': 0.6073956682514527, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7383; Top5: 0.9472
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7385, 'ACC_ID': 0.6074, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.30803016 0.29731315 ... 0.18199298 0.18196017 0.15949896]
cifar10OOD cifar100 rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 73.8300; Top-5 accuracy: 94.7200
{'Method': 'rosita_loss_txt', 'AUC': 0.825651135, 'FPR95': 0.6806, 'ACC_ALL': 0.7385, 'ACC_ID': 0.6074, 'ACC_OOD': 0.7961, 'ACC_HM': 0.6890646811542572, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=3, level=5, loss_pl=0, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000

Step 999: Top1: 0.7295; Top5: 0.9439
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7294589178356713, 'ACC_ID': 0.6492985971943888, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7328; Top5: 0.9373
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7327852004110997, 'ACC_ID': 0.6618705035971223, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7281; Top5: 0.9432
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7283044058744993, 'ACC_ID': 0.657543391188251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7309; Top5: 0.9462
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7310206133735545, 'ACC_ID': 0.6646556058320764, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7362; Top5: 0.9451
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7361668003207699, 'ACC_ID': 0.669206094627105, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7251; Top5: 0.9444
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7247920133111481, 'ACC_ID': 0.6615640599001664, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7254; Top5: 0.9409
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7251864601262191, 'ACC_ID': 0.6617900172117039, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7277; Top5: 0.9405
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7274085138162808, 'ACC_ID': 0.6639283047050037, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7301; Top5: 0.9410
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7299334811529934, 'ACC_ID': 0.6658536585365854, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7329; Top5: 0.9421
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7329329329329329, 'ACC_ID': 0.6682682682682682, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7349; Top5: 0.9436
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7348981077147017, 'ACC_ID': 0.6686681222707423, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7324; Top5: 0.9432
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7324766355140186, 'ACC_ID': 0.6683911882510013, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7340; Top5: 0.9442
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7338572969640931, 'ACC_ID': 0.6692864848204654, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7356; Top5: 0.9446
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7356847065543338, 'ACC_ID': 0.6719977152648865, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7376; Top5: 0.9460
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7376066098081023, 'ACC_ID': 0.6729744136460555, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7369; Top5: 0.9466
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7369540733324991, 'ACC_ID': 0.6726317106745088, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7389; Top5: 0.9475
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7389718856605105, 'ACC_ID': 0.6750970474061875, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7374; Top5: 0.9471
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7376391982182628, 'ACC_ID': 0.6750556792873051, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7375; Top5: 0.9480
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7376650818806127, 'ACC_ID': 0.6759640781827787, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7383; Top5: 0.9472
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7385, 'ACC_ID': 0.6754, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.30803016 0.2927742  ... 0.18196686 0.18196017 0.14289485]
cifar10OOD Tiny rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 73.8300; Top-5 accuracy: 94.7200
{'Method': 'rosita_loss_txt', 'AUC': 0.88702947, 'FPR95': 0.3887, 'ACC_ALL': 0.7385, 'ACC_ID': 0.6754, 'ACC_OOD': 0.7884, 'ACC_HM': 0.7275384068861867, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=3, level=5, loss_pl=0, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified

Step 999: Top1: 0.5010; Top5: 0.7475
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5050100200400801, 'ACC_ID': 0.32064128256513025, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4913; Top5: 0.7472
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4933196300102775, 'ACC_ID': 0.32682425488180883, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4816; Top5: 0.7375
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4826435246995995, 'ACC_ID': 0.32309746328437916, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4809; Top5: 0.7389
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.481649069884364, 'ACC_ID': 0.32176973353443944, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4836; Top5: 0.7434
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4839615076182839, 'ACC_ID': 0.3231756214915798, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4865; Top5: 0.7451
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4868552412645591, 'ACC_ID': 0.3261231281198003, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4815; Top5: 0.7440
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48164084911072863, 'ACC_ID': 0.3232931726907631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4817; Top5: 0.7394
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4819517052526761, 'ACC_ID': 0.323126711476226, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4859; Top5: 0.7401
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4862527716186253, 'ACC_ID': 0.323059866962306, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4848; Top5: 0.7397
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4850850850850851, 'ACC_ID': 0.3215215215215215, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4862; Top5: 0.7409
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4861717612809316, 'ACC_ID': 0.32259825327510916, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4832; Top5: 0.7371
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4831441922563418, 'ACC_ID': 0.31992656875834447, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4874; Top5: 0.7378
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.487286176606565, 'ACC_ID': 0.32162120511635073, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4857; Top5: 0.7371
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48579180351278023, 'ACC_ID': 0.32043409967156933, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4861; Top5: 0.7365
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48600746268656714, 'ACC_ID': 0.32076226012793174, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4827; Top5: 0.7362
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4826680015016894, 'ACC_ID': 0.3183581529220373, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4845; Top5: 0.7366
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.484295965180567, 'ACC_ID': 0.3194918244912363, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4847; Top5: 0.7363
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4846325167037862, 'ACC_ID': 0.32060133630289533, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4843; Top5: 0.7371
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48420496566296883, 'ACC_ID': 0.31949286846275754, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4841; Top5: 0.7382
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4842, 'ACC_ID': 0.3195, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.31986952 0.28284946 ... 0.21867055 0.21867017 0.18064982]
cifar100OOD MNIST rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 48.4100; Top-5 accuracy: 73.8100
{'Method': 'rosita_loss_txt', 'AUC': 0.74115981, 'FPR95': 0.9999, 'ACC_ALL': 0.4842, 'ACC_ID': 0.3195, 'ACC_OOD': 0.963, 'ACC_HM': 0.4798105263157895, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=3, level=5, loss_pl=0, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat

Step 999: Top1: 0.5010; Top5: 0.7475
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5050100200400801, 'ACC_ID': 0.32064128256513025, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4913; Top5: 0.7472
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4933196300102775, 'ACC_ID': 0.32682425488180883, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4816; Top5: 0.7375
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4826435246995995, 'ACC_ID': 0.32309746328437916, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4809; Top5: 0.7389
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.481649069884364, 'ACC_ID': 0.32176973353443944, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4836; Top5: 0.7434
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4839615076182839, 'ACC_ID': 0.3235765838011227, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4865; Top5: 0.7451
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4868552412645591, 'ACC_ID': 0.3264559068219634, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4815; Top5: 0.7440
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48164084911072863, 'ACC_ID': 0.32358003442340794, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4817; Top5: 0.7394
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4819517052526761, 'ACC_ID': 0.32337565347274083, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4859; Top5: 0.7401
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4862527716186253, 'ACC_ID': 0.3235033259423503, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4848; Top5: 0.7397
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4850850850850851, 'ACC_ID': 0.3219219219219219, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4862; Top5: 0.7409
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4861717612809316, 'ACC_ID': 0.322962154294032, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4832; Top5: 0.7371
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4831441922563418, 'ACC_ID': 0.320260347129506, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4874; Top5: 0.7378
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.487286176606565, 'ACC_ID': 0.322391739867468, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4857; Top5: 0.7371
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48579180351278023, 'ACC_ID': 0.3211480793945452, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4861; Top5: 0.7365
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48600746268656714, 'ACC_ID': 0.32142857142857145, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4827; Top5: 0.7362
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4826680015016894, 'ACC_ID': 0.3189838568389438, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4845; Top5: 0.7366
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.484295965180567, 'ACC_ID': 0.32007999058934244, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4847; Top5: 0.7363
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4846325167037862, 'ACC_ID': 0.32115812917594655, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4843; Top5: 0.7371
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48420496566296883, 'ACC_ID': 0.32002113048071845, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4841; Top5: 0.7382
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4842, 'ACC_ID': 0.32, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.31986952 0.30182382 ... 0.19664878 0.19606526 0.18064982]
cifar100OOD SVHN rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 48.4100; Top-5 accuracy: 73.8100
{'Method': 'rosita_loss_txt', 'AUC': 0.648004445, 'FPR95': 0.98, 'ACC_ALL': 0.4842, 'ACC_ID': 0.32, 'ACC_OOD': 0.7958, 'ACC_HM': 0.4564545617494175, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=3, level=5, loss_pl=0, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified

Step 999: Top1: 0.5010; Top5: 0.7475
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5050100200400801, 'ACC_ID': 0.3186372745490982, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4913; Top5: 0.7472
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4933196300102775, 'ACC_ID': 0.32579650565262075, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4816; Top5: 0.7375
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4826435246995995, 'ACC_ID': 0.32242990654205606, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4809; Top5: 0.7389
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.481649069884364, 'ACC_ID': 0.3212669683257919, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4836; Top5: 0.7434
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4839615076182839, 'ACC_ID': 0.3231756214915798, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4865; Top5: 0.7451
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4868552412645591, 'ACC_ID': 0.3261231281198003, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4815; Top5: 0.7440
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48164084911072863, 'ACC_ID': 0.3232931726907631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4817; Top5: 0.7394
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4819517052526761, 'ACC_ID': 0.323126711476226, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4859; Top5: 0.7401
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4862527716186253, 'ACC_ID': 0.3232815964523282, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4848; Top5: 0.7397
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4850850850850851, 'ACC_ID': 0.3217217217217217, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4862; Top5: 0.7409
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4861717612809316, 'ACC_ID': 0.3227802037845706, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4832; Top5: 0.7371
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4831441922563418, 'ACC_ID': 0.32009345794392524, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4874; Top5: 0.7378
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.487286176606565, 'ACC_ID': 0.32223763291724455, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4857; Top5: 0.7371
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48579180351278023, 'ACC_ID': 0.32100528344995, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4861; Top5: 0.7365
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48600746268656714, 'ACC_ID': 0.3212953091684435, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4827; Top5: 0.7362
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4826680015016894, 'ACC_ID': 0.3188587160555625, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4845; Top5: 0.7366
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.484295965180567, 'ACC_ID': 0.31996235736972123, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4847; Top5: 0.7363
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4846325167037862, 'ACC_ID': 0.3210467706013363, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4843; Top5: 0.7371
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48420496566296883, 'ACC_ID': 0.3199154780771263, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4841; Top5: 0.7382
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4842, 'ACC_ID': 0.3199, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.31986952 0.31365624 ... 0.18516362 0.18484852 0.18064982]
cifar100OOD cifar10 rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 48.4100; Top-5 accuracy: 73.8100
{'Method': 'rosita_loss_txt', 'AUC': 0.63261086, 'FPR95': 0.9322, 'ACC_ALL': 0.4842, 'ACC_ID': 0.3199, 'ACC_OOD': 0.7061, 'ACC_HM': 0.44031460038986353, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=3, level=5, loss_pl=0, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000

Step 999: Top1: 0.5010; Top5: 0.7475
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5050100200400801, 'ACC_ID': 0.32665330661322645, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4913; Top5: 0.7472
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4933196300102775, 'ACC_ID': 0.34018499486125386, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4816; Top5: 0.7375
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4826435246995995, 'ACC_ID': 0.3384512683578104, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4809; Top5: 0.7389
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.481649069884364, 'ACC_ID': 0.34489693313222725, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.4836; Top5: 0.7434
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4839615076182839, 'ACC_ID': 0.34683239775461105, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.4865; Top5: 0.7451
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4868552412645591, 'ACC_ID': 0.34575707154742097, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.4815; Top5: 0.7440
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48164084911072863, 'ACC_ID': 0.3427997705106139, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4817; Top5: 0.7394
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4819517052526761, 'ACC_ID': 0.3403037092357481, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4859; Top5: 0.7401
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4862527716186253, 'ACC_ID': 0.3385809312638581, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4848; Top5: 0.7397
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4850850850850851, 'ACC_ID': 0.3383383383383383, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4862; Top5: 0.7409
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4861717612809316, 'ACC_ID': 0.33915574963609896, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4832; Top5: 0.7371
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4831441922563418, 'ACC_ID': 0.33511348464619495, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4874; Top5: 0.7378
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.487286176606565, 'ACC_ID': 0.3361072584373555, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4857; Top5: 0.7371
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48579180351278023, 'ACC_ID': 0.33442810224189634, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4861; Top5: 0.7365
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48600746268656714, 'ACC_ID': 0.33435501066098083, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4827; Top5: 0.7362
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4826680015016894, 'ACC_ID': 0.33212363909398074, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4845; Top5: 0.7366
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.484295965180567, 'ACC_ID': 0.3345488766027526, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4847; Top5: 0.7363
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4846325167037862, 'ACC_ID': 0.3348552338530067, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4843; Top5: 0.7371
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48420496566296883, 'ACC_ID': 0.33576333861595353, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4841; Top5: 0.7382
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4842, 'ACC_ID': 0.3354, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.33556879 0.32119262 ... 0.18076146 0.18064982 0.16422734]
cifar100OOD Tiny rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 48.4100; Top-5 accuracy: 73.8100
{'Method': 'rosita_loss_txt', 'AUC': 0.674879075, 'FPR95': 0.7959, 'ACC_ALL': 0.4842, 'ACC_ID': 0.3354, 'ACC_OOD': 0.6944, 'ACC_HM': 0.45232425713730817, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 0, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




1 0
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='VisdaOOD', k_n=10, k_p=3, level=5, loss_pl=1, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_loss', workers=4)


10000 10000 20000

Step 999: Top1: 0.8737; Top5: 0.9840
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.87374749498998, 'ACC_ID': 0.6733466933867736, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8746; Top5: 0.9887
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8746145940390545, 'ACC_ID': 0.6690647482014388, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.8724; Top5: 0.9913
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8718291054739653, 'ACC_ID': 0.6588785046728972, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.8717; Top5: 0.9920
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8712921065862242, 'ACC_ID': 0.6465560583207642, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8685; Top5: 0.9920
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8684843624699278, 'ACC_ID': 0.644747393744988, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8659; Top5: 0.9917
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8658901830282862, 'ACC_ID': 0.6459234608985025, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.8660; Top5: 0.9917
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.866035570854848, 'ACC_ID': 0.6451520367183018, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.8676; Top5: 0.9918
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.86756285785412, 'ACC_ID': 0.6452576549663929, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.8672; Top5: 0.9909
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8671840354767184, 'ACC_ID': 0.6472283813747228, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.8708; Top5: 0.9916
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8706706706706707, 'ACC_ID': 0.6482482482482482, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.8712; Top5: 0.9918
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.87117903930131, 'ACC_ID': 0.6481077147016011, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.8701; Top5: 0.9920
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8699933244325768, 'ACC_ID': 0.6451935914552737, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.8687; Top5: 0.9921
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8685467714593929, 'ACC_ID': 0.6423177685313608, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.8670; Top5: 0.9911
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8669141796372983, 'ACC_ID': 0.6398686277309724, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.8674; Top5: 0.9907
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8672707889125799, 'ACC_ID': 0.6372601279317697, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.8661; Top5: 0.9906
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8659742209986234, 'ACC_ID': 0.6367163058440746, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.8653; Top5: 0.9905
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8651923303140807, 'ACC_ID': 0.6329843547817904, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.8656; Top5: 0.9903
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.865478841870824, 'ACC_ID': 0.6329621380846325, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.8652; Top5: 0.9905
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8649762282091917, 'ACC_ID': 0.632540940306392, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.8644; Top5: 0.9898
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8642, 'ACC_ID': 0.6327, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.3385146  0.29875296 ... 0.20561162 0.20553087 0.16539338]
VisdaOOD MNIST rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 86.4400; Top-5 accuracy: 98.9800
{'Method': 'rosita_loss_txt', 'AUC': 0.928472375, 'FPR95': 0.7395, 'ACC_ALL': 0.8642, 'ACC_ID': 0.6327, 'ACC_OOD': 0.997, 'ACC_HM': 0.7741325397312389, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='VisdaOOD', k_n=10, k_p=3, level=5, loss_pl=1, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_loss', workers=4)


Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/train_32x32.mat
10000 10000 20000

Step 999: Top1: 0.8737; Top5: 0.9840
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.87374749498998, 'ACC_ID': 0.6733466933867736, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8746; Top5: 0.9887
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8746145940390545, 'ACC_ID': 0.6690647482014388, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.8717; Top5: 0.9913
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8711615487316422, 'ACC_ID': 0.6582109479305741, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.8712; Top5: 0.9920
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8707893413775767, 'ACC_ID': 0.6455505279034691, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8681; Top5: 0.9920
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8680834001603849, 'ACC_ID': 0.6439454691259021, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8656; Top5: 0.9913
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8655574043261232, 'ACC_ID': 0.6452579034941763, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.8657; Top5: 0.9914
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8657487091222031, 'ACC_ID': 0.6442914515203672, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.8673; Top5: 0.9915
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8673139158576052, 'ACC_ID': 0.6445108289768484, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.8669; Top5: 0.9907
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8669623059866962, 'ACC_ID': 0.6467849223946784, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.8706; Top5: 0.9914
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8704704704704704, 'ACC_ID': 0.6478478478478479, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.8710; Top5: 0.9916
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8709970887918487, 'ACC_ID': 0.6475618631732168, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.8698; Top5: 0.9918
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8699933244325768, 'ACC_ID': 0.6448598130841121, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.8685; Top5: 0.9920
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8685467714593929, 'ACC_ID': 0.6421636615811374, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.8669; Top5: 0.9910
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8669141796372983, 'ACC_ID': 0.6398686277309724, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.8673; Top5: 0.9905
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8672707889125799, 'ACC_ID': 0.6372601279317697, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.8660; Top5: 0.9905
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8659742209986234, 'ACC_ID': 0.6367163058440746, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.8652; Top5: 0.9904
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8651923303140807, 'ACC_ID': 0.6331019880014116, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.8656; Top5: 0.9902
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.865478841870824, 'ACC_ID': 0.6330734966592427, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.8652; Top5: 0.9904
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8649762282091917, 'ACC_ID': 0.632540940306392, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.8644; Top5: 0.9898
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8642, 'ACC_ID': 0.6326, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.33858046 0.29569662 ... 0.18306679 0.18306468 0.16538304]
VisdaOOD SVHN rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 86.4400; Top-5 accuracy: 98.9800
{'Method': 'rosita_loss_txt', 'AUC': 0.902621845, 'FPR95': 0.65, 'ACC_ALL': 0.8642, 'ACC_ID': 0.6326, 'ACC_OOD': 0.9575, 'ACC_HM': 0.7618571159046601, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='ImagenetROOD', k_n=10, k_p=3, level=5, loss_pl=1, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_loss', workers=4)


len 10000
dict_values(['goldfish', 'great white shark', 'hammerhead shark', 'stingray', 'hen', 'ostrich', 'goldfinch', 'junco', 'bald eagle', 'vulture', 'smooth newt', 'axolotl', 'tree frog', 'green iguana', 'chameleon', 'Indian cobra', 'scorpion', 'tarantula', 'centipede', 'peafowl', 'lorikeet', 'hummingbird', 'toucan', 'duck', 'goose', 'black swan', 'koala', 'jellyfish', 'snail', 'American lobster', 'hermit crab', 'flamingo', 'great egret', 'pelican', 'king penguin', 'grey whale', 'killer whale', 'sea lion', 'Chihuahua', 'Shih Tzu', 'Afghan Hound', 'Basset Hound', 'Beagle', 'Bloodhound', 'Italian Greyhound', 'Whippet', 'Weimaraner', 'Yorkshire Terrier', 'Boston Terrier', 'Scottish Terrier', 'West Highland White Terrier', 'Golden Retriever', 'Labrador Retriever', 'Cocker Spaniel', 'collie', 'Border Collie', 'Rottweiler', 'German Shepherd Dog', 'Boxer', 'French Bulldog', 'St. Bernard', 'Siberian Husky', 'Dalmatian', 'pug', 'Pomeranian', 'Chow Chow', 'Pembroke Welsh Corgi', 'Toy Poodle', 'Standard Poodle', 'grey wolf', 'hyena', 'red fox', 'tabby cat', 'leopard', 'snow leopard', 'lion', 'tiger', 'cheetah', 'polar bear', 'meerkat', 'ladybug', 'fly', 'bee', 'ant', 'grasshopper', 'cockroach', 'praying mantis', 'dragonfly', 'monarch butterfly', 'starfish', 'cottontail rabbit', 'porcupine', 'fox squirrel', 'beaver', 'guinea pig', 'zebra', 'pig', 'hippopotamus', 'bison', 'gazelle', 'llama', 'skunk', 'badger', 'orangutan', 'gorilla', 'chimpanzee', 'gibbon', 'baboon', 'giant panda', 'eel', 'clownfish', 'pufferfish', 'accordion', 'ambulance', 'assault rifle', 'backpack', 'barn', 'wheelbarrow', 'basketball', 'bathtub', 'lighthouse', 'beer glass', 'binoculars', 'birdhouse', 'bow tie', 'broom', 'bucket', 'cauldron', 'candle', 'cannon', 'canoe', 'carousel', 'castle', 'mobile phone', 'cowboy hat', 'electric guitar', 'fire truck', 'flute', 'gas mask or respirator', 'grand piano', 'guillotine', 'hammer', 'harmonica', 'harp', 'hatchet', 'jeep', 'joystick', 'lab coat', 'lawn mower', 'lipstick', 'mailbox', 'missile', 'mitten', 'parachute', 'pickup truck', 'pirate ship', 'revolver', 'rugby ball', 'sandal', 'saxophone', 'school bus', 'schooner', 'shield', 'soccer ball', 'space shuttle', 'spider web', 'steam locomotive', 'scarf', 'submarine', 'tank', 'tennis ball', 'tractor', 'trombone', 'vase', 'violin', 'military aircraft', 'wine bottle', 'ice cream', 'bagel', 'pretzel', 'cheeseburger', 'hot dog', 'cabbage', 'broccoli', 'cucumber', 'bell pepper', 'mushroom', 'Granny Smith apple', 'strawberry', 'lemon', 'pineapple', 'banana', 'pomegranate', 'pizza', 'burrito', 'espresso', 'volcano', 'baseball player', 'scuba diver', 'acorn'])
len 10000
10000 10000 20000

Step 999: Top1: 0.7415; Top5: 0.9158
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7414829659318637, 'ACC_ID': 0.5350701402805611, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7369; Top5: 0.9075
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.736896197327852, 'ACC_ID': 0.5313463514902363, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7341; Top5: 0.9092
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7343124165554072, 'ACC_ID': 0.534712950600801, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7233; Top5: 0.9044
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7234791352438411, 'ACC_ID': 0.518350930115636, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7281; Top5: 0.9078
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7281475541299118, 'ACC_ID': 0.5232558139534884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7344; Top5: 0.9088
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7344425956738768, 'ACC_ID': 0.5171381031613976, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7383; Top5: 0.9096
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7383820998278829, 'ACC_ID': 0.5166379804934021, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7359; Top5: 0.9071
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7356235997012696, 'ACC_ID': 0.5175504107542942, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7394; Top5: 0.9077
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7392461197339246, 'ACC_ID': 0.5186252771618626, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7371; Top5: 0.9091
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.736936936936937, 'ACC_ID': 0.5207207207207207, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7367; Top5: 0.9105
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7365356622998545, 'ACC_ID': 0.519650655021834, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7373; Top5: 0.9127
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7371495327102804, 'ACC_ID': 0.5215287049399199, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7408; Top5: 0.9138
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7404838958237017, 'ACC_ID': 0.5211897056557251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7429; Top5: 0.9150
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7425389118949022, 'ACC_ID': 0.5220619734399543, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7429; Top5: 0.9163
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7426705756929638, 'ACC_ID': 0.5190565031982942, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7423; Top5: 0.9158
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7420848454511325, 'ACC_ID': 0.5180828431985984, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7418; Top5: 0.9152
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7415598164921774, 'ACC_ID': 0.5165274673567816, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7421; Top5: 0.9145
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7418708240534521, 'ACC_ID': 0.5160356347438753, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7436; Top5: 0.9148
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7432646592709984, 'ACC_ID': 0.5138932910723719, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7424; Top5: 0.9143
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7422, 'ACC_ID': 0.512, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.32959107 0.24188994 ... 0.14267896 0.14258552 0.08547246]
ImagenetROOD MNIST rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 74.2400; Top-5 accuracy: 91.4300
{'Method': 'rosita_loss_txt', 'AUC': 0.86355611, 'FPR95': 0.9903, 'ACC_ALL': 0.7422, 'ACC_ID': 0.512, 'ACC_OOD': 0.9842, 'ACC_HM': 0.6735869536158268, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='ImagenetROOD', k_n=10, k_p=3, level=5, loss_pl=1, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_loss', workers=4)


len 10000
dict_values(['goldfish', 'great white shark', 'hammerhead shark', 'stingray', 'hen', 'ostrich', 'goldfinch', 'junco', 'bald eagle', 'vulture', 'smooth newt', 'axolotl', 'tree frog', 'green iguana', 'chameleon', 'Indian cobra', 'scorpion', 'tarantula', 'centipede', 'peafowl', 'lorikeet', 'hummingbird', 'toucan', 'duck', 'goose', 'black swan', 'koala', 'jellyfish', 'snail', 'American lobster', 'hermit crab', 'flamingo', 'great egret', 'pelican', 'king penguin', 'grey whale', 'killer whale', 'sea lion', 'Chihuahua', 'Shih Tzu', 'Afghan Hound', 'Basset Hound', 'Beagle', 'Bloodhound', 'Italian Greyhound', 'Whippet', 'Weimaraner', 'Yorkshire Terrier', 'Boston Terrier', 'Scottish Terrier', 'West Highland White Terrier', 'Golden Retriever', 'Labrador Retriever', 'Cocker Spaniel', 'collie', 'Border Collie', 'Rottweiler', 'German Shepherd Dog', 'Boxer', 'French Bulldog', 'St. Bernard', 'Siberian Husky', 'Dalmatian', 'pug', 'Pomeranian', 'Chow Chow', 'Pembroke Welsh Corgi', 'Toy Poodle', 'Standard Poodle', 'grey wolf', 'hyena', 'red fox', 'tabby cat', 'leopard', 'snow leopard', 'lion', 'tiger', 'cheetah', 'polar bear', 'meerkat', 'ladybug', 'fly', 'bee', 'ant', 'grasshopper', 'cockroach', 'praying mantis', 'dragonfly', 'monarch butterfly', 'starfish', 'cottontail rabbit', 'porcupine', 'fox squirrel', 'beaver', 'guinea pig', 'zebra', 'pig', 'hippopotamus', 'bison', 'gazelle', 'llama', 'skunk', 'badger', 'orangutan', 'gorilla', 'chimpanzee', 'gibbon', 'baboon', 'giant panda', 'eel', 'clownfish', 'pufferfish', 'accordion', 'ambulance', 'assault rifle', 'backpack', 'barn', 'wheelbarrow', 'basketball', 'bathtub', 'lighthouse', 'beer glass', 'binoculars', 'birdhouse', 'bow tie', 'broom', 'bucket', 'cauldron', 'candle', 'cannon', 'canoe', 'carousel', 'castle', 'mobile phone', 'cowboy hat', 'electric guitar', 'fire truck', 'flute', 'gas mask or respirator', 'grand piano', 'guillotine', 'hammer', 'harmonica', 'harp', 'hatchet', 'jeep', 'joystick', 'lab coat', 'lawn mower', 'lipstick', 'mailbox', 'missile', 'mitten', 'parachute', 'pickup truck', 'pirate ship', 'revolver', 'rugby ball', 'sandal', 'saxophone', 'school bus', 'schooner', 'shield', 'soccer ball', 'space shuttle', 'spider web', 'steam locomotive', 'scarf', 'submarine', 'tank', 'tennis ball', 'tractor', 'trombone', 'vase', 'violin', 'military aircraft', 'wine bottle', 'ice cream', 'bagel', 'pretzel', 'cheeseburger', 'hot dog', 'cabbage', 'broccoli', 'cucumber', 'bell pepper', 'mushroom', 'Granny Smith apple', 'strawberry', 'lemon', 'pineapple', 'banana', 'pomegranate', 'pizza', 'burrito', 'espresso', 'volcano', 'baseball player', 'scuba diver', 'acorn'])
len 10000
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/train_32x32.mat
10000 10000 20000

Step 999: Top1: 0.7415; Top5: 0.9158
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7414829659318637, 'ACC_ID': 0.5350701402805611, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7369; Top5: 0.9075
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.736896197327852, 'ACC_ID': 0.5334018499486125, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7341; Top5: 0.9092
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7349799732977303, 'ACC_ID': 0.5387182910547397, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7233; Top5: 0.9044
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7239819004524887, 'ACC_ID': 0.526395173453997, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7285; Top5: 0.9074
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7289494787489976, 'ACC_ID': 0.5300721732157178, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7348; Top5: 0.9085
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.735108153078203, 'ACC_ID': 0.524459234608985, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7383; Top5: 0.9093
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7389558232931727, 'ACC_ID': 0.5209409064830751, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7361; Top5: 0.9066
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7366193676873288, 'ACC_ID': 0.5267612646253423, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7399; Top5: 0.9071
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7403547671840355, 'ACC_ID': 0.530820399113082, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7373; Top5: 0.9085
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7379379379379379, 'ACC_ID': 0.5313313313313314, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7369; Top5: 0.9099
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7374454148471615, 'ACC_ID': 0.5292940320232896, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7374; Top5: 0.9122
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7379839786381842, 'ACC_ID': 0.5320427236315087, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7408; Top5: 0.9134
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7412544305748189, 'ACC_ID': 0.5329018338727076, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7429; Top5: 0.9146
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7433956875624732, 'ACC_ID': 0.5330572611737827, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7428; Top5: 0.9160
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7434701492537313, 'ACC_ID': 0.5298507462686567, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7422; Top5: 0.9155
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7428356901514204, 'ACC_ID': 0.5292203729195345, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7416; Top5: 0.9151
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7422656158099047, 'ACC_ID': 0.5271144571226914, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7421; Top5: 0.9142
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7426503340757238, 'ACC_ID': 0.5269487750556793, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7437; Top5: 0.9147
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7441098784997359, 'ACC_ID': 0.524986793449551, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7426; Top5: 0.9142
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.743, 'ACC_ID': 0.5238, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.32961145 0.27579215 ... 0.12479353 0.1238823  0.08548063]
ImagenetROOD SVHN rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 74.2600; Top-5 accuracy: 91.4200
{'Method': 'rosita_loss_txt', 'AUC': 0.865670845, 'FPR95': 0.8976, 'ACC_ALL': 0.743, 'ACC_ID': 0.5238, 'ACC_OOD': 0.981, 'ACC_HM': 0.6829449760765551, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=3, level=5, loss_pl=1, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified

Step 999: Top1: 0.7295; Top5: 0.9439
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7294589178356713, 'ACC_ID': 0.5851703406813628, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7379; Top5: 0.9383
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.736896197327852, 'ACC_ID': 0.60431654676259, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7381; Top5: 0.9439
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7376502002670227, 'ACC_ID': 0.6041388518024032, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7404; Top5: 0.9472
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7400703871292107, 'ACC_ID': 0.6194067370537959, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7478; Top5: 0.9479
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7477947072975141, 'ACC_ID': 0.6259021651964716, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7401; Top5: 0.9491
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7400998336106489, 'ACC_ID': 0.6222961730449251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7412; Top5: 0.9472
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7412507171543317, 'ACC_ID': 0.6219162363740677, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7461; Top5: 0.9482
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7460791635548917, 'ACC_ID': 0.6253422952452079, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7492; Top5: 0.9490
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7492239467849224, 'ACC_ID': 0.6232815964523282, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7527; Top5: 0.9517
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7527527527527528, 'ACC_ID': 0.6244244244244245, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7562; Top5: 0.9529
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7561863173216885, 'ACC_ID': 0.6264556040756915, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7548; Top5: 0.9531
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7548397863818425, 'ACC_ID': 0.6270026702269693, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7568; Top5: 0.9536
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7568192325473879, 'ACC_ID': 0.6293727847125905, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7598; Top5: 0.9550
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7598172211909182, 'ACC_ID': 0.6342995858917607, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7621; Top5: 0.9563
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7621268656716418, 'ACC_ID': 0.6376599147121536, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7632; Top5: 0.9569
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7631084970591916, 'ACC_ID': 0.6409710924790389, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7646; Top5: 0.9584
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7643806610986943, 'ACC_ID': 0.6452182096223974, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7642; Top5: 0.9582
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7639198218262806, 'ACC_ID': 0.6467706013363029, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7644; Top5: 0.9593
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7641838351822504, 'ACC_ID': 0.6474379292128896, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7652; Top5: 0.9593
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7651, 'ACC_ID': 0.6458, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.32413852 0.29159459 ... 0.20469037 0.20452464 0.18509312]
cifar10OOD MNIST rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 76.5200; Top-5 accuracy: 95.9300
{'Method': 'rosita_loss_txt', 'AUC': 0.92479121, 'FPR95': 0.5995, 'ACC_ALL': 0.7651, 'ACC_ID': 0.6458, 'ACC_OOD': 0.9851, 'ACC_HM': 0.7801552271751794, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=3, level=5, loss_pl=1, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat

Step 999: Top1: 0.7295; Top5: 0.9439
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7314629258517034, 'ACC_ID': 0.5851703406813628, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7379; Top5: 0.9383
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7389516957862282, 'ACC_ID': 0.6063720452209661, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7388; Top5: 0.9439
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.739652870493992, 'ACC_ID': 0.6068090787716955, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7409; Top5: 0.9467
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7415786827551534, 'ACC_ID': 0.6219205630970337, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7482; Top5: 0.9475
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7489975942261428, 'ACC_ID': 0.6307137129109863, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7401; Top5: 0.9488
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7407653910149751, 'ACC_ID': 0.6276206322795341, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7412; Top5: 0.9469
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7418244406196214, 'ACC_ID': 0.6351118760757315, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7468; Top5: 0.9477
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7473238735374658, 'ACC_ID': 0.6440129449838188, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7501; Top5: 0.9485
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7505543237250555, 'ACC_ID': 0.6447893569844789, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7545; Top5: 0.9515
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7549549549549549, 'ACC_ID': 0.6458458458458458, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7580; Top5: 0.9527
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.758551673944687, 'ACC_ID': 0.6470160116448326, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7571; Top5: 0.9529
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7576769025367156, 'ACC_ID': 0.6473631508678238, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7589; Top5: 0.9536
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7594390507011867, 'ACC_ID': 0.6495607951918632, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7616; Top5: 0.9550
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.762101956304441, 'ACC_ID': 0.6541482221904897, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7637; Top5: 0.9563
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7641257995735607, 'ACC_ID': 0.656183368869936, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7642; Top5: 0.9569
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7646101864597672, 'ACC_ID': 0.659116506069328, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7656; Top5: 0.9585
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7659098929537701, 'ACC_ID': 0.6628631925655806, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7650; Top5: 0.9583
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7652561247216035, 'ACC_ID': 0.6645879732739421, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7650; Top5: 0.9594
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7652403592181722, 'ACC_ID': 0.6653988378235605, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7656; Top5: 0.9594
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7659, 'ACC_ID': 0.6649, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.32457429 0.28729767 ... 0.18700087 0.18555084 0.18173409]
cifar10OOD SVHN rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 76.5600; Top-5 accuracy: 95.9400
{'Method': 'rosita_loss_txt', 'AUC': 0.909022055, 'FPR95': 0.5524, 'ACC_ALL': 0.7659, 'ACC_ID': 0.6649, 'ACC_OOD': 0.9113, 'ACC_HM': 0.7688407181829717, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=3, level=5, loss_pl=1, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified

Step 999: Top1: 0.7295; Top5: 0.9439
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7294589178356713, 'ACC_ID': 0.5851703406813628, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7369; Top5: 0.9383
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7379239465570401, 'ACC_ID': 0.6073997944501541, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7388; Top5: 0.9452
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7389853137516689, 'ACC_ID': 0.6108144192256342, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7425; Top5: 0.9472
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7410759175465058, 'ACC_ID': 0.6259426847662142, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7502; Top5: 0.9483
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7489975942261428, 'ACC_ID': 0.6351242983159583, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7428; Top5: 0.9491
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7417637271214642, 'ACC_ID': 0.63261231281198, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7438; Top5: 0.9481
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7429718875502008, 'ACC_ID': 0.6402753872633391, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7498; Top5: 0.9495
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7488175255165547, 'ACC_ID': 0.6479960169280558, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7534; Top5: 0.9505
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.752549889135255, 'ACC_ID': 0.6527716186252772, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7581; Top5: 0.9531
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7573573573573573, 'ACC_ID': 0.6574574574574574, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7606; Top5: 0.9545
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.759825327510917, 'ACC_ID': 0.6604803493449781, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7591; Top5: 0.9546
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7585113484646195, 'ACC_ID': 0.6610480640854473, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7600; Top5: 0.9553
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7595931576514101, 'ACC_ID': 0.6631222068115272, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7622; Top5: 0.9569
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7618163644152506, 'ACC_ID': 0.6669998572040554, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7645; Top5: 0.9579
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7641257995735607, 'ACC_ID': 0.6643123667377399, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7653; Top5: 0.9586
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7649856088099112, 'ACC_ID': 0.6666249530722063, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7668; Top5: 0.9601
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7662627926126339, 'ACC_ID': 0.6669803552523232, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7660; Top5: 0.9599
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.765478841870824, 'ACC_ID': 0.6653674832962138, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7661; Top5: 0.9608
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7655573164289488, 'ACC_ID': 0.6649762282091918, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7664; Top5: 0.9609
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.766, 'ACC_ID': 0.664, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.32489601 0.32083905 ... 0.18617748 0.18613166 0.15780881]
cifar10OOD cifar100 rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 76.6400; Top-5 accuracy: 96.0900
{'Method': 'rosita_loss_txt', 'AUC': 0.819887765, 'FPR95': 0.65, 'ACC_ALL': 0.766, 'ACC_ID': 0.664, 'ACC_OOD': 0.7224, 'ACC_HM': 0.6919699942296595, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=3, level=5, loss_pl=1, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000

Step 999: Top1: 0.7315; Top5: 0.9439
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7334669338677354, 'ACC_ID': 0.655310621242485, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7379; Top5: 0.9383
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7389516957862282, 'ACC_ID': 0.6721479958890031, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7395; Top5: 0.9466
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7409879839786382, 'ACC_ID': 0.677570093457944, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7440; Top5: 0.9487
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7440925087983912, 'ACC_ID': 0.6882855706385118, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7514; Top5: 0.9495
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7514033680834001, 'ACC_ID': 0.6956696070569367, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7434; Top5: 0.9501
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7434276206322795, 'ACC_ID': 0.6838602329450915, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7446; Top5: 0.9498
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.74469305794607, 'ACC_ID': 0.6873207114170969, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7506; Top5: 0.9510
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7503111774956435, 'ACC_ID': 0.6905650983320887, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7547; Top5: 0.9519
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7543237250554323, 'ACC_ID': 0.6955654101995565, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7599; Top5: 0.9543
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7595595595595596, 'ACC_ID': 0.7011011011011011, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7620; Top5: 0.9558
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7616448326055313, 'ACC_ID': 0.7057860262008734, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7601; Top5: 0.9559
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7598464619492656, 'ACC_ID': 0.7044392523364486, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7614; Top5: 0.9565
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7611342271536446, 'ACC_ID': 0.7051934042225304, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7638; Top5: 0.9580
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7635299157503926, 'ACC_ID': 0.7072683135798943, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7661; Top5: 0.9590
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7658582089552238, 'ACC_ID': 0.7077558635394456, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7668; Top5: 0.9596
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7666124389938681, 'ACC_ID': 0.7086722562883244, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7682; Top5: 0.9612
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7679096576873309, 'ACC_ID': 0.7100341136336902, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7676; Top5: 0.9610
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.767260579064588, 'ACC_ID': 0.7097995545657015, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7674; Top5: 0.9620
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7671421024828314, 'ACC_ID': 0.7107237189646064, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7677; Top5: 0.9621
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7675, 'ACC_ID': 0.7121, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.32555112 0.3103812  ... 0.18265535 0.18263415 0.15029785]
cifar10OOD Tiny rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 76.7700; Top-5 accuracy: 96.2100
{'Method': 'rosita_loss_txt', 'AUC': 0.884345675, 'FPR95': 0.4059, 'ACC_ALL': 0.7675, 'ACC_ID': 0.7121, 'ACC_OOD': 0.766, 'ACC_HM': 0.7380672484946891, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=3, level=5, loss_pl=1, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified

Step 999: Top1: 0.5150; Top5: 0.7535
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5170340681362725, 'ACC_ID': 0.3366733466933868, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5026; Top5: 0.7523
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5046248715313464, 'ACC_ID': 0.32476875642343267, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4930; Top5: 0.7401
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4939919893190921, 'ACC_ID': 0.33377837116154874, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.4990; Top5: 0.7435
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5002513826043238, 'ACC_ID': 0.3283056812468577, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5024; Top5: 0.7474
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5036086607858862, 'ACC_ID': 0.326383319967923, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5045; Top5: 0.7521
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5058236272878536, 'ACC_ID': 0.3287853577371048, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5033; Top5: 0.7535
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5040160642570282, 'ACC_ID': 0.33103843947217443, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5049; Top5: 0.7538
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5056011949215833, 'ACC_ID': 0.33582275329848144, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5079; Top5: 0.7567
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5086474501108648, 'ACC_ID': 0.3392461197339246, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5060; Top5: 0.7581
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5071071071071072, 'ACC_ID': 0.3429429429429429, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5106; Top5: 0.7611
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5116448326055313, 'ACC_ID': 0.3484352256186317, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5069; Top5: 0.7593
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5078437917222964, 'ACC_ID': 0.346128170894526, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5085; Top5: 0.7611
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.509323470488519, 'ACC_ID': 0.3478193866543381, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5080; Top5: 0.7622
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5089247465371983, 'ACC_ID': 0.3474225332000571, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5081; Top5: 0.7617
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5089285714285714, 'ACC_ID': 0.3482142857142857, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5068; Top5: 0.7628
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5075710173945689, 'ACC_ID': 0.34601426604930546, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5086; Top5: 0.7629
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5093518409598871, 'ACC_ID': 0.3471356311022233, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5086; Top5: 0.7636
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5091314031180401, 'ACC_ID': 0.34910913140311806, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5081; Top5: 0.7633
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5086106708927628, 'ACC_ID': 0.3489698890649762, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5084; Top5: 0.7651
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5088, 'ACC_ID': 0.3504, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.3470234  0.30884328 ... 0.21694514 0.21692537 0.18380065]
cifar100OOD MNIST rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 50.8300; Top-5 accuracy: 76.5100
{'Method': 'rosita_loss_txt', 'AUC': 0.7641368949999999, 'FPR95': 0.9725, 'ACC_ALL': 0.5088, 'ACC_ID': 0.3504, 'ACC_OOD': 0.8951, 'ACC_HM': 0.5036419751103974, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=3, level=5, loss_pl=1, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat

Step 999: Top1: 0.5150; Top5: 0.7555
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150300601202404, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5036; Top5: 0.7575
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5035971223021583, 'ACC_ID': 0.3371017471736896, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4957; Top5: 0.7448
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4953271028037383, 'ACC_ID': 0.3444592790387183, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5025; Top5: 0.7475
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5027652086475616, 'ACC_ID': 0.33534439416792355, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5044; Top5: 0.7510
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5048115477145149, 'ACC_ID': 0.33159582999198073, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5065; Top5: 0.7554
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5068219633943427, 'ACC_ID': 0.33377703826955074, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5062; Top5: 0.7570
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5060240963855421, 'ACC_ID': 0.3347676419965577, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5071; Top5: 0.7560
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5070948469006722, 'ACC_ID': 0.33955688324620364, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5105; Top5: 0.7591
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5104212860310421, 'ACC_ID': 0.3434589800443459, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5096; Top5: 0.7603
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5097097097097097, 'ACC_ID': 0.34534534534534533, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5147; Top5: 0.7624
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5147379912663755, 'ACC_ID': 0.3484352256186317, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5103; Top5: 0.7606
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5101802403204272, 'ACC_ID': 0.343958611481976, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5120; Top5: 0.7616
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5120973955925412, 'ACC_ID': 0.34489135460009246, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5121; Top5: 0.7629
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5122090532628873, 'ACC_ID': 0.34328145080679706, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5119; Top5: 0.7617
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5118603411513859, 'ACC_ID': 0.34421641791044777, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5098; Top5: 0.7628
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5099486922788137, 'ACC_ID': 0.34175947941434115, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5106; Top5: 0.7629
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5107634395953418, 'ACC_ID': 0.34266556875661686, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5107; Top5: 0.7633
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5108017817371938, 'ACC_ID': 0.34443207126948777, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5108; Top5: 0.7630
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5108293713681986, 'ACC_ID': 0.34484944532488115, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5109; Top5: 0.7644
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5109, 'ACC_ID': 0.3466, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.34662014 0.31510884 ... 0.20062371 0.20012021 0.18361156]
cifar100OOD SVHN rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 51.0800; Top-5 accuracy: 76.4400
{'Method': 'rosita_loss_txt', 'AUC': 0.73839158, 'FPR95': 0.9536, 'ACC_ALL': 0.5109, 'ACC_ID': 0.3466, 'ACC_OOD': 0.8687, 'ACC_HM': 0.4955013906031433, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=3, level=5, loss_pl=1, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified

Step 999: Top1: 0.5150; Top5: 0.7535
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150300601202404, 'ACC_ID': 0.3346693386773547, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5046; Top5: 0.7533
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5046248715313464, 'ACC_ID': 0.35251798561151076, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4977; Top5: 0.7435
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4979973297730307, 'ACC_ID': 0.36181575433911883, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5050; Top5: 0.7460
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5062845651080945, 'ACC_ID': 0.36048265460030166, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5080; Top5: 0.7506
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5092221331194867, 'ACC_ID': 0.35765838011226947, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5095; Top5: 0.7557
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5104825291181364, 'ACC_ID': 0.3584026622296173, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5085; Top5: 0.7581
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5094664371772806, 'ACC_ID': 0.3588640275387263, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5093; Top5: 0.7583
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5103310928553647, 'ACC_ID': 0.36221060492905155, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5130; Top5: 0.7603
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5137472283813748, 'ACC_ID': 0.36607538802660755, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5116; Top5: 0.7611
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5125125125125125, 'ACC_ID': 0.36816816816816816, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5158; Top5: 0.7635
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5165574963609898, 'ACC_ID': 0.37063318777292575, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5113; Top5: 0.7616
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.511849132176235, 'ACC_ID': 0.3666555407209613, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5139; Top5: 0.7628
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5145631067961165, 'ACC_ID': 0.36924025273539834, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5139; Top5: 0.7641
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5144937883764101, 'ACC_ID': 0.3682707411109524, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5136; Top5: 0.7635
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5139925373134329, 'ACC_ID': 0.36847014925373134, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5125; Top5: 0.7635
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.512952071079965, 'ACC_ID': 0.366412213740458, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5138; Top5: 0.7635
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5141748029643571, 'ACC_ID': 0.36713327843783083, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5129; Top5: 0.7645
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5131403118040089, 'ACC_ID': 0.3675946547884187, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5133; Top5: 0.7645
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5135763338615954, 'ACC_ID': 0.3667194928684628, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5127; Top5: 0.7658
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5129, 'ACC_ID': 0.3675, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.34466475 0.32880041 ... 0.18354391 0.18337175 0.18169092]
cifar100OOD cifar10 rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 51.2600; Top-5 accuracy: 76.5700
{'Method': 'rosita_loss_txt', 'AUC': 0.6902138, 'FPR95': 0.8702, 'ACC_ALL': 0.5129, 'ACC_ID': 0.3675, 'ACC_OOD': 0.6984, 'ACC_HM': 0.4815873909372361, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=3, level=5, loss_pl=1, loss_simclr=0, model='clip', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.7, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000

Step 999: Top1: 0.5150; Top5: 0.7535
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5150300601202404, 'ACC_ID': 0.33867735470941884, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.5046; Top5: 0.7544
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5046248715313464, 'ACC_ID': 0.35251798561151076, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4963; Top5: 0.7435
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4959946595460614, 'ACC_ID': 0.36181575433911883, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5035; Top5: 0.7460
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5032679738562091, 'ACC_ID': 0.371543489190548, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5068; Top5: 0.7494
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5068163592622293, 'ACC_ID': 0.37650360866078586, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5082; Top5: 0.7547
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.508153078202995, 'ACC_ID': 0.37304492512479204, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5079; Top5: 0.7567
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5074584050487665, 'ACC_ID': 0.3697647733792312, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5081; Top5: 0.7558
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5078416728902165, 'ACC_ID': 0.36992780682101073, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5112; Top5: 0.7583
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5108647450110865, 'ACC_ID': 0.37250554323725055, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5094; Top5: 0.7597
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5093093093093093, 'ACC_ID': 0.37317317317317317, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5142; Top5: 0.7618
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5140101892285298, 'ACC_ID': 0.37791120815138285, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5101; Top5: 0.7595
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5098464619492656, 'ACC_ID': 0.37550066755674233, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5123; Top5: 0.7608
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5122515025427646, 'ACC_ID': 0.3766373863461242, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5120; Top5: 0.7625
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.511923461373697, 'ACC_ID': 0.3782664572326146, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5115; Top5: 0.7615
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5113272921108742, 'ACC_ID': 0.3787313432835821, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5103; Top5: 0.7617
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5101989738455762, 'ACC_ID': 0.3784257289450632, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5114; Top5: 0.7620
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5113516056934478, 'ACC_ID': 0.3787789671803317, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5107; Top5: 0.7628
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.510467706013363, 'ACC_ID': 0.37984409799554564, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5101; Top5: 0.7624
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5099841521394611, 'ACC_ID': 0.3799260433174855, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5092; Top5: 0.7638
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.509, 'ACC_ID': 0.3809, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}
[       inf 0.35079628 0.34697193 ... 0.18321936 0.1831695  0.17508812]
cifar100OOD Tiny rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 50.9100; Top-5 accuracy: 76.3700
{'Method': 'rosita_loss_txt', 'AUC': 0.68695233, 'FPR95': 0.8165, 'ACC_ALL': 0.509, 'ACC_ID': 0.3809, 'ACC_OOD': 0.6605, 'ACC_HM': 0.4831658344536202, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': 1, 'loss_simclr': 0, 'OOD Detector': 'maxlogit'}




0 0
Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='VisdaOOD', k_n=10, k_p=3, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_loss', workers=4)


10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.8580; Top5: 0.9918
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8580246913580247, 'ACC_ID': 0.6646090534979424, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8636; Top5: 0.9930
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8635907723169508, 'ACC_ID': 0.6670010030090271, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.8603; Top5: 0.9940
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8603874415497662, 'ACC_ID': 0.6833667334669339, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.8577; Top5: 0.9900
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8577844311377245, 'ACC_ID': 0.7180638722554891, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8570; Top5: 0.9888
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8570858283433134, 'ACC_ID': 0.7429141716566866, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8555; Top5: 0.9877
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8555776892430279, 'ACC_ID': 0.7592961487383798, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.8545; Top5: 0.9878
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8545402789638485, 'ACC_ID': 0.771135781383433, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.8527; Top5: 0.9865
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8526919242273181, 'ACC_ID': 0.7789132602193419, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.8498; Top5: 0.9860
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.849766303138215, 'ACC_ID': 0.7836634765190296, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.8506; Top5: 0.9862
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8506714772499498, 'ACC_ID': 0.7911405091200642, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.8497; Top5: 0.9853
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8497099347353154, 'ACC_ID': 0.7955039883973894, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.8515; Top5: 0.9851
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8515508376181788, 'ACC_ID': 0.8017913418477359, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.8509; Top5: 0.9852
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8508839354342813, 'ACC_ID': 0.8047655649500385, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.8490; Top5: 0.9843
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8490028490028491, 'ACC_ID': 0.8062678062678063, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.8472; Top5: 0.9845
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8472461844724618, 'ACC_ID': 0.8074319840743198, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.8476; Top5: 0.9839
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8476606363069246, 'ACC_ID': 0.8102308172177167, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.8473; Top5: 0.9834
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.847256491599107, 'ACC_ID': 0.8120079896604394, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.8473; Top5: 0.9835
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8472960992907801, 'ACC_ID': 0.8140514184397163, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.8483; Top5: 0.9830
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8482649842271294, 'ACC_ID': 0.8167192429022082, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.8475; Top5: 0.9819
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8475, 'ACC_ID': 0.8175, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36848494 0.30782199 ... 0.09187892 0.09185328 0.06782711]
VisdaOOD MNIST rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 84.7500; Top-5 accuracy: 98.1900
{'Method': 'rosita_loss_txt', 'AUC': 0.9870023750000001, 'FPR95': 0.1082, 'ACC_ALL': 0.8475, 'ACC_ID': 0.8175, 'ACC_OOD': 0.9993, 'ACC_HM': 0.8993039960369881, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='VisdaOOD', k_n=10, k_p=3, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_loss', workers=4)


Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/train_32x32.mat
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.8580; Top5: 0.9918
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8580246913580247, 'ACC_ID': 0.668724279835391, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8626; Top5: 0.9930
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8625877632898696, 'ACC_ID': 0.6629889669007021, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.8590; Top5: 0.9940
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8590514362057449, 'ACC_ID': 0.6586506346025384, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.8572; Top5: 0.9910
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8572854291417166, 'ACC_ID': 0.6616766467065869, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8586; Top5: 0.9896
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.858682634730539, 'ACC_ID': 0.6694610778443114, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8582; Top5: 0.9894
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8582337317397079, 'ACC_ID': 0.6743027888446215, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.8588; Top5: 0.9898
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8588101337887846, 'ACC_ID': 0.681753487048107, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.8581; Top5: 0.9893
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8581754735792622, 'ACC_ID': 0.6839481555333998, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.8558; Top5: 0.9889
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8557756510126864, 'ACC_ID': 0.6872913420876919, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.8559; Top5: 0.9894
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8558829424734415, 'ACC_ID': 0.6925235518139908, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.8546; Top5: 0.9884
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8546047860768673, 'ACC_ID': 0.6954314720812182, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.8552; Top5: 0.9881
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8551998673080112, 'ACC_ID': 0.6971305357439045, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.8555; Top5: 0.9877
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8554957724827056, 'ACC_ID': 0.7014604150653344, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.8534; Top5: 0.9866
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8534188034188034, 'ACC_ID': 0.7015669515669516, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.8524; Top5: 0.9867
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8524220305242203, 'ACC_ID': 0.7031187790311878, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.8519; Top5: 0.9863
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.851902682470368, 'ACC_ID': 0.7035558328134748, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.8513; Top5: 0.9864
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8512513218188227, 'ACC_ID': 0.704382563741041, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.8511; Top5: 0.9860
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.851063829787234, 'ACC_ID': 0.7080008865248227, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.8510; Top5: 0.9855
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8509989484752891, 'ACC_ID': 0.7107255520504732, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.8503; Top5: 0.9847
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8503, 'ACC_ID': 0.7135, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.35956883 0.31337175 ... 0.17506778 0.17506033 0.15183501]
VisdaOOD SVHN rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 85.0300; Top-5 accuracy: 98.4700
{'Method': 'rosita_loss_txt', 'AUC': 0.94856987, 'FPR95': 0.3677, 'ACC_ALL': 0.8503, 'ACC_ID': 0.7135, 'ACC_OOD': 0.9925, 'ACC_HM': 0.8301861078546309, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='ImagenetROOD', k_n=10, k_p=3, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_loss', workers=4)


len 10000
dict_values(['goldfish', 'great white shark', 'hammerhead shark', 'stingray', 'hen', 'ostrich', 'goldfinch', 'junco', 'bald eagle', 'vulture', 'smooth newt', 'axolotl', 'tree frog', 'green iguana', 'chameleon', 'Indian cobra', 'scorpion', 'tarantula', 'centipede', 'peafowl', 'lorikeet', 'hummingbird', 'toucan', 'duck', 'goose', 'black swan', 'koala', 'jellyfish', 'snail', 'American lobster', 'hermit crab', 'flamingo', 'great egret', 'pelican', 'king penguin', 'grey whale', 'killer whale', 'sea lion', 'Chihuahua', 'Shih Tzu', 'Afghan Hound', 'Basset Hound', 'Beagle', 'Bloodhound', 'Italian Greyhound', 'Whippet', 'Weimaraner', 'Yorkshire Terrier', 'Boston Terrier', 'Scottish Terrier', 'West Highland White Terrier', 'Golden Retriever', 'Labrador Retriever', 'Cocker Spaniel', 'collie', 'Border Collie', 'Rottweiler', 'German Shepherd Dog', 'Boxer', 'French Bulldog', 'St. Bernard', 'Siberian Husky', 'Dalmatian', 'pug', 'Pomeranian', 'Chow Chow', 'Pembroke Welsh Corgi', 'Toy Poodle', 'Standard Poodle', 'grey wolf', 'hyena', 'red fox', 'tabby cat', 'leopard', 'snow leopard', 'lion', 'tiger', 'cheetah', 'polar bear', 'meerkat', 'ladybug', 'fly', 'bee', 'ant', 'grasshopper', 'cockroach', 'praying mantis', 'dragonfly', 'monarch butterfly', 'starfish', 'cottontail rabbit', 'porcupine', 'fox squirrel', 'beaver', 'guinea pig', 'zebra', 'pig', 'hippopotamus', 'bison', 'gazelle', 'llama', 'skunk', 'badger', 'orangutan', 'gorilla', 'chimpanzee', 'gibbon', 'baboon', 'giant panda', 'eel', 'clownfish', 'pufferfish', 'accordion', 'ambulance', 'assault rifle', 'backpack', 'barn', 'wheelbarrow', 'basketball', 'bathtub', 'lighthouse', 'beer glass', 'binoculars', 'birdhouse', 'bow tie', 'broom', 'bucket', 'cauldron', 'candle', 'cannon', 'canoe', 'carousel', 'castle', 'mobile phone', 'cowboy hat', 'electric guitar', 'fire truck', 'flute', 'gas mask or respirator', 'grand piano', 'guillotine', 'hammer', 'harmonica', 'harp', 'hatchet', 'jeep', 'joystick', 'lab coat', 'lawn mower', 'lipstick', 'mailbox', 'missile', 'mitten', 'parachute', 'pickup truck', 'pirate ship', 'revolver', 'rugby ball', 'sandal', 'saxophone', 'school bus', 'schooner', 'shield', 'soccer ball', 'space shuttle', 'spider web', 'steam locomotive', 'scarf', 'submarine', 'tank', 'tennis ball', 'tractor', 'trombone', 'vase', 'violin', 'military aircraft', 'wine bottle', 'ice cream', 'bagel', 'pretzel', 'cheeseburger', 'hot dog', 'cabbage', 'broccoli', 'cucumber', 'bell pepper', 'mushroom', 'Granny Smith apple', 'strawberry', 'lemon', 'pineapple', 'banana', 'pomegranate', 'pizza', 'burrito', 'espresso', 'volcano', 'baseball player', 'scuba diver', 'acorn'])
len 10000
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7716; Top5: 0.9115
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7695473251028807, 'ACC_ID': 0.6193415637860082, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7713; Top5: 0.9268
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7703109327983951, 'ACC_ID': 0.6068204613841525, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7667; Top5: 0.9231
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7661990647962592, 'ACC_ID': 0.6072144288577155, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7703; Top5: 0.9256
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7699600798403193, 'ACC_ID': 0.6422155688622755, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7720; Top5: 0.9257
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7712574850299401, 'ACC_ID': 0.6666666666666666, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7679; Top5: 0.9229
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7672642762284196, 'ACC_ID': 0.6792828685258964, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7640; Top5: 0.9229
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7634500426985482, 'ACC_ID': 0.6868773128380302, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7594; Top5: 0.9242
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7592223330009971, 'ACC_ID': 0.6909272183449651, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7570; Top5: 0.9205
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7567326953038059, 'ACC_ID': 0.6944135321611395, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7512; Top5: 0.9174
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.751052315093205, 'ACC_ID': 0.6947284024854681, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7494; Top5: 0.9184
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7490935460478607, 'ACC_ID': 0.6976069615663524, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7460; Top5: 0.9182
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7458948415989385, 'ACC_ID': 0.6986233206170177, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7470; Top5: 0.9176
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7468101460415065, 'ACC_ID': 0.7029976940814758, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7441; Top5: 0.9165
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.744017094017094, 'ACC_ID': 0.7034188034188035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7432; Top5: 0.9180
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.743065693430657, 'ACC_ID': 0.7048440610484407, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7420; Top5: 0.9168
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7418590143480973, 'ACC_ID': 0.7058016219588272, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7441; Top5: 0.9180
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.743978380918811, 'ACC_ID': 0.7099048290447656, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7427; Top5: 0.9168
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7425753546099291, 'ACC_ID': 0.710438829787234, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7415; Top5: 0.9154
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7415352260778129, 'ACC_ID': 0.7109358569926393, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7399; Top5: 0.9149
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7399, 'ACC_ID': 0.7105, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.38668591 0.31295371 ... 0.13486147 0.13485208 0.11367027]
ImagenetROOD MNIST rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 73.9900; Top-5 accuracy: 91.4900
{'Method': 'rosita_loss_txt', 'AUC': 0.98204893, 'FPR95': 0.1121, 'ACC_ALL': 0.7399, 'ACC_ID': 0.7105, 'ACC_OOD': 0.9981, 'ACC_HM': 0.8300948729954347, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='ImagenetROOD', k_n=10, k_p=3, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_loss', workers=4)


len 10000
dict_values(['goldfish', 'great white shark', 'hammerhead shark', 'stingray', 'hen', 'ostrich', 'goldfinch', 'junco', 'bald eagle', 'vulture', 'smooth newt', 'axolotl', 'tree frog', 'green iguana', 'chameleon', 'Indian cobra', 'scorpion', 'tarantula', 'centipede', 'peafowl', 'lorikeet', 'hummingbird', 'toucan', 'duck', 'goose', 'black swan', 'koala', 'jellyfish', 'snail', 'American lobster', 'hermit crab', 'flamingo', 'great egret', 'pelican', 'king penguin', 'grey whale', 'killer whale', 'sea lion', 'Chihuahua', 'Shih Tzu', 'Afghan Hound', 'Basset Hound', 'Beagle', 'Bloodhound', 'Italian Greyhound', 'Whippet', 'Weimaraner', 'Yorkshire Terrier', 'Boston Terrier', 'Scottish Terrier', 'West Highland White Terrier', 'Golden Retriever', 'Labrador Retriever', 'Cocker Spaniel', 'collie', 'Border Collie', 'Rottweiler', 'German Shepherd Dog', 'Boxer', 'French Bulldog', 'St. Bernard', 'Siberian Husky', 'Dalmatian', 'pug', 'Pomeranian', 'Chow Chow', 'Pembroke Welsh Corgi', 'Toy Poodle', 'Standard Poodle', 'grey wolf', 'hyena', 'red fox', 'tabby cat', 'leopard', 'snow leopard', 'lion', 'tiger', 'cheetah', 'polar bear', 'meerkat', 'ladybug', 'fly', 'bee', 'ant', 'grasshopper', 'cockroach', 'praying mantis', 'dragonfly', 'monarch butterfly', 'starfish', 'cottontail rabbit', 'porcupine', 'fox squirrel', 'beaver', 'guinea pig', 'zebra', 'pig', 'hippopotamus', 'bison', 'gazelle', 'llama', 'skunk', 'badger', 'orangutan', 'gorilla', 'chimpanzee', 'gibbon', 'baboon', 'giant panda', 'eel', 'clownfish', 'pufferfish', 'accordion', 'ambulance', 'assault rifle', 'backpack', 'barn', 'wheelbarrow', 'basketball', 'bathtub', 'lighthouse', 'beer glass', 'binoculars', 'birdhouse', 'bow tie', 'broom', 'bucket', 'cauldron', 'candle', 'cannon', 'canoe', 'carousel', 'castle', 'mobile phone', 'cowboy hat', 'electric guitar', 'fire truck', 'flute', 'gas mask or respirator', 'grand piano', 'guillotine', 'hammer', 'harmonica', 'harp', 'hatchet', 'jeep', 'joystick', 'lab coat', 'lawn mower', 'lipstick', 'mailbox', 'missile', 'mitten', 'parachute', 'pickup truck', 'pirate ship', 'revolver', 'rugby ball', 'sandal', 'saxophone', 'school bus', 'schooner', 'shield', 'soccer ball', 'space shuttle', 'spider web', 'steam locomotive', 'scarf', 'submarine', 'tank', 'tennis ball', 'tractor', 'trombone', 'vase', 'violin', 'military aircraft', 'wine bottle', 'ice cream', 'bagel', 'pretzel', 'cheeseburger', 'hot dog', 'cabbage', 'broccoli', 'cucumber', 'bell pepper', 'mushroom', 'Granny Smith apple', 'strawberry', 'lemon', 'pineapple', 'banana', 'pomegranate', 'pizza', 'burrito', 'espresso', 'volcano', 'baseball player', 'scuba diver', 'acorn'])
len 10000
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/train_32x32.mat
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7716; Top5: 0.9115
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7695473251028807, 'ACC_ID': 0.6275720164609053, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7693; Top5: 0.9268
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7683049147442327, 'ACC_ID': 0.6138415245737212, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7660; Top5: 0.9238
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7655310621242485, 'ACC_ID': 0.5971943887775552, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7733; Top5: 0.9271
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7729540918163673, 'ACC_ID': 0.6002994011976048, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7748; Top5: 0.9281
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7744510978043913, 'ACC_ID': 0.6055888223552894, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7728; Top5: 0.9273
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7725763612217795, 'ACC_ID': 0.6039176626826029, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7734; Top5: 0.9268
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7731283803017364, 'ACC_ID': 0.6037574722459437, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7699; Top5: 0.9279
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.769690927218345, 'ACC_ID': 0.6089232303090728, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7661; Top5: 0.9261
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7658580013354106, 'ACC_ID': 0.6105052303583351, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7616; Top5: 0.9228
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7614752455401884, 'ACC_ID': 0.6113449589096012, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7603; Top5: 0.9240
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7599709934735316, 'ACC_ID': 0.6122189992748368, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7605; Top5: 0.9224
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7603250953723669, 'ACC_ID': 0.6181788024548018, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7597; Top5: 0.9214
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7594158339738662, 'ACC_ID': 0.62152190622598, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7562; Top5: 0.9205
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7561253561253561, 'ACC_ID': 0.6215099715099716, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7545; Top5: 0.9204
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7543463835434638, 'ACC_ID': 0.6248175182481752, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7529; Top5: 0.9188
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7528384279475983, 'ACC_ID': 0.6273237679351217, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7535; Top5: 0.9195
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7533779814357889, 'ACC_ID': 0.6320056397603102, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7517; Top5: 0.9186
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7515514184397163, 'ACC_ID': 0.6340868794326241, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7493; Top5: 0.9171
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.749211356466877, 'ACC_ID': 0.6355415352260778, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7477; Top5: 0.9169
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7476, 'ACC_ID': 0.6368, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.38294384 0.33915067 ... 0.17251213 0.17149277 0.17015754]
ImagenetROOD SVHN rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 74.7700; Top-5 accuracy: 91.6900
{'Method': 'rosita_loss_txt', 'AUC': 0.951118495, 'FPR95': 0.3654, 'ACC_ALL': 0.7476, 'ACC_ID': 0.6368, 'ACC_OOD': 0.9956, 'ACC_HM': 0.7767680470472923, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=3, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.7994; Top5: 0.9739
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7993981945837513, 'ACC_ID': 0.7362086258776329, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7908; Top5: 0.9753
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7909151636606546, 'ACC_ID': 0.7327989311957248, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7968; Top5: 0.9795
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7969061876247505, 'ACC_ID': 0.7425149700598802, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7967; Top5: 0.9796
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7968063872255489, 'ACC_ID': 0.7421157684630738, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.7938; Top5: 0.9781
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7938247011952191, 'ACC_ID': 0.7423638778220452, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7882; Top5: 0.9758
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7882152006831767, 'ACC_ID': 0.7440933674921719, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7886; Top5: 0.9761
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7886340977068793, 'ACC_ID': 0.7497507477567298, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7890; Top5: 0.9766
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.78878255063432, 'ACC_ID': 0.7540618740262631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7887; Top5: 0.9777
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7885347765083183, 'ACC_ID': 0.7572659851673682, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7866; Top5: 0.9791
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7864394488759971, 'ACC_ID': 0.7579767947788252, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7875; Top5: 0.9793
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7873610880743075, 'ACC_ID': 0.7608226903300713, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7863; Top5: 0.9788
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7861644888547271, 'ACC_ID': 0.7615680245964642, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7863; Top5: 0.9785
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7860398860398861, 'ACC_ID': 0.7632478632478632, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7863; Top5: 0.9784
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7861977438619775, 'ACC_ID': 0.7649635036496351, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7857; Top5: 0.9790
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7856519026824703, 'ACC_ID': 0.7656893325015596, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7835; Top5: 0.9786
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7833392080836564, 'ACC_ID': 0.7645400070497004, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7828; Top5: 0.9783
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7828014184397163, 'ACC_ID': 0.7650709219858156, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7843; Top5: 0.9785
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7842271293375395, 'ACC_ID': 0.7674027339642482, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7828; Top5: 0.9781
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7826, 'ACC_ID': 0.7666, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33738869 0.29659    ... 0.1065264  0.10652611 0.06592193]
cifar10OOD MNIST rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 78.2700; Top-5 accuracy: 97.8000
{'Method': 'rosita_loss_txt', 'AUC': 0.98872928, 'FPR95': 0.0813, 'ACC_ALL': 0.7826, 'ACC_ID': 0.7666, 'ACC_OOD': 0.9989, 'ACC_HM': 0.8674672783913906, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=3, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7881; Top5: 0.9753
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7880658436213992, 'ACC_ID': 0.7139917695473251, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8004; Top5: 0.9749
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8004012036108324, 'ACC_ID': 0.7412236710130391, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7968; Top5: 0.9759
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7975951903807615, 'ACC_ID': 0.7394789579158316, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.8003; Top5: 0.9785
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8008982035928144, 'ACC_ID': 0.7470059880239521, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8035; Top5: 0.9816
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8039920159680639, 'ACC_ID': 0.7532934131736527, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8074; Top5: 0.9817
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8074369189907038, 'ACC_ID': 0.7616201859229748, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7985; Top5: 0.9798
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.798462852263023, 'ACC_ID': 0.7526330771420439, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7961; Top5: 0.9796
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7961116650049851, 'ACC_ID': 0.7485044865403788, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7952; Top5: 0.9786
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.795237035388382, 'ACC_ID': 0.7404851991987537, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7927; Top5: 0.9771
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7925435959110042, 'ACC_ID': 0.73541791942273, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7931; Top5: 0.9773
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7933284989122552, 'ACC_ID': 0.7349528643944888, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7928; Top5: 0.9768
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7928346326090562, 'ACC_ID': 0.7326256427268204, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7906; Top5: 0.9757
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7906225980015372, 'ACC_ID': 0.728977709454266, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7887; Top5: 0.9754
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7886039886039886, 'ACC_ID': 0.7253561253561254, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7854; Top5: 0.9745
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7854014598540145, 'ACC_ID': 0.721300597213006, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7850; Top5: 0.9740
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7850280723643169, 'ACC_ID': 0.7187772925764192, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7845; Top5: 0.9726
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7845141581482787, 'ACC_ID': 0.7161320643872635, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7836; Top5: 0.9723
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7835771276595744, 'ACC_ID': 0.7124335106382979, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7842; Top5: 0.9722
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7842271293375395, 'ACC_ID': 0.7112513144058885, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7824; Top5: 0.9716
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7823, 'ACC_ID': 0.7089, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33737585 0.30069339 ... 0.15605444 0.15602982 0.1270435 ]
cifar10OOD SVHN rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 78.2300; Top-5 accuracy: 97.1600
{'Method': 'rosita_loss_txt', 'AUC': 0.95470999, 'FPR95': 0.3021, 'ACC_ALL': 0.7823, 'ACC_ID': 0.7089, 'ACC_OOD': 0.9845, 'ACC_HM': 0.8242731191685366, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=3, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar100', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.6707818930041153, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8024; Top5: 0.9769
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.802407221664995, 'ACC_ID': 0.6850551654964895, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7948; Top5: 0.9779
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7949231796927188, 'ACC_ID': 0.7020708082832331, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7978; Top5: 0.9795
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7979041916167665, 'ACC_ID': 0.7150698602794411, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.8019; Top5: 0.9820
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8015968063872255, 'ACC_ID': 0.7229540918163673, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8041; Top5: 0.9831
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8034528552456839, 'ACC_ID': 0.7270916334661355, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7965; Top5: 0.9829
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7961855963563905, 'ACC_ID': 0.7224594363791631, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7963; Top5: 0.9828
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7961116650049851, 'ACC_ID': 0.7205882352941176, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7959; Top5: 0.9829
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7956821722679724, 'ACC_ID': 0.7200089027375918, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7967; Top5: 0.9826
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7963519743435559, 'ACC_ID': 0.7229905792744037, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7984; Top5: 0.9835
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7982233502538071, 'ACC_ID': 0.7266134880348079, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7993; Top5: 0.9831
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7991375020733124, 'ACC_ID': 0.7276496931497761, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7997; Top5: 0.9832
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7993850883935434, 'ACC_ID': 0.7275941583397386, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.8000; Top5: 0.9826
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7995726495726496, 'ACC_ID': 0.7257834757834758, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7984; Top5: 0.9822
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.79814200398142, 'ACC_ID': 0.724220305242203, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7984; Top5: 0.9822
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7981285090455396, 'ACC_ID': 0.7240174672489083, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7992; Top5: 0.9820
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7989660439431324, 'ACC_ID': 0.7228292797556104, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.8002; Top5: 0.9820
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7999778368794326, 'ACC_ID': 0.721520390070922, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.8019; Top5: 0.9821
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.8016824395373291, 'ACC_ID': 0.7219768664563617, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7999; Top5: 0.9823
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7996, 'ACC_ID': 0.7197, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33939546 0.33122343 ... 0.17488855 0.17427644 0.15072826]
cifar10OOD cifar100 rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 79.9800; Top-5 accuracy: 98.2300
{'Method': 'rosita_loss_txt', 'AUC': 0.8627985050000001, 'FPR95': 0.5341, 'ACC_ALL': 0.7996, 'ACC_ID': 0.7197, 'ACC_OOD': 0.7353, 'ACC_HM': 0.7274163711340205, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar10OOD', k_n=10, k_p=3, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
10000 10000 20000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.7901; Top5: 0.9753
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7901234567901234, 'ACC_ID': 0.7160493827160493, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.8004; Top5: 0.9759
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7993981945837513, 'ACC_ID': 0.7372116349047142, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.7934; Top5: 0.9773
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7929191716766867, 'ACC_ID': 0.7374749498997996, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.7953; Top5: 0.9785
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7949101796407185, 'ACC_ID': 0.7430139720558883, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.7979; Top5: 0.9808
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7976047904191617, 'ACC_ID': 0.7516966067864271, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.8007; Top5: 0.9821
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.800464807436919, 'ACC_ID': 0.7583001328021248, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.7933; Top5: 0.9812
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7930543694847708, 'ACC_ID': 0.7517791061770567, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.7938; Top5: 0.9813
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7936191425722832, 'ACC_ID': 0.7509970089730807, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.7932; Top5: 0.9809
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7932339194302248, 'ACC_ID': 0.7480525261517916, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.7935; Top5: 0.9806
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7933453597915414, 'ACC_ID': 0.7486470234515935, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.7949; Top5: 0.9820
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7949601160261058, 'ACC_ID': 0.7527193618564177, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.7966; Top5: 0.9819
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7968153922706916, 'ACC_ID': 0.752695306020899, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.7963; Top5: 0.9820
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7966179861644889, 'ACC_ID': 0.752651806302844, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.7966; Top5: 0.9816
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7967236467236467, 'ACC_ID': 0.7508547008547009, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.7952; Top5: 0.9812
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7954877239548772, 'ACC_ID': 0.7503649635036497, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.7937; Top5: 0.9812
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7940112289457267, 'ACC_ID': 0.748471615720524, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.7946; Top5: 0.9808
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7948537187169545, 'ACC_ID': 0.7475032311126777, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.7944; Top5: 0.9807
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7946586879432624, 'ACC_ID': 0.7451241134751773, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.7964; Top5: 0.9811
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7965299684542587, 'ACC_ID': 0.7449001051524711, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.7948; Top5: 0.9809
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.7948, 'ACC_ID': 0.7412, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.33747816 0.33534566 ... 0.17256552 0.17253065 0.13990822]
cifar10OOD Tiny rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 79.4700; Top-5 accuracy: 98.0900
{'Method': 'rosita_loss_txt', 'AUC': 0.8661931050000001, 'FPR95': 0.4173, 'ACC_ALL': 0.7948, 'ACC_ID': 0.7412, 'ACC_OOD': 0.7225, 'ACC_HM': 0.7317305458768874, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=3, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='MNIST', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.5123; Top5: 0.7942
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.3724279835390947, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4905; Top5: 0.7934
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49047141424272817, 'ACC_ID': 0.36609829488465395, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4960; Top5: 0.7787
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49632598530394123, 'ACC_ID': 0.37942551770207084, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5072; Top5: 0.7793
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5069860279441117, 'ACC_ID': 0.3907185628742515, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5108; Top5: 0.7724
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5109780439121756, 'ACC_ID': 0.4039920159680639, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5058; Top5: 0.7665
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5059760956175299, 'ACC_ID': 0.4153386454183267, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5027; Top5: 0.7672
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5027042413891261, 'ACC_ID': 0.42442356959863364, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.4999; Top5: 0.7632
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4997507477567298, 'ACC_ID': 0.43020937188434694, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4977; Top5: 0.7636
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49766303138215, 'ACC_ID': 0.4353438682394836, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4934; Top5: 0.7616
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4936861094407697, 'ACC_ID': 0.4373621968330327, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4896; Top5: 0.7581
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4894851341551849, 'ACC_ID': 0.43836113125453224, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4862; Top5: 0.7553
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48615027367722674, 'ACC_ID': 0.4393763476530104, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4847; Top5: 0.7534
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4847040737893928, 'ACC_ID': 0.4410453497309762, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4827; Top5: 0.7512
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4824786324786325, 'ACC_ID': 0.44188034188034186, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4829; Top5: 0.7514
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4828135368281354, 'ACC_ID': 0.4449900464499005, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4813; Top5: 0.7501
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4810979413599501, 'ACC_ID': 0.44541484716157204, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4807; Top5: 0.7495
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4805545764305017, 'ACC_ID': 0.44695100458230524, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4775; Top5: 0.7486
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4773936170212766, 'ACC_ID': 0.4457003546099291, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4779; Top5: 0.7487
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4778128286014721, 'ACC_ID': 0.44763406940063094, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4756; Top5: 0.7488
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4756, 'ACC_ID': 0.4469, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36519945 0.30951419 ... 0.12166585 0.12166356 0.09370014]
cifar100OOD MNIST rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 47.5700; Top-5 accuracy: 74.8800
{'Method': 'rosita_loss_txt', 'AUC': 0.947989395, 'FPR95': 0.2034, 'ACC_ALL': 0.4756, 'ACC_ID': 0.4469, 'ACC_OOD': 0.9887, 'ACC_HM': 0.6155614795207579, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=3, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='SVHN', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
Using downloaded and verified file: /home/manogna/TTA/PromptAlign/data/ood/test_32x32.mat
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.5144; Top5: 0.7963
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.4012345679012346, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4965; Top5: 0.7954
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49648946840521563, 'ACC_ID': 0.38615847542627885, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4987; Top5: 0.7774
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49899799599198397, 'ACC_ID': 0.3967935871743487, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5047; Top5: 0.7793
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5034930139720559, 'ACC_ID': 0.4086826347305389, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5076; Top5: 0.7744
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5065868263473053, 'ACC_ID': 0.4179640718562874, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5058; Top5: 0.7745
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5053120849933599, 'ACC_ID': 0.4219787516600266, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5073; Top5: 0.7720
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.506689439225733, 'ACC_ID': 0.42727013948192427, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5024; Top5: 0.7686
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5017447657028913, 'ACC_ID': 0.42821535393818544, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.4968; Top5: 0.7645
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49610505230358337, 'ACC_ID': 0.4248831515691075, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.4906; Top5: 0.7612
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49007817197835235, 'ACC_ID': 0.4215273601924233, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.4845; Top5: 0.7547
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.48404641044234953, 'ACC_ID': 0.41751269035532995, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.4774; Top5: 0.7503
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4768618344667441, 'ACC_ID': 0.41316967988057723, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.4732; Top5: 0.7465
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4727132974634896, 'ACC_ID': 0.4115295926210607, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.4700; Top5: 0.7444
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46951566951566953, 'ACC_ID': 0.4101139601139601, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.4668; Top5: 0.7448
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.46635700066357, 'ACC_ID': 0.4088918380889184, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.4637; Top5: 0.7425
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4632563942607611, 'ACC_ID': 0.4086088583905178, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.4619; Top5: 0.7402
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.461402890377159, 'ACC_ID': 0.40794266243684646, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.4581; Top5: 0.7381
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.45766843971631205, 'ACC_ID': 0.40602836879432624, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.4560; Top5: 0.7366
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4556256572029443, 'ACC_ID': 0.40473186119873816, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.4540; Top5: 0.7348
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4537, 'ACC_ID': 0.4039, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36462167 0.30458599 ... 0.19035387 0.1903322  0.15222143]
cifar100OOD SVHN rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 45.4100; Top-5 accuracy: 73.4800
{'Method': 'rosita_loss_txt', 'AUC': 0.9434880849999999, 'FPR95': 0.2903, 'ACC_ALL': 0.4537, 'ACC_ID': 0.4039, 'ACC_OOD': 0.983, 'ACC_HM': 0.5725484173336217, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=3, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='cifar10', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
Files already downloaded and verified
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.5123; Top5: 0.7942
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5123456790123457, 'ACC_ID': 0.3374485596707819, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4895; Top5: 0.7944
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.4884653961885657, 'ACC_ID': 0.3229689067201605, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4926; Top5: 0.7774
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49298597194388777, 'ACC_ID': 0.33400133600534404, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5042; Top5: 0.7823
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5039920159680639, 'ACC_ID': 0.35429141716566864, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5164; Top5: 0.7796
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5165668662674651, 'ACC_ID': 0.36726546906187624, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5168; Top5: 0.7811
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5169322709163346, 'ACC_ID': 0.37250996015936255, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5178; Top5: 0.7797
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5177910617705664, 'ACC_ID': 0.3709080557927697, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5161; Top5: 0.7801
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5159521435692921, 'ACC_ID': 0.372382851445663, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5139; Top5: 0.7817
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5139105274872023, 'ACC_ID': 0.3661250834631649, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5134; Top5: 0.7831
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5135297654840649, 'ACC_ID': 0.3666065343756264, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5130; Top5: 0.7822
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5130529369108049, 'ACC_ID': 0.36892675852066714, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5090; Top5: 0.7809
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.508873776745729, 'ACC_ID': 0.36855199867308014, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5085; Top5: 0.7791
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5085318985395849, 'ACC_ID': 0.3714066102997694, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5073; Top5: 0.7772
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5072649572649572, 'ACC_ID': 0.37037037037037035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5104; Top5: 0.7784
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5104180491041805, 'ACC_ID': 0.37398805573988053, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5121; Top5: 0.7790
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5120399251403618, 'ACC_ID': 0.3779164067373674, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5118; Top5: 0.7800
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5118082481494537, 'ACC_ID': 0.3786864058277523, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5098; Top5: 0.7803
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5097517730496454, 'ACC_ID': 0.37743794326241137, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5121; Top5: 0.7813
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5120925341745531, 'ACC_ID': 0.3779179810725552, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5121; Top5: 0.7825
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5121, 'ACC_ID': 0.3771, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.36485037 0.35164467 ... 0.18639913 0.18123776 0.17718129]
cifar100OOD cifar10 rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 51.2100; Top-5 accuracy: 78.2500
{'Method': 'rosita_loss_txt', 'AUC': 0.697613825, 'FPR95': 0.844, 'ACC_ALL': 0.5121, 'ACC_ID': 0.3771, 'ACC_OOD': 0.6882, 'ACC_HM': 0.48722466910729373, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




Namespace(N_m=512, alpha=0.5, batch_size=1, classifier_type='txt', corruption='snow', dataroot='/home/manogna/TTA/PromptAlign/data/ood', dataset='cifar100OOD', k_n=10, k_p=3, level=5, loss_pl=True, loss_simclr=True, model='maple', model_type='ViT-B/16', n_views=64, ood_detector='maxlogit', out_dir='./logs', pl_thresh=0.6, seed=0, strong_OOD='Tiny', strong_ratio=1, tta_method='rosita_loss', workers=4)


Test on snow level 5
Files already downloaded and verified
len 10000
MaPLe design: Multi-modal Prompt Learning
Initial context: "a photo of a"
Number of MaPLe context words (tokens): 2

Step 999: Top1: 0.5123; Top5: 0.7984
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.51440329218107, 'ACC_ID': 0.38477366255144035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 1999: Top1: 0.4905; Top5: 0.7964
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49147442326980945, 'ACC_ID': 0.3510531594784353, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 2999: Top1: 0.4933; Top5: 0.7781
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.49432197728790916, 'ACC_ID': 0.353373413493654, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 3999: Top1: 0.5047; Top5: 0.7808
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5049900199600799, 'ACC_ID': 0.35578842315369263, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 4999: Top1: 0.5164; Top5: 0.7784
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5165668662674651, 'ACC_ID': 0.36167664670658684, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 5999: Top1: 0.5158; Top5: 0.7788
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5159362549800797, 'ACC_ID': 0.36819389110225764, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 6999: Top1: 0.5169; Top5: 0.7777
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5169370908055793, 'ACC_ID': 0.36976942783945344, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 7999: Top1: 0.5151; Top5: 0.7789
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5149551345962113, 'ACC_ID': 0.36889332003988035, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 8999: Top1: 0.5141; Top5: 0.7808
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5141330959269975, 'ACC_ID': 0.36434453594480304, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 9999: Top1: 0.5132; Top5: 0.7815
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5133293245139307, 'ACC_ID': 0.36420124273401483, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 10999: Top1: 0.5119; Top5: 0.7793
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5119651921682379, 'ACC_ID': 0.3640319071791153, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 11999: Top1: 0.5078; Top5: 0.7774
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5077127218444186, 'ACC_ID': 0.36108807430751366, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 12999: Top1: 0.5071; Top5: 0.7754
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5071483474250577, 'ACC_ID': 0.3620292083013067, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 13999: Top1: 0.5056; Top5: 0.7726
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5055555555555555, 'ACC_ID': 0.36324786324786323, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 14999: Top1: 0.5074; Top5: 0.7748
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5076310550763106, 'ACC_ID': 0.36363636363636365, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 15999: Top1: 0.5082; Top5: 0.7758
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5084217092950717, 'ACC_ID': 0.36781035558328135, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 16999: Top1: 0.5085; Top5: 0.7764
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5085183879685113, 'ACC_ID': 0.36916931030431205, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 17999: Top1: 0.5061; Top5: 0.7763
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5060948581560284, 'ACC_ID': 0.36713209219858156, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 18999: Top1: 0.5082; Top5: 0.7770
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5082018927444795, 'ACC_ID': 0.36740273396424816, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}

Step 19999: Top1: 0.5072; Top5: 0.7773
{'Method': 'rosita_loss_txt', 'AUC': 0, 'FPR95': 0, 'ACC_ALL': 0.5072, 'ACC_ID': 0.3657, 'ACC_OOD': 0, 'ACC_HM': 0, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}
[       inf 0.37917346 0.36607194 ... 0.18038462 0.17795284 0.17125851]
cifar100OOD Tiny rosita_loss_txt maxlogit


Final metrics: Top-1 accuracy: 50.7200; Top-5 accuracy: 77.7300
{'Method': 'rosita_loss_txt', 'AUC': 0.67693603, 'FPR95': 0.84, 'ACC_ALL': 0.5072, 'ACC_ID': 0.3657, 'ACC_OOD': 0.6811, 'ACC_HM': 0.4758851165456629, 'kp': 3, 'kn': 10, 'alpha': 0.5, 'loss_pl': True, 'loss_simclr': True, 'OOD Detector': 'maxlogit'}




1 0
